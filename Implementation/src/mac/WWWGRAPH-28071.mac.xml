<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="22" zv="CACHE" ts="2001-01-01 00:00:00">
<Routine name="WWWGRAPH" type="MAC" languagemode="0" timestamp="58440,0"><![CDATA[
WWWGRAPH(YFELD)  ;WWWGRAPH;DT;ERZEUGEN EINER GRAPHIC GIF-FORMAT;29.03.2000
	;
	;/------------------------------------------------------------------\
	;| Description of Function :
	;|		ERZEUGEN EINER GRAPHIC GIF-FORMAT
	;|
	;| Inputs : 
	;|
	;|
	;| ByRef :
	;|
	;|
	;| Returns :
	;|
	;|
	;| History :
	;| 30-May-2005		RobertW		SR12056: Attempt at Performance Increase
	;| 05-May-2005		Paul K		Normalised Directory
	;| DT	29.03.2000
	;|
	;\------------------------------------------------------------------/
	;
	;S YFELD="DATEI.GIF~GRAPHIKART0/1/2/3~HEADER~COLOR~JAN,FEB,MAR,APR,..~~100,200,300,400,500~~~SPALTE1~COLOR~WERT,WERT,WERT,WERT~SPALTE2~COLOR~WERT,WERT,WERT,WERT~SPALTE3~COLOR~WERT,WERT,WERT,WERT~SPALTE4~COLOR~WERT,WERT,WERT,WERT~~~~~~~~~~BREITE~HOEHE~SOURCE"
	; DATENREIHEN IN 12,15,18,21,24,27,30
	; 31 BREITE ;width 
	; 32 HÖHE ;highness 
	;S YFELD="~~~~~~~~~~~NN,NN,NN,NN,NN~~~NN,NN,NN,NN,NN~~~NN,NN,NN,NN,NN,NN,NN~~~NN,NN,NN,NN"
	;S YKEY=VORGABEDATEN AUS WWWPIC(0,YKEY,1)
	NEW YUSER,COL,COLOR,BREITE,HOEHE,MAXWERT,MINWERT,MAXCOLUMN,XACHSE,XACHSE,TXT,I,MAXSPALTE,HIGHT,DATEI
	SET YFELD=$GET(YFELD)
	SET YKEY=$GET(YKEY)
	SET YFELD1=""  
	IF YFELD=""&(YKEY'="") SET YFELD1=$GET(^WWWPIC(YM,YKEY,1))  ;VORGABEN AUS DATENERFASSUNG ;out of data gathering 
	IF YFELD1'="" FOR YI=1,2,3,4,5,6,7,8,9,10,11,13,14,16,17,19,20 IF $PIECE(YFELD,Y,YI)="" SET $PIECE(YFELD,Y,YI)=$PIECE(YFELD1,Y,YI)
	KILL ^WWWSOR(1)
	SET YUSER=1
	;I $G(YFELD)="" D  ;NUR TEST
	;.S YFELD="gif.gif~0~Phone and Fax Summary 1999 User: TEST ~8~Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec~Month                 (c) GlobalNet Telecom 2000~~No. of Calls~~Phone~125~124,300,431,345,543,444,666,432,345,455,444,333~Fax~90~100,120,110,133,122,90,100,112,100,122,106,133~other~59~22,33,23,25,34,0,0,0,0,0,0~Errors~45~10,4,0,34,3,2,3,3,3,1,0~"
	;.Q
	SET YFELD=$TRANSLATE(YFELD,";_",", ")  ;UMFORMEN ";" IN "," UND "_" IN " "
	IF $PIECE(YFELD,Y,1)="" SET $PIECE(YFELD,Y,1)="gif.gif"
	IF $PIECE(YFELD,Y,1)="" QUIT  ;KEINE DATEI ;no data file 
	;FARBEN FESTLEGEN
	SET COL(0)=$PIECE(YFELD,Y,4)
	IF COL(0)="" SET COL(0)=8
	SET COL(1)=$PIECE(YFELD,Y,11)
	IF COL(1)="" SET COL(1)=125
	SET COL(2)=$PIECE(YFELD,Y,14)
	IF COL(2)="" SET COL(2)=90
	SET COL(3)=$PIECE(YFELD,Y,17)
	IF COL(3)="" SET COL(3)=59
	SET COL(4)=$PIECE(YFELD,Y,20)
	IF COL(4)="" SET COL(4)=45
	SET COL(5)=$PIECE(YFELD,Y,23)
	IF COL(5)="" SET COL(5)=100
	SET COL(6)=$PIECE(YFELD,Y,26)
	IF COL(6)="" SET COL(6)=118
	SET COL(7)=$PIECE(YFELD,Y,29)
	IF COL(7)="" SET COL(7)=120
	FOR YI=0:1:7 IF COL(YI)'="" IF $DATA(^WWW100(0,"FARBE",SPRACHE,COL(YI),1)) SET COL(YI)=$PIECE($GET(^WWW100(0,"FARBE",SPRACHE,COL(YI),1)),Y,1)
	SET COLOR="WS,SW,"
	;FOR YI=1:1:7,0 SET COLOR=COLOR_$$^WWWUPER(COL(YI))_"," SET COL(YI)=$$^WWWUPER(COL(YI))
	FOR YI=1:1:7,0 SET COL(YI)=$zconvert(COL(YI),"U"),COLOR=COLOR_COL(YI)_","
	;ERRECHNEN MAXIMALWERTE ANZAHL DER SAULEN ODER LINIEN/ Y ACHSE ;Number the Or axle 
	SET MAXCOLUMN=1
	SET MAXWERT=0
	IF $PIECE(YFELD,Y,7)'="" DO
	. FOR YI(1)=1:1:50 QUIT:$PIECE($PIECE(YFELD,Y,7),",",YI(1))=""  IF MAXWERT<$PIECE($PIECE(YFELD,Y,7),",",YI(1)) SET MAXWERT=$JUSTIFY($PIECE($PIECE(YFELD,Y,7),",",YI(1)),0,0)
	. QUIT
	IF $PIECE(YFELD,Y,2)'=2 FOR YI=12,15,18,21,24,27,30 IF $PIECE(YFELD,Y,YI)'="" DO
	. SET MAXCOLUMN=MAXCOLUMN+1  ;ANZAHL DER SPALTEN ;Number the split 
	. IF $PIECE(YFELD,Y,7)="" FOR YI(1)=1:1 QUIT:$PIECE($PIECE(YFELD,Y,YI),",",YI(1),999)=""  DO
	. . IF MAXWERT<$PIECE($PIECE(YFELD,Y,YI),",",YI(1)) SET MAXWERT=$JUSTIFY($PIECE($PIECE(YFELD,Y,YI),",",YI(1)),0,0)
	. . QUIT
	. QUIT
	IF $PIECE(YFELD,Y,2)=2 FOR YI=12,15,18,21,24,27,30 IF $PIECE(YFELD,Y,YI)'="" DO   ;MAXWERT BEI STACK ;next to 
	. SET MAXCOLUMN=MAXCOLUMN+1  ;ANZAHL DER SPALTEN ;Number the split 
	. IF $PIECE(YFELD,Y,7)="" FOR YI(1)=1:1:50 DO
	. . NEW YSUM
	. . SET YSUM=""
	. . IF $PIECE($PIECE(YFELD,Y,12),",",YI(1),999)="" IF $PIECE($PIECE(YFELD,Y,15),",",YI(1),999)="" IF $PIECE($PIECE(YFELD,Y,18),",",YI(1),999)="" IF $PIECE($PIECE(YFELD,Y,21),",",YI(1),999)="" IF $PIECE($PIECE(YFELD,Y,21),",",YI(1),999)="" QUIT  ;KEINE WERTE ;no 
	. . FOR YI(2)=12,15,18,21,24,27,30 SET YSUM=YSUM+$PIECE($PIECE(YFELD,Y,YI(2)),",",YI(1))
	. . IF MAXWERT<YSUM SET MAXWERT=$JUSTIFY(YSUM,0,0)
	. . QUIT
	. QUIT
	IF MAXWERT=0 SET MAXWERT=1000
	IF MAXWERT>1000000000 SET $PIECE(YFELD,Y,2)=""  ;KEINE AUSWERTUNG ;no 
	;Y-ACHSENWERTE AUF MAXIMALGRÖßE ;upon 
	IF $PIECE(YFELD,Y,7)="" DO
	. SET MAXWERT1=$EXTRACT("100000000000000",1,$LENGTH(MAXWERT)+1)
	. IF $EXTRACT(MAXWERT)<5 SET MAXWERT1=MAXWERT1/2
	. IF MAXWERT1=10*MAXWERT SET MAXWERT1=MAXWERT  ;WENN GENAU 100,1000,...
	. SET MAXWERT=MAXWERT1
	. SET YACHSE=""
	. FOR YI=0:1:10 SET YACHSE=YACHSE_(MAXWERT/10*YI)_","
	. SET $PIECE(YFELD,Y,7)=YACHSE
	. QUIT
	;BESTIMMEN GRÖSSE ;ordain 
	SET BREITE=$PIECE(YFELD,Y,31)
	IF BREITE="" SET BREITE=480
	SET BREITE=BREITE+30+(10*MAXCOLUMN)
	SET HOEHE=$PIECE(YFELD,Y,32)
	IF HOEHE="" SET HOEHE=300
	SET HOEHE=HOEHE+30+30
	DO NEW^WWWPIC(BREITE,HOEHE,COLOR)
	;Y-ACHSE BEARBEITEN
	;I +$P($P(YFELD,Y,7),",",1)'=0 S $P(YFELD,Y,7)="0,"_$P(YFELD,Y,7)  ;START BEI 0
	SET MINWERT=+$PIECE($PIECE(YFELD,Y,7),",",1)  ;KLEINSTER WERT ;worthy 
	SET YMAXWERTE=0
	FOR YI=1:1:50 QUIT:$PIECE($PIECE(YFELD,Y,7),",",YI)=""  SET YMAXWERTE=YMAXWERTE+1  ;WIE VIELE WERTE ;such as much 
	SET YMAXWERTE=YMAXWERTE-1  ;EINEN WENIGER ;minus 
	;X ACHSE BESTIMMEN ;X axle ordain 
	KILL TXT
	SET XACHSE=$PIECE(YFELD,Y,5)
	IF XACHSE="" SET XACHSE=$$^WWWTEXT(30024,,1)  ;MONATE
	SET TXT(0)=""
	FOR YI=1:1:50 QUIT:$PIECE(XACHSE,",",YI)=""  SET TXT(0)=TXT(0)_$P($PIECE(XACHSE,",",YI),"|",1)_Y
	SET MAXSPALTE=YI-1  ;ANZAHL DER X ACHSEN SPALTEN ;Number the X split 
	IF MAXSPALTE<7 SET MAXSPALTE=7 
	SET TXT(1)=$PIECE(YFELD,Y,6)  ;BEZEICHNUNG X ACHSE ;notation X axle 
	DO XAXE^WWWPIC(30,30,BREITE-30-(10*MAXCOLUMN),MAXSPALTE,0,"TXT",0)   ;DRUCKEN X ACHSE ;print X axle 
	;Y ACHSE BESTIMMEN ;axle ordain 
	KILL TXT 
	SET TXT(0)=$TRANSLATE($PIECE(YFELD,Y,7),",",Y)
	SET TXT(1)=$PIECE(YFELD,Y,8)
	DO YAXE^WWWPIC(30,30,HOEHE-30-30,YMAXWERTE,0,"TXT",0)
	;3D
	DO LINE^WWWPIC(30,30,30+5,30+5)
	DO LINE^WWWPIC(30+5,30+5,30+5,HOEHE-30+5)
	DO LINE^WWWPIC(30+5,30+5,BREITE-(10*MAXCOLUMN)+5,30+5)
	;HILFSLINIEN
	FOR I=1:1:MAXSPALTE+1 DO   
	. DO LINE^WWWPIC($JUSTIFY(30+((BREITE-30-(10*MAXCOLUMN))/MAXSPALTE*(I-1)),0,0)-1,30,$JUSTIFY(30+((BREITE-30-(10*MAXCOLUMN))/MAXSPALTE*(I-1)),0,0)+5,30+5)
	FOR I=1:1:YMAXWERTE DO
	. DO LINE^WWWPIC(30,$JUSTIFY((HOEHE-30-30)/YMAXWERTE*I,0,0)+30,30+5,$JUSTIFY((HOEHE-30-30)/YMAXWERTE*I,0,0)+5+30)
	. DO LINE^WWWPIC(30+5,$JUSTIFY((HOEHE-30-30)/YMAXWERTE*I,0,0)+5+30,30+5+BREITE-30-(10*MAXCOLUMN),$JUSTIFY((HOEHE-30-30)/YMAXWERTE*I,0,0)+5+30)
	. QUIT
	;ZEICHNEN FLÄCHE ;drawing top 
	IF $PIECE(YFELD,Y,2)=0 FOR YI=1:1:MAXCOLUMN-1 DO
	. DO PEN^WWWPIC(COL(YI))
	. KILL TST
	. FOR I=1:1:MAXSPALTE DO  IF +WERT>0 SET TST($JUSTIFY(30+((BREITE-30-(10*MAXCOLUMN))/MAXSPALTE*(I-1)),0,0)+3)=WERT+30+3  ;TST(XWERT)=YWERT
	. . SET WERT=$JUSTIFY((HOEHE-30-30)/(MAXWERT-MINWERT)*($PIECE($PIECE(YFELD,Y,9+(YI*3)),",",I)-MINWERT),0,0)  ;UMRECHNEN
	. . QUIT
	. DO XHIS^WWWPIC("TST",33,$JUSTIFY((BREITE-30-(10*MAXCOLUMN))/MAXSPALTE/(MAXCOLUMN-1),0,0),$JUSTIFY((BREITE-30-(10*MAXCOLUMN))/MAXSPALTE/(MAXCOLUMN-1)*(YI-1),0,0))
	. KILL TST
	. QUIT
	;ZEICHNEN LINIEN ;drawing 
	IF $PIECE(YFELD,Y,2)=1 FOR YI=1:1:MAXCOLUMN-1 DO
	. DO PEN^WWWPIC(COL(YI))
	. KILL TST 
	. FOR I=1:1:MAXSPALTE DO  IF +WERT>0 SET TST($JUSTIFY(30+((BREITE-30-(10*MAXCOLUMN))/MAXSPALTE*(I-1)),0,0)+5)=WERT+30+5  ;TST(XWERT)=YWERT
	. . SET WERT=$JUSTIFY((HOEHE-30-30)/(MAXWERT-MINWERT)*($PIECE($PIECE(YFELD,Y,9+(YI*3)),",",I)-MINWERT),0,0)  ;UMRECHNEN
	. . QUIT
	. DO KURV^WWWPIC("TST",YI)
	. KILL TST
	. QUIT
	;ZEICHNEN STAPEL ;drawing 
	IF $PIECE(YFELD,Y,2)=2 KILL TST1 FOR YI=1:1:MAXCOLUMN-1 DO
	. DO PEN^WWWPIC(COL(YI))
	. FOR I=1:1:MAXSPALTE DO
	. . KILL TST
	. . SET WERT=$JUSTIFY((HOEHE-30-30)/(MAXWERT-MINWERT)*($PIECE($PIECE(YFELD,Y,9+(YI*3)),",",I)-MINWERT),0,0)  ;UMRECHNEN
	. . SET TST($JUSTIFY(30+((BREITE-30-(10*MAXCOLUMN))/MAXSPALTE*(I-1)),0,0)+3)=WERT+30+3+$GET(TST1(YI-1,I))  ;TST(XWERT)=YWERT
	. . SET TST1(YI,I)=WERT+$GET(TST1(YI-1,I))
	. . IF +WERT>0 DO XHIS^WWWPIC("TST",33+$GET(TST1(YI-1,I)),$JUSTIFY((BREITE-30-(10*MAXCOLUMN))/MAXSPALTE,0,0),0)
	. . QUIT
	. QUIT
	KILL TST,TST1
	;ZEICHNEN KURSVERLAUF ;drawing 
	IF $PIECE(YFELD,Y,2)=3 DO  ;F YI=1:1:MAXCOLUMN-1 D   
	. DO PEN^WWWPIC(COL(1))
	. KILL WERTY,WERTX,WERTZ
	. FOR I=1:1:MAXSPALTE DO
	. . SET YI=1
	. . SET WERTX(YI)=0
	. . SET WERTY(YI)=$JUSTIFY((HOEHE-30-30)/(MAXWERT-MINWERT)*($PIECE($PIECE(YFELD,Y,9+(YI*3)),",",I)-MINWERT),0,0)+30+5  ;UMRECHNEN
	. . IF +WERTY(YI)>0 SET WERTX(YI)=$JUSTIFY(30+((BREITE-30-(10*MAXCOLUMN))/MAXSPALTE*(I-1)),0,0)+5  ;XWERT
	. . SET YI=2
	. . SET WERTX(YI)=0
	. . SET WERTY(YI)=$JUSTIFY((HOEHE-30-30)/(MAXWERT-MINWERT)*($PIECE($PIECE(YFELD,Y,9+(YI*3)),",",I)-MINWERT),0,0)+30+5  ;UMRECHNEN
	. . IF +WERTY(YI)>0 SET WERTX(YI)=$JUSTIFY(30+((BREITE-30-(10*MAXCOLUMN))/MAXSPALTE*(I-1)),0,0)+5  ;XWERT
	. . SET YI=3 
	. . SET WERTX(YI)=0
	. . SET WERTY(YI)=$JUSTIFY((HOEHE-30-30)/(MAXWERT-MINWERT)*($PIECE($PIECE(YFELD,Y,9+(YI*3)),",",I)-MINWERT),0,0)+30+5  ;UMRECHNEN
	. . IF +WERTY(YI)>0 SET WERTX(YI)=$JUSTIFY(30+((BREITE-30-(10*MAXCOLUMN))/MAXSPALTE*(I-1)),0,0)+5  ;XWERT
	. . DO LINE^WWWPIC(WERTX(1)+2,WERTY(1),WERTX(1)+2,WERTY(2))
	. . DO LINE^WWWPIC(WERTX(1)+1,WERTY(1),WERTX(1)+1,WERTY(2))
	. . IF WERTY(3)>35 DO LINE^WWWPIC(WERTX(1)+1,WERTY(3),WERTX(1)+5,WERTY(3))
	. . IF WERTY(3)>35 DO LINE^WWWPIC(WERTX(1)+1,WERTY(3)+1,WERTX(1)+5,WERTY(3)+1)
	. . QUIT
	. QUIT
	;UEBERSCHRIFT
	DO PEN^WWWPIC(COL(0))
	DO XTXT^WWWPIC(BREITE-110-(10*MAXCOLUMN),HOEHE-15,$$^WWWDATE($HOROLOG)_" "_$$^WWWTIME($HOROLOG),0,0)
	DO XTXT^WWWPIC(30,HOEHE-15,$PIECE(YFELD,Y,3),0,2)
	SET SOURCE=$EXTRACT($PIECE(YFELD,Y,33),1,30)
	DO XTXT^WWWPIC(5,5,SOURCE,0,0)
	SET SOURCE=$CHAR(40,112,111,119,101,114,101,100,32,98,121,32,73,78,84,82,65,80,82,69,78,68,41)
	DO XTXT^WWWPIC(BREITE-140,5,SOURCE,0,0)
	;LEGENDE ;legend 
	IF $PIECE(YFELD,Y,2)'=3 FOR YI=1:1:MAXCOLUMN-1 DO
	. SET HIGHT=30
	. DO PEN^WWWPIC(COL(YI))
	. FOR YI(1)=0:1:7 DO  ;BOX MALEN ;paint 
	. . DO LINE^WWWPIC(BREITE-((10*MAXCOLUMN)-(YI*10))-YI(1),HIGHT,BREITE-((10*MAXCOLUMN)-(YI*10))-YI(1),HIGHT+10)
	. . QUIT
	. DO PEN^WWWPIC(COL(0))
	. FOR YI(1)=1:1:3 DO  ;BOX MALEN ;paint 
	. . DO LINE^WWWPIC(BREITE-((10*MAXCOLUMN)-(YI*10))+YI(1),HIGHT+YI(1),BREITE-((10*MAXCOLUMN)-(YI*10))+YI(1),HIGHT+10+YI(1))
	. . QUIT
	. DO PEN^WWWPIC(COL(0))
	. FOR YI(1)=1:1:3 DO  ;BOX MALEN ;paint 
	. . DO LINE^WWWPIC(BREITE-((10*MAXCOLUMN)-(YI*10))+YI(1)-8,HIGHT+10+YI(1),BREITE-((10*MAXCOLUMN)-(YI*10))+YI(1),HIGHT+10+YI(1))
	. . QUIT
	. DO YTXT^WWWPIC(BREITE-((10*MAXCOLUMN)-(YI*10)),HIGHT+18,$PIECE(YFELD,Y,7+(3*YI)),0,0)
	. QUIT
	;bild und map ;and 
	WRITE YCR
	SET DATEI=$PIECE(YFELD,Y,1)
	WRITE "<IMG SRC="_""""_YGIF_DATEI_""""_" Border=1 TITLE="_""""_$PIECE(YFELD,Y,3)_""""_" USEMAP="_""""_"#WWW_MAP"_""""_">"
	WRITE YCR
	;erstellen gif
	SET DATEI=$PIECE(YFELD,Y,1)
	SET FILE=##Class(%File).NormalizeDirectory($PIECE($GET(^WWW012(0,YM,1)),Y,49)) ;SR12252
	SET DATEI=FILE_$PIECE(YFELD,Y,1)
	DO GIF^WWWPIC(DATEI,"WS")
	WRITE "<MAP NAME="_""""_"WWW_MAP"_""""_">"
	WRITE YCR
	IF $PIECE(YFELD,Y,2)=0 DO  ;BOX
	. NEW X1,X2,Y1,Y2,OF,TXT,YI,I
	. FOR YI=1:1:MAXCOLUMN-1 DO
	. . FOR I=1:1:MAXSPALTE DO 
	. . . QUIT:+$PIECE($PIECE(YFELD,Y,9+(YI*3)),",",I)=0
	. . . SET Y1=30
	. . . SET Y2=$JUSTIFY((HOEHE-30-30)/(MAXWERT-MINWERT)*($PIECE($PIECE(YFELD,Y,9+(YI*3)),",",I)-MINWERT),0,0)+30+3 ;YWERT
	. . . SET X1=$JUSTIFY(30+((BREITE-30-(10*MAXCOLUMN))/MAXSPALTE*(I-1)),0,0)  ;XWERT
	. . . SET OF=$JUSTIFY((BREITE-30-(10*MAXCOLUMN))/MAXSPALTE/(MAXCOLUMN-1)*(YI-1),0,0)  ;OFFSET
	. . . SET X1=X1+OF
	. . . SET X2=X1+$JUSTIFY((BREITE-30-(10*MAXCOLUMN))/MAXSPALTE/(MAXCOLUMN-1),0,0)  ;BREITE ;width 
	. . . ;TXT="SPALTE  X-ACHSE  WERT"
	. . . SET TXT=$TR($PIECE($PIECE(YFELD,Y,5),",",I),"|"," ")_": "_$PIECE($PIECE($PIECE(YFELD,Y,9+(YI*3)),",",I),".",1)_" "_$PIECE(YFELD,Y,7+(3*YI))
	. . . WRITE YCR
	. . . SET Y1=HOEHE-Y1  ;COORDINATEN DREHEN ;veer 
	. . . SET Y2=HOEHE-Y2  ;DREHEN ;veer 
	. . . WRITE "<AREA SHAPE=RECT COORDS="_""""_X1_","_Y1_" "_X2_","_Y2_""""_" TITLE="_""""_TXT_""""
	. . . WRITE ">"
	. . . QUIT
	. . QUIT
	. QUIT
	IF $PIECE(YFELD,Y,2)=2 DO   ;STAPEL
	. NEW X1,X2,Y1,Y2,OF,TXT,YI,I,TST1
	. FOR YI=1:1:MAXCOLUMN-1 DO
	. . FOR I=1:1:MAXSPALTE DO
	. . . IF +$PIECE($PIECE(YFELD,Y,9+(YI*3)),",",I)=0 SET TST1(YI,I)=$GET(TST1(YI-1,I)) QUIT
	. . . SET Y1=30
	. . . SET Y2=$JUSTIFY((HOEHE-30-30)/(MAXWERT-MINWERT)*($PIECE($PIECE(YFELD,Y,9+(YI*3)),",",I)-MINWERT),0,0)+30+3+$GET(TST1(YI-1,I))  ;YWERT
	. . . SET TST1(YI,I)=Y2-30-3
	. . . SET X1=$JUSTIFY(30+((BREITE-30-(10*MAXCOLUMN))/MAXSPALTE*(I-1)),0,0)  ;XWERT
	. . . SET OF=0  ;OFFSET
	. . . SET X1=X1+OF
	. . . SET X2=X1+$JUSTIFY((BREITE-30-(10*MAXCOLUMN))/MAXSPALTE,0,0)  ;BREITE ;width 
	. . . ;TXT="SPALTE  X-ACHSE  WERT"
	. . . SET TXT=$TR($PIECE($PIECE(YFELD,Y,5),",",I),"|"," ")_": "_$P($PIECE($PIECE(YFELD,Y,9+(YI*3)),",",I),".",1)_" "_$PIECE(YFELD,Y,7+(3*YI))
	. . . WRITE YCR
	. . . SET Y1=HOEHE-Y1  ;COORDINATEN DREHEN ;veer 
	. . . SET Y2=HOEHE-Y2  ;DREHEN ;veer 
	. . . WRITE "<AREA SHAPE=RECT COORDS="_""""_X1_","_Y1_" "_X2_","_Y2_""""_" TITLE="_""""_TXT_""""
	. . . WRITE ">"
	. . . QUIT
	. . QUIT
	. QUIT
	WRITE YCR
	WRITE "<AREA SHAPE=RECT COORDS="_""""_(BREITE-140)_","_HOEHE_" "_BREITE_","_(HOEHE-10)_""""_" TITLE="_""""_"INTRAPREND"_""""
	WRITE " HREF=http://www.intraprend.de>"
	WRITE YCR
	WRITE "</MAP>"
	WRITE YCR
	KILL ^WWWSOR(1)
	QUIT
]]></Routine>
</Export>