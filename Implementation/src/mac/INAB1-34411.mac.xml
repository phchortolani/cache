<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="22" zv="CACHE" ts="2001-01-01 00:00:00">
<Routine name="INAB1" type="MAC" languagemode="0" timestamp="58440,0"><![CDATA[
INAB1
#include COMSYS
	;-------------------------------------------------------------------------------
	; Description of Function :
	; 		Print Confirmation of Customer Order
	;		DRUCKEN EINZEL AB
	;
	; Inputs : 
	;
	;
	; ByRef :
	;
	;
	; Returns :
	;
	;
	; History :
	; 25.11.2004	BEC		26820
	; 02.06.2004	BEC		25224
	; 23.02.2004	FIS		25177
	; 28.04.2003	BEC		PDF ERGÄNTZT
	; 13.03.2003	FAN		23059
	; 08-Jul-2000			Created
	;-------------------------------------------------------------------------------
	NEW POS,YAUFTRAG,WH,YPOSITION
	
	IF $PIECE($GET(YKEY),",",1)="" DO ^WWWFORM QUIT   ;KEIN KEY ENTHALTEN ;no KEY include 
	
	;PRUEFEN WH
	SET YAUFTRAG  = $PIECE($GET(YKEY),",",1)
	SET YPOSITION = $PIECE($GET(YKEY),",",2)
	
	IF YPOSITION'="" SET YAUFTRAG(YPOSITION)=""  ;NUR 1 POSITION DRUCKEN ;only print 
	
	;SET WH=""
	;I $PIECE($GET(^INAUF(YM,YAUFTRAG,1)),Y,196)'=1 SET POS="" FOR  SET POS=$ORDER(^INAUFP(YM,YAUFTRAG,POS)) QUIT:POS=""  DO  QUIT:WH="X"
	;.IF +$PIECE($GET(^INAUFP(YM,YAUFTRAG,POS,1)),Y,7)=0 SET WH="X"
	
	;IF WH="X" DO ^WWWINFO($$^WWWTEXT(32076)) QUIT  ;NICHT ALLE WH ERFASST
	
	NEW AUFTRAG1,POS
	
	;BEC;26820;25.11.04;KEINE AUFBAU DER ANZEIGE BEI NUR EINEM GESPERRTEN ARTIKEL
	SET POS=""
	FOR  SET POS=$ORDER(^INAUFP(YM,YAUFTRAG,POS)) QUIT:POS=""  DO 
	. QUIT:+$PIECE($GET(^INAUFP(YM,YAUFTRAG,POS,1)),Y,205)=1  ;GESPERRT ;DISABLED;BEC;26820;25.11.04
	. ;IF $GET(VORG(1))=1 IF +$PIECE($GET(^INAUFP(YM,AUFTRAG,POS,1)),Y,79)=0 SET YAUFTRAG(POS)=""           ;GESAMTDRUCK
	. ;IF $GET(VORG(2))'="" IF +$PIECE($GET(^INAUFP(YM,AUFTRAG,POS,1)),Y,79)=VORG(2) SET YAUFTRAG(POS)=""   ;WIEDERHOLUNGSDRUCK
	. ;IF $GET(VORG(1))=1 IF +$PIECE($GET(^INAUFP(YM,AUFTRAG,POS,1)),Y,60)=1 KILL YAUFTRAG(POS)             ;BEC;25224;02.06.04;nicht bei abgeschlossen pos
	. ;IF $PIECE(SATZ,Y,1)'="" I $P($G(^INKUNDE(YM,$PIECE(SATZ,Y,1),1)),Y,32)=1 W $$^WWWTEXT(32047)," ",AUFTRAG," "  ;BEC;25.11.04;26820
	. SET YAUFTRAG1(POS)=""
	IF '$DATA(YAUFTRAG1) WRITE $$^WWWTEXT(46),"<BR>" QUIT ;KEINE DATEN ;no Line Item 
	
	SET YBELEG=2
	SET YCOPY=0     ; KEINE WIEDERHOLUNG ;no repetition 
	DO ^INDRUCK     ; DRUCK ;printing 
	DO ^INDRUCKZHD  ; DRUCK KOPIE ZU ANSPRECHENPATNER     FAN;13.03.2003;23059 ;printing copy within buff 
	QUIT
	
	
MAIL ;SEND VIA MAIL  / EINSPRUNG VON DRUCKFORMULAR
	SET YSEND=1  ;MAIL
	DO INAB1
	QUIT
	
FAX ;SEND VIA FAX  / EINSPRUNG VON DRUCKFORMULAR
	SET YSEND=2  ;FAX
	DO INAB1
	QUIT
	
XML ;SEND VIA XML  / EINSPRUNG VON DRUCKFORMULAR
	SET YSEND=3  ;XML ;XML
	DO INAB1
	QUIT
	
EDI ;SEND VIA EDI  / EINSPRUNG VON DRUCKFORMULAR
	SET YSEND=4  ;EDI ;EDI 
	DO INAB1
	QUIT
	
FTP ;SEND VIA FTP  / EINSPRUNG VON DRUCKFORMULAR
	SET YSEND=5  ;FTP
	DO INAB1
	QUIT
	
EDIP ;SEND VIA EDI  / EINSPRUNG VON DRUCKFORMULAR
	SET YSEND=6  ;EDI
	DO INAB1
	QUIT
	
PDF ;SEND VIA PDF  / EINSPRUNG VON DRUCKFORMULAR     ;BEC;28.04.03;PDF ERGÄNTZT
	SET YSEND=7  ;PDF
	DO INAB1
	QUIT
	
STDIF ;SEND VIA STD. INTERFACE  / EINSPRUNG VON DRUCKFORMULAR    ;FIS;23.02.04;25177
	SET YSEND=9  ;STANDARDSCHNITTSTELLE
	DO INAB1
	QUIT
]]></Routine>
</Export>