<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="22" zv="CACHE" ts="2001-01-01 00:00:00">
<Routine name="INPROAUF" type="MAC" languagemode="0" timestamp="58440,0"><![CDATA[
INPROAUF        ;INPROAUF;DT;AUSWAHL DER AUFTRÄGE FÜR DIE FERTIGUNGSAUFTRÄGE;06.09.2000
	;
	;/------------------------------------------------------------------\
	;| Description of Function :
	;|		AUSWAHL DER AUFTRÄGE FÜR DIE FERTIGUNGSAUFTRÄGE
	;|
	;| Inputs : 
	;|
	;|
	;| ByRef :
	;|
	;|
	;| Returns :
	;|
	;|
	;| History :
	;|
	;| DT	06.09.2000
	;|
	;\------------------------------------------------------------------/
	;
	NEW AUF,POS,POS1,AUF1,YSORT,YLFN,YLFNUM,YLFPOS,PRODU,MATERIAL,ZEICHN,STUECKL,YQ,FERTIG
	;SUCHEN NOCH NICHT GEDRUCKTE ANWEISUNGEN ;seek yet Not 
	;SUCHEN OFFENE AUFTRÄGE ;seek 
	;VORG(1)=DATUM DER FERTIGUNG ;the 
	;VORG(11)=NUR BESTIMMTE FERTIGUNGSPLÄTZE
	;VORG(12)=NUR BESTIMMTE AUFTRÄGE
	;VORG(9)=WIEDERHOLUNGSDRUCK
	;VORG(10)=WIEDERHOLUNG EINER FERTIGUNGSNUMMER ;unit 
	;VORG(13)=WIEDERHOLUNG ALLER BELEGE AB FERTIGUNGSNUMMER ;everyone Confirm. 
	;VORG(14)=KEIN DRUCK WENN QM-PRÜFUNG / PRODUKTION AUF ABGESCHLOSSEN GESETZT WURDE ;printing when production upon staid were 
	;VORG(2)=DRUCK DER FERTIGUNGSAUFTRÄGE J/N  ;the 
	;VORG(4)=DRUCK DER ZEICHNUNGEN ;the 
	;VORG(5)=MIT STUECKLISTEN
	;VORG(3)=MIT MATERIALAUSGABESCHEINEN
	;VORG(6)=DRUCK DER FERTIGMELDUNG ;the 
	SET VORG(1)=$GET(VORG(1))
	SET VORG(2)=+$GET(VORG(2))
	SET VORG(3)=+$GET(VORG(3))
	SET VORG(4)=+$GET(VORG(4))
	SET VORG(5)=+$GET(VORG(5))
	SET VORG(6)=+$GET(VORG(6))
	SET VORG(9)=+$GET(VORG(9))
	SET VORG(10)=$GET(VORG(10))
	SET VORG(11)=$GET(VORG(11))
	SET VORG(12)=$GET(VORG(12))
	SET VORG(13)=$GET(VORG(13))
	SET VORG(14)=+$GET(VORG(14))
	KILL ^WWWSOR(YUSER)
	SET PRODU=+VORG(2)
	SET MATERIAL=+VORG(3)
	SET ZEICHN=+VORG(4)
	SET STUECKL=+VORG(5)
	SET FERTIG=+VORG(6)
	IF VORG(1)="" IF VORG(12)="" IF VORG(10)="" QUIT  ;KEINE AUSWAHL ;no Selection 
	SET VORG(1)=$$^WWWDATE1(VORG(1))
	IF VORG(10)'=""!(VORG(13)'="") SET VORG(9)=1  ;WIEDERHOLUNGSDRUCK
	IF VORG(13)'="" SET VORG(1)=""
	IF VORG(10)'="" SET VORG(1)=""
	IF VORG(10)'="" SET ^WWWSOR(YUSER," "," ")=VORG(10)   ;BESTIMMTE NUMMER WIEDERHOLEN ;numeral retell 
	IF VORG(10)="" DO
	. SET AUF="" FOR  SET AUF=$ORDER(^INAUF1(YM,AUF)) QUIT:AUF=""  DO  ;OFFENE AUFTRÄGE
	. . IF $GET(VORG(12))'="" QUIT:'$FIND(","_$TRANSLATE(VORG(12),";",",")_",",","_AUF_",")  ;NICHT AUSGEWÄHLT
	. . SET AUF1=$GET(^INAUF(YM,AUF,1))
	. . QUIT:$PIECE(AUF1,Y,2)=2  ;LIEFERANTENBESTELLUNG NICHT AUSGEBEN ;Not 
	. . SET POS="" FOR  SET POS=$ORDER(^INAUFP(YM,AUF,POS)) QUIT:POS=""  DO
	. . . SET POS1=$GET(^INAUFP(YM,AUF,POS,1))  ;AUFTRAGSPOSITION
	. . . ;QUIT:$PIECE(POS1,Y,168)=""   ;KEIN PRODUKTIONSBEGINN;GGF BEGINN FÜR DIE TEILE
	. . . IF $PIECE(POS1,Y,7)'=3 QUIT  ;KEINE PRODUKTION ;no production 
	. . . IF +$PIECE(POS1,Y,60)=1 QUIT  ;ABGESCHLOSSENE POSITION
	. . . IF +$PIECE(POS1,Y,90)=1 QUIT  ;AUSLIEFERUNGSFÄHIG
	. . . IF +$PIECE(POS1,Y,9)=1 QUIT  ;STORNO POSITION        
	. . . IF $P(POS1,Y,165)'="" IF $D(^INPROSTEMP1(YM,$P(POS1,Y,165))) QUIT  ; FERTIGUNG BEENDET
	. . . DO ^INPROSTEMPEL(AUF,POS,VORG(1),+VORG(9),VORG(11),1)  ;SPEICHERN DER STEMPELKARTEN ;Save the 
	. . . QUIT
	. . QUIT
	. QUIT
	;DRUCKEN VOM KLEINARTIKEL BIS ZUM FERTIGEN PRODUKT ;print until 
	SET YSORT="" FOR  SET YSORT=$ORDER(^WWWSOR(YUSER,YSORT)) QUIT:YSORT=""  DO
	. SET YLFNUM="" FOR  SET YLFNUM=$ORDER(^WWWSOR(YUSER,YSORT,YLFNUM)) QUIT:YLFNUM=""  DO
	. . SET YSTEMPEL=^WWWSOR(YUSER,YSORT,YLFNUM)
	. . IF VORG(13)'="" QUIT:YSTEMPEL<VORG(13)  ;ZU KLEIN FÜR GEWÄHLTE DRUCKWIEDERHOLUNG ;within wee to 
	. . SET YQ=0
	. . IF VORG(14)=1 IF YSTEMPEL'=VORG(10) DO
	. . . IF $DATA(^INPROSTEMP1(YM,YSTEMPEL,1)) SET:$PIECE(^(1),Y,24)=1 YQ=1  ;QUIT  ;PRODUKTION ABGESCHLOSSEN
	. . . IF $DATA(^INPROSTEMP(YM,YSTEMPEL,1)) SET:$PIECE(^(1),Y,24)=1 YQ=1          ;PRODUKTION ABGESCHLOSSEN ;production 
	. . . QUIT
	. . QUIT:YQ=1
	. . ;
	. . ;
	. . ;GEDRUCKT WERDEN DIE BELEGE DER ARTIKEL UNTER DEM SUBSCRIPT DAS UNTER DER STEMPELNUMMER ANGEGEBEN IST ;will who the item under who under the 
	. . ;
	. . ;IF $PIECE($GET(^INVORG(YM,YM,1)),Y,110)=1 IF $DATA(^INDRPARAHTML(YM,YLOCATION,20)) DO   ;HTML
	. . ;.IF PRODU=1 DO ^INFERTPLATZ(YSTEMPEL)  
	. . ;.;IF ZEICHN=1 DO ^INPROZEICHN(YSTEMPEL)
	. . ;.;IF MATERIAL=1 DO ^INPROMATERIAL(YSTEMPEL)
	. . ;
	. . IF $PIECE($GET(^INVORG(YM,YM,1)),Y,110)=1 DO  QUIT  ;HTML
	. . . IF PRODU=1 DO ^INPROPROHTML(YSTEMPEL)  
	. . . IF ZEICHN=1 DO ^INPROZEIHTML(YSTEMPEL)
	. . . IF MATERIAL=1 DO ^INPROMATHTML(YSTEMPEL)
	. . . IF $P($G(^INVORG(YM,YM,1)),Y,120)=1 IF FERTIG=1 DO ^INPROFERTHTML(YSTEMPEL)
	. . . QUIT
	. . IF $PIECE($GET(^INVORG(YM,YM,1)),Y,110)'=1 DO  ;PARAMETER
	. . . IF PRODU=1 DO ^INPROPRODU(YSTEMPEL) 
	. . . IF ZEICHN=1 DO ^INPROZEICHN(YSTEMPEL)
	. . . IF MATERIAL=1 DO ^INPROMATERIAL(YSTEMPEL)
	. . . IF $P($G(^INVORG(YM,YM,1)),Y,120)=1 IF FERTIG=1 DO ^INPROFERTMELDUNG(YSTEMPEL)  ;FERTIGMELDUNG PRODUKTION ;production 
	. . . QUIT
	. . QUIT
	. QUIT
	QUIT
]]></Routine>
</Export>