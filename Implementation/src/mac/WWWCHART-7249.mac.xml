<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="22" zv="CACHE" ts="2001-01-01 00:00:00">
<Routine name="WWWCHART" type="MAC" languagemode="0" timestamp="58440,0"><![CDATA[
WWWCHART
	;-------------------------------------------------------------------------------
	; Description of Function :
	;		STATISTIK AUS CGI
	;
	; Inputs : 
	;
	;
	; ByRef :
	;
	;
	; Returns :
	;
	;
	; History :
	; 19-Nov-2009	shobby	SR17032: Disabled 'NumberOfHits' functionality.
	; 08-Jun-2007	GRF		Doco
	; 30-May-2005	RobertW	SR12056: Attempt at Performance Increase
	; 29.22.04.2000	DT
	;-------------------------------------------------------------------------------
	;/scripts/mgwms32.dll?MGWLPN=LOCAL&EP=WWWCHART&GRAPH=LINES&HEIGHT=300&WIDTH=480&BACKGROUND=3;HEADER=THIS_IS_A_HEADER&HCOLOR=BLACK&X=JAN,FEB,MAR,APR,MAY,JUN&XHEADER=MONTH&Y=0,100,200,300,400,500&COLUMN1=SALES1&VALUE1=123,234,234,234,123,222
	;/scripts/mgwms32.dll?MGWLPN=LOCAL
	;&EP=WWWCHART
	;&GRAPH=LINES,BOX,STACK,STOCK
	;&HEIGHT=300
	;&WIDTH=480
	;&HEADER=THIS_IS_A_HEADER
	;&HCOLOR=BLACK
	;&X=JAN,FEB,MAR,APR,MAY,JUN
	;&XHEADER=MONTH
	;&Y=0,100,200,300,400,500
	;&YHEADER=SALES
	;&COLUMN1=SALES1
	;&VALUE1=123,234,234,234,123,222
	;&COLOR1=RED
	;&LANGUAGE=DE,EN
	;&SPONSOR=...gif
	;&BGCOLOR=FARBE
	;&BACKGROUND=..GIF
	;&SOURCE=WERTE SIND VON WEM
	;DIESES PROGRAMM IST DAS EMPFANGSTEIL FÜR DIE MANUELLEN HTML SEITEN MIT DEN ENTSPRECHENDEN VOGABEN DER VARIABLEN ;this programme who to who HTML sidelong by means of the 
	;DIE VARIABLEN KÖNNEN ALS LINK ODER ALS FORM SUBMIT ÜBERGEBEN WERDEN. ;who may when Or when shape transfer 
	NEW (%request,%session,%KEY,%,%ZCS,%CGIEVAR)
	
	DO ^WWWVAR  ;VORGABEN SETZEN ;typeset 
	SET YFORM="WWWCHART"
	IF '$DATA(^WWW120(0,YFORM)) DO ^WWWINFO($$^WWWTEXT(35)) QUIT  ;FALSCHE FORM ;shape 
	DO ^WWWFORMX  ;VORGABEN AUS WWW012 MANDANT ;out of Company 
	SET BANNER=$GET(%(YQUERY,"SPONSOR"))
	IF BANNER'="" SET $PIECE(YVOR,Y,1)=BANNER
	SET YKOPF=$PIECE(YVOR,Y,1)
	SET YFOART=5 
	;SET $PIECE(^WWW120(0,YFORM,1),Y,50)=$PIECE($GET(^WWW120(0,YFORM,1)),Y,50)+1  ;ANZAHL DER HITS ;Number the $$$WWW120NumberOfHits
	SET YI=$GET(^WWW1205(YM,YFORM,$PIECE($HOROLOG,",",1),1))+1
	SET ^WWW1205(YM,YFORM,$PIECE($HOROLOG,",",1),1)=YI  ;ANZAHL DER ZUGRIFFE PER DATUM ;Number the Date 
	;START HTML ;take-off HTML 
	SET SPRACHE=$GET(%(YQUERY,"LANGUAGE"))
	IF SPRACHE="" SET SPRACHE=$GET(%(YQUERY,"language"))
	IF SPRACHE="" SET SPRACHE="DE"
	;SET SPRACHE=$$^WWWUPER(SPRACHE)
	SET SPRACHE=$zconvert(SPRACHE,"U")
	SET LANGUAGE=SPRACHE
	DO ^WWWSTART("INTRAPREND Web-Chart",1,0)
	SET BACKGROUND=$GET(%(YQUERY,"BACKGROUND"))
	IF BACKGROUND'="" SET $PIECE(YVOR,Y,3)=BACKGROUND
	SET BACKGROUND=$GET(%(YQUERY,"background"))
	IF BACKGROUND'="" SET $PIECE(YVOR,Y,3)=BACKGROUND
	SET BGCOLOR=$GET(%(YQUERY,"BGCOLOR"))
	IF BGCOLOR'="" SET $PIECE(YVOR,Y,5)=BGCOLOR
	SET BGCOLOR=$GET(%(YQUERY,"bgcolor"))
	IF BGCOLOR'="" SET $PIECE(YVOR,Y,5)=BGCOLOR
	DO ^WWWBODY(1)  ;BODY TAG
	DO START
	DO STOP
	QUIT
	
START ;START FORM ;take-off shape 
	NEW YUSER,YBED,YTRAKT,YANZ,YNAME
	
	SET SPRACHE=$GET(%(YQUERY,"LANGUAGE"))
	IF SPRACHE="" SET SPRACHE=$GET(%(YQUERY,"language"))
	IF SPRACHE="" SET SPRACHE="DE"
	;SET SPRACHE=$$^WWWUPER(SPRACHE)
	SET SPRACHE=$zconvert(SPRACHE,"U")
	SET LANGUAGE=SPRACHE
	;KOPFSATZ ANZEIGEN ;display 
	IF $PIECE(YVOR,Y,10)=1 WRITE "<CENTER>"
	IF '$FIND($TRANSLATE(YKOPF,"gif","GIF"),".GIF") DO
	. DO ^WWWKOPF(YKOPF)
	
	IF $PIECE(YVOR,Y,65)=1 DO ^WWWUP(0)   ;START ;take-off 
	IF YKOPF'="" IF $FIND($TRANSLATE(YKOPF,"gif","GIF"),".GIF") WRITE YCR,"<IMG SRC="_""""_YGIF_YKOPF_""""_" TITLE="_""""_YKOPF_""""_" border=0></A>"
	IF $PIECE(YVOR,Y,10)=1 WRITE "</CENTER>"
	WRITE YCR
	IF +$PIECE(YVOR,Y,13)=1 DO  ;RAHMEN ;framework 
	. DO ^WWWFRAME(2)  ;FRAME OHNE % ;without 
	. WRITE "<TR><TD>"
	
	WRITE YCR
	WRITE "<FONT"
	IF $PIECE(YVOR,Y,9)'="" WRITE " FACE="_""""_$PIECE($GET(^WWW100(0,"SCHRIFTART",SPRACHE,$PIECE(YVOR,Y,9),1)),Y,1)_""""
	IF $PIECE(YVOR,Y,7)'="" WRITE " SIZE="_""""_$PIECE(YVOR,Y,7)_""""
	IF $PIECE(YVOR,Y,6)'=""  DO
	. ;I $L($P(YVOR,Y,6))=6 W " COLOR="_""""_"#"_$P(YVOR,Y,6)_""""
	. WRITE " COLOR="_""""_$PIECE($GET(^WWW100(0,"FARBE",SPRACHE,$PIECE(YVOR,Y,6),1)),Y,1)_""""
	
	WRITE ">"
	IF $PIECE(YVOR,Y,9)=""!($PIECE(YVOR,Y,21)=1) WRITE "<PRE>"
	IF $FIND($PIECE(YVOR,Y,8),1) WRITE "<STRONG><B>"
	IF $FIND($PIECE(YVOR,Y,8),2) WRITE "<U>"
	IF $FIND($PIECE(YVOR,Y,8),3) WRITE "<I>"
	IF $FIND($PIECE(YVOR,Y,8),4) WRITE "<STRIKE>"
	IF $FIND($PIECE(YVOR,Y,8),5) WRITE "<BLINK>"
	IF $PIECE(YVOR,Y,10)=1       WRITE "<CENTER>"
	DO
	. WRITE YCR,"<TABLE cellspacing=0"
	. WRITE ">"
	
	WRITE YCR
	SET YFELD=""
	;/scripts/mgwms32.dll?MGWLPN=LOCAL&EP=WWWCHART&GRAPH=LINES&HEIGHT=300&WIDTH=480&HEADER=THIS_IS_A_HEADER&HCOLOR=BLACK&X=JAN,FEB,MAR,APR,MAY,JUN&XHEADER=MONTH&Y=0,100,200,300,400,500&COLUMN1=SALES1&VALUE1=123,234,234,234,123,222
	;S YFELD="DATEI.GIF~GRAPHIKART0/1~HEADER~COLOR~JAN,FEB,MAR,APR,..~MONTH~100,200,300,400,500~~~SPALTE1~COLOR~WERT,WERT,WERT,WERT~SPALTE2~COLOR~WERT,WERT,WERT,WERT~SPALTE3~COLOR~WERT,WERT,WERT,WERT~SPALTE4~COLOR~WERT,WERT,WERT,WERT~~~~~~~~~~BREITE~HOEHE"
	SET $PIECE(YFELD,Y,1)="gif"_$PIECE($HOROLOG,",",2)_$RANDOM(10)_".gif"  ;DATEI ;data file 
	SET TYPE=$GET(%(YQUERY,"GRAPH"))
	IF TYPE="" SET TYPE=$GET(%(YQUERY,"graph"))
	SET $PIECE(YFELD,Y,2)=0   ;BOX
	new strTYPE
	set strTYPE=$zconvert(TYPE,"U")
	;IF $FIND($$^WWWUPER(TYPE),"LIN") SET $PIECE(YFELD,Y,2)=1  ;LINE 
	;IF $FIND($$^WWWUPER(TYPE),"STA") SET $PIECE(YFELD,Y,2)=2  ;STAPEL
	;IF $FIND($$^WWWUPER(TYPE),"STO") SET $PIECE(YFELD,Y,2)=3  ;KURS STOCK ;forward rate storey 
	IF $FIND(strTYPE,"LIN") SET $PIECE(YFELD,Y,2)=1  ;LINE 
	IF $FIND(strTYPE,"STA") SET $PIECE(YFELD,Y,2)=2  ;STAPEL
	IF $FIND(strTYPE,"STO") SET $PIECE(YFELD,Y,2)=3  ;KURS STOCK ;forward rate storey 
	SET HEADER=$TRANSLATE($GET(%(YQUERY,"HEADER")),"_"," ")
	IF HEADER="" SET HEADER=$TRANSLATE($GET(%(YQUERY,"header")),"_"," ")
	SET $PIECE(YFELD,Y,3)=HEADER
	SET HCOLOR=$GET(%(YQUERY,"HCOLOR"))
	IF HCOLOR="" SET HCOLOR=$GET(%(YQUERY,"hcolor"))
	SET $PIECE(YFELD,Y,4)=HCOLOR
	SET XHEAD=$GET(%(YQUERY,"X"))
	IF XHEAD="" SET XHEAD=$GET(%(YQUERY,"x"))
	SET $PIECE(YFELD,Y,5)=XHEAD
	SET XHEAD=$TRANSLATE($GET(%(YQUERY,"XHEADER")),"_"," ")
	IF XHEAD="" SET XHEAD=$TRANSLATE($GET(%(YQUERY,"xheader")),"_"," ")
	SET $PIECE(YFELD,Y,6)=XHEAD
	SET XHEAD=$GET(%(YQUERY,"Y"))
	IF XHEAD="" SET XHEAD=$GET(%(YQUERY,"y"))
	SET $PIECE(YFELD,Y,7)=XHEAD
	SET XHEAD=$TRANSLATE($GET(%(YQUERY,"YHEADER")),"_"," ")
	IF XHEAD="" SET XHEAD=$TRANSLATE($GET(%(YQUERY,"yheader")),"_"," ")
	SET $PIECE(YFELD,Y,8)=XHEAD
	SET COLUMN=$GET(%(YQUERY,"COLUMN1"))
	IF COLUMN="" SET COLUMN=$GET(%(YQUERY,"column1"))
	SET $PIECE(YFELD,Y,10)=COLUMN
	SET VALUE=$GET(%(YQUERY,"COLOR1"))
	IF VALUE="" SET VALUE=$GET(%(YQUERY,"color1"))
	SET $PIECE(YFELD,Y,11)=VALUE
	SET VALUE=$GET(%(YQUERY,"VALUE1"))
	IF VALUE="" SET VALUE=$GET(%(YQUERY,"value1"))
	SET $PIECE(YFELD,Y,12)=VALUE
	SET COLUMN=$GET(%(YQUERY,"COLUMN2"))
	IF COLUMN="" SET VALUE=$GET(%(YQUERY,"column2"))
	SET $PIECE(YFELD,Y,13)=COLUMN
	SET VALUE=$GET(%(YQUERY,"COLOR2"))
	IF VALUE="" SET VALUE=$GET(%(YQUERY,"color2"))
	SET $PIECE(YFELD,Y,14)=VALUE
	SET VALUE=$GET(%(YQUERY,"VALUE2"))
	IF VALUE="" SET VALUE=$GET(%(YQUERY,"value2"))
	SET $PIECE(YFELD,Y,15)=VALUE
	SET COLUMN=$GET(%(YQUERY,"COLUMN3"))
	IF COLUMN="" SET VALUE=$GET(%(YQUERY,"column3"))
	SET $PIECE(YFELD,Y,16)=COLUMN
	SET VALUE=$GET(%(YQUERY,"COLOR3"))
	IF VALUE="" SET VALUE=$GET(%(YQUERY,"color3"))
	SET $PIECE(YFELD,Y,17)=VALUE
	SET VALUE=$GET(%(YQUERY,"VALUE3"))
	IF VALUE="" SET VALUE=$GET(%(YQUERY,"value3"))
	SET $PIECE(YFELD,Y,18)=VALUE
	SET COLUMN=$GET(%(YQUERY,"COLUMN4"))
	IF COLUMN="" SET VALUE=$GET(%(YQUERY,"column4"))
	SET $PIECE(YFELD,Y,19)=COLUMN
	SET VALUE=$GET(%(YQUERY,"COLOR4"))
	IF VALUE="" SET VALUE=$GET(%(YQUERY,"color4"))
	SET $PIECE(YFELD,Y,20)=VALUE
	SET VALUE=$GET(%(YQUERY,"VALUE4"))
	IF VALUE="" SET VALUE=$GET(%(YQUERY,"value4"))
	SET $PIECE(YFELD,Y,21)=VALUE
	SET COLUMN=$GET(%(YQUERY,"COLUMN5"))
	IF COLUMN="" SET VALUE=$GET(%(YQUERY,"column5"))
	SET $PIECE(YFELD,Y,22)=COLUMN
	SET VALUE=$GET(%(YQUERY,"COLOR5"))
	IF VALUE="" SET VALUE=$GET(%(YQUERY,"color5"))
	SET $PIECE(YFELD,Y,23)=VALUE
	SET VALUE=$GET(%(YQUERY,"VALUE5"))
	IF VALUE="" SET VALUE=$GET(%(YQUERY,"value5"))
	SET $PIECE(YFELD,Y,24)=VALUE
	SET COLUMN=$GET(%(YQUERY,"COLUMN6"))
	IF COLUMN="" SET VALUE=$GET(%(YQUERY,"column6"))
	SET $PIECE(YFELD,Y,25)=COLUMN
	SET VALUE=$GET(%(YQUERY,"COLOR6"))
	IF VALUE="" SET VALUE=$GET(%(YQUERY,"color6"))
	SET $PIECE(YFELD,Y,26)=VALUE
	SET VALUE=$GET(%(YQUERY,"VALUE6"))
	IF VALUE="" SET VALUE=$GET(%(YQUERY,"value6"))
	SET $PIECE(YFELD,Y,27)=VALUE
	SET COLUMN=$GET(%(YQUERY,"COLUMN7"))
	IF COLUMN="" SET VALUE=$GET(%(YQUERY,"column7"))
	SET $PIECE(YFELD,Y,28)=COLUMN
	SET VALUE=$GET(%(YQUERY,"COLOR7"))
	IF VALUE="" SET VALUE=$GET(%(YQUERY,"color7"))
	SET $PIECE(YFELD,Y,29)=VALUE
	SET VALUE=$GET(%(YQUERY,"VALUE7"))
	IF VALUE="" SET VALUE=$GET(%(YQUERY,"value7"))
	SET $PIECE(YFELD,Y,30)=VALUE
	SET VALUE=$GET(%(YQUERY,"SOURCE"))
	IF VALUE="" SET VALUE=$GET(%(YQUERY,"source"))
	SET $PIECE(YFELD,Y,33)=VALUE
	WRITE "<BR>"
	WRITE YCR
	DO ^WWWGRAPH(YFELD)
	IF $PIECE(YVOR,Y,44)'=1 WRITE YCR,"</TABLE>"  ;FORMAT
	IF +$PIECE(YVOR,Y,13)=1 WRITE YCR,"</TD></TR></TABLE>"  ;RAHMEN ;framework 
	
	;WRITE YCR,YCR,"<!-- ************************* FORMAT ABSCHLUSS ************************** -->",YCR,YCR
	
	WRITE YCR,"<INPUT TYPE="_""""_"BUTTON"_""""_" VALUE="_""""_YAM_$$^WWWTEXT(99)_""""_" onClick="_""""_"window.history.back()"_""""_">"
	IF $PIECE(YVOR,Y,10)=1 WRITE YCR,"</CENTER>"
	IF $FIND($PIECE(YVOR,Y,8),1) WRITE "</STRONG></B>"
	IF $FIND($PIECE(YVOR,Y,8),2) WRITE "</U>"
	IF $FIND($PIECE(YVOR,Y,8),3) WRITE "</I>"
	IF $FIND($PIECE(YVOR,Y,8),4) WRITE "</STRIKE>"
	IF $FIND($PIECE(YVOR,Y,8),5) WRITE "</BLINK>"
	IF $PIECE(YVOR,Y,9)=""!($PIECE(YVOR,Y,21)=1) WRITE "</PRE>"
	WRITE "</FONT></TD></TR></TABLE>",YCR
	WRITE "</NOBR>"
	;W "</FORM>"
	QUIT
	
STOP ;ENDE FORM ;termination shape 
	DO ^WWWSTOP
	WRITE "</FORM>"
	SET %KEY=YKEY
	QUIT
]]></Routine>
</Export>