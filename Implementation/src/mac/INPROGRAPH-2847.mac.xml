<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="22" zv="CACHE" ts="2001-01-01 00:00:00">
<Routine name="INPROGRAPH" type="MAC" languagemode="0" timestamp="58440,0"><![CDATA[
INPROGRAPH ;INPROGRAPH;FIS;GRAPHISCHE ÜBERSICHT PRODUKTIONSPLANUNG;22.03.2003
	;
	;/------------------------------------------------------------------\
	;| Description of Function :
	;|		GRAPHISCHE ÜBERSICHT PRODUKTIONSPLANUNG
	;|
	;| Inputs : 
	;|
	;|
	;| ByRef :
	;|
	;|
	;| Returns :
	;|
	;|
	;| History :
	;|
	;| FIS	22.03.2003
	;|
	;\------------------------------------------------------------------/
	;
	NEW VON,BIS,ARBTAGE,WOCHE,TAG,AUF,AUSR
	;SET WOCHE=$GET(YAUSWAHL) ;table-mat 
	;IF WOCHE="" SET WOCHE=$$^WWWWEEK(+$H,3)
	;SET ARBTAGE=$PIECE($GET(^INVORG(YM,YM,1)),Y,17)  ;ARBEITSTAGE AUS MANDANTENVORGABE
	;IF ARBTAGE="" SET ARBTAGE=7
	;SET VON=$$^WWWWEEK1($PIECE(WOCHE,"-",2)_"."_$PIECE(WOCHE,"-",1))
	;SET VON=$$^WWWDATE1(VON)
	;SET BIS=VON+ARBTAGE ;table-mat 
	SET TAG=+VORG(1)
	IF TAG=0 SET TAG=+$HOROLOG
	SET VON=TAG
	SET BIS=TAG+40
	KILL ^WWWSOR(YUSER,"XGANTT")
	DO SORT
	DO ^INXGANTT("xgantt_produ.ini",,1,VON,BIS)   		;ALTE METHODE ;method 
	;DO ^INXGANTTD("Produktionsplanung",VON,BIS)      		;DYNAMISCHE ERZEUGUNG
	KILL ^WWWSOR(YUSER,"XGANTT")
	KILL ^WWWSOR(YUSER,"XGANTTLINK")
	QUIT
	
SET ;SETZEN AUSWAHL ;typeset Selection 
	SET VORG(1)=$GET(VORG(1))
	SET VORG(2)=$GET(VORG(2))  ;AUFTRAGSNUMMER
	SET VORG(3)=$GET(VORG(3))  ;ZEITSKALA DEM PRODUKTIONSTERMIN ANPASSEN ;take one´s measure for 
	SET %("VAR","YAUSWAHL")=VORG(1)_"/"_VORG(2)_"/"_VORG(3)
	DO ^WWWFORM
	QUIT
	
SORT ;ZUSAMMENSTELLEN DATEN
	NEW MASCH,DAT,SATZ,SATZ1,LFN,AUF1,POS1,MASCHINE,TEIL,TOTAL,AUF,POS,DATEI,YI,SUCH,VOR,NACH,LINK
	SET LFN=0
	SET AUF=""
	SET VOR=""
	SET NACH=""
	IF VORG(2)'="" SET AUF=VORG(2)
	;FOR  SET AUF=$ORDER(^INAUF1SEL(YM,AUF)) QUIT:AUF=""  DO
	Q:AUF=""
	IF VORG(2)'="" IF AUF'="" DO
	. SET AUF1=$GET(^INAUF1SEL(YM,AUF,1))
	. QUIT:$PIECE(AUF1,Y,2)=2  ;LIEFERANTENBESTELLUNG
	. SET POS=$PIECE(AUF1,Y,3)
	. FOR YI=1:1:1 SET POS1=$PIECE(POS,";",YI)  QUIT:POS1=""  DO
	. . SET SUCH="^INAUFPXL("_""""_YM_""""_","_""""_AUF_""""_","_""""_POS_""""_")"
	. . FOR  DO  QUIT:SUCH=""
	. . . SET SUCH=$QUERY(@SUCH)
	. . . IF $TRANSLATE($PIECE(SUCH,",",2),"""")'=AUF SET SUCH="" QUIT  ;21.06.04;FAN;25794; WENN alphanumerischen Auftragsnummern SOLL DATEN AUCH AUFBAUEN.
	. . . ;IF $PIECE(SUCH,",",2)'=AUF SET SUCH="" QUIT  ;21.06.04;FAN;25794; 
	. . . IF $PIECE(SUCH,",",3)=POS DO
	. . . . SET TEIL=$PIECE(SUCH,",",2,99)
	. . . . SET TEIL=$TRANSLATE(TEIL,")","")
	. . . . SET TEIL=$TRANSLATE(TEIL,",",".")
	. . . . SET SATZ1=@SUCH
	. . . . QUIT:$PIECE(SATZ1,Y,26)'=2  ;NUR LEISTUNGEN ANZEIGEN ;only LEISTUNGEN display 
	. . . . ;
	. . . . ;
	. . . . SET AUF1=""
	. . . . IF $PIECE(TEIL,".",1)'="" SET AUF1=$GET(^INAUF(YM,$PIECE(TEIL,".",1),1))
	. . . . SET POS1=""
	. . . . IF AUF1'="" IF $PIECE(TEIL,".",2)'="" SET POS1=$GET(^INAUFP(YM,$PIECE(TEIL,".",1),$PIECE(TEIL,".",2),1))
	. . . . ;
	. . . . SET SATZ=""
	. . . . SET LINK=""
	. . . . SET LFN=LFN+1
	. . . . SET MASCH=$PIECE(SATZ1,Y,57)
	. . . . IF MASCH="" SET MASCH=" "
	. . . . SET $PIECE(SATZ,Y,1)=TEIL  ;TEILESTRUKTUR  =ID
	. . . . SET $PIECE(SATZ,Y,2)=$PIECE(TEIL,".",1)_"-"_$PIECE(TEIL,".",2)  ;AUFTRAG, POS
	. . . . SET $PIECE(SATZ,Y,3)=" ("_$PIECE(SATZ1,Y,4)_") "_$PIECE(POS1,Y,1)  ;ARTIKEL ;item 
	. . . . SET $PIECE(SATZ,Y,4)="("_MASCH_") "_$PIECE($GET(^INMASCH(YM,MASCH,1)),Y,1)  ;MASCHINE ;machine 
	. . . . SET $PIECE(SATZ,Y,5)=$$^WWWDATE($PIECE(SATZ1,Y,168))  ;BEGINN ;inauguration 
	. . . . SET $PIECE(SATZ,Y,6)=$PIECE(SATZ1,Y,45)/60  ;DAUER  ;35838 ;permanence 
	. . . . SET $PIECE(SATZ,Y,7)=$PIECE(AUF1,Y,13)  ;KUNDENNAME
	. . . . ;SET $PIECE(SATZ,Y,8)=$$^WWWDATE(DAT)  ;ENDE DAUER  10.02.03 00:20:00
	. . . . SET $PIECE(SATZ,Y,9)=$$^WWWTIME($PIECE(SATZ1,Y,45))  ;AUDFÜHRUNGSZEIT 00:20:00
	. . . . SET $PIECE(SATZ,Y,10)=$PIECE($GET(^INMASCH(YM,MASCH,1)),Y,26)  ;MASCHINEFARBCODE
	. . . . SET $PIECE(SATZ,Y,11)=""    ;GESAMTDAUER
	. . . . SET $PIECE(SATZ,Y,12)=$PIECE(SATZ1,Y,1)  ;LEISTUNG ;performance 
	. . . . ;
	. . . . ;
	. . . . SET ^WWWSOR(YUSER,"XGANTT",LFN)=SATZ
	. . . . SET MASCHINE(MASCH)=""
	. . . . SET ^WWWSOR(YUSER,"XGANTTLINK",LFN)=VOR_";"_TEIL_";"_"FS"_";"_"1"   ;VERBINDUNG SPEICHERN
	. . . . ;                                                                    ;VORGÄNDER   ;NACHFOLGER  ;TYPE (ENDE/ENDE)       ;??
	. . . . SET VOR=TEIL  ;SETZTEN VORLÄUFER FÜR VERBINDUNG ;to fraternity 
	. . . . IF VORG(3)=1 IF VON>$PIECE(SATZ1,Y,168) SET VON=$PIECE(SATZ1,Y,168)   ;BEGINN AN DER PRODUKTIONSPLANUNG AUSRICHT ;inauguration upon the 
	. . . . IF VORG(3)=1 IF BIS<$PIECE(SATZ1,Y,168) SET BIS=$PIECE(SATZ1,Y,168)   ;ENDE AN DER PRODUKTIONSPLANUNG AUSRICHT ;termination upon the 
	. . . . QUIT
	. . . QUIT
	. . QUIT
	. QUIT
	WRITE "ANZAHL DATENSÄTZE: "_LFN_"<BR>"
	SET MASCH="" FOR  SET MASCH=$ORDER(^INMASCH(YM,MASCH)) QUIT:MASCH=""  IF '$DATA(MASCHINE(MASCH)) DO
	. SET LFN=LFN+1
	. SET ^WWWSOR(YUSER,"XGANTT",LFN)="**DEL**"_LFN_Y_LFN_Y_Y_"("_MASCH_") "_$PIECE($GET(^INMASCH(YM,MASCH,1)),Y,1)_Y_$$^WWWDATE(+$HOROLOG)  ;MASCHINE ;machine 
	. QUIT
	QUIT
]]></Routine>
</Export>