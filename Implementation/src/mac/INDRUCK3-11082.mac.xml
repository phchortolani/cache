<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="22" zv="CACHE" ts="2001-01-01 00:00:00">
<Routine name="INDRUCK3" type="MAC" languagemode="0" timestamp="58440,0"><![CDATA[
INDRUCK3 ;INDRUCK3;DT;DRUCKEN HINWEIS(ZEICHEN,SEITE..);24.02.2000  ; Compiled March 3, 2005 16:29:46
	;
	;/------------------------------------------------------------------\
	;| Description of Function :
	;|		DRUCKEN HINWEIS(ZEICHEN,SEITE..)
	;|
	;| Inputs : 
	;|
	;|
	;| ByRef :
	;|
	;|
	;| Returns :
	;|
	;|
	;| History :
	;|
	;| DT	24.02.2000  
	;\------------------------------------------------------------------/
	NEW VERSAND,POS,POS1,ZEICHEN
	;IF YSEITE'=1 IF $PIECE(YBELEG1,Y,11)'=1 QUIT   ;ANSCHRIFT AUCH AUF FOLGESEITEN? alternative Belegdruckparameter 
	SET POS1=""
	SET POS=$ORDER(YAUFTRAG(""))
	IF POS'="" SET POS1=$GET(^INAUFP(YM,YAUFTRAG,POS,1))
	IF +$PIECE(YBELEG1,Y,14)'=0 SET LFN=$PIECE(YBELEG1,Y,14)  ;AB ZEILE ;Confirm. 
	IF LFN="" SET LFN=13
	IF $PIECE(YBELEG1,Y,15)="" SET $PIECE(YBELEG1,Y,15)=40
	SET YTAB=$EXTRACT("                                                                           ",1,+$PIECE(YBELEG1,Y,15))  ;IN SPALTE ;within rift 
	SET YI(1)=$TRANSLATE($PIECE(YBELEG1,Y,17),";",",")   ;WELCHE HINWEISE DATUM USW.
	IF YSEITE'=1 IF $PIECE(YBELEG1,Y,11)=1 I $PIECE(YBELEG1,Y,219)'="" SET YI(1)=$TRANSLATE($PIECE(YBELEG1,Y,219),";",",")   ;BEC;27122;03.03.05
	IF YSEITE'=1 IF $PIECE(YBELEG1,Y,11)'=1 SET YI(1)=$TRANSLATE($PIECE(YBELEG1,Y,219),";",",")   ;BEC;27122;03.03.05
	
	FOR YI=0,1,2,3,4,5,6,7,8,9,19,15,20,11,16,17,18,10,14,13,21,22,23,24,99,12 IF $FIND(","_YI(1)_",",","_YI_",") SET YI(2)=YI DO   ;SET YI(2)=$PIECE(YI(1),",",YI) QUIT:YI(2)=""  DO
	. SET YI(4)=$PIECE($GET(^WWW101(0,"BETREFF",SPRACHE,YI(2),1)),Y,1)                ;TEXT FÜR DRUCK ;Text to printing 
	. IF YBELEG=1  SET YI(4)=$PIECE($GET(^WWW101(0,"BETREFF1",SPRACHE,YI(2),1)),Y,1)  ;TEXT FÜR DRUCK DER ANGEBOTE ;Text to printing the 
	. IF YBELEG=10 SET YI(4)=$PIECE($GET(^WWW101(0,"BETREFF2",SPRACHE,YI(2),1)),Y,1)  ;TEXT FÜR DRUCK DER ANFRAGE  ;BEC;25676;10.05.04;NEUE ANFRAGEPARAMETER
	. IF YI=22 IF $DATA(^WWW122D(0,"INAUF",268,YM)) SET YI(4)=$$^WWWFELDNAME("INAUF","D",302)  ;CUSTOMIZING NAME ;FIS;06.04.04
	. IF YI=23 IF $DATA(^WWW122D(0,"INAUF",269,YM)) SET YI(4)=$$^WWWFELDNAME("INAUF","D",300)  ;CUSTOMIZING NAME ;FIS;06.04.04
	. SET YI(5)=$EXTRACT(YI(4)_"                                    ",1,13)_": "  ;FORMAT
	. SET YI(4)=YI(5)
	. IF YI(2)=0 DO  ;ORT, DATUM
	. . SET YI(4)=$PIECE($GET(^WWW0121(0,YM,YBETRIEB,1)),Y,8)  ;ORT DES BETRIEBES ;village 
	. . IF YI(4)'="" SET YI(4)=YI(4)_", "
	. . SET YI(4)=YI(4)_$$^WWWDATE(YDATE) 
	. ;
	. SET ZEICHEN=$PIECE($GET(^WWW013(0,YBED,1)),Y,119)
	. IF ZEICHEN="" SET ZEICHEN=$PIECE($GET(^WWW013(0,YBED,1)),Y,1)
	. IF ZEICHEN="" SET ZEICHEN=YBED
	. IF YI(2)=1 SET YI(4)=YI(4)_ZEICHEN  ;UNSER ZEICHEN ;we sign ;FAN;15.02.05;27173 
	. IF YI(2)=2 IF YBELEG'=9 SET YI(4)=YI(4)_$PIECE($GET(^WWW013(0,YBED,1)),Y,31)  ;TELEFON MITARBEITER
	. IF YI(2)=3 IF YBELEG'=9 SET YI(4)=YI(4)_$PIECE($GET(YAUFTRAG1),Y,30)          ;VERKÄUFER ;salesman 
	. IF YI(2)=4 IF YBELEG'=9 IF $PIECE($GET(YAUFTRAG1),Y,30)'="" SET YI(4)=YI(4)_$PIECE($GET(^WWW013(0,$PIECE($GET(YAUFTRAG1),Y,30),1)),Y,31)  ;TELEFON VERKAUF ;sale 
	. IF YI(2)=6 DO 
	. . IF $GET(YSUMINVOICE)=1 QUIT  ; ONLY IF NOT SUM-INVOICE;TYBD;28,1,2004
	. . IF $PIECE(YBELEG1,Y,89)=1 IF $PIECE($GET(YAUFTRAG1),Y,302)'="" SET YI(4)=YI(4)_$PIECE($GET(YAUFTRAG1),Y,302)_" " ;BESTELLNUMMER MIT DRUCKEN
	. . SET YI(4)=YI(4)_YAUFTRAG   ;AUFTRAGSNUMMER;ORDER
	. ;
	. ;IF YBELEG=9 IF YI(2)>6 QUIT  ;WARENBEREITSTELLUNGSSCHEIN NUR BIS HIER !
	. IF YI(2)=7 DO
	. . IF $GET(YSUMINVOICE)=1             QUIT  ; ONLY IF NOT SUM-INVOICE;TYBD;28,1,2004
	. . IF $PIECE($GET(YAUFTRAG1),Y,10)="" QUIT
	. . IF '$FIND($PIECE($GET(YAUFTRAG1),Y,10)," ")  SET YI(4)=YI(4)_$PIECE($GET(YAUFTRAG1),Y,10) QUIT  ;AUFTRAG ERTEILT VON ;order 
	. . IF $LENGTH($PIECE($GET(YAUFTRAG1),Y,10))'>15 SET YI(4)=YI(4)_$PIECE($GET(YAUFTRAG1),Y,10) QUIT  ;AUFTRAG ERTEILT VON ;order 
	. . SET YI(4)=YI(4)_$REVERSE($PIECE($REVERSE($PIECE($GET(YAUFTRAG1),Y,10))," ",1))                  ;AUFTRAG ERTEILT VON ;order 
	. ;
	. IF YI(2)=8 DO
	. . IF $GET(YSUMINVOICE)=1 QUIT  ; ONLY IF NOT SUM-INVOICE;TYBD;28,1,2004
	. . SET YI(4)=YI(4)_$$^WWWDATE($PIECE($GET(YAUFTRAG1),Y,4))  ;AUFTRAGSDATUM
	. ;
	. IF YI(2)=9 SET YI(4)=YI(4)_$GET(YKUNDE) IF $GET(YKUNDE)'="" IF $PIECE($GET(^INKUNDE(YM,YKUNDE,1)),Y,226)'="" SET YI(4)=YI(4)_"/"_$PIECE($GET(^INKUNDE(YM,YKUNDE,1)),Y,226) ;KUNDENNUMMER / EIGENE NUMMER BEIM LIEFERANT;TYBD;26972;13,12,2004
	. IF YI(2)=19 IF $GET(YKUNDE)'="" IF $PIECE($GET(^INKUNDE(YM,YKUNDE,1)),Y,48)'="" SET YI(4)=YI(4)_$PIECE($GET(^INKUNDE(YM,YKUNDE,1)),Y,48)   ;debitorennr.    FAN 08.07.02 ;buff 
	. IF YI(2)=15 SET YI(4)=YI(4)_$GET(YLIEFER)  ;LIEFERANTENNUMMER
	. IF YI(2)=20 IF $GET(YLIEFER)'="" IF $PIECE($GET(^INLIEF(YM,YLIEFER,1)),Y,48)'="" SET YI(4)=YI(4)_$PIECE($GET(^INLIEF(YM,YLIEFER,1)),Y,48)   ;KREDITORENNR.    FAN 08.07.02 ;buff 
	. IF YI(2)=11 SET YI(4)=YI(4)_$PIECE(YADRES,Y,30)  ;KUNDENNUMMER LIEFERANT ;supplier 
	. ;IF YI(2)=16 IF $PIECE(YAUFTRAG1,Y,7)'="" SET YI(4)=YI(4)_$PIECE(YAUFTRAG1,Y,7)  ;ANGEBOTSNUMMER;BEC;25571;19.04.04
	. IF YI(2)=16 IF YBELEG'=1!(YBELEG'=10) IF $PIECE(YAUFTRAG1,Y,7)'="" SET YI(4)=YI(4)_$PIECE(YAUFTRAG1,Y,7)  ;ANGEBOTSNUMMER;BEC;25571;19.04.04
	. IF YI(2)=16 IF YBELEG=1!(YBELEG=10)   SET YI(4)=YI(4)_$GET(YAUFTRAG)                   ;ANGEBOTSNUMMER
	. IF YI(2)=17 IF $PIECE(POS1,Y,100)'="" SET YI(4)=YI(4)_$$^WWWTIME($PIECE(POS1,Y,100))   ;AUSLIEFERUNGSUHRZEIT
	. IF YI(2)=18 IF YVERBAND'=""           SET YI(4)=YI(4)_YVERBAND_"/"_$PIECE($GET(^INKUNDE(YM,YKUNDE,1)),Y,2)   ;ZENTRALREG.-NR.
	. IF YI(2)=10 IF $PIECE($GET(YAUFTRAG1),Y,19)="" QUIT  ;KEIN LIEFERTERMIN ;no time of delivery 
	. IF YI(2)=10 IF $GET(YSUMINVOICE)'=1 IF $PIECE(YBELEG1,Y,36)'=1 SET YI(4)=YI(4)_$$^WWWDATE($PIECE($GET(YAUFTRAG1),Y,19))  ;LIEFERTERMIN ;time of delivery 
	. IF YI(2)=10 IF $GET(YSUMINVOICE)'=1 IF $PIECE(YBELEG1,Y,36)=1 SET YI(4)=YI(4)_$$^WWWWEEK($PIECE($GET(YAUFTRAG1),Y,19),1)  ;LIEFERTERMIN WOCHE ;time of delivery week 
	. IF YI(2)=12 SET YI(4)=YI(4)_YSEITE  ;SEITE ;side 
	. IF YBELEG'=1 IF YI(2)=13 DO  SET YI(4)=YI(4)_VERSAND  ;VERSANDART
	. . NEW YPOS
	. . SET VERSAND=""
	. . IF $GET(YSUMINVOICE)=1 QUIT  ; ONLY IF NOT SUM-INVOICE;TYBD;28,1,2004
	. . SET YPOS=$ORDER(YAUFTRAG(""))
	. . IF YPOS=""    SET YPOS=$ORDER(^INAUFP(YM,YAUFTRAG,""))
	. . IF YPOS'=""   SET VERSAND=$PIECE($GET(^INAUFP(YM,YAUFTRAG,YPOS,1)),Y,95)  ;VERSANDART AUS TOUR ;out of voyage 
	. . IF VERSAND="" SET VERSAND=$PIECE(YAUFTRAG1,Y,16)  ;AUS AUFTRAG ;out of order 
	. ;
	. IF YBELEG'=1 IF YI(2)=14 DO  SET YI(4)=YI(4)_$$^WWWDATE(LIEFTERM)  ;LIEFERDATUM
	. . NEW YPOS
	. . SET LIEFTERM=""
	. . IF $GET(YSUMINVOICE)=1 QUIT  ; ONLY IF NOT SUM-INVOICE;TYBD;28,1,2004
	. . SET YPOS=$ORDER(YAUFTRAG(""))
	. . IF YPOS="" SET YPOS=$ORDER(^INAUFP(YM,YAUFTRAG,""))
	. . IF YPOS'="" DO
	. . . SET LIEFTERM=$PIECE($GET(^INAUFP(YM,YAUFTRAG,YPOS,1)),Y,76)  ;LIEFERDATUM
	. . . IF YBELEG=6 IF $DATA(^INVORG(YM,YM,1)) IF $PIECE($GET(^INVORG(YM,YM,1)),Y,40)=1 SET LIEFTERM=+$HOROLOG          ;BEC;25973;30.06.04;AUSLIEFERUNGSDATUM=LIEFERSCHEINDRUCK
	. ;
	. IF YI(2)=21 DO  ;STEUERNUMMER;FIS;24855;23.12.03
	. . NEW STNR
	. . SET STNR=$PIECE($GET(^INFIBPAR(0,YM,YLOCATION,1)),Y,40)
	. . IF STNR'="" SET YI(4)=YI(4)_STNR
	. ;
	. IF YI(2)=22 IF $GET(YSUMINVOICE)'=1 SET YI(4)=YI(4)_$PIECE($GET(YAUFTRAG1),Y,302)  ;KUNDENBESTELLNUMMER
	. IF YI(2)=23 IF $GET(YSUMINVOICE)'=1 SET YI(4)=YI(4)_$PIECE($GET(YAUFTRAG1),Y,300)  ;EXTERNE BESTELLNUMMER
	. IF YI(2)=24 DO  ;UST-ID NUMMER;FIS;24855;23.12.03
	. . NEW STNR
	. . SET STNR=$PIECE($GET(^INFIBPAR(0,YM,YLOCATION,1)),Y,20)
	. . IF STNR'="" SET YI(4)=YI(4)_STNR
	. ;
	. QUIT:YI(4)=YI(5)  ;KEIN EINTRAG ;no 
	. SET A=YTAB_YI(4) DO SPE^INDRUCK  ;SPEICHERN ;Save 
	
	IF YSEITE'=1 IF $PIECE(YBELEG1,Y,11)'=1 IF $TRANSLATE($PIECE(YBELEG1,Y,219),";",",")'="" DO  ;BEC;27122;03.03.05;LEERZEILE
	. SET LFN=LFN+1
	 
	QUIT
]]></Routine>
</Export>