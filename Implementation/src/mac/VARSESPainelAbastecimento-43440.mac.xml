<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="22" zv="CACHE" ts="2001-01-01 00:00:00">
<Routine name="VARSESPainelAbastecimento" type="MAC" languagemode="0" timestamp="58440,0"><![CDATA[
VARSESPainelAbastecimento
#include COMSYS
#include INConst
#include VARConst
#include VARSESPainelAbastecimento
 
OnAfterDataFields
	new horaUltimaExecucao, horaAtual
 
	;Verificando a última execução
	set horaUltimaExecucao = $$GetUltimaExecucao^VARSESPainelAbastUtils()
	set horaAtual = $piece($horolog,",",2)
 
	do PrintProdutosAll
	do PrintLogExecucao
 
	quit
	
ExecutarManualmente	
	do GerarPainelAbastecimento	
	do RefreshForm^COMUtilForm()
	
	quit
	
GerarPainelAbastecimento(debugMode=1)
	$$$VAR
	
	new idLocationOrder, idItemOrder, objItem, statusItem, blnMS, tipoEstoque, qtyEstoqueCentral,
		situacao, blnEstoqueZeradoCentral, abastRegular, fltPontoRessuprimento, qtyEstoqueRede, CMM,
		coberturaRede, coberturaCentrais, blnEstoqueZeradoRede, situacaoFornecimento, situacaoProcessoRP,
		Atas, Pregoes, SRPs, cnt, idProcessoSep, objProcesso, strDetentorAtual, dataUltimaMov, infoProcesso,
		tipoPadrao
 
	kill ^VARSESPainelAbastecimento
	kill ^VARSESPainelAbastRegionais
	kill ^VARSESPainelAbastecimentoRun
	
	/* GERA O PAINEL DE ABASTECIMENTO DAS CENTRAIS */		
	$$$Order2(^VARAlertaLocalLinha,YM,idLocationOrder)
		
		;Só aceita os registros da VARSESAlertaLinha dos locais 5 e 1
		continue:( (idLocationOrder '= 5) && (idLocationOrder '= 1) )
		
		$$$Order3(^VARAlertaLocalLinha,YM,idLocationOrder,idItemOrder) 			
 			
 			set objItem      = $get(^INART(YM,idItemOrder,1))
 			set statusItem   = $$$INARTHoldReason(objItem)
 			set blnMS	     = $$$INARTFREE21(objItem)
 			set abastRegular = $$$INARTFREE33(objItem)
 			set tipoEstoque  = $$$INARTFREE35(objItem)
 			
 			;Ignora se o item não for de abastecimento regular
 			continue:(abastRegular '= $$$YES)
 			
 			;Ignora se o item não estiver ativo
 			continue:(statusItem '= 0)
		
			;Ignora se o produto for do Ministério da Saúde
			continue:(blnMS = $$$YES)
			continue:($extract(idItemOrder,1,2) = "MS")
 		
			;Ignora se o produto não for Padrão
 			continue:($$GetPadrao^VARAlertaLinha(idItemOrder) '= 1)
 			
 			;Ignora se o produto não tiver Tipo de Padrão
			set tipoPadrao = $$GetTipoPadrao^VARAlertaLinha(idItemOrder)
			continue:(tipoPadrao = "")
 			
			set qtyEstoqueCentral = $$GetEstoqueCentral(idItemOrder,tipoEstoque) 			
 			;Não gravar estoque negativo em hipótese alguma
 			set:(qtyEstoqueCentral < 0) qtyEstoqueCentral = 0
 			
			if (qtyEstoqueCentral > 0) {
				set blnEstoqueZeradoCentral = $$$NO
			} else {
				set blnEstoqueZeradoCentral = $$$YES
			}
			
			set qtyEstoqueRede = $$GetEstoqueRede^VARAlertaLinha(idItemOrder)
			;Não gravar estoque negativo em hipótese alguma
 			set:(qtyEstoqueRede < 0) qtyEstoqueRede = 0
 
			if (qtyEstoqueRede > 0) {
				set blnEstoqueZeradoRede = $$$NO
			} else {
				set blnEstoqueZeradoRede = $$$YES
			}
			
			set CMM = $$GetCMMRede^VARAlertaLinha(idItemOrder)
			set:(CMM < 0) CMM = 0
			
			set coberturaRede = $$GetCoberturaEstoque^VARAlertaLinha(idItemOrder)
			set:(coberturaRede < 0) coberturaRede = 0
			
			set coberturaCentrais = $$GetCoberturaEstoqueCentral^VARAlertaLinha(idItemOrder)
			set:(coberturaCentrais < 0) coberturaCentrais = 0
			
			;Definindo a Situação de Fornecimento
			set situacaoFornecimento = ""
			
			set Entregas = $$GetPrevisaoEntregas^VARCompraEntregaPrevisao(idItemOrder_"~~~~~~~~~~1")
			set AFMs 	 = $$GetAFMs^VARAlertaLinha(idItemOrder,idLocationOrder)
			set PAMs	 = $$GetPAMs^VARAlertaLinha(idItemOrder,idLocationOrder)
			
			if (Entregas '= "") {
				set situacaoFornecimento = $$$AguardandoEntregas			
			
			;O método containAFMs foi criado para não considerar retornos da função GetAFMs somente com "Sem Nº AFM" (1 ou n vezes)
			} elseif ( (AFMs '= "") && ( $$containsAFM(AFMs) = $$$YES ) ) {
				set situacaoFornecimento = $$$AFMAguardandoEmpenho
			
			} elseif (PAMs '= "") {
				set situacaoFornecimento = $$$PAMAguardandoAFM	
			
			} else {
				set situacaoFornecimento = $$$SemPAM	
			}
			;------
			
			;Definindo a Situação do Processo de Registro de Preços
			set situacaoProcessoRP = ""
			
			set Atas 	= $$GetAtas^VARAlertaLinha(idItemOrder)
			set Pregoes = $$GetPregaoData^VARAlertaLinha(idItemOrder)
			set SRPs	= $$GetSRPs^VARSESSOLICPRECO(idItemOrder)
			
			if (Atas '= "") {
				set situacaoProcessoRP = $$$ComAtaVigente				
			
			} elseif (Pregoes '= "") {
				set situacaoProcessoRP = $$$PregaoAguardAceitHomolog
			
			} elseif (SRPs '= "") {
				set situacaoProcessoRP = $$$SRPAguardandoPregao	
				
			} else {
				set situacaoProcessoRP = $$$SemSRP	
			}
			
			;------
			
			;Definindo a Situação de Abastecimento
			set fltPontoRessuprimento = +$$GetPR^VARAlertaLinha(idItemOrder)
			set fltEstoqueCentrais 	  = +$$GetEstoqueFisicoCentral^VARReposicao(idItemOrder)
			set fltEstoqueMaximo   	  = +$$GetEstoqueMaximo^VARReposicao(idItemOrder)
			
			set fltEstoqueCentraisVirtual = fltEstoqueCentrais + $$GetQtdAbertaPorItem^VARSESSOLICPRECO(idItemOrder,idLocationOrder)
			set fltSugestao = fltEstoqueMaximo - fltEstoqueCentraisVirtual 
			set:(fltSugestao < 0) fltSugestao = 0
			
			if (+fltPontoRessuprimento = 0) {
				set situacao = $$$SemDadosPlanejamento
			
			} elseif (fltEstoqueCentrais < fltPontoRessuprimento) {
				
				if (situacaoProcessoRP = $$$SemSRP) {
					set situacao = $$$AbaixoPRSemProcesso
				} else {
					if (fltSugestao > 0) {	
						;Se tem sugestão, é porque a SRP ainda não é suficiente					
						set situacao = $$$AbaixoPRComAquisicaoInsuf
					} else {
						set situacao = $$$AbaixoPRComAquisicaoSuf
					}
				}		
			
			} elseif ( (fltEstoqueCentrais >= fltPontoRessuprimento) && (fltEstoqueCentrais < fltEstoqueMaximo) )  {
				set situacao = $$$AcimaPR
			
			} elseif (fltEstoqueCentrais >= fltEstoqueMaximo) {
				set situacao = $$$AcimaEM
			
			} else {								
				set situacao = "NaoIdentificada"
			}
			;------
			
			new strProcessos
			set strProcessos = ""
			set strProcessos = $$GetProcessos^VARAlertaLinha(idItemOrder,idLocationOrder)
						
			;Definindo o objeto do item para o painel de abastecimento
			set $$$VARSESPainelAbastecimentoSituacao(objPainelAbastecimento) 	  	   = situacao
			set $$$VARSESPainelAbastecimentoTipodePadrao(objPainelAbastecimento)   	   = tipoPadrao
			set $$$VARSESPainelAbastecimentoEstoqueCentrais(objPainelAbastecimento)    = $$Floor^COMUtilNum(qtyEstoqueCentral) ;desprezando casas decimais
			set $$$VARSESPainelAbastecimentoNoDiasAbaixoPR(objPainelAbastecimento)     = $$GetDiasAbaixoPR^VARAlertaLocalLinha(idItemOrder,,0)
			set $$$VARSESPainelAbastecimentoProcesso(objPainelAbastecimento)		   = $$FullReplace^COMUtilStr(strProcessos,";","<BR>&nbsp;")	
			set $$$VARSESPainelAbastecimentoLocaldoProcesso(objPainelAbastecimento)    = "" ;Este dado agora é obtido da ^VARSESPainelAbastecimentoProc - Old $$FullReplace^COMUtilStr($$GetDetentoresAtuaisSICOP^VARSESAlertaLinha(idItemOrder,idLocationOrder),"<BR>","<BR>&nbsp;")
			set $$$VARSESPainelAbastecimentoSugCompraUrgente(objPainelAbastecimento)   = "" ;não existe método
			set $$$VARSESPainelAbastecimentoSugCompraRegular(objPainelAbastecimento)   = fltSugestao
			set $$$VARSESPainelAbastecimentoAta(objPainelAbastecimento) 			   = $$FullReplace^COMUtilStr(Atas,";","<BR>&nbsp;")
			set $$$VARSESPainelAbastecimentoSaldoemAta(objPainelAbastecimento) 		   = $$FullReplace^COMUtilStr($$GetSaldoAtas^VARAlertaLinha(idItemOrder),"<BR>","<BR>&nbsp;")
			set $$$VARSESPainelAbastecimentoVigencia(objPainelAbastecimento) 		   = $$FullReplace^COMUtilStr($$GetVigenciaAtas^VARAlertaLinha(idItemOrder),"<BR>","<BR>&nbsp;")
			set $$$VARSESPainelAbastecimentoZerado(objPainelAbastecimento)			   = blnEstoqueZeradoCentral
			set $$$VARSESPainelAbastecimentoObservacoes(objPainelAbastecimento) 	   = $$GetObservacaoProgramacao^VARAlertaLocalLinha(idItemOrder)
			set $$$VARSESPainelAbastecimentoEstoqueRede(objPainelAbastecimento) 	   = $$Floor^COMUtilNum(qtyEstoqueRede)
			set $$$VARSESPainelAbastecimentoCMM(objPainelAbastecimento) 	 		   = $$Floor^COMUtilNum(CMM)
			set $$$VARSESPainelAbastecimentoCoberturaRede(objPainelAbastecimento) 	   = $$Floor^COMUtilNum(coberturaRede)
			set $$$VARSESPainelAbastecimentoCoberturaCentrais(objPainelAbastecimento)  = $$Floor^COMUtilNum(coberturaCentrais)
			set $$$VARSESPainelAbastecimentoSituacaoCompras(objPainelAbastecimento)    = situacaoFornecimento
			set $$$VARSESPainelAbastecimentoZeradoRede(objPainelAbastecimento)   	   = blnEstoqueZeradoRede
			set $$$VARSESPainelAbastecimentoSituacaoProcessoRP(objPainelAbastecimento) = situacaoProcessoRP
			
			set ^VARSESPainelAbastecimento(YM,idItemOrder,1) = objPainelAbastecimento
			
			/*****************************************************************************************\
			/* 27/01/2014 - MIGRADO PARA O MÉTODO GerarPainelAbastProcesso^VARSESPainelAbastProcesso *\
			/*****************************************************************************************\
			;Gravando os processos individualmente em tabela auxiliar para consulta específica			
			if (strProcessos '= "") {
				set cnt = ""
				set idProcessoSep = ""
				
				for cnt = 1:1:$length(strProcessos,";") {
					continue:(cnt = "")
					set idProcessoSep = $piece(strProcessos,";",cnt)
					continue:(idProcessoSep = "")
					continue:(idProcessoSep = "Sem Nº Processo")
					
					set infoProcesso = ""
					set infoProcesso  = $$getDetentor^VARSESProcesso(idProcessoSep)
							
					set strDetentorAtual = $piece(infoProcesso,"-",1)
					set dataUltimaMov    = $piece(infoProcesso,"-",2)
					
					set ^VARSESPainelAbastecimentoProc(YM,idItemOrder,idProcessoSep,1) = strDetentorAtual_Y_dataUltimaMov
				}
			}
			;-----
			*/			
			
			if (debugMode = 1) {
				write "Local: "_idLocationOrder_", Produto: "_idItemOrder,!
			}
			
		$$$End
	$$$End
  	; ---------------
  	 
 	/* GERA O PAINEL DE ABASTECIMENTO DAS REGIONAIS */
 	
 	new objParametrosCliente, strListRegionais, cnt, idRegional, idProdutoOrder, objItem,
 		statusItem, blnMS, abastRegular, tipoEstoque, qtyEstoqueCentral, situacao,
 		objPainelAbastRegionais, qtyEstoqueLocal, coberturaEstoque, blnEstoqueLocalZerado,
 		CMML
 	
 	set objParametrosCliente = $get(^VARParametroCliente(YM,YM,1))
 	set strListRegionais = $$$VARParametroClienteRegionaisPainelAbast(objParametrosCliente)
  	
  	if (strListRegionais '= "") {
		
		for cnt = 1:1:$length(strListRegionais,";") { 	
			set idRegional = $piece(strListRegionais,";",cnt)		 		
		 	continue:(idRegional = "")
		 	
		 	;Ignorando locais inválidos
		 	continue:( '$data(^WWW0121(YM,YM,idRegional)) )
		 	
		 	$$$Order3(^VARAlertaLocalLinha,YM,idRegional,idProdutoOrder)
 
 				set objItem      = $get(^INART(YM,idProdutoOrder,1))
 				set statusItem   = $piece(objItem,Y,66)
 				set blnMS	     = $piece(objItem,Y,296)
 				set abastRegular = $piece(objItem,Y,343)
 				set tipoEstoque  = $piece(objItem,Y,345)
 			
 				;Ignora se o item não for de abastecimento regular
 				continue:(abastRegular '= $$$YES)
 			
 				;Ignora se o item não estiver ativo
 				continue:(statusItem '= 0)
		
				;Ignora se o produto for do Ministério da Saúde
				continue:(blnMS = $$$YES)
				continue:($extract(idProdutoOrder,1,2) = "MS")
 		
				;Ignora se o produto não for Padrão
 				continue:($$GetPadrao^VARAlertaLinha(idProdutoOrder) '= 1)
 			
 				;Ignora se o produto for do Tipo de Padrão = 6 - OPME, pois deixa a função que gera 50% mais leve
 				;Subsecretario pediu para incluir OPME de volta
 				//continue:($$GetTipoPadrao^VARAlertaLinha(idProdutoOrder) = 6)
 				
				set qtyEstoqueCentral = $$GetEstoqueCentral(idProdutoOrder,tipoEstoque)
				set qtyEstoqueLocal	  = $$GetEstoqueLocal^VARAlertaLinha(idProdutoOrder,idRegional)
 
 				;Não gravar estoque negativo em hipótese alguma
 				set:(qtyEstoqueCentral < 0) qtyEstoqueCentral = 0
 				set:(qtyEstoqueLocal < 0) qtyEstoqueLocal = 0
 
				if (qtyEstoqueLocal > 0) {
					set blnEstoqueLocalZerado = $$$NO
				} else {
					set blnEstoqueLocalZerado = $$$YES
				}
				
				set CMML = $$GetCMML^VARAlertaLocalLinha(idRegional,idProdutoOrder)
				set coberturaEstoque = +$$GetCoberturaEstoqueLocal^VARAlertaLocalLinha(idRegional,idProdutoOrder)
				set situacao = $$GetSituacaoFromCobertura^VARSESPainelAbastUtils(CMML,coberturaEstoque)
 
				;Definindo o objeto do item para o painel de abastecimento das regionais
				set $$$VARSESPainelAbastRegionaisSituacao(objPainelAbastRegionais) 	  	   	  = situacao
				set $$$VARSESPainelAbastRegionaisTipodePadrao(objPainelAbastRegionais)     	  = $$GetTipoPadrao^VARAlertaLinha(idProdutoOrder)
				set $$$VARSESPainelAbastRegionaisEstoquesCentrais(objPainelAbastRegionais) 	  = $$Floor^COMUtilNum(qtyEstoqueCentral)
				set $$$VARSESPainelAbastRegionaisEstoqueLocal(objPainelAbastRegionais)	   	  = $$Floor^COMUtilNum(qtyEstoqueLocal)
				set $$$VARSESPainelAbastRegionaisCMMLocal(objPainelAbastRegionais)		   	  = CMML
				set $$$VARSESPainelAbastRegionaisCoberturaLocal(objPainelAbastRegionais)	  = coberturaEstoque
				set $$$VARSESPainelAbastRegionaisQuantSolicPendentes(objPainelAbastRegionais) = $$GetQuantidadePendenteReq^VARReposicao(idProdutoOrder,idRegional)
				set $$$VARSESPainelAbastRegionaisZerado(objPainelAbastRegionais)		   	  = blnEstoqueLocalZerado
			
				set ^VARSESPainelAbastRegionais(YM,idRegional,idProdutoOrder,1) = objPainelAbastRegionais
			
			if (debugMode = 1) {
				write "Local: "_idRegional_", Produto: "_idProdutoOrder,!
			}				
 
		 	$$$End
		}
  	}
  	; ---------------
 
  	/* GERA O PAINEL DO PDPAS */	
	set competenciaAtual = $extract($zdate($horolog,8),1,6)	
	set competenciaAnter = $$GetCompetenciaAnterior^VARSESPainelPDPASUtils(competenciaAtual)
	set competenciaRetra = $$GetCompetenciaAnterior^VARSESPainelPDPASUtils(competenciaAnter)
	
 	do GeraConsolidadoMensalPDPAS^VARDWPDPAS(competenciaRetra)
 	do GeraConsolidadoMensalPDPAS^VARDWPDPAS(competenciaAnter)
 	do GeraConsolidadoMensalPDPAS^VARDWPDPAS(competenciaAtual)
  	; ---------------
  	 
	set ^VARSESPainelAbastecimentoRun(YM,YM,1) = $piece($horolog,",",1)_Y_$piece($horolog,",",2)_Y_YBED
	
	quit 1
	
	
GetEstoqueCentral(pidItem,pTipoEstoque)	
	new qtyEstoqueCentral
	set qtyEstoqueCentral = 0	
	
	if (pTipoEstoque = "FARMACIA") {
		new qtyEstoqueFC, qtyEstoqueNUMEBE, qtyEstoqueGEMEX, qtyEstoqueGCEAF
		set qtyEstoqueFC 	 = $$GetEstoqueLocal^VARAlertaLinha(pidItem,5)    ;Farmácia Central
		set qtyEstoqueNUMEBE = $$GetEstoqueLocal^VARAlertaLinha(pidItem,5070) ;Numebe
		set qtyEstoqueGEMEX  = $$GetEstoqueLocal^VARAlertaLinha(pidItem,5071) ;GEMEX
		set qtyEstoqueGCEAF  = $$GetEstoqueLocal^VARAlertaLinha(pidItem,5095) ;GCEAF
		
		set qtyEstoqueCentral = qtyEstoqueFC + qtyEstoqueNUMEBE + qtyEstoqueGEMEX + qtyEstoqueGCEAF 
 
	} elseif (pTipoEstoque = "ALMOXARIFADO") {
		set qtyEstoqueCentral = $$GetEstoqueLocal^VARAlertaLinha(pidItem,1)
	}
 
	quit qtyEstoqueCentral
 
PrintProdutosAll
	new rsSQL, meuSQL, tipoPadrao, situacao, blnZerado, countItens
 	
 	if '$data(^VARSESPainelAbastecimentoRun(YM,YM,1)) {
	 	do PrintMsgEmExecucao^VARSESPainelAbastUtils
	 	quit
 	} 	 
 	
	set rsSQL = ##class(%ResultSet).%New()  ;Create Result Set Object
		
	set meuSQL = "SELECT TipodePadrao,"
	set meuSQL = meuSQL_" Situacao,"
	set meuSQL = meuSQL_" Zerado,"
	set meuSQL = meuSQL_" count(Produto),"
	set meuSQL = meuSQL_" ZeradoRede"
	set meuSQL = meuSQL_" FROM VARSESPainelAbastecimento"
	set meuSQL = meuSQL_" GROUP BY TipoDePadrao, Situacao, Zerado, ZeradoRede"
	
	do rsSQL.Prepare(meuSQL) ;Prepare Query
	do rsSQL.Execute()  	 ;Execute Query
 
 
	// 0 - MEDICAMENTO
	;Posição
	set countMedSemProcesso = 0
	set countMedAquisSuf    = 0
	set countMedAquisInsuf  = 0
	set countMedAcimaPR 	= 0
	set countMedAcimaEM 	= 0
	set countMedSemPlanej   = 0
	
	;Zerados	
	set countMedSemProcessoZerado = 0
	set countMedAquisInsufZerado  = 0
	set countMedAquisSufZerado 	  = 0
	set countMedSemPlanejZerado   = 0
	set countMedZeradoRede		  = 0
	
	;Totais
	set countTotalMed = 0	
	set countTotalMedZerado = 0
	//--------------------
 
	// 1 - MATERIAL MÉDICO
	;Posição
	set countMatMedSemProcesso = 0
	set countMatMedAquisInsuf  = 0
	set countMatMedAquisSuf    = 0
	set countMatMedAcimaPR 	   = 0
	set countMatMedAcimaEM 	   = 0
	set countMatMedSemPlanej   = 0
	
	;Zerados
	set countMatMedSemProcessoZerado = 0
	set countMatMedAquisInsufZerado  = 0
	set countMatMedAquisSufZerado	 = 0
	set countMatMedSemPlanejZerado	 = 0
	set countMatMedZeradoRede        = 0
 
	;Totais
	set countTotalMatMed = 0
	set countTotalMatMedZerado = 0
	//--------------------
 
	// 2 - ALMOXARIFADO
	;Posição
	set countAlmoxSemProcesso = 0
	set countAlmoxAquisInsuf  = 0	
	set countAlmoxAquisSuf    = 0
	set countAlmoxAcimaPR     = 0
	set countAlmoxAcimaEM     = 0
	set countAlmoxSemPlanej   = 0
 
	;Zerados
	set countAlmoxSemProcessoZerado = 0
	set countAlmoxAquisInsufZerado  = 0
	set countAlmoxAquisSufZerado    = 0
	set countAlmoxSemPlanejZerado   = 0
	set countAlmoxZeradoRede        = 0
 
	;Totais
	set countTotalAlmox = 0
	set countTotalAlmoxZerado = 0
	//--------------------
	
	// 3 - ODONTOLÓGICO
	;Posição
	set countOdontSemProcesso = 0
	set countOdontAquisInsuf  = 0
	set countOdontAquisSuf    = 0
	set countOdontAcimaPR     = 0
	set countOdontAcimaEM     = 0
	set countOdontSemPlanej	  = 0
	
	;Zerados
	set countOdontSemProcessoZerado = 0
	set countOdontAquisInsufZerado 	= 0
	set countOdontAquisSufZerado 	= 0
	set countOdontSemPlanejZerado 	= 0
	set countOdontZeradoRede        = 0
	
	;Totais
	set countTotalOdont = 0
	set countTotalOdontZerado = 0	
	//--------------------	
	
	// 4 - LABORATÓRIO
	;Posição
	set countLabSemProcesso = 0
	set countLabAquisInsuf  = 0
	set countLabAquisSuf    = 0
	set countLabAcimaPR     = 0
	set countLabAcimaEM     = 0
	set countLabSemPlanej   = 0
	
	;Zerados
	set countLabSemProcessoZerado = 0
	set countLabAquisInsufZerado  = 0
	set countLabAquisSufZerado 	  = 0
	set countLabSemPlanejZerado	  = 0
	set countLabZeradoRede        = 0
	
	;Totais
	set countTotalLab = 0
	set countTotalLabZerado = 0
	//--------------------	
	
	// 5 - NUTRIÇÃO
	;Posição
	set countNutricSemProcesso = 0
	set countNutricAquisInsuf  = 0
	set countNutricAquisSuf    = 0		
	set countNutricAcimaPR     = 0
	set countNutricAcimaEM     = 0
	set countNutricSemPlanej   = 0
	
	;Zerados
	set countNutricSemProcessoZerado = 0
	set countNutricAquisInsufZerado  = 0	
	set countNutricAquisSufZerado    = 0	
	set countNutricSemPlanejZerado   = 0
	set countNutricZeradoRede        = 0
	
	;Totais
	set countTotalNutric = 0
	set countTotalNutricZerado = 0
	//--------------------	
	
	// 6 - OPME
	;Posição
	set countOPMESemProcesso = 0
	set countOPMEAquisInsuf  = 0
	set countOPMEAquisSuf    = 0		
	set countOPMEAcimaPR     = 0
	set countOPMEAcimaEM     = 0
	set countOPMESemPlanej   = 0
	
	;Zerados
	set countOPMESemProcessoZerado = 0
	set countOPMEAquisInsufZerado  = 0	
	set countOPMEAquisSufZerado    = 0	
	set countOPMESemPlanejZerado   = 0
	set countOPMEZeradoRede        = 0
	
	;Totais
	set countTotalOPME = 0
	set countTotalOPMEZerado = 0
	//--------------------	
 
	while (rsSQL.Next()) {		
		set tipoPadrao 		= rsSQL.GetData(1)
		set situacao    	= rsSQL.GetData(2)
		set blnZerado 		= rsSQL.GetData(3)
		set countItens 		= rsSQL.GetData(4)
		set blnZeradoRede	= rsSQL.GetData(5)
		
		if (tipoPadrao = $$$Medicamento) {
			
			if (situacao = $$$AbaixoPRSemProcesso) {
				set countMedSemProcesso = countMedSemProcesso + countItens
				set:(blnZerado = $$$YES) countMedSemProcessoZerado = countMedSemProcessoZerado + countItens
				
			} elseif (situacao = $$$AbaixoPRComAquisicaoInsuf) {
				set countMedAquisInsuf = countMedAquisInsuf + countItens
				set:(blnZerado = $$$YES) countMedAquisInsufZerado = countMedAquisInsufZerado + countItens			
				
			} elseif (situacao = $$$AbaixoPRComAquisicaoSuf) {
				set countMedAquisSuf = countMedAquisSuf + countItens
				set:(blnZerado = $$$YES) countMedAquisSufZerado = countMedAquisSufZerado + countItens
				
			} elseif (situacao = $$$AcimaPR) {
				set countMedAcimaPR = countMedAcimaPR + countItens
				
			} elseif (situacao = $$$AcimaEM) {
				set countMedAcimaEM = countMedAcimaEM + countItens
			
			} elseif (situacao = $$$SemDadosPlanejamento) {
				set countMedSemPlanej = countMedSemPlanej + countItens
				set:(blnZerado = $$$YES) countMedSemPlanejZerado = countMedSemPlanejZerado + countItens
			}
			set:(blnZeradoRede = $$$YES) countMedZeradoRede = countMedZeradoRede + countItens
			
		} elseif (tipoPadrao = $$$MaterialMedico) {
			
			if (situacao = $$$AbaixoPRSemProcesso) {
				set countMatMedSemProcesso = countMatMedSemProcesso + countItens
				set:(blnZerado = $$$YES) countMatMedSemProcessoZerado = countMatMedSemProcessoZerado + countItens
				
			} elseif (situacao = $$$AbaixoPRComAquisicaoInsuf) {
				set countMatMedAquisInsuf = countMatMedAquisInsuf + countItens
				set:(blnZerado = $$$YES) countMatMedAquisInsufZerado = countMatMedAquisInsufZerado + countItens
				
			} elseif (situacao = $$$AbaixoPRComAquisicaoSuf) {
				set countMatMedAquisSuf = countMatMedAquisSuf + countItens
				set:(blnZerado = $$$YES) countMatMedAquisSufZerado = countMatMedAquisSufZerado + countItens
				
			} elseif (situacao = $$$AcimaPR) {
				set countMatMedAcimaPR = countMatMedAcimaPR + countItens
				
			} elseif (situacao = $$$AcimaEM) {
				set countMatMedAcimaEM = countMatMedAcimaEM + countItens
 
			} elseif (situacao = $$$SemDadosPlanejamento) {
				set countMatMedSemPlanej = countMatMedSemPlanej + countItens
				set:(blnZerado = $$$YES) countMatMedSemPlanejZerado = countMatMedSemPlanejZerado + countItens
			}
			set:(blnZeradoRede = $$$YES) countMatMedZeradoRede = countMatMedZeradoRede + countItens
			
		} elseif (tipoPadrao = $$$Almoxarifado) {
 
			if (situacao = $$$AbaixoPRSemProcesso) {
				set countAlmoxSemProcesso = countAlmoxSemProcesso + countItens
				set:(blnZerado = $$$YES) countAlmoxSemProcessoZerado = countAlmoxSemProcessoZerado + countItens
 
			} elseif (situacao = $$$AbaixoPRComAquisicaoInsuf) {
				set countAlmoxAquisInsuf = countAlmoxAquisInsuf + countItens
				set:(blnZerado = $$$YES) countAlmoxAquisInsufZerado = countAlmoxAquisInsufZerado + countItens
			
			} elseif (situacao = $$$AbaixoPRComAquisicaoSuf) {
				set countAlmoxAquisSuf = countAlmoxAquisSuf + countItens
				set:(blnZerado = $$$YES) countAlmoxAquisSufZerado = countAlmoxAquisSufZerado + countItens
						
			} elseif (situacao = $$$AcimaPR) {
				set countAlmoxAcimaPR = countAlmoxAcimaPR + countItens
			
			} elseif (situacao = $$$AcimaEM) {
				set countAlmoxAcimaEM = countAlmoxAcimaEM + countItens
			
			} elseif (situacao = $$$SemDadosPlanejamento) {
				set countAlmoxSemPlanej = countAlmoxSemPlanej + countItens
				set:(blnZerado = $$$YES) countAlmoxSemPlanejZerado = countAlmoxSemPlanejZerado + countItens
			}
			set:(blnZeradoRede = $$$YES) countAlmoxZeradoRede = countAlmoxZeradoRede + countItens
		
		} elseif (tipoPadrao = $$$Odontologico) {
 
			if (situacao = $$$AbaixoPRSemProcesso) {
				set countOdontSemProcesso = countOdontSemProcesso + countItens
				set:(blnZerado = $$$YES) countOdontSemProcessoZerado = countOdontSemProcessoZerado + countItens				
				
			} elseif (situacao = $$$AbaixoPRComAquisicaoInsuf) {
				set countOdontAquisInsuf = countOdontAquisInsuf + countItens
				set:(blnZerado = $$$YES) countOdontAquisInsufZerado = countOdontAquisInsufZerado + countItens
				
			} elseif (situacao = $$$AbaixoPRComAquisicaoSuf) {
				set countOdontAquisSuf = countOdontAquisSuf + countItens
				set:(blnZerado = $$$YES) countOdontAquisSufZerado = countOdontAquisSufZerado + countItens
				
			} elseif (situacao = $$$AcimaPR) {
				set countOdontAcimaPR = countOdontAcimaPR + countItens
				
			} elseif (situacao = $$$AcimaEM) {
				set countOdontAcimaEM = countOdontAcimaEM + countItens
			
			} elseif (situacao = $$$SemDadosPlanejamento) {
				set countOdontSemPlanej = countOdontSemPlanej + countItens
				set:(blnZerado = $$$YES) countOdontSemPlanejZerado = countOdontSemPlanejZerado + countItens
			}
			set:(blnZeradoRede = $$$YES) countOdontZeradoRede = countOdontZeradoRede + countItens
		
		} elseif (tipoPadrao = $$$Laboratorio) { 
 
			if (situacao = $$$AbaixoPRSemProcesso) {
				set countLabSemProcesso = countLabSemProcesso + countItens
				set:(blnZerado = $$$YES) countLabSemProcessoZerado = countLabSemProcessoZerado + countItens
						
			} elseif (situacao = $$$AbaixoPRComAquisicaoInsuf) {
				set countLabAquisInsuf = countLabAquisInsuf + countItens
				set:(blnZerado = $$$YES) countLabAquisInsufZerado = countLabAquisInsufZerado + countItens
				
			} elseif (situacao = $$$AbaixoPRComAquisicaoSuf) {
				set countLabAquisSuf = countLabAquisSuf + countItens
				set:(blnZerado = $$$YES) countLabAquisSufZerado = countLabAquisSufZerado + countItens
				
			} elseif (situacao = $$$AcimaPR) {
				set countLabAcimaPR = countLabAcimaPR + countItens
				
			} elseif (situacao = $$$AcimaEM) {
				set countLabAcimaEM = countLabAcimaEM + countItens
 
			} elseif (situacao = $$$SemDadosPlanejamento) {
				set countLabSemPlanej = countLabSemPlanej + countItens
				set:(blnZerado = $$$YES) countLabSemPlanejZerado = countLabSemPlanejZerado + countItens
			}
			set:(blnZeradoRede = $$$YES) countLabZeradoRede = countLabZeradoRede + countItens
		
		} elseif (tipoPadrao = $$$Nutricao) {
 
			if (situacao = $$$AbaixoPRSemProcesso) {
				set countNutricSemProcesso = countNutricSemProcesso + countItens
				set:(blnZerado = $$$YES) countNutricSemProcessoZerado = countNutricSemProcessoZerado + countItens
				
			} elseif (situacao = $$$AbaixoPRComAquisicaoInsuf) {
				set countNutricAquisInsuf = countNutricAquisInsuf + countItens
				set:(blnZerado = $$$YES) countNutricAquisInsufZerado = countNutricAquisInsufZerado + countItens
				
			} elseif (situacao = $$$AbaixoPRComAquisicaoSuf) {
				set countNutricAquisSuf = countNutricAquisSuf + countItens
				set:(blnZerado = $$$YES) countNutricAquisSufZerado = countNutricAquisSufZerado + countItens
				
			} elseif (situacao = $$$AcimaPR) {
				set countNutricAcimaPR = countNutricAcimaPR + countItens
				
			} elseif (situacao = $$$AcimaEM) {
				set countNutricAcimaEM = countNutricAcimaEM + countItens
			
			} elseif (situacao = $$$SemDadosPlanejamento) {
				set countNutricSemPlanej = countNutricSemPlanej + countItens
				set:(blnZerado = $$$YES) countNutricSemPlanejZerado = countNutricSemPlanejZerado + countItens
			}
			set:(blnZeradoRede = $$$YES) countNutricZeradoRede = countNutricZeradoRede + countItens
 
		} elseif (tipoPadrao = $$$OPME) {
 
			if (situacao = $$$AbaixoPRSemProcesso) {
				set countOPMESemProcesso = countOPMESemProcesso + countItens
				set:(blnZerado = $$$YES) countOPMESemProcessoZerado = countOPMESemProcessoZerado + countItens
				
			} elseif (situacao = $$$AbaixoPRComAquisicaoInsuf) {
				set countOPMEAquisInsuf = countOPMEAquisInsuf + countItens
				set:(blnZerado = $$$YES) countOPMEAquisInsufZerado = countOPMEAquisInsufZerado + countItens
				
			} elseif (situacao = $$$AbaixoPRComAquisicaoSuf) {
				set countOPMEAquisSuf = countOPMEAquisSuf + countItens
				set:(blnZerado = $$$YES) countOPMEAquisSufZerado = countOPMEAquisSufZerado + countItens
				
			} elseif (situacao = $$$AcimaPR) {
				set countOPMEAcimaPR = countOPMEAcimaPR + countItens
				
			} elseif (situacao = $$$AcimaEM) {
				set countOPMEAcimaEM = countOPMEAcimaEM + countItens
			
			} elseif (situacao = $$$SemDadosPlanejamento) {
				set countOPMESemPlanej = countOPMESemPlanej + countItens
				set:(blnZerado = $$$YES) countOPMESemPlanejZerado = countOPMESemPlanejZerado + countItens
			}
			set:(blnZeradoRede = $$$YES) countOPMEZeradoRede = countOPMEZeradoRede + countItens
 
		}
 
	}
	
 	set lstHeader = ""
  	set lstHeader = lstHeader_$listbuild("","Medicamentos","Materiais Médicos","Almoxarifado","Odontológico","Laboratório","Nutrição","OPME")
 
	if $$Start^COMTable(lstHeader) {
		;Formato de YPARA: "TipoPadrão;Situação;Ordenação;Zerado;ZeradoRede"
				
		do NewLine^COMTable($$$corVermelho)
		do InsertCell^COMTable("<strong>Estoque Zerado na rede</strong>")
	    do InsertCell^COMTable("<strong>"_$$^WWWTR(0,12,countMedZeradoRede)_"</strong>","VARSESPainelAbastecimentoDet","0;;3;0;1","0;;3;0;1","center")
	    do InsertCell^COMTable("<strong>"_$$^WWWTR(0,12,countMatMedZeradoRede)_"</strong>","VARSESPainelAbastecimentoDet","1;;3;0;1","1;;3;0;1","center")
	    do InsertCell^COMTable("<strong>"_$$^WWWTR(0,12,countAlmoxZeradoRede)_"</strong>","VARSESPainelAbastecimentoDet","2;;3;0;1","2;;3;0;1","center")
	    do InsertCell^COMTable("<strong>"_$$^WWWTR(0,12,countOdontZeradoRede)_"</strong>","VARSESPainelAbastecimentoDet","3;;3;0;1","3;;3;0;1","center")	    
	    do InsertCell^COMTable("<strong>"_$$^WWWTR(0,12,countLabZeradoRede)_"</strong>","VARSESPainelAbastecimentoDet","4;;3;0;1","4;;3;0;1","center")
	    do InsertCell^COMTable("<strong>"_$$^WWWTR(0,12,countNutricZeradoRede)_"</strong>","VARSESPainelAbastecimentoDet","5;;3;0;1","5;;3;0;1","center")
	    do InsertCell^COMTable("<strong>"_$$^WWWTR(0,12,countOPMEZeradoRede)_"</strong>","VARSESPainelAbastecimentoDet","6;;3;0;1","6;;3;0;1","center")
	    do EndLine^COMTable()
 
		do NewLine^COMTable("#dcdcdc")
		do InsertCell^COMTable("",,,,,,8)
		do EndLine^COMTable()
 
		do NewLine^COMTable($$$corVermelho)
		do InsertCell^COMTable("<strong>Estoque Zerado nas Centrais sem OC</strong>")
	    do InsertCell^COMTable("<strong>"_$$^WWWTR(0,12,countMedSemProcessoZerado),"VARSESPainelAbastecimentoDet","0;1;3;1","0;1;3;1","center")
	    do InsertCell^COMTable("<strong>"_$$^WWWTR(0,12,countMatMedSemProcessoZerado),"VARSESPainelAbastecimentoDet","1;1;3;1","1;1;3;1","center")
	    do InsertCell^COMTable("<strong>"_$$^WWWTR(0,12,countAlmoxSemProcessoZerado),"VARSESPainelAbastecimentoDet","2;1;3;1","2;1;3;1","center")
	    do InsertCell^COMTable("<strong>"_$$^WWWTR(0,12,countOdontSemProcessoZerado),"VARSESPainelAbastecimentoDet","3;1;3;1","3;1;3;1","center")	    
	    do InsertCell^COMTable("<strong>"_$$^WWWTR(0,12,countLabSemProcessoZerado),"VARSESPainelAbastecimentoDet","4;1;3;1","4;1;3;1","center")
	    do InsertCell^COMTable("<strong>"_$$^WWWTR(0,12,countNutricSemProcessoZerado),"VARSESPainelAbastecimentoDet","5;1;3;1","5;1;3;1","center")
	    do InsertCell^COMTable("<strong>"_$$^WWWTR(0,12,countOPMESemProcessoZerado),"VARSESPainelAbastecimentoDet","6;1;3;1","6;1;3;1","center")
	    do EndLine^COMTable()
 
	    set countTotalMedZerado    = countMedAquisInsufZerado + countMedAquisSufZerado
	    set countTotalMatMedZerado = countMatMedAquisInsufZerado + countMatMedAquisSufZerado
	    set countTotalAlmoxZerado  = countAlmoxAquisInsufZerado + countAlmoxAquisSufZerado
	    set countTotalOdontZerado  = countOdontAquisInsufZerado + countOdontAquisSufZerado
	    set countTotalLabZerado	   = countLabAquisInsufZerado + countLabAquisSufZerado
	    set countTotalNutricZerado = countNutricAquisInsufZerado + countNutricAquisSufZerado
	    set countTotalOPMEZerado = countOPMEAquisInsufZerado + countOPMEAquisSufZerado
 
		do NewLine^COMTable($$$corLaranja)
		do InsertCell^COMTable("<strong>Estoque Zerado nas Centrais com OC</strong>")
	    do InsertCell^COMTable("<strong>"_$$^WWWTR(0,12,countTotalMedZerado),"VARSESPainelAbastecimentoDet","0;11;3;1","0;11;3;1","center")
	    do InsertCell^COMTable("<strong>"_$$^WWWTR(0,12,countTotalMatMedZerado),"VARSESPainelAbastecimentoDet","1;11;3;1","1;11;3;1","center")
	    do InsertCell^COMTable("<strong>"_$$^WWWTR(0,12,countTotalAlmoxZerado),"VARSESPainelAbastecimentoDet","2;11;3;1","2;11;3;1","center")
	    do InsertCell^COMTable("<strong>"_$$^WWWTR(0,12,countTotalOdontZerado),"VARSESPainelAbastecimentoDet","3;11;3;1","3;11;3;1","center")	    
	    do InsertCell^COMTable("<strong>"_$$^WWWTR(0,12,countTotalLabZerado),"VARSESPainelAbastecimentoDet","4;11;3;1","4;11;3;1","center")
	    do InsertCell^COMTable("<strong>"_$$^WWWTR(0,12,countTotalNutricZerado),"VARSESPainelAbastecimentoDet","5;11;3;1","5;11;3;1","center")
	    do InsertCell^COMTable("<strong>"_$$^WWWTR(0,12,countTotalOPMEZerado),"VARSESPainelAbastecimentoDet","6;11;3;1","6;11;3;1","center")
	    do EndLine^COMTable()
	    
 
		do NewLine^COMTable("#dcdcdc")
		do InsertCell^COMTable("",,,,,,8)
		do EndLine^COMTable()
 
		do NewLine^COMTable($$GetColorFromSituacao^VARSESPainelAbastUtils($$$AbaixoPRSemProcesso))
		do InsertCell^COMTable("<strong>"_$$GetDescricaoSituacaoFromID^VARSESPainelAbastUtils($$$AbaixoPRSemProcesso)_"</strong>")
		do InsertCell^COMTable($$AddHyperlink("<strong>"_$$^WWWTR(0,12,countMedSemProcesso)_"</strong>","0;1;3")_" <span title='Estoque zerado'>"_$$AddHyperlink("("_$$^WWWTR(0,12,countMedSemProcessoZerado)_")</span>","0;1;3;1"),,,,"center")
	    do InsertCell^COMTable($$AddHyperlink("<strong>"_$$^WWWTR(0,12,countMatMedSemProcesso)_"</strong>","1;1;3")_" <span title='Estoque zerado'>"_$$AddHyperlink("("_$$^WWWTR(0,12,countMatMedSemProcessoZerado)_")</span>]]><![CDATA[","1;1;3;1"),,,,"center")
	    do InsertCell^COMTable($$AddHyperlink("<strong>"_$$^WWWTR(0,12,countAlmoxSemProcesso)_"</strong>","2;1;3")_" <span title='Estoque zerado'>"_$$AddHyperlink("("_$$^WWWTR(0,12,countAlmoxSemProcessoZerado)_")</span>","2;1;3;1"),,,,"center")
	    do InsertCell^COMTable($$AddHyperlink("<strong>"_$$^WWWTR(0,12,countOdontSemProcesso)_"</strong>","3;1;3")_" <span title='Estoque zerado'>"_$$AddHyperlink("("_$$^WWWTR(0,12,countOdontSemProcessoZerado)_")</span>","3;1;3;1"),,,,"center")
	    do InsertCell^COMTable($$AddHyperlink("<strong>"_$$^WWWTR(0,12,countLabSemProcesso)_"</strong>","4;1;3")_" <span title='Estoque zerado'>"_$$AddHyperlink("("_$$^WWWTR(0,12,countLabSemProcessoZerado)_")</span>","4;1;3;1"),,,,"center")
	    do InsertCell^COMTable($$AddHyperlink("<strong>"_$$^WWWTR(0,12,countNutricSemProcesso)_"</strong>","5;1;3")_" <span title='Estoque zerado'>"_$$AddHyperlink("("_$$^WWWTR(0,12,countNutricSemProcessoZerado)_")</span>","5;1;3;1"),,,,"center")
	    do InsertCell^COMTable($$AddHyperlink("<strong>"_$$^WWWTR(0,12,countOPMESemProcesso)_"</strong>","6;1;3")_" <span title='Estoque zerado'>"_$$AddHyperlink("("_$$^WWWTR(0,12,countOPMESemProcessoZerado)_")</span>","6;1;3;1"),,,,"center")
	    do EndLine^COMTable()
 
		do NewLine^COMTable($$GetColorFromSituacao^VARSESPainelAbastUtils($$$AbaixoPRComAquisicaoInsuf))
		do InsertCell^COMTable("<strong>"_$$GetDescricaoSituacaoFromID^VARSESPainelAbastUtils($$$AbaixoPRComAquisicaoInsuf)_"</strong>")
		do InsertCell^COMTable($$AddHyperlink("<strong>"_$$^WWWTR(0,12,countMedAquisInsuf)_"</strong>","0;2;3")_" <span title='Estoque zerado'>"_$$AddHyperlink("("_$$^WWWTR(0,12,countMedAquisInsufZerado)_")</span>","0;2;3;1"),,,,"center")
		do InsertCell^COMTable($$AddHyperlink("<strong>"_$$^WWWTR(0,12,countMatMedAquisInsuf)_"</strong>","1;2;3")_" <span title='Estoque zerado'>"_$$AddHyperlink("("_$$^WWWTR(0,12,countMatMedAquisInsufZerado)_")</span>","1;2;3;1"),,,,"center")
		do InsertCell^COMTable($$AddHyperlink("<strong>"_$$^WWWTR(0,12,countAlmoxAquisInsuf)_"</strong>","2;2;3")_" <span title='Estoque zerado'>"_$$AddHyperlink("("_$$^WWWTR(0,12,countAlmoxAquisInsufZerado)_")</span>","2;2;3;1"),,,,"center")
		do InsertCell^COMTable($$AddHyperlink("<strong>"_$$^WWWTR(0,12,countOdontAquisInsuf)_"</strong>","3;2;3")_" <span title='Estoque zerado'>"_$$AddHyperlink("("_$$^WWWTR(0,12,countOdontAquisInsufZerado)_")</span>","3;2;3;1"),,,,"center")
		do InsertCell^COMTable($$AddHyperlink("<strong>"_$$^WWWTR(0,12,countLabAquisInsuf)_"</strong>","4;2;3")_" <span title='Estoque zerado'>"_$$AddHyperlink("("_$$^WWWTR(0,12,countLabAquisInsufZerado)_")</span>","4;2;3;1"),,,,"center")
		do InsertCell^COMTable($$AddHyperlink("<strong>"_$$^WWWTR(0,12,countNutricAquisInsuf)_"</strong>","5;2;3")_" <span title='Estoque zerado'>"_$$AddHyperlink("("_$$^WWWTR(0,12,countNutricAquisInsufZerado)_")</span>","5;2;3;1"),,,,"center")
		do InsertCell^COMTable($$AddHyperlink("<strong>"_$$^WWWTR(0,12,countOPMEAquisInsuf)_"</strong>","6;2;3")_" <span title='Estoque zerado'>"_$$AddHyperlink("("_$$^WWWTR(0,12,countOPMEAquisInsufZerado)_")</span>","6;2;3;1"),,,,"center")
	    do EndLine^COMTable()
	    
		do NewLine^COMTable($$GetColorFromSituacao^VARSESPainelAbastUtils($$$AbaixoPRComAquisicaoSuf))
		do InsertCell^COMTable("<strong>"_$$GetDescricaoSituacaoFromID^VARSESPainelAbastUtils($$$AbaixoPRComAquisicaoSuf)_"</strong>")
		do InsertCell^COMTable($$AddHyperlink("<strong>"_$$^WWWTR(0,12,countMedAquisSuf)_"</strong>","0;3;3")_" <span title='Estoque zerado'>"_$$AddHyperlink("("_$$^WWWTR(0,12,countMedAquisSufZerado)_")</span>","0;3;3;1"),,,,"center")
		do InsertCell^COMTable($$AddHyperlink("<strong>"_$$^WWWTR(0,12,countMatMedAquisSuf)_"</strong>","1;3;3")_" <span title='Estoque zerado'>"_$$AddHyperlink("("_$$^WWWTR(0,12,countMatMedAquisSufZerado)_")</span>","1;3;3;1"),,,,"center")
		do InsertCell^COMTable($$AddHyperlink("<strong>"_$$^WWWTR(0,12,countAlmoxAquisSuf)_"</strong>","2;3;3")_" <span title='Estoque zerado'>"_$$AddHyperlink("("_$$^WWWTR(0,12,countAlmoxAquisSufZerado)_")</span>","2;3;3;1"),,,,"center")
		do InsertCell^COMTable($$AddHyperlink("<strong>"_$$^WWWTR(0,12,countOdontAquisSuf)_"</strong>","3;3;3")_" <span title='Estoque zerado'>"_$$AddHyperlink("("_$$^WWWTR(0,12,countOdontAquisSufZerado)_")</span>","3;3;3;1"),,,,"center")
		do InsertCell^COMTable($$AddHyperlink("<strong>"_$$^WWWTR(0,12,countLabAquisSuf)_"</strong>","4;3;3")_" <span title='Estoque zerado'>"_$$AddHyperlink("("_$$^WWWTR(0,12,countLabAquisSufZerado)_")</span>","4;3;3;1"),,,,"center")
		do InsertCell^COMTable($$AddHyperlink("<strong>"_$$^WWWTR(0,12,countNutricAquisSuf)_"</strong>","5;3;3")_" <span title='Estoque zerado'>"_$$AddHyperlink("("_$$^WWWTR(0,12,countNutricAquisSufZerado)_")</span>","5;3;3;1"),,,,"center")
		do InsertCell^COMTable($$AddHyperlink("<strong>"_$$^WWWTR(0,12,countOPMEAquisSuf)_"</strong>","6;3;3")_" <span title='Estoque zerado'>"_$$AddHyperlink("("_$$^WWWTR(0,12,countOPMEAquisSufZerado)_")</span>","6;3;3;1"),,,,"center")
	    do EndLine^COMTable()
	    
		do NewLine^COMTable($$GetColorFromSituacao^VARSESPainelAbastUtils($$$AcimaPR))
		do InsertCell^COMTable("<strong>"_$$GetDescricaoSituacaoFromID^VARSESPainelAbastUtils($$$AcimaPR)_"</strong>")
	    do InsertCell^COMTable("<strong>"_$$^WWWTR(0,12,countMedAcimaPR)_"</strong>","VARSESPainelAbastecimentoDet","0;4;1","0;4;1","center")
	    do InsertCell^COMTable("<strong>"_$$^WWWTR(0,12,countMatMedAcimaPR)_"</strong>","VARSESPainelAbastecimentoDet","1;4;1","1;4;1","center")			
		do InsertCell^COMTable("<strong>"_$$^WWWTR(0,12,countAlmoxAcimaPR)_"</strong>","VARSESPainelAbastecimentoDet","2;4;1","2;4;1","center")			
	    do InsertCell^COMTable("<strong>"_$$^WWWTR(0,12,countOdontAcimaPR)_"</strong>","VARSESPainelAbastecimentoDet","3;4;1","3;4;1","center")	    
	    do InsertCell^COMTable("<strong>"_$$^WWWTR(0,12,countLabAcimaPR)_"</strong>","VARSESPainelAbastecimentoDet","4;4;1","4;4;1","center")
	    do InsertCell^COMTable("<strong>"_$$^WWWTR(0,12,countNutricAcimaPR)_"</strong>","VARSESPainelAbastecimentoDet","5;4;1","5;4;1","center")	    	
	    do InsertCell^COMTable("<strong>"_$$^WWWTR(0,12,countOPMEAcimaPR)_"</strong>","VARSESPainelAbastecimentoDet","6;4;1","6;4;1","center")	    	
	    do EndLine^COMTable()
 
		do NewLine^COMTable($$GetColorFromSituacao^VARSESPainelAbastUtils($$$AcimaEM))
		do InsertCell^COMTable("<strong>"_$$GetDescricaoSituacaoFromID^VARSESPainelAbastUtils($$$AcimaEM)_"</strong>")
	    do InsertCell^COMTable("<strong>"_$$^WWWTR(0,12,countMedAcimaEM)_"</strong>","VARSESPainelAbastecimentoDet","0;5;1","0;5;1","center")
	    do InsertCell^COMTable("<strong>"_$$^WWWTR(0,12,countMatMedAcimaEM)_"</strong>","VARSESPainelAbastecimentoDet","1;5;1","1;5;1","center")
	    do InsertCell^COMTable("<strong>"_$$^WWWTR(0,12,countAlmoxAcimaEM)_"</strong>","VARSESPainelAbastecimentoDet","2;5;1","2;5;1","center")
	    do InsertCell^COMTable("<strong>"_$$^WWWTR(0,12,countOdontAcimaEM)_"</strong>","VARSESPainelAbastecimentoDet","3;5;1","3;5;1","center")	    
	    do InsertCell^COMTable("<strong>"_$$^WWWTR(0,12,countLabAcimaEM)_"</strong>","VARSESPainelAbastecimentoDet","4;5;1","4;5;1","center")
	    do InsertCell^COMTable("<strong>"_$$^WWWTR(0,12,countNutricAcimaEM)_"</strong>","VARSESPainelAbastecimentoDet","5;5;1","5;5;1","center")
	    do InsertCell^COMTable("<strong>"_$$^WWWTR(0,12,countOPMEAcimaEM)_"</strong>","VARSESPainelAbastecimentoDet","6;5;1","6;5;1","center")
	    do EndLine^COMTable()
 
	    set countTotalMed 	 = countMedSemProcesso + countMedAquisInsuf + countMedAquisSuf + countMedAcimaPR + countMedAcimaEM + countMedSemPlanej
	    set countTotalMatMed = countMatMedSemProcesso + countMatMedAquisInsuf + countMatMedAquisSuf + countMatMedAcimaPR + countMatMedAcimaEM + countMatMedSemPlanej
	    set countTotalAlmox	 = countAlmoxSemProcesso + countAlmoxAquisInsuf + countAlmoxAquisSuf + countAlmoxAcimaPR + countAlmoxAcimaEM + countAlmoxSemPlanej
	    set countTotalOdont  = countOdontSemProcesso + countOdontAquisInsuf + countOdontAquisSuf + countOdontAcimaPR + countOdontAcimaEM + countOdontSemPlanej
	    set countTotalLab    = countLabSemProcesso + countLabAquisInsuf + countLabAquisSuf + countLabAcimaPR + countLabAcimaEM + countLabSemPlanej
	    set countTotalNutric = countNutricSemProcesso + countNutricAquisInsuf + countNutricAquisSuf + countNutricAcimaPR + countNutricAcimaEM + countNutricSemPlanej
	    set countTotalOPME = countOPMESemProcesso + countOPMEAquisInsuf + countOPMEAquisSuf + countOPMEAcimaPR + countOPMEAcimaEM + countOPMESemPlanej
	    
		do NewLine^COMTable($$GetColorFromSituacao^VARSESPainelAbastUtils($$$SemDadosPlanejamento))
		do InsertCell^COMTable("<strong>"_$$GetDescricaoSituacaoFromID^VARSESPainelAbastUtils($$$SemDadosPlanejamento)_"</strong>")
	    do InsertCell^COMTable($$AddHyperlink("<strong>"_$$^WWWTR(0,12,countMedSemPlanej)_"</strong>","0;6;1")_" <span title='Estoque zerado'>"_$$AddHyperlink("("_$$^WWWTR(0,12,countMedSemPlanejZerado)_")</span>","0;6;1;1"),,,,"center")
	    do InsertCell^COMTable($$AddHyperlink("<strong>"_$$^WWWTR(0,12,countMatMedSemPlanej)_"</strong>","1;6;1")_" <span title='Estoque zerado'>"_$$AddHyperlink("("_$$^WWWTR(0,12,countMatMedSemPlanejZerado)_")</span>","1;6;1;1"),,,,"center")
	    do InsertCell^COMTable($$AddHyperlink("<strong>"_$$^WWWTR(0,12,countAlmoxSemPlanej)_"</strong>","2;6;1")_" <span title='Estoque zerado'>"_$$AddHyperlink("("_$$^WWWTR(0,12,countAlmoxSemPlanejZerado)_")</span>","2;6;1;1"),,,,"center")
	    do InsertCell^COMTable($$AddHyperlink("<strong>"_$$^WWWTR(0,12,countOdontSemPlanej)_"</strong>","3;6;1")_" <span title='Estoque zerado'>"_$$AddHyperlink("("_$$^WWWTR(0,12,countOdontSemPlanejZerado)_")</span>","3;6;1;1"),,,,"center")
	    do InsertCell^COMTable($$AddHyperlink("<strong>"_$$^WWWTR(0,12,countLabSemPlanej)_"</strong>","4;6;1")_" <span title='Estoque zerado'>"_$$AddHyperlink("("_$$^WWWTR(0,12,countLabSemPlanejZerado)_")</span>","4;6;1;1"),,,,"center")
	    do InsertCell^COMTable($$AddHyperlink("<strong>"_$$^WWWTR(0,12,countNutricSemPlanej)_"</strong>","5;6;1")_" <span title='Estoque zerado'>"_$$AddHyperlink("("_$$^WWWTR(0,12,countNutricSemPlanejZerado)_")</span>","5;6;1;1"),,,,"center")
	    do InsertCell^COMTable($$AddHyperlink("<strong>"_$$^WWWTR(0,12,countOPMESemPlanej)_"</strong>","6;6;1")_" <span title='Estoque zerado'>"_$$AddHyperlink("("_$$^WWWTR(0,12,countOPMESemPlanejZerado)_")</span>","6;6;1;1"),,,,"center")
	    do EndLine^COMTable()	    
 
		do NewLine^COMTable("white")
		do InsertCell^COMTable("<strong>Total de Produtos</strong>")
	    do InsertCell^COMTable("<strong>"_$$^WWWTR(0,12,countTotalMed)_"</strong>",,,,"center")
	    do InsertCell^COMTable("<strong>"_$$^WWWTR(0,12,countTotalMatMed)_"</strong>",,,,"center")
	    do InsertCell^COMTable("<strong>"_$$^WWWTR(0,12,countTotalAlmox)_"</strong>",,,,"center")
	    do InsertCell^COMTable("<strong>"_$$^WWWTR(0,12,countTotalOdont)_"</strong>",,,,"center")	    
	    do InsertCell^COMTable("<strong>"_$$^WWWTR(0,12,countTotalLab)_"</strong>",,,,"center")
	    do InsertCell^COMTable("<strong>"_$$^WWWTR(0,12,countTotalNutric)_"</strong>",,,,"center")
	    do InsertCell^COMTable("<strong>"_$$^WWWTR(0,12,countTotalOPME)_"</strong>",,,,"center")
	    do EndLine^COMTable()
 
	    do Stop^COMTable()
	}
	
	do rsSQL.Close()
	
	quit
 
PrintVisaoUnidadesCentrais
	new rsSQL, meuSQL, tipoPadrao, situacao, blnZerado, countItens 
 
  	if '$data(^VARSESPainelAbastecimentoRun(0,0,1)) {
	 	do PrintMsgEmExecucao^VARSESPainelAbastUtils(1)
	 	quit
 	}
 
	set rsSQL = ##class(%ResultSet).%New()  ;Create Result Set Object
		
	set meuSQL = "SELECT TipodePadrao,"
	set meuSQL = meuSQL_" Situacao,"
	set meuSQL = meuSQL_" Zerado,"
	set meuSQL = meuSQL_" count(Produto)"
	set meuSQL = meuSQL_" FROM VARSESPainelAbastecimento"
	set meuSQL = meuSQL_" GROUP BY TipoDePadrao, Situacao, Zerado"
	
	do rsSQL.Prepare(meuSQL) ;Prepare Query
	do rsSQL.Execute()  	 ;Execute Query
 
 
	// 0 - MEDICAMENTO
	;Posição
	set countMedSemProcesso = 0
	set countMedAquisSuf    = 0
	set countMedAquisInsuf  = 0
	set countMedAcimaPR 	= 0
	set countMedAcimaEM 	= 0
	set countMedSemPlanej   = 0
	
	;Zerados	
	set countMedSemProcessoZerado = 0
	set countMedAquisInsufZerado  = 0
	set countMedAquisSufZerado 	  = 0
	set countMedSemPlanejZerado	  = 0
	
	;Totais
	set countTotalMed = 0	
	set countTotalMedZerado = 0
	//--------------------
 
	// 1 - MATERIAL MÉDICO
	;Posição
	set countMatMedSemProcesso = 0
	set countMatMedAquisInsuf  = 0
	set countMatMedAquisSuf    = 0
	set countMatMedAcimaPR 	   = 0
	set countMatMedAcimaEM 	   = 0
	set countMatMedSemPlanej   = 0
	
	;Zerados
	set countMatMedSemProcessoZerado = 0
	set countMatMedAquisInsufZerado  = 0
	set countMatMedAquisSufZerado	 = 0
	set countMatMedSemPlanejZerado 	 = 0
 
	;Totais
	set countTotalMatMed = 0
	set countTotalMatMedZerado = 0
	//--------------------
 
	// 2 - ALMOXARIFADO
	;Posição
	set countAlmoxSemProcesso = 0
	set countAlmoxAquisInsuf  = 0	
	set countAlmoxAquisSuf    = 0
	set countAlmoxAcimaPR     = 0
	set countAlmoxAcimaEM     = 0
	set countAlmoxSemPlanej	  = 0
 
	;Zerados
	set countAlmoxSemProcessoZerado = 0
	set countAlmoxAquisInsufZerado  = 0
	set countAlmoxAquisSufZerado    = 0
	set countAlmoxSemPlanejZerado   = 0
 
	;Totais
	set countTotalAlmox = 0
	set countTotalAlmoxZerado = 0
	//--------------------
	
	// 3 - ODONTOLÓGICO
	;Posição
	set countOdontSemProcesso = 0
	set countOdontAquisInsuf  = 0
	set countOdontAquisSuf    = 0
	set countOdontAcimaPR     = 0
	set countOdontAcimaEM     = 0
	set countOdontSemPlanej	  = 0
	
	;Zerados
	set countOdontSemProcessoZerado = 0
	set countOdontAquisInsufZerado 	= 0
	set countOdontAquisSufZerado 	= 0
	set countOdontSemPlanejZerado 	= 0
	
	;Totais
	set countTotalOdont = 0
	set countTotalOdontZerado = 0	
	//--------------------	
	
	// 4 - LABORATÓRIO
	;Posição
	set countLabSemProcesso = 0
	set countLabAquisInsuf  = 0
	set countLabAquisSuf    = 0
	set countLabAcimaPR     = 0
	set countLabAcimaEM     = 0
	set countLabSemPlanej	= 0
	
	;Zerados
	set countLabSemProcessoZerado = 0
	set countLabAquisInsufZerado  = 0
	set countLabAquisSufZerado 	  = 0
	set countLabSemPlanejZerado	  = 0
	
	;Totais
	set countTotalLab = 0
	set countTotalLabZerado = 0
	//--------------------	
	
	// 5 - NUTRIÇÃO
	;Posição
	set countNutricSemProcesso = 0
	set countNutricAquisInsuf  = 0
	set countNutricAquisSuf    = 0		
	set countNutricAcimaPR     = 0
	set countNutricAcimaEM     = 0
	set countNutricSemPlanej   = 0
	
	;Zerados
	set countNutricSemProcessoZerado = 0
	set countNutricAquisInsufZerado  = 0	
	set countNutricAquisSufZerado    = 0	
	set countNutricSemPlanejZerado   = 0
	
	;Totais
	set countTotalNutric = 0
	set countTotalNutricZerado = 0
	//--------------------	
 
	// 6 - OPME
	;Posição
	set countOPMESemProcesso = 0
	set countOPMEAquisInsuf  = 0
	set countOPMEAquisSuf    = 0		
	set countOPMEAcimaPR     = 0
	set countOPMEAcimaEM     = 0
	set countOPMESemPlanej   = 0
	
	;Zerados
	set countOPMESemProcessoZerado = 0
	set countOPMEAquisInsufZerado  = 0	
	set countOPMEAquisSufZerado    = 0	
	set countOPMESemPlanejZerado   = 0
	
	;Totais
	set countTotalOPME = 0
	set countTotalOPMEZerado = 0
	//--------------------	
 
	while (rsSQL.Next()) {		
		set tipoPadrao 	= rsSQL.GetData(1)
		set situacao    = rsSQL.GetData(2)
		set blnZerado 	= rsSQL.GetData(3)
		set countItens  = rsSQL.GetData(4)
		
		if (tipoPadrao = $$$Medicamento) {
			
			if (situacao = $$$AbaixoPRSemProcesso) {
				set countMedSemProcesso = countMedSemProcesso + countItens
				set:(blnZerado = $$$YES) countMedSemProcessoZerado = countItens
				
			} elseif (situacao = $$$AbaixoPRComAquisicaoInsuf) {
				set countMedAquisInsuf = countMedAquisInsuf + countItens
				set:(blnZerado = $$$YES) countMedAquisInsufZerado = countItens			
				
			} elseif (situacao = $$$AbaixoPRComAquisicaoSuf) {
				set countMedAquisSuf = countMedAquisSuf + countItens
				set:(blnZerado = $$$YES) countMedAquisSufZerado = countItens
				
			} elseif (situacao = $$$AcimaPR) {
				set countMedAcimaPR = countMedAcimaPR + countItens
				
			} elseif (situacao = $$$AcimaEM) {
				set countMedAcimaEM = countMedAcimaEM + countItens
			
			} elseif (situacao = $$$SemDadosPlanejamento) {
				set countMedSemPlanej = countMedSemPlanej + countItens
				set:(blnZerado = $$$YES) countMedSemPlanejZerado = countItens
			}
		
		} elseif (tipoPadrao = $$$MaterialMedico) {
			
			if (situacao = $$$AbaixoPRSemProcesso) {
				set countMatMedSemProcesso = countMatMedSemProcesso + countItens
				set:(blnZerado = $$$YES) countMatMedSemProcessoZerado = countItens
				
			} elseif (situacao = $$$AbaixoPRComAquisicaoInsuf) {
				set countMatMedAquisInsuf = countMatMedAquisInsuf + countItens
				set:(blnZerado = $$$YES) countMatMedAquisInsufZerado = countItens
				
			} elseif (situacao = $$$AbaixoPRComAquisicaoSuf) {
				set countMatMedAquisSuf = countMatMedAquisSuf + countItens
				set:(blnZerado = $$$YES) countMatMedAquisSufZerado = countItens
				
			} elseif (situacao = $$$AcimaPR) {
				set countMatMedAcimaPR = countMatMedAcimaPR + countItens
				
			} elseif (situacao = $$$AcimaEM) {
				set countMatMedAcimaEM = countMatMedAcimaEM + countItens
							
			} elseif (situacao = $$$SemDadosPlanejamento) {
				set countMatMedSemPlanej = countMatMedSemPlanej + countItens
				set:(blnZerado = $$$YES) countMatMedSemPlanejZerado = countItens
			}				
			
		} elseif (tipoPadrao = $$$Almoxarifado) {
 
			if (situacao = $$$AbaixoPRSemProcesso) {
				set countAlmoxSemProcesso = countAlmoxSemProcesso + countItens
				set:(blnZerado = $$$YES) countAlmoxSemProcessoZerado = countItens
 
			} elseif (situacao = $$$AbaixoPRComAquisicaoInsuf) {
				set countAlmoxAquisInsuf = countAlmoxAquisInsuf + countItens
				set:(blnZerado = $$$YES) countAlmoxAquisInsufZerado = countItens
			
			} elseif (situacao = $$$AbaixoPRComAquisicaoSuf) {
				set countAlmoxAquisSuf = countAlmoxAquisSuf + countItens
				set:(blnZerado = $$$YES) countAlmoxAquisSufZerado = countItens
						
			} elseif (situacao = $$$AcimaPR) {
				set countAlmoxAcimaPR = countAlmoxAcimaPR + countItens
			
			} elseif (situacao = $$$AcimaEM) {
				set countAlmoxAcimaEM = countAlmoxAcimaEM + countItens
			
			} elseif (situacao = $$$SemDadosPlanejamento) {
				set countAlmoxSemPlanej = countAlmoxSemPlanej + countItens
				set:(blnZerado = $$$YES) countAlmoxSemPlanejZerado = countItens
			}
		
		} elseif (tipoPadrao = $$$Odontologico) {
 
			if (situacao = $$$AbaixoPRSemProcesso) {
				set countOdontSemProcesso = countOdontSemProcesso + countItens
				set:(blnZerado = $$$YES) countOdontSemProcessoZerado = countItens				
				
			} elseif (situacao = $$$AbaixoPRComAquisicaoInsuf) {
				set countOdontAquisInsuf = countOdontAquisInsuf + countItens
				set:(blnZerado = $$$YES) countOdontAquisInsufZerado = countItens
				
			} elseif (situacao = $$$AbaixoPRComAquisicaoSuf) {
				set countOdontAquisSuf = countOdontAquisSuf + countItens
				set:(blnZerado = $$$YES) countOdontAquisSufZerado = countItens
				
			} elseif (situacao = $$$AcimaPR) {
				set countOdontAcimaPR = countOdontAcimaPR + countItens
				
			} elseif (situacao = $$$AcimaEM) {
				set countOdontAcimaEM = countOdontAcimaEM + countItens
 
			} elseif (situacao = $$$SemDadosPlanejamento) {
				set countOdontSemPlanej = countOdontSemPlanej + countItens
				set:(blnZerado = $$$YES) countOdontSemPlanejZerado = countItens				
			}
		
		} elseif (tipoPadrao = $$$Laboratorio) { 
 
			if (situacao = $$$AbaixoPRSemProcesso) {
				set countLabSemProcesso = countLabSemProcesso + countItens
				set:(blnZerado = $$$YES) countLabSemProcessoZerado = countItens
						
			} elseif (situacao = $$$AbaixoPRComAquisicaoInsuf) {
				set countLabAquisInsuf = countLabAquisInsuf + countItens
				set:(blnZerado = $$$YES) countLabAquisInsufZerado = countItens
				
			} elseif (situacao = $$$AbaixoPRComAquisicaoSuf) {
				set countLabAquisSuf = countLabAquisSuf + countItens
				set:(blnZerado = $$$YES) countLabAquisSufZerado = countItens
				
			} elseif (situacao = $$$AcimaPR) {
				set countLabAcimaPR = countLabAcimaPR + countItens
				
			} elseif (situacao = $$$AcimaEM) {
				set countLabAcimaEM = countLabAcimaEM + countItens
			
			} elseif (situacao = $$$SemDadosPlanejamento) {
				set countLabSemPlanej = countLabSemPlanej + countItens
				set:(blnZerado = $$$YES) countLabSemPlanejZerado = countItens				
			}
		
		} elseif (tipoPadrao = $$$Nutricao) {
 
			if (situacao = $$$AbaixoPRSemProcesso) {
				set countNutricSemProcesso = countNutricSemProcesso + countItens
				set:(blnZerado = $$$YES) countNutricSemProcessoZerado = countItens
				
			} elseif (situacao = $$$AbaixoPRComAquisicaoInsuf) {
				set countNutricAquisInsuf = countNutricAquisInsuf + countItens
				set:(blnZerado = $$$YES) countNutricAquisInsufZerado = countItens
				
			} elseif (situacao = $$$AbaixoPRComAquisicaoSuf) {
				set countNutricAquisSuf = countNutricAquisSuf + countItens
				set:(blnZerado = $$$YES) countNutricAquisSufZerado = countItens
				
			} elseif (situacao = $$$AcimaPR) {
				set countNutricAcimaPR = countNutricAcimaPR + countItens
				
			} elseif (situacao = $$$AcimaEM) {
				set countNutricAcimaEM = countNutricAcimaEM + countItens
			
			} elseif (situacao = $$$SemDadosPlanejamento) {
				set countNutricSemPlanej = countNutricSemPlanej + countItens
				set:(blnZerado = $$$YES) countNutricSemPlanejZerado = countItens
			} 
			
		} elseif (tipoPadrao = $$$OPME) {
 
			if (situacao = $$$AbaixoPRSemProcesso) {
				set countOPMESemProcesso = countOPMESemProcesso + countItens
				set:(blnZerado = $$$YES) countOPMESemProcessoZerado = countItens
				
			} elseif (situacao = $$$AbaixoPRComAquisicaoInsuf) {
				set countOPMEAquisInsuf = countOPMEAquisInsuf + countItens
				set:(blnZerado = $$$YES) countOPMEAquisInsufZerado = countItens
				
			} elseif (situacao = $$$AbaixoPRComAquisicaoSuf) {
				set countOPMEAquisSuf = countOPMEAquisSuf + countItens
				set:(blnZerado = $$$YES) countOPMEAquisSufZerado = countItens
				
			} elseif (situacao = $$$AcimaPR) {
				set countOPMEAcimaPR = countOPMEAcimaPR + countItens
				
			} elseif (situacao = $$$AcimaEM) {
				set countOPMEAcimaEM = countOPMEAcimaEM + countItens
			
			} elseif (situacao = $$$SemDadosPlanejamento) {
				set countOPMESemPlanej = countOPMESemPlanej + countItens
				set:(blnZerado = $$$YES) countOPMESemPlanejZerado = countItens
			} 
		}
	}
	
	write "<table cellspacing='1' width='100%'>"
	write "	<tr style='background-color:#2c6c7f;color:white'>"
	write "		<th></th>"
	write "		<th width='115px'>Medicamentos</th>"
	write "		<th width='115px'>Material Médico</th>"
	write "		<th width='115px'>Vacinas</th>"
	write "		<th width='115px'>Laboratório</th>"
	write "		<th width='115px'>Nutrição</th>"
	write "		<th width='115px'>Mat. Escritório</th>"
	write "		<th width='115px'>Diversos</th>"
	write "	</tr>"
	
	write "	<tr style='background-color:"_$$GetColorFromSituacao^VARSESPainelAbastUtils($$$AbaixoPRSemProcesso)_"'>"
	write "	<td style='text-align:left'><strong>"_$$GetDescricaoSituacaoFromID^VARSESPainelAbastUtils($$$AbaixoPRSemProcesso)_"</strong></td>"
	write " <td style='text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=0&fSit=1&fOrd=3'>"_countMedSemProcesso_"</a> (<a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=0&fSit=1&fOrd=3&fZer=1'>"_countMedSemProcessoZerado_"</a>)</td>"
	write " <td style='text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=1&fSit=1&fOrd=3'>"_countMatMedSemProcesso_"</a> (<a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=1&fSit=1&fOrd=3&fZer=1'>"_countMatMedSemProcessoZerado_"</a>)</td>"
	write " <td style='text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=2&fSit=1&fOrd=3'>"_countAlmoxSemProcesso_"</a> (<a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=2&fSit=1&fOrd=3&fZer=1'>"_countAlmoxSemProcessoZerado_"</a>)</td>"		
	write " <td style='text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=3&fSit=1&fOrd=3'>"_countOdontSemProcesso_"</a> (<a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=3&fSit=1&fOrd=3&fZer=1'>"_countOdontSemProcessoZerado_"</a>)</td>"
	write " <td style='text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=4&fSit=1&fOrd=3'>"_countLabSemProcesso_"</a> (<a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=4&fSit=1&fOrd=3&fZer=1'>"_countLabSemProcessoZerado_"</a>)</td>"
	write " <td style='text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=5&fSit=1&fOrd=3'>"_countNutricSemProcesso_"</a> (<a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=5&fSit=1&fOrd=3&fZer=1'>"_countNutricSemProcessoZerado_"</a>)</td>"	
	write " <td style='text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=6&fSit=1&fOrd=3'>"_countOPMESemProcesso_"</a> (<a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=6&fSit=1&fOrd=3&fZer=1'>"_countOPMESemProcessoZerado_"</a>)</td>"	
	write "</tr>"
	
	write "	<tr style='background-color:"_$$GetColorFromSituacao^VARSESPainelAbastUtils($$$AbaixoPRComAquisicaoInsuf)_"'>"
	write "	<td style='text-align:left'><strong>"_$$GetDescricaoSituacaoFromID^VARSESPainelAbastUtils($$$AbaixoPRComAquisicaoInsuf)_"</strong></td>"
	write " <td style='text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=0&fSit=2&fOrd=3'>"_countMedAquisInsuf_"</a> (<a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=0&fSit=2&fOrd=3&fZer=1'>"_countMedAquisInsufZerado_"</a>)</td>"
	write " <td style='text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=1&fSit=2&fOrd=3'>"_countMatMedAquisInsuf_"</a> (<a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=1&fSit=2&fOrd=3&fZer=1'>"_countMatMedAquisInsufZerado_"</a>)</td>"
	write " <td style='text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=2&fSit=2&fOrd=3'>"_countAlmoxAquisInsuf_"</a> (<a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=2&fSit=2&fOrd=3&fZer=1'>"_countAlmoxAquisInsufZerado_"</a>)</td>"		
	write " <td style='text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=3&fSit=2&fOrd=3'>"_countOdontAquisInsuf_"</a> (<a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=3&fSit=2&fOrd=3&fZer=1'>"_countOdontAquisInsufZerado_"</a>)</td>"
	write " <td style='text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=4&fSit=2&fOrd=3'>"_countLabAquisInsuf_"</a> (<a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=4&fSit=2&fOrd=3&fZer=1'>"_countLabAquisInsufZerado_"</a>)</td>"
	write " <td style='text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=5&fSit=2&fOrd=3'>"_countNutricAquisInsuf_"</a> (<a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=5&fSit=2&fOrd=3&fZer=1'>"_countNutricAquisInsufZerado_"</a>)</td>"	
	write " <td style='text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=6&fSit=2&fOrd=3'>"_countOPMEAquisInsuf_"</a> (<a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=6&fSit=2&fOrd=3&fZer=1'>"_countOPMEAquisInsufZerado_"</a>)</td>"	
	write "</tr>"
 
	write "	<tr style='background-color:"_$$GetColorFromSituacao^VARSESPainelAbastUtils($$$AbaixoPRComAquisicaoSuf)_"'>"
	write "	<td style='text-align:left'><strong>"_$$GetDescricaoSituacaoFromID^VARSESPainelAbastUtils($$$AbaixoPRComAquisicaoSuf)_"</strong></td>"
	write " <td style='text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=0&fSit=3&fOrd=3'>"_countMedAquisSuf_"</a> (<a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=0&fSit=3&fOrd=3&fZer=1'>"_countMedAquisSufZerado_"</a>)</td>"
	write " <td style='text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=1&fSit=3&fOrd=3'>"_countMatMedAquisSuf_"</a> (<a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=1&fSit=3&fOrd=3&fZer=1'>"_countMatMedAquisSufZerado_"</a>)</td>"
	write " <td style='text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=2&fSit=3&fOrd=3'>"_countAlmoxAquisSuf_"</a> (<a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=2&fSit=3&fOrd=3&fZer=1'>"_countAlmoxAquisSufZerado_"</a>)</td>"		
	write " <td style='text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=3&fSit=3&fOrd=3'>"_countOdontAquisSuf_"</a> (<a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=3&fSit=3&fOrd=3&fZer=1'>"_countOdontAquisSufZerado_"</a>)</td>"
	write " <td style='text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=4&fSit=3&fOrd=3'>"_countLabAquisSuf_"</a> (<a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=4&fSit=3&fOrd=3&fZer=1'>"_countLabAquisSufZerado_"</a>)</td>"
	write " <td style='text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=5&fSit=3&fOrd=3'>"_countNutricAquisSuf_"</a> (<a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=5&fSit=3&fOrd=3&fZer=1'>"_countNutricAquisSufZerado_"</a>)</td>"	
	write " <td style='text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=6&fSit=3&fOrd=3'>"_countOPMEAquisSuf_"</a> (<a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=6&fSit=3&fOrd=3&fZer=1'>"_countOPMEAquisSufZerado_"</a>)</td>"	
	write "</tr>"
 
	write "	<tr style='background-color:"_$$GetColorFromSituacao^VARSESPainelAbastUtils($$$AcimaPR)_"'>"
	write "	<td style='text-align:left'><strong>"_$$GetDescricaoSituacaoFromID^VARSESPainelAbastUtils($$$AcimaPR)_"</strong></td>"
	write " <td style='text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=0&fSit=4&fOrd=1'>"_countMedAcimaPR_"</a></td>"
	write " <td style='text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=1&fSit=4&fOrd=1'>"_countMatMedAcimaPR_"</a></td>"
	write " <td style='text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=2&fSit=4&fOrd=1'>"_countAlmoxAcimaPR_"</a></td>"
	write " <td style='text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=3&fSit=4&fOrd=1'>"_countOdontAcimaPR_"</a></td>"	
	write " <td style='text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=4&fSit=4&fOrd=1'>"_countLabAcimaPR_"</a></td>"
	write " <td style='text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=5&fSit=4&fOrd=1'>"_countNutricAcimaPR_"</a></td>"		
	write " <td style='text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=6&fSit=4&fOrd=1'>"_countOPMEAcimaPR_"</a></td>"		
	write "</tr>"
 
	write "	<tr style='background-color:"_$$GetColorFromSituacao^VARSESPainelAbastUtils($$$AcimaEM)_"'>"
	write "	<td style='text-align:left'><strong>"_$$GetDescricaoSituacaoFromID^VARSESPainelAbastUtils($$$AcimaEM)_"</strong></td>"
	write " <td style='text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=0&fSit=5&fOrd=1'>"_countMedAcimaEM_"</a></td>"
	write " <td style='text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=1&fSit=5&fOrd=1'>"_countMatMedAcimaEM_"</a></td>"
	write " <td style='text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=2&fSit=5&fOrd=1'>"_countAlmoxAcimaEM_"</a></td>"		
	write " <td style='text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=3&fSit=5&fOrd=1'>"_countOdontAcimaEM_"</a></td>"
	write " <td style='text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=4&fSit=5&fOrd=1'>"_countLabAcimaEM_"</a></td>"
	write " <td style='text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=5&fSit=5&fOrd=1'>"_countNutricAcimaEM_"</a></td>"
	write " <td style='text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=6&fSit=5&fOrd=1'>"_countOPMEAcimaEM_"</a></td>"
	write "</tr>"
	
	write "	<tr style='background-color:"_$$GetColorFromSituacao^VARSESPainelAbastUtils($$$SemDadosPlanejamento)_"'>"
	writ]]><![CDATA[e "	<td style='text-align:left'><strong>"_$$GetDescricaoSituacaoFromID^VARSESPainelAbastUtils($$$SemDadosPlanejamento)_"</strong></td>"
	write " <td style='text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=0&fSit=6&fOrd=1'>"_countMedSemPlanej_"</a> (<a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=0&fSit=6&fOrd=1&fZer=1'>"_countMedSemPlanejZerado_"</a>)</td>"
	write " <td style='text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=1&fSit=6&fOrd=1'>"_countMatMedSemPlanej_"</a> (<a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=1&fSit=6&fOrd=1&fZer=1'>"_countMatMedSemPlanejZerado_"</a>)</td>"
	write " <td style='text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=2&fSit=6&fOrd=1'>"_countAlmoxSemPlanej_"</a> (<a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=2&fSit=6&fOrd=1&fZer=1'>"_countAlmoxSemPlanejZerado_"</a>)</td>"
	write " <td style='text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=3&fSit=6&fOrd=1'>"_countOdontSemPlanej_"</a> (<a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=3&fSit=6&fOrd=1&fZer=1'>"_countOdontSemPlanejZerado_"</a>)</td>"
	write " <td style='text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=4&fSit=6&fOrd=1'>"_countLabSemPlanej_"</a> (<a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=4&fSit=6&fOrd=1&fZer=1'>"_countLabSemPlanejZerado_"</a>)</td>"
	write " <td style='text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=5&fSit=6&fOrd=1'>"_countNutricSemPlanej_"</a> (<a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=5&fSit=6&fOrd=1&fZer=1'>"_countNutricSemPlanejZerado_"</a>)</td>"
	write " <td style='text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=6&fSit=6&fOrd=1'>"_countOPMESemPlanej_"</a> (<a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=6&fSit=6&fOrd=1&fZer=1'>"_countOPMESemPlanejZerado_"</a>)</td>"
	write "</tr>"	
 
    set countTotalMed 	 = countMedSemProcesso + countMedAquisInsuf + countMedAquisSuf + countMedAcimaPR + countMedAcimaEM + countMedSemPlanej
    set countTotalMatMed = countMatMedSemProcesso + countMatMedAquisInsuf + countMatMedAquisSuf + countMatMedAcimaPR + countMatMedAcimaEM + countMatMedSemPlanej
    set countTotalAlmox	 = countAlmoxSemProcesso + countAlmoxAquisInsuf + countAlmoxAquisSuf + countAlmoxAcimaPR + countAlmoxAcimaEM + countAlmoxSemPlanej
    set countTotalOdont  = countOdontSemProcesso + countOdontAquisInsuf + countOdontAquisSuf + countOdontAcimaPR + countOdontAcimaEM + countOdontSemPlanej
    set countTotalLab    = countLabSemProcesso + countLabAquisInsuf + countLabAquisSuf + countLabAcimaPR + countLabAcimaEM + countLabSemPlanej
    set countTotalNutric = countNutricSemProcesso + countNutricAquisInsuf + countNutricAquisSuf + countNutricAcimaPR + countNutricAcimaEM + countNutricSemPlanej
    set countTotalOPME = countOPMESemProcesso + countOPMEAquisInsuf + countOPMEAquisSuf + countOPMEAcimaPR + countOPMEAcimaEM + countOPMESemPlanej
	    
    set countTotalMedZerado    = countMedSemProcessoZerado + countMedAquisInsufZerado + countMedAquisSufZerado + countMedSemPlanejZerado
    set countTotalMatMedZerado = countMatMedSemProcessoZerado + countMatMedAquisInsufZerado + countMatMedAquisSufZerado + countMatMedSemPlanejZerado
    set countTotalAlmoxZerado  = countAlmoxSemProcessoZerado + countAlmoxAquisInsufZerado + countAlmoxAquisSufZerado + countAlmoxSemPlanejZerado
    set countTotalOdontZerado  = countOdontSemProcessoZerado + countOdontAquisInsufZerado + countOdontAquisSufZerado + countOdontSemPlanejZerado
    set countTotalLabZerado	   = countLabSemProcessoZerado + countLabAquisInsufZerado + countLabAquisSufZerado + countLabSemPlanejZerado
    set countTotalNutricZerado = countNutricSemProcessoZerado + countNutricAquisInsufZerado + countNutricAquisSufZerado + countNutricSemPlanejZerado
    set countTotalOPMEZerado = countOPMESemProcessoZerado + countOPMEAquisInsufZerado + countOPMEAquisSufZerado + countOPMESemPlanejZerado
 
	write "	<tr style='background-color:"_$$$corCinzaEscuro_"'>"
	write "	<td style='text-align:left;font-weight:bold'>Total de Produtos</td>"
	write " <td style='text-align:center;font-weight:bold'>"_countTotalMed_"</td>"
	write " <td style='text-align:center;font-weight:bold'>"_countTotalMatMed_"</td>"
	write " <td style='text-align:center;font-weight:bold'>"_countTotalAlmox_"</td>"	
	write " <td style='text-align:center;font-weight:bold'>"_countTotalOdont_"</td>"
	write " <td style='text-align:center;font-weight:bold'>"_countTotalLab_"</td>"
	write " <td style='text-align:center;font-weight:bold'>"_countTotalNutric_"</td>"	
	write " <td style='text-align:center;font-weight:bold'>"_countTotalOPME_"</td>"	
	write "</tr>"
 
	write "</table>"
	
	do rsSQL.Close()
	
	quit
 
PrintPainelCentrais	
	new rsSQL, meuSQL, tipoPadrao, situacao, blnZerado, countItens 
 
  	if '$data(^VARSESPainelAbastecimentoRun(0,0,1)) {
	 	do PrintMsgEmExecucao^VARSESPainelAbastUtils(1)
	 	quit
 	}
 	
	set rsSQLCentrais = ##class(%ResultSet).%New()  ;Create Result Set Object
	
	set meuSQL = "SELECT TipodePadrao,"
	set meuSQL = meuSQL_" Situacao,"
	set meuSQL = meuSQL_" Zerado,"
	set meuSQL = meuSQL_" count(Produto)"
	set meuSQL = meuSQL_" FROM VARSESPainelAbastecimento"
	set meuSQL = meuSQL_" GROUP BY TipoDePadrao, Situacao, Zerado"
	
	do rsSQLCentrais.Prepare(meuSQL) ;Prepare Query
	do rsSQLCentrais.Execute()  	 ;Execute Query
	
	// FARMÁCIA
	;Posição
	set countFarmSemProcesso = 0
	set countFarmAquisSuf    = 0
	set countFarmAquisInsuf  = 0
	set countFarmAcimaPR 	 = 0
	set countFarmAcimaEM 	 = 0
	set countFarmSemPlanej   = 0
	
	;Zerados	
	set countFarmSemProcessoZerado = 0
	set countFarmAquisInsufZerado  = 0
	set countFarmAquisSufZerado    = 0
	set countFarmSemPlanejZerado   = 0
	
	;Totais
	set countTotalFarm = 0	
	set countTotalFarmZerado = 0
	//--------------------
	
	// ALMOXARIFADO
	;Posição
	set countAlmoxSemProcesso = 0
	set countAlmoxAquisSuf    = 0
	set countAlmoxAquisInsuf  = 0
	set countAlmoxAcimaPR 	  = 0
	set countAlmoxAcimaEM 	  = 0
	set countAlmoxSemPlanej   = 0
	
	;Zerados	
	set countAlmoxSemProcessoZerado = 0
	set countAlmoxAquisInsufZerado  = 0
	set countAlmoxAquisSufZerado 	= 0
	set countAlmoxSemPlanejZerado	= 0
	
	;Totais
	set countTotalAlmox = 0	
	set countTotalAlmoxZerado = 0
	//--------------------
	
	while (rsSQLCentrais.Next()) {		
		set tipoPadrao 	= rsSQLCentrais.GetData(1)
		set situacao    = rsSQLCentrais.GetData(2)
		set blnZerado 	= rsSQLCentrais.GetData(3)
		set countItens  = rsSQLCentrais.GetData(4)
 
		if ( (tipoPadrao = $$$Medicamento) || (tipoPadrao = $$$MaterialMedico) || (tipoPadrao = $$$Odontologico) ||
		     (tipoPadrao = $$$Laboratorio) || (tipoPadrao = $$$Nutricao) || (tipoPadrao = $$$OPME) ) {
			
			if (situacao = $$$AbaixoPRSemProcesso) {
				set countFarmSemProcesso = countFarmSemProcesso + countItens
				set:(blnZerado = $$$YES) countFarmSemProcessoZerado = countFarmSemProcessoZerado + countItens
				
			} elseif (situacao = $$$AbaixoPRComAquisicaoInsuf) {
				set countFarmAquisInsuf = countFarmAquisInsuf + countItens
				set:(blnZerado = $$$YES) countFarmAquisInsufZerado = countFarmAquisInsufZerado + countItens			
				
			} elseif (situacao = $$$AbaixoPRComAquisicaoSuf) {
				set countFarmAquisSuf = countFarmAquisSuf + countItens
				set:(blnZerado = $$$YES) countFarmAquisSufZerado = countFarmAquisSufZerado + countItens
				
			} elseif (situacao = $$$AcimaPR) {
				set countFarmAcimaPR = countFarmAcimaPR + countItens
				
			} elseif (situacao = $$$AcimaEM) {
				set countFarmAcimaEM = countFarmAcimaEM + countItens
			
			} elseif (situacao = $$$SemDadosPlanejamento) {
				set countFarmSemPlanej = countFarmSemPlanej + countItens
				set:(blnZerado = $$$YES) countFarmSemPlanejZerado = countFarmSemPlanejZerado + countItens
			}
		
		} elseif (tipoPadrao = $$$Almoxarifado) {
			
			if (situacao = $$$AbaixoPRSemProcesso) {
				set countAlmoxSemProcesso = countAlmoxSemProcesso + countItens
				set:(blnZerado = $$$YES) countAlmoxSemProcessoZerado = countItens
				
			} elseif (situacao = $$$AbaixoPRComAquisicaoInsuf) {
				set countAlmoxAquisInsuf = countAlmoxAquisInsuf + countItens
				set:(blnZerado = $$$YES) countAlmoxAquisInsufZerado = countItens			
				
			} elseif (situacao = $$$AbaixoPRComAquisicaoSuf) {
				set countAlmoxAquisSuf = countAlmoxAquisSuf + countItens
				set:(blnZerado = $$$YES) countAlmoxAquisSufZerado = countItens
				
			} elseif (situacao = $$$AcimaPR) {
				set countAlmoxAcimaPR = countAlmoxAcimaPR + countItens
				
			} elseif (situacao = $$$AcimaEM) {
				set countAlmoxAcimaEM = countAlmoxAcimaEM + countItens
			
			} elseif (situacao = $$$SemDadosPlanejamento) {
				set countAlmoxSemPlanej = countAlmoxSemPlanej + countItens
				set:(blnZerado = $$$YES) countAlmoxSemPlanejZerado = countItens
			}			
		}
	}
	
	set countTotalFarm  = countFarmSemProcesso + countFarmAquisInsuf + countFarmAquisSuf + countFarmAcimaPR + countFarmAcimaEM + countFarmSemPlanej
	set countTotalFarmZerado = countFarmSemProcessoZerado + countFarmAquisInsufZerado + countFarmAquisSufZerado + countFarmSemPlanejZerado
 
	set countTotalAlmox  = countAlmoxSemProcesso + countAlmoxAquisInsuf + countAlmoxAquisSuf + countAlmoxAcimaPR + countAlmoxAcimaEM + countAlmoxSemPlanej
	set countTotalAlmoxZerado = countAlmoxSemProcessoZerado + countAlmoxAquisInsufZerado + countAlmoxAquisSufZerado + countAlmoxSemPlanejZerado
	
	write "<table cellspacing='1' width='100%'>"
	write "	<tr style='background-color:#2c6c7f;color:white'>"
	write "		<th>Local</th>"
	write " 	<th style='width:115px;'>"_$$GetDescricaoSituacaoFromID^VARSESPainelAbastUtils($$$AbaixoPRSemProcesso)_"</th>"
	write "		<th style='width:115px;'>"_$$GetDescricaoSituacaoFromID^VARSESPainelAbastUtils($$$AbaixoPRComAquisicaoInsuf)_"</th>"
	write " 	<th style='width:115px;'>"_$$GetDescricaoSituacaoFromID^VARSESPainelAbastUtils($$$AbaixoPRComAquisicaoSuf)_"</th>"	
	write "		<th style='width:115px;'>"_$$GetDescricaoSituacaoFromID^VARSESPainelAbastUtils($$$AcimaPR)_"</th>"	
	write "		<th style='width:115px;'>"_$$GetDescricaoSituacaoFromID^VARSESPainelAbastUtils($$$AcimaEM)_"</th>"
	write "		<th style='width:115px;'>"_$$GetDescricaoSituacaoFromID^VARSESPainelAbastUtils($$$SemDadosPlanejamento)_"</th>"
	write "		<th style='width:115px;'>Total</th>"
	write "	</tr>"
	
	write "	<tr>"
	write "	<td style='text-align:left;background-color:"_$$$corCinzaClaro_"'><strong><a class='link' href='VARSESPainelAbastecimento.csp?Loc=5'>CENTRAL DE DISTRIBUIÇÃO SP</strong></td>"
	write " <td style='background-color:"_$$GetColorFromSituacao^VARSESPainelAbastUtils($$$AbaixoPRSemProcesso)_"'>"_countFarmSemProcesso_" ("_countFarmSemProcessoZerado_")</td>"
	write " <td style='background-color:"_$$GetColorFromSituacao^VARSESPainelAbastUtils($$$AbaixoPRComAquisicaoInsuf)_"'>"_countFarmAquisInsuf_" ("_countFarmAquisInsufZerado_")</td>"
	write " <td style='background-color:"_$$GetColorFromSituacao^VARSESPainelAbastUtils($$$AbaixoPRComAquisicaoSuf)_"'>"_countFarmAquisSuf_" ("_countFarmAquisSufZerado_")</td>"
	write " <td style='background-color:"_$$GetColorFromSituacao^VARSESPainelAbastUtils($$$AcimaPR)_"'>"_countFarmAcimaPR_"</td>"
	write " <td style='background-color:"_$$GetColorFromSituacao^VARSESPainelAbastUtils($$$AcimaEM)_"'>"_countFarmAcimaEM_"</td>"
	write " <td style='background-color:"_$$GetColorFromSituacao^VARSESPainelAbastUtils($$$SemDadosPlanejamento)_"'>"_countFarmSemPlanej_" ("_countFarmSemPlanejZerado_")</td>"
	write " <td style='background-color:"_$$$corCinzaEscuro_"'>"_countTotalFarm_" ("_countTotalFarmZerado_")</td>"
	write "</tr>"
	
	write "	<tr>"
	write "	<td style='text-align:left;background-color:"_$$$corCinzaEscuro_"'><strong><a class='link' href='VARSESPainelAbastecimento.csp?Loc=1'>CENTRAL DE DISTRIBUIÇÃO RJ</strong></td>"
	write " <td style='background-color:"_$$GetColorFromSituacao^VARSESPainelAbastUtils($$$AbaixoPRSemProcesso)_"'>"_countAlmoxSemProcesso_" ("_countAlmoxSemProcessoZerado_")</td>"
	write " <td style='background-color:"_$$GetColorFromSituacao^VARSESPainelAbastUtils($$$AbaixoPRComAquisicaoInsuf)_"'>"_countAlmoxAquisInsuf_" ("_countAlmoxAquisInsufZerado_")</td>"
	write " <td style='background-color:"_$$GetColorFromSituacao^VARSESPainelAbastUtils($$$AbaixoPRComAquisicaoSuf)_"'>"_countAlmoxAquisSuf_" ("_countAlmoxAquisSufZerado_")</td>"
	write " <td style='background-color:"_$$GetColorFromSituacao^VARSESPainelAbastUtils($$$AcimaPR)_"'>"_countAlmoxAcimaPR_"</td>"
	write " <td style='background-color:"_$$GetColorFromSituacao^VARSESPainelAbastUtils($$$AcimaEM)_"'>"_countAlmoxAcimaEM_"</td>"
	write " <td style='background-color:"_$$GetColorFromSituacao^VARSESPainelAbastUtils($$$SemDadosPlanejamento)_"'>"_countAlmoxSemPlanej_" ("_countAlmoxSemPlanejZerado_")</td>"
	write " <td style='background-color:"_$$$corCinzaEscuro_"'>"_countTotalAlmox_" ("_countTotalAlmoxZerado_")</td>"
	write "</tr>"	
	
	write "</table>"
	do rsSQLCentrais.Close()
 
	quit
 
PrintLogExecucao
	new objUltimaExecucao, dataUltimaExecucao, horaUltimaExecucao
	
	;Sai caso não tenha log de execução
 	quit:('$data(^VARSESPainelAbastecimentoRun(0,0,1)))
	
	set objUltimaExecucao  = $get(^VARSESPainelAbastecimentoRun(0,0,1))
	set dataUltimaExecucao = $piece(objUltimaExecucao,"~",1)
	set horaUltimaExecucao = $piece(objUltimaExecucao,"~",2)
 	
	write "<br />"
	
	write "<div style='border-width:1px;border-style:solid;line-height:18px;border-color:#C9C9C9;padding-left:10px;padding-top:7px;padding-bottom:7px;background-color:#E3E3E3'>"		
	write "<strong>Orientações gerais para o uso da tela:</strong><br />"
	write "&nbsp;&nbsp;1. Os dados acima foram gerados em <strong>"_$zdate(dataUltimaExecucao,4)_"</strong> às <strong>"_$extract($ztime(horaUltimaExecucao),1,5)_"</strong>.<br />"
	write "&nbsp;&nbsp;2. Clique nos indicadores de cada grupo para visualizar a lista detalhada dos produtos que estão na situação.<br />"	
	//write "&nbsp;&nbsp;3. Os produtos distribuídos pelo Ministério da Saúde não estão sendo apresentados nessa consulta.<br />"
	write "&nbsp;&nbsp;3. Somente são apresentados nesta consulta os produtos que estão marcados no Cadastro de Produtos como <strong>Padronizados</strong> e como <strong>Abastecimento Regular</strong>.<br />"
	write "&nbsp;&nbsp;4. Os valores entre parenteses representam a quantidade de produtos zerados. Exemplo: 10 (2) significa que dos 10 produtos, 2 estão com estoque zerado.<br />"
	write "&nbsp;&nbsp;5. A consulta de estoque zerado nesta tela refere-se ao estoque das unidades centrais que estão zerados.<br />"
	write "&nbsp;&nbsp;6. Os produtos na categoria 'Sem dados de Planejamento' são recém-padronizados ou não possuem registros de consumo nos últimos 12 meses.<br />"
	write "&nbsp;&nbsp;7. O ponto de ressuprimento é determinado pelo estoque mínimo suficiente para o abastecimento do produto pelo período de 4 (quatro) meses. Ele é calculado considerando a movimentação do produto nos últimos 12 meses."
	write "</div>"
	
	quit
	
	
containsAFM(pstrListAFMs)
	quit:(pstrListAFMs = "") $$$NO
	
	new blnContainAFM, cnt, idAFM
	set blnContainAFM = $$$NO
 
	for cnt = 1:1:$length(pstrListAFMs,";") { 	
		set idAFM = $piece(pstrListAFMs,";",cnt)		 		
	 	continue:(idAFM = "")
	 	
	 	if $data(^INAUF(0,idAFM)) {
		 	set blnContainAFM = $$$YES
		 	quit
	 	}
	 	
	}
 
	quit blnContainAFM
	
AddHyperlink(pTexto,pYPARA)
	
	set strLink = "<a href='"_YAKTION_"EP=WWWFORM&amp;YFORM=VARSESPainelAbastecimentoDet&amp;YUCI="_YUCI_"&amp;YBED="_YBED_"&amp;YM="_YM_"&amp;YUSER="_YUSER_"&amp;YPARA="_pYPARA_"'>"_pTexto_"</a>"
	
	quit strLink
 
PrintPainelZerados
	new rsSQL, meuSQL, tipoPadrao, situacao, blnZerado, countItens 
 
  	if '$data(^VARSESPainelAbastecimentoRun(0,0,1)) {
	 	do PrintMsgEmExecucao^VARSESPainelAbastUtils(1)
	 	quit
 	}
 	
	set rsSQLCentrais = ##class(%ResultSet).%New()  ;Create Result Set Object
	
	set meuSQL = "SELECT TipodePadrao,"
	set meuSQL = meuSQL_" Situacao,"
	set meuSQL = meuSQL_" Zerado,"
	set meuSQL = meuSQL_" count(Produto),"
	set meuSQL = meuSQL_" ZeradoRede,"
	set meuSQL = meuSQL_" Produto"
	set meuSQL = meuSQL_" FROM VARSESPainelAbastecimento"
	set meuSQL = meuSQL_" GROUP BY TipoDePadrao, Situacao, Zerado, ZeradoRede"
	
	do rsSQLCentrais.Prepare(meuSQL) ;Prepare Query
	do rsSQLCentrais.Execute()  	 ;Execute Query
	
	// 0 - MEDICAMENTO
	set countMedSemSRPZeradoCentral = 0
	set countMedComSRPZeradoCentral = 0
	set countMedZeradoRede	 		= 0
	//--------------------
 
	// 1 - MATERIAL MÉDICO
	set countMatMedSemSRPZeradoCentral = 0
	set countMatMedComSRPZeradoCentral = 0
	set countMatMedZeradoRede	 	   = 0
	//--------------------
 
	// 2 - ALMOXARIFADO
	set countAlmoxSemSRPZeradoCentral = 0
	set countAlmoxComSRPZeradoCentral = 0
	set countAlmoxZeradoRede	 	  = 0
	//--------------------
	
	// 3 - ODONTOLÓGICO
	set countOdontSemSRPZeradoCentral = 0
	set countOdontComSRPZeradoCentral = 0
	set countOdontZeradoRede	 	  = 0
	//--------------------	
	
	// 4 - LABORATÓRIO
	set countLabSemSRPZeradoCentral = 0
	set countLabComSRPZeradoCentral = 0
	set countLabZeradoRede	 	  	= 0
	//--------------------	
	
	// 5 - NUTRIÇÃO
	set countNutricSemSRPZeradoCentral = 0
	set countNutricComSRPZeradoCentral = 0
	set countNutricZeradoRede  	  	   = 0
	//--------------------	
 	
	// 6 - OPME
	set countOPMESemSRPZeradoCentral = 0
	set countOPMEComSRPZeradoCentral = 0
	set countOPMEZeradoRede  	  	   = 0
	//--------------------	
 	
	while (rsSQLCentrais.Next()) {		
		set tipoPadrao 	   = rsSQLCentrais.GetData(1)
		set situacao   	   = rsSQLCentrais.GetData(2)
		set blnZerado 	   = rsSQLCentrais.GetData(3)
		set countItens 	   = rsSQLCentrais.GetData(4)
		set blnZeradoRede  = rsSQLCentrais.GetData(5)
		set idProduto	   = rsSQLCentrais.GetData(6)
		
		if (tipoPadrao = $$$Medicamento) {
			
			if (blnZerado = $$$YES) {
				if (situacao = $$$AbaixoPRSemProcesso) {
					set countMedSemSRPZeradoCentral = countMedSemSRPZeradoCentral + countItens
				} elseif ( (situacao = $$$AbaixoPRComAquisicaoInsuf) || (situacao = $$$AbaixoPRComAquisicaoSuf) ) {
					set countMedComSRPZeradoCentral = countMedComSRPZeradoCentral + countItens
				}
			}			
			set:(blnZeradoRede = $$$YES) countMedZeradoRede = countMedZeradoRede + countItens
			
		} elseif (tipoPadrao = $$$MaterialMedico) {
			
			if (blnZerado = $$$YES) {
				if (situacao = $$$AbaixoPRSemProcesso) {	
					set countMatMedSemSRPZeradoCentral = countMatMedSemSRPZeradoCentral + countItens
				} elseif ( (situacao = $$$AbaixoPRComAquisicaoInsuf) || (situacao = $$$AbaixoPRComAquisicaoSuf) ) {
					set countMatMedComSRPZeradoCentral = countMatMedComSRPZeradoCentral + countItens
				}
			}			
			set:(blnZeradoRede = $$$YES) countMatMedZeradoRede = countMatMedZeradoRede + countItens
			
		} elseif (tipoPadrao = $$$Almoxarifado) {
 
			if (blnZerado = $$$YES) {
				if (situacao = $$$AbaixoPRSemProcesso) {
					set countAlmoxSemSRPZeradoCentral = countAlmoxSemSRPZeradoCentral + countItens
				} elseif ( (situacao = $$$AbaixoPRComAquisicaoInsuf) || (situacao = $$$AbaixoPRComAquisicaoSuf) ) {
					set countAlmoxComSRPZeradoCentral = countAlmoxComSRPZeradoCentral + countItens
				}
			}			
			set:(blnZeradoRede = $$$YES) countAlmoxZeradoRede = countAlmoxZeradoRede + countItens
		
		} elseif (tipoPadrao = $$$Odontologico) {
 
			if (blnZerado = $$$YES) {
				if (situacao = $$$AbaixoPRSemProcesso) {	
					set countOdontSemSRPZeradoCentral = countOdontSemSRPZeradoCentral + countItens
				} elseif ( (situacao = $$$AbaixoPRComAquisicaoInsuf) || (situacao = $$$AbaixoPRComAquisicaoSuf) ) {
					set countOdontComSRPZeradoCentral = countOdontComSRPZeradoCentral + countItens
				}
			}			
			set:(blnZeradoRede = $$$YES) countOdontZeradoRede = countOdontZeradoRede + countItens
		
		} elseif (tipoPadrao = $$$Laboratorio) { 
 
			if (blnZerado = $$$YES) {
				if (situacao = $$$AbaixoPRSemProcesso) {
					set countLabSemSRPZeradoCentral = countLabSemSRPZeradoCentral + countItens
				} elseif ( (situacao = $$$AbaixoPRComAquisicaoInsuf) || (situacao = $$$AbaixoPRComAquisicaoSuf) ) {
					set countLabComSRPZeradoCentral = countLabComSRPZeradoCentral + countItens
				}
			}			
			set:(blnZeradoRede = $$$YES) countLabZeradoRede = countLabZeradoRede + countItens
		
		} elseif (tipoPadrao = $$$Nutricao) {
 
			if (blnZerado = $$$YES) {
				if (situacao = $$$AbaixoPRSemProcesso) {
					set countNutricSemSRPZeradoCentral = countNutricSemSRPZeradoCentral + countItens
				} elseif ( (situacao = $$$AbaixoPRComAquisicaoInsuf) || (situacao = $$$AbaixoPRComAquisicaoSuf) ) {
					set countNutricComSRPZeradoCentral = countNutricComSRPZeradoCentral + countItens
				}
			}			
			set:(blnZeradoRede = $$$YES) countNutricZeradoRede = countNutricZeradoRede + countItens
 
		} elseif (tipoPadrao = $$$OPME) {
 
			if (blnZerado = $$$YES) {
				if (situacao = $$$AbaixoPRSemProcesso) {
					set countOPMESemSRPZeradoCentral = countOPMESemSRPZeradoCentral + countItens
				} elseif ( (situacao = $$$AbaixoPRComAquisicaoInsuf) || (situacao = $$$AbaixoPRComAquisicaoSuf) ) {
					set countOPMEComSRPZeradoCentral = countOPMEComSRPZeradoCentral + countItens
				}
			}			
			set:(blnZeradoRede = $$$YES) countOPMEZeradoRede = countOPMEZeradoRede + countItens
 
		}
 
	}
 
	write "<table cellspacing='1' width='100%'>"
	write "	<tr style='background-color:#2c6c7f;color:white'>"
	write "		<th ></th>"
	write "		<th style='width:115px;'>Medicamentos</th>"
	write "		<th style='width:115px;'>Material Médico</th>"
	write "		<th style='width:115px;'>Vacinas</th>"
	write "		<th style='width:115px;'>Nutrição</th>"
	write "		<th style='width:115px;'>Laboratório</th>"
	write "		<th style='width:115px;'>Mat. Escritório</th>"
	write "		<th style='width:115px;'>Diversos</th>"
	write "	</tr>"
	
	write "	<tr>"
	write "	<td style='text-align:left;background-color:"_$$$corVermelho_"'><strong>Estoque Zerado na rede</strong>"
	write " <td style='background-color:"_$$$corVermelho_";text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=0&fOrd=3&fZerRede=1'>"_countMedZeradoRede_"</td>"
	write " <td style='background-color:"_$$$corVermelho_";text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=1&fOrd=3&fZerRede=1'>"_countMatMedZeradoRede_"</td>"
	write " <td style='background-color:"_$$$corVermelho_";text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=2&fOrd=3&fZerRede=1'>"_countAlmoxZeradoRede_"</td>"
	write " <td style='background-color:"_$$$corVermelho_";text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=3&fOrd=3&fZerRede=1'>"_countOdontZeradoRede_"</td>"
	write " <td style='background-color:"_$$$corVermelho_";text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=4&fOrd=3&fZerRede=1'>"_countLabZeradoRede_"</td>"
	write " <td style='background-color:"_$$$corVermelho_";text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=5&fOrd=3&fZerRede=1'>"_countNutricZeradoRede_"</td>"
	write " <td style='background-color:"_$$$corVermelho_";text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=6&fOrd=3&fZerRede=1'>"_countOPMEZeradoRede_"</td>"
	write "</tr>"
	
	write "	<tr>"
	write "	<td style='text-align:left;background-color:"_$$$corVermelho_"'><strong>Estoque Zerado nas Centrais sem OC </strong>"
	write " <td style='background-color:"_$$$corVermelho_";text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=0&fSit=1&fOrd=3&fZer=1'>"_countMedSemSRPZeradoCentral_"</a></td>"
	write " <td style='background-color:"_$$$corVermelho_";text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=1&fSit=1&fOrd=3&fZer=1'>"_countMatMedSemSRPZeradoCentral_"</a></td>"
	write " <td style='background-color:"_$$$corVermelho_";text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=2&fSit=1&fOrd=3&fZer=1'>"_countAlmoxSemSRPZeradoCentral_"</a></td>"
	write " <td style='background-color:"_$$$corVermelho_";text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=3&fSit=1&fOrd=3&fZer=1'>"_countOdontSemSRPZeradoCentral_"</a></td>"
	write " <td style='background-color:"_$$$corVermelho_";text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=4&fSit=1&fOrd=3&fZer=1'>"_countLabSemSRPZeradoCentral_"</a></td>"
	write " <td style='background-color:"_$$$corVermelho_";text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=5&fSit=1&fOrd=3&fZer=1'>"_countNutricSemSRPZeradoCentral_"</a></td>"
	write " <td style='background-color:"_$$$corVermelho_";text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=6&fSit=1&fOrd=3&fZer=1'>"_countOPMESemSRPZeradoCentral_"</a></td>"
	write "</tr>"
 
	write "	<tr>"
	write "	<td style='text-align:left;background-color:"_$$$corLaranja_"'><strong>Estoque Zerado nas Centrais com OC </strong>"
	write " <td style='background-color:"_$$$corLaranja_";text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=0&fSit=11&fOrd=3&fZer=1'>"_countMedComSRPZeradoCentral_"</a></td>"
	write " <td style='background-color:"_$$$corLaranja_";text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=1&fSit=11&fOrd=3&fZer=1'>"_countMatMedComSRPZeradoCentral_"</a></td>"
	write " <td style='background-color:"_$$$corLaranja_";text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=2&fSit=11&fOrd=3&fZer=1'>"_countAlmoxComSRPZeradoCentral_"</a></td>"
	write " <td style='background-color:"_$$$corLaranja_";text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=3&fSit=11&fOrd=3&fZer=1'>"_countOdontComSRPZeradoCentral_"</a></td>"
	write " <td style='background-color:"_$$$corLaranja_";text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=4&fSit=11&fOrd=3&fZer=1'>"_countLabComSRPZeradoCentral_"</a></td>"
	write " <td style='background-color:"_$$$corLaranja_";text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=5&fSit=11&fOrd=3&fZer=1'>"_countNutricComSRPZeradoCentral_"</a></td>"
	write " <td style='background-color:"_$$$corLaranja_";text-align:center;font-weight:bold'><a class='link2' href='VARSESPainelAbastecimentoDet.csp?fTip=6&fSit=11&fOrd=3&fZer=1'>"_countOPMEComSRPZeradoCentral_"</a></td>"
	write "</tr>"
	
	write "</table>"
 
	do rsSQLCentrais.Close()
 	quit
 
printComboSituacao(pSelected)
	new idSituacao
	set idSituacao = $order(^VARPARA(0,"SITUACAOABASTECIMENTO","PT",""))
	while ($length(idSituacao) '= 0) {
		write "<option value='"_idSituacao_"' " write:(pSelected = idSituacao) "selected" write ">"_$$GetDescricaoSituacaoFromID^VARSESPainelAbastUtils(idSituacao)_"</option>"
		set idSituacao = $order(^VARPARA(0,"SITUACAOABASTECIMENTO","PT",idSituacao))
	}
	quit
 
printComboTipoPadrao(pSelected)
	new idTipoPadrao
	set idTipoPadrao = $order(^INPARA(0,"VARSESPADRAO","PT",""))
	while ($length(idTipoPadrao) '= 0) {
		write "<option value='"_idTipoPadrao_"' " write:(pSelected = idTipoPadrao) "selected" write ">"_$$SQLGetUserParamDesc^VARSQL("VARSESPADRAO~"_idTipoPadrao)_"</option>"
		set idTipoPadrao = $order(^INPARA(0,"VARSESPADRAO","PT",idTipoPadrao))
	}
	quit
	
showInNewWindow
	do GoToForm^COMUtilForm("VARSESPainelAbastecimentoMain","",,,$$$YES)
	quit
]]></Routine>
</Export>