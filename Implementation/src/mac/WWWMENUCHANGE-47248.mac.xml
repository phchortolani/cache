<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="22" zv="CACHE" ts="2001-01-01 00:00:00">
<Routine name="WWWMENUCHANGE" type="MAC" languagemode="0" timestamp="58440,0"><![CDATA[
WWWMENUCHANGE ;WWWMENUCHANGE;TYBD;CHANGE MENU ITEMS;8,9,2004
	;
	;/------------------------------------------------------------------\
	;| Description of Function :
	;|		CHANGE MENU ITEMS
	;|
	;| Inputs : 
	;|
	;|
	;| ByRef :
	;|
	;|
	;| Returns :
	;|
	;|
	;| History :
	;|
	;| TYBD	8,9,2004
	;|
	;\------------------------------------------------------------------/
	;
	NEW VERSION
	; ;SPEICHERN VERSION FÜR MENUEUMSTRUKTURIERUNG;26370;TYBD;8,9,2004
	IF VORG(1)="" DO WRONG(1)  QUIT  ;NO MENU
	IF '$DATA(^WWW004(0,VORG(1))) DO WRONG(2) QUIT  ;NO MENU
	IF VORG(2)="" DO WRONG(3)  QUIT  ;NO MENU
	;SET VORG(2)=$TRANSLATE(VORG(2),",",".")
	IF VORG(2)="" DO WRONG(4) QUIT
	IF '$DATA(^WWW004(0,VORG(1),VORG(2),1)) DO WRONG(5) QUIT
	IF VORG(3)="" DO WRONG(6)  QUIT  ;NO MENU
	;SET VORG(3)=$TRANSLATE(VORG(3),",",".")
	IF VORG(3)="" DO WRONG(7) QUIT
	IF $DATA(^WWW004(0,VORG(1),VORG(3),1)) DO WRONG(8) QUIT
	SET VERSION=$PIECE($GET(^WWWVERSION(0,VORG(1),1)),Y,2)  ;LAST VERSION ;charge 
	IF VERSION="" SET VERSION=+$HOROLOG  ;OR DATE
	SET ^WWWMENUCHANGE(0,VORG(1),VERSION,VORG(2),1)=VORG(3)
	;DO CHANGE ;EXCHANGE FIELDS
	SET YLINK=""
	DO  ;LINK
	. NEW YKEY,YI
	. SET YI=YAKTION_"EP=WWWFORM&amp;YFORM=WWWMENUCHANGE"
	. DO VAR^WWWCGI
	. SET YLINK=YI
	. QUIT
	DO ^WWWINFO($$^WWWTEXT(30013)_" ("_VORG(2)_" -> "_VORG(3)_")",0,YLINK)  ; ANGELEGT
	QUIT
	
WRONG(X) ;
	SET YLINK=""
	DO  ;LINK
	. NEW YKEY,YI
	. SET YI=YAKTION_"EP=WWWFORM&amp;YFORM=WWWMENUCHANGE"
	. DO VAR^WWWCGI
	. SET YLINK=YI
	. QUIT
	DO ^WWWINFO($$^WWWTEXT(219)_" ",0,YLINK)  ;WRONG
	QUIT
	
CHANGE ;LOOK FOR MENU ITEM AND CHANGE
	NEW MENU
	SET MENU=VORG(2) SET MENUNEW=VORG(3) DO  FOR  SET MENU=$ORDER(^WWW004(0,VORG(1),MENU)) QUIT:MENU=""  QUIT:$EXTRACT(MENU,1,$LENGTH(VORG(2)))'=VORG(2)  DO
	. SET MENUNEW=VORG(3)_$PIECE(MENU,VORG(2),2,99)
	. MERGE ^WWW004(0,VORG(1),MENUNEW)=^WWW004(0,VORG(1),MENU)
	. KILL ^WWW004(0,VORG(1),MENU)
	. MERGE ^WWW0041(0,VORG(1),MENUNEW)=^WWW004(0,VORG(1),MENU)
	. KILL ^WWW004(0,VORG(1),MENU)
	. QUIT
	DO NEW^WWWSORT("WWW004")
	QUIT
	
LOOKUP ;CREATE BUTTON
	DO  ;
	. WRITE YCR
	. WRITE "<A HREF="_""""
	. SET URL=YAKTION_"EP=WWWMANU1&amp;YEXEC=D|SEARCH^WWWMENUCHANGE&amp;YUSER="_YUSER_"&amp;YBED="_YBED_"&amp;YFORM="_YFORM_"&amp;YTRAKT="_YTRAKT_"&amp;YUCI="_$GET(YUCI)_"&amp;YM="_YM_"&amp;YKEY="_YKEY_"&amp;YAUSWAHL="_"'+document."_YHTMFORM_".YWWWMENUCHANGEM2.value+'"
	. SET OPT="HEIGHT=400,WIDTH=450,SCROLLBARS=YES,RESIZEABLE=YES"
	. WRITE "javascript:var parameter=window.open('"_URL_"','Suche','"_OPT_"');"  
	. WRITE """"
	. WRITE ">"
	. ;set icone=""
	. ;if $$MenuType^WWW013()=14{
	. ;	set icone = $$traducaoIcone^WWWFORMCOMMON("search1.gif")
	. ;}
	. ;if icone'=""{
	.	;if disabledButton set corBotao="secondary"
	.	;WRITE "   <div class='btn btn-outline-"_corBotao_" btn-sm "_$select(disabledButton=1:"disabled",1:"")_"'"
	.	;WRITE " style='width:30px' "
	.	;WRITE " TITLE="_""""_$$^WWWTEXT(148)_""""_" border=0>"
	.	;WRITE "<i class='"_icone_"'></i>"
	.	;WRITE "</div>"
	. ;}else{			
	.   WRITE YCR,"<IMG SRC="_""""_YGIF_"search1.gif"_""""_" ALIGN=ABSBOTTOM TITLE="_""""_$$^WWWTEXT(148)_""""_" border=0>"
	. ;}
	. WRITE "</A>"
	. QUIT
	QUIT
	
SEARCH ; SEARCH WWW004
	NEW SPRACHE1,SUCH,TEXT,ANZ
	SET SPRACHE1=SPRACHE
	SET SUCH=$GET(YAUSWAHL)  ;SUCHBEGRIFF
	;IF SUCH="" WRITE $$^WWWTEXT(32310) QUIT  ;KEINE AUSWAHL
	SET VORG(1)=$PIECE($GET(^WWWDATEN(YM,+$HOROLOG,YUSER,YFORM,"M",1)),Y,1)
	IF VORG(1)="" WRITE $$^WWWTEXT(32310) QUIT
	DO ^WWWSTART()
	SET YNOFOOT=1
	SET ANZ=0
	WRITE "<TABLE BORDER=0 CELLSPACING=0 WIDTH=100% VALIGN=TOP>",YCR
	SET YI="" FOR  SET YI=$ORDER(^WWW004(0,VORG(1),YI)) QUIT:YI=""  DO
	. SET TEXT=$PIECE($GET(^WWW004(0,VORG(1),YI,1)),Y,1)
	. IF $DATA(^WWW0041(0,VORG(1),YI,SPRACHE1,1)) SET TEXT=$PIECE(^(1),Y,1)
	. ;IF SUCH'="" QUIT:'$FIND($$^WWWUPER(TEXT),$$^WWWUPER(SUCH))  ;NOT IN MENU
	. DO
	. . SET ANZ=ANZ+1
	. . WRITE "<TR>"
	. . WRITE "<TD ALIGN=RIGHT VALIGN=TOP NOWRAP>"
	. . WRITE "<FONT SIZE=2 FACE=ARIAL>"
	. . WRITE YI_" "
	. . WRITE "</TD>"
	. . WRITE "<TD ALIGN=LEFT VALIGN=TOP NOWRAP>"
	. . WRITE "<FONT SIZE=2 FACE=ARIAL>"
	. . WRITE "- "_TEXT
	. . WRITE "</TD>"
	. . WRITE "</TR>"
	. . WRITE YCR
	. . QUIT
	. QUIT
	IF ANZ=0 WRITE "<TR><TD ALIGN=LEFT NOWRAP><FONT SIZE=2 FACE=ARIAL>"_$$^WWWTEXT(46)_"</FONT></TD></TR>"  ;KEINE DATEN GEFUNDEN ;no 
	WRITE "</TABLE>"
	DO ^WWWSTOP
	QUIT
	QUIT
	
EXIST ;
	SET %TXT(1)="§"_$$^WWWTEXT(13,,1)
	SET VORG(1)=$PIECE(YMFELD,Y,1)
	IF VORG(1)="" SET %TXT(1)="" QUIT
	SET VORG(2)=$PIECE(YMFELD,Y,2)
	IF VORG(2)="" SET %TXT(1)="" QUIT
	;
	QUIT:'$DATA(^WWW004(0,VORG(1),VORG(2),1))
	SET %TXT(1)=$PIECE($GET(^WWW004(0,VORG(1),VORG(2),1)),Y,1)  ;EXISTS
	QUIT
	
NOTEXIST ;
	SET %TXT(1)="§"_$$^WWWTEXT(286,,1)
	SET VORG(1)=$PIECE(YMFELD,Y,1)
	IF VORG(1)="" SET %TXT(1)="" QUIT
	;SET VORG(3)=$TRANSLATE($PIECE(YMFELD,Y,3),",",".")
	SET VORG(3)=$PIECE(YMFELD,Y,3)
	IF VORG(3)="" SET %TXT(1)="" QUIT
	IF $EXTRACT($REVERSE(VORG(3)))'="." SET %TXT(1)="§"_$$^WWWTEXT(219,,1) QUIT  ;WRONG INPUT
	QUIT:$DATA(^WWW004(0,VORG(1),VORG(3),1))
	SET %TXT(1)=""  ;DOES NOT EXIST ;privation 
	QUIT
]]></Routine>
</Export>