<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="22" zv="CACHE" ts="2001-01-01 00:00:00">
<Routine name="INGEWICHT" type="MAC" languagemode="0" timestamp="58440,0"><![CDATA[
INGEWICHT(YART) ;INGEWICHT;DT;GEWICHTE DES TEILS;30.06.2000
	;
	;-------------------------------------------------------------------------------
	; Description of Function :
	;		GEWICHTE DES TEILS
	;
	; Inputs : 
	;	YART		ARTIKELNUMMER
	;
	; ByRef :
	;
	;
	; Returns :
	;
	;
	; History :
	; 16-Aug-2005	GRF		SR13215 : Doco
	; DT	30.06.2000
	;-------------------------------------------------------------------------------
	NEW GEWICHT,YLAENGE,YBREITE,YHOEHE,MATERIAL,SPGEWICHT,HGEWICHT,YFELD,MGEWICHT
	
	;+++++++++++++++++++++++++++++++++++++++
	;  YLAENGE		Length			(m)
	;  YBREITE		Breadth			(m)
	;  YHOEHE		Height			(m)
	;  SPGEWICHT	Specific Weight or Density	(Kg/m³)
	;  GEWIGHT		Mass			(Kg)
	;  HGEWICHT		Mass per length (Kg/m)
	;+++++++++++++++++++++++++++++++++++++++
	
	SET GEWICHT = ""
	SET YART    = $GET(YART)				QUIT:YART="" GEWICHT
	SET YFELD   = $GET(^INART(YM,YART,1))
	
	IF +$PIECE(YFELD,Y,255)=1 DO  QUIT GEWICHT
	. SET GEWICHT=$PIECE(YFELD,Y,43)  ;KEINE NEURECHNUNG DES GEWICHTES ;no 
	. IF +$PIECE(GEWICHT,".",2)'=0 SET GEWICHT=$JUSTIFY(GEWICHT,0,3)
	. QUIT
	
	SET YLAENGE  = $PIECE(YFELD,Y,15)
	SET YBREITE  = $PIECE(YFELD,Y,16)
	SET YHOEHE   = $PIECE(YFELD,Y,17)
	SET MATERIAL = $PIECE(YFELD,Y,37)  ;MATERIAL
	
	IF MATERIAL'="" DO
	. IF +$PIECE(YFELD,Y,255)=1 DO
	. . IF +YLAENGE'=0 IF +YBREITE'=0 IF +YHOEHE'=0 DO
	. . . SET SPGEWICHT=$PIECE($GET(^INMATERIAL(YM,MATERIAL,1)),Y,2)
	. . . IF +SPGEWICHT'=0 SET GEWICHT=(YLAENGE/100)*(YBREITE/100)*(YHOEHE/100)*SPGEWICHT   ;GEWICHT IN KG/dm2 ;wt. within 
	. . . QUIT
	. . QUIT
	. QUIT
	
	SET HGEWICHT=$PIECE(YFELD,Y,172)  ;HANDELSGEWICHT
	IF HGEWICHT'="" DO
	. IF +YLAENGE'=0 DO
	. . ;SET GEWICHT=(YLAENGE/1000)*HGEWICHT  ;table-mat 
	. . SET GEWICHT=(YLAENGE/1)*HGEWICHT             ;HG IN KG/m; ULM,27.06.02 FAKTOR 1000 ABGEÄNDERT IN 1
	. . IF $PIECE(YFELD,Y,40)=6 IF +YBREITE'=0 SET GEWICHT=GEWICHT*YBREITE  ;HG KG/M² ZUGEFÜGT AM 27.06.02 ;to the 
	. . IF $PIECE(YFELD,Y,40)=12 IF +YHOEHE'=0 SET GEWICHT=GEWICHT*YBREITE*YHOEHE   ;HG KG/M³ ZUGEFÜGT AM 27.06.02 ;to the 
	. . QUIT
	. QUIT
	
	IF $DATA(^INARTT(YM,YART)) SET GEWICHT="" DO  ;ERRECHNEN GEWICHT DER TEILE ;wt. the 
	. NEW TEIL,ARTIKEL1,TARTIKEL,TMENGE,TGEWICHT
	. IF $PIECE(YFELD,Y,255)=1 SET GEWICHT=$PIECE(YFELD,Y,43) QUIT  ;FIS;21.09.04;26400;GEWICHT NICHT RECHNEN
	. SET TEIL=""
	. FOR  SET TEIL=$ORDER(^INARTT(YM,YART,TEIL)) QUIT:TEIL=""  DO
	. . QUIT:$GET(TGEWICHT)>100000000  ;FALSCH ;wrong 
	. . SET ARTIKEL1 = $GET(^INARTT(YM,YART,TEIL,1))  ;ARTIKELTEILEINFO
	. . QUIT:YART=$PIECE(ARTIKEL1,Y,1)  ;GLEICHES TEIL;TYBD;28,11,2004;26567
	. . SET TARTIKEL = $PIECE(ARTIKEL1,Y,1)  ;TEILEARTIKEL
	. . SET TMENGE   = $PIECE(ARTIKEL1,Y,4)  ;MENGE INNERHALB DES TEILS ;quantity inside partly 
	. . SET TGEWICHT = $PIECE(ARTIKEL1,Y,6)  ;GEWICHT   ;wt. 
	. . IF TARTIKEL'="" SET GEWICHT=GEWICHT+TGEWICHT  ;GEWICHT DES TEILS ;wt. partly 
	. . QUIT
	. QUIT
	
	IF GEWICHT="" SET GEWICHT=$PIECE($GET(^INART(YM,YART,1)),Y,43)
	IF +$PIECE(GEWICHT,".",2)=0 QUIT $JUSTIFY(GEWICHT,0,0)  ;KEINE NACHKOMMA ;no 
	QUIT $JUSTIFY(GEWICHT,0,3)  ;MAX 3 NACHKOMMA = g
	
]]></Routine>
</Export>