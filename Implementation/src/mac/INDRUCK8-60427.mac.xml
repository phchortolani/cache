<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="22" zv="CACHE" ts="2001-01-01 00:00:00">
<Routine name="INDRUCK8" type="MAC" languagemode="0" timestamp="58440,0"><![CDATA[
INDRUCK8
	;/------------------------------------------------------------------\
	;| Description of Function :
	;|		DRUCKEN BELEG FUSS / HINWEISE
	;|
	;| Inputs : 
	;|
	;|
	;| ByRef :
	;|
	;|
	;| Returns :
	;|
	;|
	;| History :
	;| DT	24.02.2000  
	;\------------------------------------------------------------------/
	NEW YOK,YMINDESTLFN
	
	DO LIEFER
	DO GUELTIG
	DO FUSS
	DO WERBUNG
	DO ENDE
	QUIT
	
LIEFER ;LIEFERHINWEIS
	SET A=YTAB
	IF $PIECE(YBELEG1,Y,29)=1 DO  ;LIEFERHINWEIS
	. SET YA(3)=$PIECE(YAUFTRAG1,Y,21)
	. NEW TEXT,TEXT1
	. QUIT:$TRANSLATE(YA(3),"| ")=""
	. SET A=YTAB
	. DO SPE^INDRUCK   ;ZEILE EINFÜGEN ;interpolate 
	. SET A=YTAB
	. SET TEXT=YA(3)
	. FOR YA(88)=1:1 SET TEXT1=$PIECE(TEXT,"|",YA(88)) QUIT:$TRANSLATE($PIECE(TEXT,"|",YA(88),999),"|")=""  DO
	. . SET A=YTAB
	. . FOR YA(33)=1:1 QUIT:$PIECE(TEXT1," ",YA(33),999)=""  DO  SET A=A_$PIECE(TEXT1," ",YA(33))_" "   
	. . . IF $LENGTH(A_$EXTRACT($PIECE(TEXT1," ",YA(33)),1,26))>60 DO SPE^INDRUCK SET A=YTAB
	. . ;
	. . IF $TRANSLATE(A," ")'="" DO SPE^INDRUCK
	. . IF $TRANSLATE(A," ")="" IF YA(33)=1 DO SPE^INDRUCK
	. ;
	. SET A=YTAB
	. DO SPE^INDRUCK   ;ZEILE EINFÜGEN ;interpolate 
	
	QUIT
	
FUSS ;FUSSZEILE
	IF $PIECE(YBELEG1,Y,70)="" QUIT   ;KEIN HINWEIS ;no 
	NEW YI,YII
	
	SET YTAB=$EXTRACT("                                                                           ",1,+$PIECE(YBELEG1,Y,41))  ;IN SPALTE ;within rift 
	
	IF $PIECE(YBELEG1,Y,191)'=1 IF ($GET(YSEND)=0) || ('$FIND($PIECE(YBELEG1,Y,12),"<PRE>")) DO
	. IF LFN<$PIECE(YBELEG1,Y,69) SET LFN=$PIECE(YBELEG1,Y,69)+2  ;AB ZEILE ;Confirm. 
	. IF LFN<40 SET LFN=40
	
	IF $PIECE(YBELEG1,Y,191)=1!$GET(YSEND)=1!($GET(YSEND)=2) DO
	. IF '$FIND($PIECE(YBELEG1,Y,12),"<PRE>") IF LFN<$PIECE(YBELEG1,Y,69) SET LFN=$PIECE(YBELEG1,Y,69)+2   ;BEC;04.01.05;NICHT BEI HTML HEADERN
	. IF '$FIND($PIECE(YBELEG1,Y,12),"<PRE>") IF LFN<40 SET LFN=40    ;BEC;04.01.05;NICHT BEI HTML HEADERN
	
	SET A=" " DO SPE^INDRUCK
	IF $PIECE(YBELEG1,Y,70)'="" DO  ;TEXT VORHANDEN ;Text on hand 
	. SET TEXT=$PIECE(YBELEG1,Y,70)
	. FOR YI=1:1 SET TEXT1=$PIECE(TEXT,"|",YI) QUIT:$TRANSLATE($PIECE(TEXT,"|",YI,999),"|")=""  DO
	. . SET A=YTAB
	. . FOR YII=1:1 QUIT:$PIECE(TEXT1," ",YII,999)=""  DO  SET A=A_$PIECE(TEXT1," ",YII)_" "   
	. . . IF $LENGTH(A_$EXTRACT($PIECE(TEXT1," ",YII),1,26))>77 DO SPE^INDRUCK SET A=YTAB
	. . ;
	. . IF $TRANSLATE(A," ")'="" DO SPE^INDRUCK
	. . IF $TRANSLATE(A," ")="" IF YII=1 DO SPE^INDRUCK
	
	QUIT
	
GUELTIG ;ANGEBOT GÜLTIG BIS ;proposition valuable until 
	IF YBELEG=1 DO   ;NUR BEI ANGEBOTEN ;only next to 
	. NEW YSPA
	. QUIT:$PIECE(YBELEG1,Y,189)'=1  ;NICHT DRUCKEN ;Not print 
	. IF +$PIECE(YBELEG1,Y,190)=0 SET $PIECE(YBELEG1,Y,190)=$PIECE(YBELEG1,Y,41)
	. SET A=" " DO SPE^INDRUCK
	. SET YSPA="                                                                                           "
	. SET YTAB=$EXTRACT(YSPA,1,+$PIECE(YBELEG1,Y,190))  ;IN SPALTE ;within rift 
	. IF $PIECE(YAUFTRAG1,Y,202)'="" DO
	. . SET A=YTAB_$$^WWWTEXT(32531)_" "  ;ANGEBOT IST GÜLTIG BIS ;proposition valuable until 
	. . SET A=A_$$^WWWDATE($PIECE(YAUFTRAG1,Y,202))
	. . DO SPE^INDRUCK
	
	QUIT
	
WERBUNG ; WERBETEXT FÜR KUNDEN ;to 
	QUIT:YBELEG=3   ;BESTELLUNG ;sales order 
	QUIT:YBELEG=13  ;BESTELLUNG STORNO
	QUIT:YBELEG=10  ;ANFRAGE
	IF +$PIECE(YAUFTRAG1,Y,17)=0 QUIT   ;KEIN HINWEIS ;no 
	SET $PIECE(YBELEG1,Y,76)=$PIECE($GET(^INWERBTX(YM,$PIECE(YAUFTRAG1,Y,17),1)),Y,1)   ;WERBTEXT VORHANDEN DANN OHNE FUßNOTE MEHR ;26055;FAN;25.11.04
	QUIT
	
	
	; vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv DISABLED BLOCK START
	SET YOK=1  ;ETWAS GEDRUCKT ;to some extend 
	NEW YI,YII
	SET YTAB=$EXTRACT("                                                                           ",1,+$PIECE(YBELEG1,Y,41))  ;IN SPALTE ;within rift 
	
	;IF LFN<$PIECE(YBELEG1,Y,69) SET LFN=$PIECE(YBELEG1,Y,69)+2  ;AB ZEILE ;Confirm. 
	;IF LFN<40 SET LFN=40
	
	IF $PIECE(YBELEG1,Y,191)'=1 IF $GET(YSEND)=0!('$FIND($PIECE(YBELEG1,Y,12),"<PRE>")) DO
	. IF LFN<$PIECE(YBELEG1,Y,77) SET LFN=$PIECE(YBELEG1,Y,77)  ;AB ZEILE ;Confirm.   ;WERBTEXT VORHANDEN DANN OHNE FUßNOTE MEHR ;26055;FAN;25.11.04
	. IF LFN<60 SET LFN=60
	
	IF $PIECE(YBELEG1,Y,191)=1!$GET(YSEND)=1!($GET(YSEND)=2) DO
	. IF '$FIND($PIECE(YBELEG1,Y,12),"<PRE>") IF LFN<$PIECE(YBELEG1,Y,77) SET LFN=$PIECE(YBELEG1,Y,77)  ;BEC; 27102;04.12.05;AB ZEILE ;Confirm.   ;WERBTEXT VORHANDEN DANN OHNE FUßNOTE MEHR ;26055;FAN;25.11.04
	. IF '$FIND($PIECE(YBELEG1,Y,12),"<PRE>") IF LFN<60 SET LFN=60                                       ;BEC; 27102;04.12.05;
	
	SET A=" " DO SPE^INDRUCK
	IF +$PIECE(YAUFTRAG1,Y,17)'=0 DO  ;TEXT VORHANDEN ;Text on hand 
	. SET TEXT=$PIECE($GET(^INWERBTX(YM,$PIECE(YAUFTRAG1,Y,17),1)),Y,1)
	. FOR YI=1:1 SET TEXT1=$PIECE(TEXT,"|",YI) QUIT:$TRANSLATE($PIECE(TEXT,"|",YI,999),"|")=""  DO
	. . SET A=YTAB
	. . FOR YII=1:1 QUIT:$PIECE(TEXT1," ",YII,999)=""  DO  SET A=A_$PIECE(TEXT1," ",YII)_" "   
	. . . IF $LENGTH(A_$EXTRACT($PIECE(TEXT1," ",YII),1,26))>77 DO SPE^INDRUCK SET A=YTAB
	. . ;
	. . IF $TRANSLATE(A," ")'="" DO SPE^INDRUCK
	. . IF $TRANSLATE(A," ")="" IF YII=1 DO SPE^INDRUCK
	
	QUIT
	; ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ DISABLED BLOCK END
	
ENDE ;SEITENENDE 
	IF $PIECE(YBELEG1,Y,216)=1 QUIT   ;BEC;28.02.05;27122;BELEGFUSS AUF JEDER SEITE
	QUIT:YSEND=2  ;NICHT AUF EIN FAX ;Not upon uni- 
	IF $PIECE(YBELEG1,Y,76)="" QUIT   ;FUSS IN HTML ;within HTML 
	
	NEW YI,YII
	
	;IF LFN<$PIECE(YBELEG1,Y,77) SET LFN=$PIECE(YBELEG1,Y,77)  ;AB ZEILE ;Confirm. 
	;IF LFN<60 SET LFN=60
	
	IF $PIECE(YBELEG1,Y,191)'=1 IF $GET(YSEND)=0!('$FIND($PIECE(YBELEG1,Y,12),"<PRE>")) DO
	. IF LFN<$PIECE(YBELEG1,Y,77) SET LFN=$PIECE(YBELEG1,Y,77)  ;AB ZEILE ;Confirm. 
	. IF LFN<60 SET LFN=60
	
	IF $PIECE(YBELEG1,Y,191)=1!$GET(YSEND)=1!($GET(YSEND)=2) DO
	. IF LFN<$PIECE(YBELEG1,Y,77) SET LFN=$PIECE(YBELEG1,Y,77)  ;AB ZEILE ;Confirm. 
	
	NEW YPAGEBR
	SET YPAGEBR=2
	SET A=" " DO SPE^INDRUCK
	SET YPAGEBR=2
	IF $PIECE($GET(YAUFTRAG1),Y,333)=1 IF $PIECE(YBELEG1,Y,209)'="" SET $PIECE(YBELEG1,Y,76)=$PIECE(YBELEG1,Y,209)  ;FIS;ALTERNATIVER BELEGFUSS;31.12.2004;26055
	IF $PIECE(YBELEG1,Y,76)'="" DO  ;TEXT VORHANDEN ;Text on hand 
	. SET A=$TRANSLATE($PIECE(YBELEG1,Y,76),"|"," ")
	. SET YMINDESTLFN=LFN
	. DO SPE^INDRUCK
	. KILL YMINDESTLFN
	
	QUIT
]]></Routine>
</Export>