<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="22" zv="CACHE" ts="2001-01-01 00:00:00">
<Routine name="INDRUCKXML4" type="MAC" languagemode="0" timestamp="58440,0"><![CDATA[
INDRUCKXML4 ;INDRUCKXML4;DT;DRUCKEN BELEG NAME XML;19.06.2002
	;
	;/------------------------------------------------------------------\
	;| Description of Function :
	;|		DRUCKEN BELEG NAME XML
	;|
	;| Inputs : 
	;|
	;|
	;| ByRef :
	;|
	;|
	;| Returns :
	;|
	;|
	;| History :
	;|
	;| DT	19.06.2002
	;|
	;\------------------------------------------------------------------/
	;
	IF YSEITE'=1 IF $PIECE(YBELEG1,Y,11)'=1 QUIT   ;ANSCHRIFT AUCH AUF FOLGESEITEN? ;too upon 
	NEW TYPE,NUMBER
	SET TYPE=""
	IF YBELEG=7!(YBELEG=17) IF $GET(YPROFORMA)=1 SET TYPE="PRO FORMA-"  ;PROFORMARECHNUNG ;proforma invoice 
	IF YBELEG=12 DO
	. IF $PIECE(YFELDPZ,Y,14)'="" DO  QUIT
	. . NEW TXT
	. . SET TXT=$PIECE($GET(^INPARA(YM,"INAUFPZ",SPRACHE,$PIECE(YFELDPZ,Y,14),1)),Y,1)
	. . IF TXT="" SET TXT=$PIECE(YFELDPZ,Y,14)
	. . SET TYPE=TYPE_TXT
	. . SET $PIECE(YBELEG1,Y,23)=""  ;KEIN WEITERER TEXT ;no Text 
	. . QUIT
	. IF $PIECE(YFELDPZ,Y,14)="" DO
	. . IF $PIECE(YBELEG1,Y,23)'="" SET TYPE=TYPE_$PIECE(YBELEG1,Y,23) SET $PIECE(YBELEG1,Y,23)="" QUIT
	. . IF $PIECE(YFELDPZ,Y,1)'=1 SET TYPE=TYPE_$$^WWWTEXT(32335)    ;TEILZAHLUNGSRECHNUNG
	. . IF $PIECE(YFELDPZ,Y,1)=1 SET TYPE=TYPE_$$^WWWTEXT(32336)    ;ANZAHLUNGSRECHNUNG
	. . QUIT
	. QUIT
	SET TYPE=TYPE_$PIECE(YBELEG1,Y,23)
	IF $GET(YCOPY)=1 SET TYPE=TYPE_" ("_$$^WWWTEXT(32097)_")"  ;KOPIE ;copy 
	DO XML^INDRUCK(,,,"TYPE",TYPE)
	SET NUMBER=""
	IF YBELEG=1 SET NUMBER=YAUFTRAG   ;ANGEBOT ;proposition 
	IF YBELEG=2 SET NUMBER=$PIECE(YAUFTRAG1,Y,78)   ;AB ;Confirm. 
	IF YBELEG=6 SET NUMBER=$PIECE(YAUFTRAG1,Y,91)   ;LIEFERSCHEIN ;packing slip 
	IF YBELEG=7 SET NUMBER=$PIECE(YAUFTRAG1,Y,96)   ;RECHNUNG ;tab 
	IF YBELEG=17 SET NUMBER=$PIECE(YAUFTRAG1,Y,96)  ;GUTSCHRIFT
	IF YBELEG=12 SET NUMBER=$PIECE(YFELDPZ,Y,7)       ;TEILZAHLUNGSRECHNUNG
	;IF $GET(YCOPY)=1 SET NUMBER=NUMBER_" ("_$$^WWWTEXT(32097)_")"  ;KOPIE
	DO XML^INDRUCK(,,,"NUMBER",NUMBER)
	;KOMMISSION ;errand 
	IF $PIECE($GET(YAUFTRAG1),Y,8)'="" DO
	. SET YI(1)=$TRANSLATE($PIECE(YBELEG1,Y,17),";",",")   ;WELCHE HINWEISE DATUM USW.
	. FOR YI=1:1 SET YI(2)=$PIECE(YI(1),",",YI) QUIT:YI(2)=""  IF YI(2)=99 DO  QUIT
	. . SET YI(4)=$PIECE($GET(^WWW101(0,"BETREFF",SPRACHE,YI(2),1)),Y,1)  ;TEXT FÃœR DRUCK ;Text to printing 
	. . SET YI(5)=$PIECE($GET(YAUFTRAG1),Y,8)  ;KOMMISSION ;errand 
	. . ;DO XML^INDRUCK(,,,YI(4),YI(5))
	. . DO XML^INDRUCK(,,,"BETREFF"_YI(2),YI(5))
	. . QUIT
	. QUIT
	QUIT
]]></Routine>
</Export>