<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="22" zv="CACHE" ts="2001-01-01 00:00:00">
<Routine name="INFIBEXPO" type="MAC" languagemode="0" timestamp="58440,0"><![CDATA[
INFIBEXPO ;INFIBEXPO;DT;EXPORT DATEN AUF DISK;08.12.2001  ; Compiled March 14, 2005 13:38:32
	;
	;/------------------------------------------------------------------\
	;| Description of Function :
	;|		EXPORT DATEN AUF DISK
	;|
	;| Inputs : 
	;|
	;|
	;| ByRef :
	;|
	;|
	;| Returns :
	;|
	;|
	;| History :
	;|
	;| DT	08.12.2001  
	;|
	;\------------------------------------------------------------------/
	;
	;
	NEW FILE,KILL
	IF $GET(VORG(1))="" DO NICHT QUIT
	LOCK +^INFIBEXPO:1 IF '$TEST DO NICHT QUIT
	;
	SET FILE=VORG(1)
	SET KILL=$GET(VORG(2))
	IF $PIECE($GET(^INFIBPAR(0,YM,YLOCATION,1)),Y,46)=1 DO PROT(0)
	DO EXPO
	IF $PIECE($GET(^INFIBPAR(0,YM,YLOCATION,1)),Y,46)=1 DO PROT(1)
	DO OK QUIT  ;UEBERTRAGUNG OK
	;
	LOCK -^INFIBEXPO
	QUIT
	;
	
NICHT ;
	;
	DO ^WWWINFO($$^WWWTEXT(30005))  ;NICHT UEBERTRAGEN ;Not 
	QUIT
	;
	
OK ;
	;
	DO ^WWWINFO($$^WWWTEXT(30007))  ;UEBERTRAGUNG OK
	QUIT
	;
	
EXPO ;
	;
	NEW VORG
	;
	;
	;VORG(1)=DATEI
	;VORG(2)=SCHLÜSSEL
	;VORG(3)=FILENAME
	;VORG(4)=FORMAT=1=AS IS
	;VORG(5)=TRENNZEICHEN
	;VORG(6)=1 = LÖSCHEN DATEI ;Delete data file 
	;VORG(999)=1 = NICHT BILDSCHIRM DEV ÖFFNEN ;Not monitor unclose 
	SET VORG(1)="INFIBEXPO"
	SET VORG(2)=""
	SET VORG(3)=FILE
	SET VORG(4)=1
	SET VORG(5)=""
	SET VORG(6)=KILL
	SET VORG(999)=1
	DO ^WWWEXPO
	QUIT
	;
	
PROT(SAVE)  ;PROTOKOLL DER BUCHUNGEN (IN 2 SCHRITTEN, FALLS ABBRUCH IN WWWEXPO !)
	;
	IF $GET(SAVE)'=1 DO  QUIT  ;GET PROTOKOLL DATA
	. KILL ^CacheTempWWWSOR(YUSER)
	. SET NUM="" FOR  SET NUM=$ORDER(^INFIBEXPO(YM,NUM)) QUIT:NUM=""  DO
	. . IF $DATA(^INFIBBUCHPROTs(YM,1,NUM)) DO
	. . . SET VOR=$ORDER(^INFIBBUCHPROTs(YM,1,NUM,""))
	. . . IF VOR'="" SET ^CacheTempWWWSOR(YUSER,VOR)=""
	. . . QUIT
	. . QUIT
	. QUIT
	;
	IF $GET(SAVE)=1 DO  ;SAVE PROTOKOLL DATA
	. SET VOR="" FOR  SET VOR=$ORDER(^CacheTempWWWSOR(YUSER,VOR)) QUIT:VOR=""  DO
	. . SET VOR1=$GET(^INFIBBUCHPROT(YM,VOR,1))
	. . SET $PIECE(VOR1,Y,6)=+$HOROLOG
	. . SET $PIECE(VOR1,Y,7)=$PIECE($HOROLOG,",",2)
	. . SET $PIECE(VOR1,Y,8)=YBED
	. . DO ^WWWSKILL("INFIBBUCHPROT",VOR,1)
	. . SET ^INFIBBUCHPROT(YM,VOR,1)=VOR1
	. . DO ^WWWSSORT("INFIBBUCHPROT",VOR)
	. . QUIT
	. KILL ^CacheTempWWWSOR(YUSER)
	. QUIT
	QUIT
]]></Routine>
</Export>