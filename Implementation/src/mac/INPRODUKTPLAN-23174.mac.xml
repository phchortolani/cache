<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="22" zv="CACHE" ts="2001-01-01 00:00:00">
<Routine name="INPRODUKTPLAN" type="MAC" languagemode="0" timestamp="58440,0"><![CDATA[
INPRODUKTPLAN(YKEY)
	;-------------------------------------------------------------------------------
	; Description of Function :
	;		PRODUKTIONSPLAN
	;
	; Inputs : 
	;
	;
	; ByRef :
	;
	;
	; Returns :
	;
	;
	; History :
	; 04-Sep-2006	GRF		Doco; quits; braces
	; 18.02.2004	FIS
	;-------------------------------------------------------------------------------
	NEW ART,AUF,POS,TEIL,YDDSATZ,YFELD,ARTT,SUCH,PARENT,EBENE,YI,TEILEKEY,SUM,ANZM,LINK,YFELD1,ARTANZ,ZUSATZ
	
	SET YKEY=$GET(YKEY)
	IF $GET(YKEY)="" WRITE $$^WWWTEXT(32292) QUIT  ;BITTE PRÜFEN ;please sift 
	DO ^WWWUP(0)
	WRITE YCR,"<B>"
	WRITE $$^WWWTEXT(33762)  ;PRODUKTIONSPLAN ;production budget 
	WRITE "&nbsp;"
	WRITE YCR,"</B>"
	SET YDDSATZ=1
	SET ANZM=0
	DO START1^WWWTAB
	DO NL^WWWTAB
	FOR YI=4,"P3",5,45,70,15,43,47,53,14,174 DO
	. DO NHSTYLE^WWWTAB("text-align:center; font-size:8pt; font-weight:bold;")
	. IF YI=4  WRITE $$^WWWFELDNAME("INAUFPT","D",4)_" - "_$$^WWWFELDNAME("INAUFPT","D",1)
	. IF YI=15 WRITE $EXTRACT($$^WWWFELDNAME("INAUFPT","D",15))_" / "_$EXTRACT($$^WWWFELDNAME("INAUFPT","D",16))_" / "_$EXTRACT($$^WWWFELDNAME("INAUFPT","D",17))
	. IF +YI'=0 IF YI'=4 IF YI'=15 WRITE $$^WWWFELDNAME("INAUFPT","D",YI)
	. IF $EXTRACT(YI)="P"          WRITE $$^WWWFELDNAME("INAUFPT","P",$EXTRACT(YI,2))
	. WRITE "&nbsp;"
	. DO EH^WWWTAB
	
	DO EL^WWWTAB
	FOR YI=43,45,47,70 SET SUM(YI)=0  ;SUMMEN 
	IF '$FIND(YKEY,",") IF $DATA(^INART(YM,YKEY)) DO
	. SET ART=YKEY
	. DO ARTIKEL
	
	IF $FIND(YKEY,",") DO
	. SET AUF=$PIECE(YKEY,",",1)
	. SET POS=$PIECE(YKEY,",",2)
	. IF AUF'="" IF POS'="" IF $DATA(^INAUFP(YM,AUF,POS)) DO
	. . WRITE "<B>"_$$^WWWTEXT(32047)_": "_AUF_"-"_POS_"</B>"  ;AUFTRAG
	. . DO AUFTRAG
	. ;
	. IF AUF'="" IF POS'="" IF $DATA(^INANGP(YM,AUF,POS)) DO
	. . WRITE "<B>"_$$^WWWTEXT(32178)_": "_AUF_"-"_POS_"</B>"  ;ANGEBOT
	. . DO ANGEBOT
	
	IF ANZM=0 {
		SET EBENE=0,YFELD="",PARENT=""
		DO LIST
	}
	
	DO NL^WWWTAB  ;SUMME ;sum 
	FOR YI=4,"P3",5,45,70,15,43,47,53,14,174 DO
	. DO NHSTYLE^WWWTAB("text-align:right; font-size:8pt; font-weight:bold;")
	. IF YI=43 DO
	. . NEW LENGTH
	. . SET LENGTH=$LENGTH($PIECE(SUM(43),".",2))
	. . IF LENGTH>2 SET LENGTH=2
	. . WRITE $$^WWWZAHL(SUM(43),0,LENGTH)
	. ;
	. IF YI=45 WRITE $$^WWWTIME($JUSTIFY(SUM(45),0,0))
	. IF YI=47 WRITE $$^WWWZAHL(SUM(47),0,2)
	. IF YI=70 WRITE $$^WWWTIME(SUM(70))
	. WRITE "&nbsp;"
	. DO EH^WWWTAB
	
	DO EL^WWWTAB
	DO STOP^WWWTAB
	; 34091 : "Item Has Additional Costs (Per Lot Size)"                      ;artikel enthält Zusatzkosten
	; 34092 : "Additional Costs Will Be Calculated At The Past Calculation"   ;Zusatzkosten WERDEN ERST DURCH DIE KALKULATION NEU BERECHNET
	IF +$GET(ZUSATZ(1))'=0 {
		WRITE YCR,"<font size=2 color="_YRED_">"
		WRITE YCR,"&nbsp;*&nbsp;"_$$^WWWTEXT(34091)
		IF ZUSATZ(1)=2 WRITE "<BR>&nbsp;&nbsp;&nbsp;"_$$^WWWTEXT(34092)
		WRITE YCR,"</font>"
		WRITE YCR,"<BR><BR>"
	}
	
	DO ^WWWUP(1)
	QUIT
	
ARTIKEL	;ANZEIGEN ARTIKELSTRUKTUR ;display 
	;+++++++++++++++++++++++++++++++++++++++
	;	SUCH		objINARTXL		Item Masterfile BOM
	;	YFELD		objINART		Item Masterfile
	;+++++++++++++++++++++++++++++++++++++++
	
	SET SUCH="^INARTXL("_""""_YM_""""_","_""""_ART_""""
	SET SUCH=SUCH_")"
	SET ARTANZ=1
	SET ZUSATZ=0
	DO
	. SET YFELD=$GET(^INART(YM,ART,1))
	. SET $PIECE(YFELD,Y,4)=ART
	. SET SUM(43)=$PIECE(YFELD,Y,43)
	. SET SUM(47)=$PIECE(YFELD,Y,47)
	. SET SUM(45)=$PIECE(YFELD,Y,45)
	. SET SUM(70)=$PIECE(YFELD,Y,70)
	. SET $PIECE(YFELD,Y,39)=""
	. SET EBENE=0
	. SET PARENT=1
	. IF +$PIECE(YFELD,Y,74)'=0 SET ZUSATZ=1
	. IF +$PIECE(YFELD,Y,75)'=0 SET ZUSATZ=1
	. SET ZUSATZ(ZUSATZ)=1
	. SET LINK=YAKTION_"EP=WWWFORM&YFORM=INART&YKEY="_ART
	. DO LIST
	
	FOR  DO  QUIT:SUCH=""
	. SET SUCH=$QUERY(@SUCH)
	. IF $TRANSLATE($PIECE(SUCH,",",2),"""")'=$TRANSLATE(ART,"""") SET SUCH=""  QUIT  ;FALSCHER ARTIKEL ;item 
	. SET PARENT=0
	. SET EBENE=$LENGTH($PIECE(SUCH,",",3,99),",")
	. SET TEILEKEY1=$TRANSLATE($PIECE(SUCH,",",3,99),",)","..")  ;TEILEKEY
	. SET YFELD1=@SUCH
	. QUIT:$PIECE(YFELD1,Y,4)=""
	. SET ZUSATZ=0
	. SET YFELD=$GET(^INART(YM,$PIECE(YFELD1,Y,4),1))
	. SET $PIECE(YFELD,Y,4)=$PIECE(YFELD1,Y,4)
	. SET $PIECE(YFELD,Y,5)=$PIECE(YFELD1,Y,5)
	. IF +$PIECE(YFELD,Y,5)=0 SET $PIECE(YFELD,Y,5)=1
	. IF $FIND(",2,10,11,",","_$PIECE(YFELD,Y,40)_",") IF +$PIECE(YFELD1,Y,45)'=0 SET $PIECE(YFELD,Y,5)=1  ;AUSFÜHRUNGSZEIT ;execution time
	. SET $PIECE(YFELD,Y,39)=$PIECE(YFELD1,Y,5)    ;MENGE   ;quantity 
	. IF +$PIECE(YFELD,Y,39)=0 SET $PIECE(YFELD,Y,39)=1 
	. SET $PIECE(YFELD,Y,45)=$PIECE(YFELD1,Y,45)   ;AUSFÜHRUNGSZEIT ;execution time 
	. SET $PIECE(YFELD,Y,43)=($PIECE(YFELD,Y,43)*$PIECE(YFELD,Y,39))  ;GEWICHT ;wt. 
	. SET $PIECE(YFELD,Y,70)=$PIECE(YFELD1,Y,70)   ;RÜSTZEIT ;setup time 
	. SET $PIECE(YFELD,Y,47)=$PIECE(YFELD1,Y,47)   ;HERSTELLKOSTEN
	. IF $PIECE(YFELD1,Y,1)'=""  SET $PIECE(YFELD,Y,1)=$PIECE(YFELD1,Y,1)    ;BENENNUNG
	. IF $PIECE(YFELD1,Y,53)'="" SET $PIECE(YFELD,Y,53)=$PIECE(YFELD1,Y,53)  ;PRODUKTIONSANWEISUNG
	. IF $PIECE(YFELD1,Y,18)'="" SET $PIECE(YFELD,Y,18)=$PIECE(YFELD1,Y,18)  ;ZEICHNUNGSPOSITION
	. IF $DATA(@SUCH)=11 SET PARENT=1
	. IF +$PIECE(YFELD1,Y,74)'=0 SET ZUSATZ=1
	. IF +$PIECE(YFELD1,Y,75)'=0 SET ZUSATZ=1
	. SET ZUSATZ(ZUSATZ)=1
	. SET LINK=YAKTION_"EP=WWWFORM&YFORM=INART&YKEY="_$PIECE(YFELD1,Y,4)
	. SET ARTANZ=1
	. DO LIST
	
	QUIT
	
AUFTRAG	;ANZEIGEN AUFTRAGSPOSITION ;display 
	;+++++++++++++++++++++++++++++++++++++++
	;	SUCH		objINAUFPXL		Order Line BOM
	;	YFELD		objINAUFP		Order Line
	;+++++++++++++++++++++++++++++++++++++++
	
	SET SUCH="^INAUFPXL("_""""_YM_""""_","_""""_AUF_""""_","_POS
	SET SUCH=SUCH_")"
	SET ZUSATZ=0
	DO
	. SET YFELD=$GET(^INAUFP(YM,AUF,POS,1))
	. SET SUM(43)=$PIECE(YFELD,Y,43)
	. SET SUM(47)=$PIECE(YFELD,Y,47)
	. SET SUM(70)=$PIECE(YFELD,Y,70)
	. IF +$PIECE(YFELD,Y,74)'=0 SET ZUSATZ=1
	. IF +$PIECE(YFELD,Y,75)'=0 SET ZUSATZ=1
	. SET $PIECE(YFELD,Y,39)=$PIECE(YFELD,Y,5)
	. IF $DATA(^INAUFPTEXTRA(YM,AUF,POS,0)) SET ZUSATZ=1
	. SET ZUSATZ(ZUSATZ)=2
	. SET EBENE=0
	. SET PARENT=1
	. SET TEILEKEY1=POS_"."
	. SET LINK=YAKTION_"EP=WWWFORM&YFORM=INAUFP&YKEY="_AUF_","_POS
	. DO LIST
	
	FOR  DO  QUIT:SUCH=""
	. SET SUCH=$QUERY(@SUCH)
	. IF $TRANSLATE($PIECE(SUCH,",",2),"""")'=AUF SET SUCH="" QUIT  ;21.06.04;FAN;25794; WENN alphanumerischen Auftragsnummern SOLL DATEN AUCH AUFBAUEN.
	. ;IF $PIECE(SUCH,",",2)'=AUF SET SUCH="" QUIT  ;21.06.04;FAN;25794; 
	. IF $PIECE(SUCH,",",3)'=POS SET SUCH=""  QUIT  ;FALSCHE POSITION
	. SET PARENT=0
	. SET EBENE=$LENGTH($PIECE(SUCH,",",3,99),",")
	. SET TEILEKEY1=$TRANSLATE($PIECE(SUCH,",",3,99),",)","..")  ;TEILEKEY
	. SET ARTT=$PIECE(@SUCH,Y,4)
	. QUIT:ARTT=""
	. SET YFELD=@SUCH
	. SET ZUSATZ=0
	. IF +$PIECE(YFELD,Y,5)=0  SET $PIECE(YFELD,Y,5)=1
	. IF +$PIECE(YFELD,Y,39)=0 SET $PIECE(YFELD,Y,39)=1
	. IF $PIECE(YFELD,Y,26)="" SET $PIECE(YFELD,Y,26)=$PIECE($GET(^INART(YM,ARTT,1)),Y,26)
	. ;IF $PIECE(YFELD,Y,26)=2 SET $PIECE(YFELD,Y,45)=($PIECE(YFELD,Y,45)/$PIECE(YFELD,Y,5)*$PIECE(YFELD,Y,39))  ;AUSFÜHRUNGSZEIT ;execution time 
	. SET $PIECE(YFELD,Y,45)=($PIECE(YFELD,Y,45)/$PIECE(YFELD,Y,5)*$PIECE(YFELD,Y,39))  ;AUSFÜHRUNGSZEIT ;execution time 
	. ;;IF $PIECE(YFELD,Y,26)=2 SET $PIECE(YFELD,Y,45)=($PIECE(YFELD,Y,45)*$PIECE(YFELD,Y,39))  ;AUSFÜHRUNGSZEIT
	. ;;IF $PIECE(YFELD,Y,26)'=2 SET $PIECE(YFELD,Y,45)=($PIECE(YFELD,Y,45)*$PIECE(YFELD,Y,5))  ;AUSFÜHRUNGSZEIT
	. SET $PIECE(YFELD,Y,43)=($PIECE(YFELD,Y,43)*$PIECE(YFELD,Y,39))  ;GEWICHT ;wt. 
	. IF $DATA(@SUCH)=11 SET PARENT=1
	. IF +$PIECE(YFELD,Y,74)'=0 SET ZUSATZ=1
	. IF +$PIECE(YFELD,Y,75)'=0 SET ZUSATZ=1
	. IF $DATA(^INAUFPTEXTRA(YM,AUF,POS,$PIECE(TEILEKEY1,".",2,99))) SET ZUSATZ=1
	. SET ZUSATZ(ZUSATZ)=2
	. SET LINK=YAKTION_"EP=WWWFORM&YFORM=INAUFPT&YKEY="_AUF_","_POS_","_$PIECE(TEILEKEY1,".",2,99)
	. DO LIST
	
	QUIT
	
ANGEBOT 	;ANZEIGEN AUFTRAGSPOSITION ;display 
	;+++++++++++++++++++++++++++++++++++++++
	;	SUCH		objINANGPXL		Quote Line BOM
	;	YFELD		objINANGP		Quote Line
	;+++++++++++++++++++++++++++++++++++++++
	
	SET SUCH="^INANGPXL("_""""_YM_""""_","_""""_AUF_""""_","_POS
	SET SUCH=SUCH_")"
	SET ZUSATZ=0
	DO
	. SET YFELD=$GET(^INANGP(YM,AUF,POS,1))
	. SET SUM(43)=$PIECE(YFELD,Y,43)
	. SET SUM(47)=$PIECE(YFELD,Y,47)
	. SET SUM(70)=$PIECE(YFELD,Y,70)
	. IF +$PIECE(YFELD,Y,74)'=0 SET ZUSATZ=1
	. IF +$PIECE(YFELD,Y,75)'=0 SET ZUSATZ=1
	. SET $PIECE(YFELD,Y,39)=$PIECE(YFELD,Y,5)
	. SET ZUSATZ(ZUSATZ)=2
	. SET EBENE=0
	. SET PARENT=1
	. SET TEILEKEY1=POS_"."
	. SET LINK=YAKTION_"EP=WWWFORM&YFORM=INANGP&YKEY="_AUF_","_POS
	. DO LIST
	
	FOR  DO  QUIT:SUCH=""
	. SET SUCH=$QUERY(@SUCH)
	. IF $TRANSLATE($PIECE(SUCH,",",2),"""")'=AUF SET SUCH=""  QUIT  ;FALSCHER AUFTRAG ;order 
	. IF $PIECE(SUCH,",",3)'=POS SET SUCH=""  QUIT  ;FALSCHE POSITION
	. SET PARENT=0
	. SET EBENE=$LENGTH($PIECE(SUCH,",",3,99),",")
	. SET TEILEKEY1=$TRANSLATE($PIECE(SUCH,",",3,99),",)","..")  ;TEILEKEY
	. SET ARTT=$PIECE(@SUCH,Y,4)
	. QUIT:ARTT=""
	. SET YFELD=@SUCH
	. SET ZUSATZ=0
	. IF +$PIECE(YFELD,Y,5)=0  SET $PIECE(YFELD,Y,5)=1
	. IF +$PIECE(YFELD,Y,39)=0 SET $PIECE(YFELD,Y,39)=1
	. IF $PIECE(YFELD,Y,26)="" SET $PIECE(YFELD,Y,26)=$PIECE($GET(^INART(YM,ARTT,1)),Y,26)
	. ;IF $PIECE(YFELD,Y,26)=2 SET $PIECE(YFELD,Y,45)=($PIECE(YFELD,Y,45)/$PIECE(YFELD,Y,5)*$PIECE(YFELD,Y,39))  ;AUSFÜHRUNGSZEIT;FIS:16.08.04;26268 ;execution time 
	. SET $PIECE(YFELD,Y,45)=($PIECE(YFELD,Y,45)/$PIECE(YFELD,Y,5)*$PIECE(YFELD,Y,39))  ;AUSFÜHRUNGSZEIT;FIS:16.08.04;26268 ;execution time 
	. ;;IF $PIECE(YFELD,Y,26)=2 SET $PIECE(YFELD,Y,45)=($PIECE(YFELD,Y,45)*$PIECE(YFELD,Y,39))  ;AUSFÜHRUNGSZEIT
	. ;;IF $PIECE(YFELD,Y,26)'=2 SET $PIECE(YFELD,Y,45)=($PIECE(YFELD,Y,45)*$PIECE(YFELD,Y,5))  ;AUSFÜHRUNGSZEIT
	. SET $PIECE(YFELD,Y,43)=($PIECE(YFELD,Y,43)*$PIECE(YFELD,Y,39))  ;GEWICHT ;wt. 
	. IF $DATA(@SUCH)=11 SET PARENT=1
	. IF +$PIECE(YFELD,Y,74)'=0 SET ZUSATZ=1
	. IF +$PIECE(YFELD,Y,75)'=0 SET ZUSATZ=1
	. SET ZUSATZ(ZUSATZ)=2
	. SET LINK=YAKTION_"EP=WWWFORM&YFORM=INANGPT&YKEY="_AUF_","_POS_","_$PIECE(TEILEKEY1,".",2,99)
	. ;IF PARENT'=1 IF $PIECE(YFELD,Y,26)'=2 QUIT
	. DO LIST
	
	QUIT
	
LIST  ;ANZEIGEN WERTE ;display 
	NEW ROWID,TEILE
	
	SET ANZM=ANZM+1
	SET TEILEKEY1=$GET(TEILEKEY1)
	SET ROWID=TEILEKEY1
	IF $EXTRACT($REVERSE(ROWID))="." SET ROWID=$REVERSE($EXTRACT($REVERSE(ROWID),2,999))
	DO
	. ;ARTIKEL ;item 
	. DO NL^WWWTAB
	. DO NFSTYLE^WWWTAB("text-align:left; font-size:8pt; overflow:hidden;",$TRANSLATE(ROWID,".","_"))
	. IF EBENE'=0 FOR YI=1:1:EBENE WRITE "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"
	. IF EBENE=0  WRITE "&nbsp;"
	. IF EBENE'=0 WRITE "<font face=arial><i>|_</i></font>&nbsp;"
	. ;
	. SET SUCH2=SUCH  ;SUCHEN UNTERTEILE ;seek 
	. FOR  DO  QUIT:SUCH2=""
	. . SET SUCH2=$QUERY(@SUCH2)
	. . IF $EXTRACT($TRANSLATE(SUCH2,""""),1,$LENGTH($TRANSLATE(SUCH,""""))-1)'=$EXTRACT($TRANSLATE(SUCH,""""),1,$LENGTH($TRANSLATE(SUCH,""""))-1) SET SUCH2="" QUIT
	. . SET TEILEKEY2=$TRANSLATE($PIECE(SUCH2,",",3,99),",)","..")  ;TEILEKEY2
	. . IF $LENGTH(TEILEKEY2,".")>($LENGTH(TEILEKEY1,".")+1) QUIT
	. . IF $EXTRACT($REVERSE(TEILEKEY2))="." SET TEILEKEY2=$REVERSE($EXTRACT($REVERSE(TEILEKEY2),2,999))
	. . QUIT:$TRANSLATE(TEILEKEY2,".")=""
	. . SET TEILE($TRANSLATE(TEILEKEY2,".","_"))=""
	. ;
	. WRITE YCR,"<A HREF="_""""_LINK
	. DO
	. . NEW YKEY,YFORM,YBACK
	. . DO ^WWWCGI
	. ;
	. WRITE """"
	. WRITE " TARGET="_""""_YTARGET_""""
	. WRITE " TITLE="_""""_$$^WWWTEXT(374)_""""  ;DATENSATZ BEARBEITEN ;data record 
	. IF PARENT=1 DO
	. . WRITE YCR," onmouseover="_""""
	. . ;IF ROWID'="" WRITE YCR," document.getElementById('"_$TRANSLATE(ROWID,".","_")_"').style.color='orangered';"
	. . SET TEILEKEY2="" FOR  SET TEILEKEY2=$ORDER(TEILE(TEILEKEY2)) QUIT:TEILEKEY2=""  WRITE YCR," document.getElementById('"_TEILEKEY2_"').style.color='orangered';"
	. . WRITE """"_YCR_" onmouseout="_""""
	. . ;IF ROWID'="" WRITE YCR," document.getElementById('"_$TRANSLATE(ROWID,".","_")_"').style.color='';"
	. . SET TEILEKEY2="" FOR  SET TEILEKEY2=$ORDER(TEILE(TEILEKEY2)) QUIT:TEILEKEY2=""  WRITE YCR," document.getElementById('"_TEILEKEY2_"').style.color='';"
	. . WRITE """"
	. ;
	. WRITE ">"
	. IF PARENT=1 WRITE "<B>"
	. WRITE $PIECE(YFELD,Y,4)
	. WRITE "&nbsp;-&nbsp;"
	. WRITE $EXTRACT($PIECE(YFELD,Y,1),1,25)
	. WRITE YCR,"</A>"
	. IF +$GET(ZUSATZ)'=0 WRITE "<font color="_YRED_">*</font>"
	. ;
	. WRITE "&nbsp;"
	. WRITE YCR
	. DO EF^WWWTAB
	. ;
	. ;UNTERTEIL
	. DO NFSTYLE^WWWTAB("text-align:left; font-size:8pt;")
	. IF PARENT=1 WRITE "<B>"
	. ;IF $GET(TEILEKEY1)'="" WRITE TEILEKEY1
	. IF $GET(ROWID)'="" DO
	. . NEW YKEY,YFORM,YBACK
	. . WRITE YCR,"<A HREF="_""""_LINK
	. . DO ^WWWCGI
	. . WRITE """"
	. . WRITE " TARGET="_""""_YTARGET_""""
	. . WRITE " TITLE="_""""_$$^WWWFELDNAME("INAUFPT","P",3)_": "_ROWID
	. . IF $PIECE(YFELD,Y,18)'="" WRITE YCR_$$^WWWFELDNAME("INAUFPT","D",18)_": "_$PIECE(YFELD,Y,18)  ;ZEICHNUNGSPOSITION
	. . WRITE """"  ;DATENSATZ BEARBEITEN ;data record 
	. . WRITE ">"
	. . WRITE ROWID
	. . IF $PIECE(YFELD,Y,18)'="" WRITE " ("_$PIECE(YFELD,Y,18)_")"
	. . WRITE "</A>"
	. ;
	. WRITE "&nbsp;"
	. WRITE YCR
	. DO EF^WWWTAB
	. ;
	. ;MENGE / EINHEIT ;quantity unit 
	. DO NFSTYLE^WWWTAB("text-align:right; font-size:8pt;")
	. IF PARENT=1 WRITE "<B>"
	. ;IF $PIECE(YFELD,Y,26)'=2 IF +EBENE'=0 WRITE $$^WWWZAHL($PIECE(YFELD,Y,39),0,$LENGTH($PIECE($PIECE(YFELD,Y,39),".",2)))
	. IF $PIECE(YFELD,Y,26)'=2 IF +$PIECE(YFELD,Y,39)'=0 WRITE $$^WWWZAHL($PIECE(YFELD,Y,39),0,$LENGTH($PIECE($PIECE(YFELD,Y,39),".",2)))
	. WRITE "&nbsp;"
	. IF $PIECE(YFELD,Y,40)'="" DO
	. . ;WRITE $PIECE($GET(^WWW101(0,"EINHEIT",SPRACHE,$PIECE(YFELD,Y,40),1)),Y,1)
	. . WRITE $PIECE($GET(^WWW101(0,"EINHEIT",SPRACHE,$PIECE(YFELD,Y,40),1)),Y,1)    ;BEC;25866;07.06.04;DA ZENTRALE DATEI
	. . WRITE "&nbsp;"
	. ;
	. WRITE YCR
	. DO EF^WWWTAB
	. ;
	. ;DAUER ;duration 
	. DO NFSTYLE^WWWTAB("text-align:right; font-size:8pt;")
	. IF PARENT=1 WRITE "<B>"
	. IF EBENE'=0 DO
	. . IF +$PIECE(YFELD,Y,45)'=0 WRITE $$^WWWTIME($PIECE(YFELD,Y,45))
	. . QUIT:$GET(ARTANZ)=1
	. . IF $PIECE(YFELD,Y,26)=2 IF PARENT'=1 SET SUM(45)=(SUM(45)+$PIECE(YFELD,Y,45))
	. ;
	. WRITE "&nbsp;"
	. WRITE YCR
	. DO EF^WWWTAB
	. ;
	. ;RÜSTZEIT ;setup time 
	. DO NFSTYLE^WWWTAB("text-align:right; font-size:8pt;")
	. IF PARENT=1 WRITE "<B>"
	. IF EBENE'=0 DO
	. . IF +$PIECE(YFELD,Y,70)'=0 WRITE $$^WWWTIME($PIECE(YFELD,Y,70))
	. . ;IF $PIECE(YFELD,Y,26)=2 SET SUM(70)=SUM(70)+$PIECE(YFELD,Y,70)
	. . ;SET SUM(70)=SUM(70)+$PIECE(YFELD,Y,70)
	. . ;IF $PIECE(YFELD,Y,26)=2 SET SUM(70)=SUM(70)+($PIECE(YFELD,Y,70)*$$^INPROLOS($PIECE(YFELD,Y,4),$PIECE(YFELD,Y,39)))
	. ;
	. WRITE "&nbsp;"
	. WRITE YCR
	. DO EF^WWWTAB
	. ;
	. ;MASSE L/B/H ;shoal 
	. DO NFSTYLE^WWWTAB("text-align:right; font-size:8pt;")
	. IF PARENT=1 WRITE "<B>"
	. IF +EBENE'=0 DO
	. . NEW MASS
	. . FOR MASS=15,16,17 DO
	. . . WRITE $$^WWWZAHL($PIECE(YFELD,Y,MASS),0,$LENGTH($PIECE($PIECE(YFELD,Y,MASS),".",2)))
	. . . IF MASS'=17 WRITE "/"
	. ;
	. WRITE "&nbsp;"
	. WRITE YCR
	. DO EF^WWWTAB
	. ;
	. ;GEWICHT ;wt. 
	. DO NFSTYLE^WWWTAB("text-align:right; font-size:8pt;")
	. IF PARENT=1 WRITE "<B>"
	. IF +EBENE'=0 DO
	. . WRITE $$^WWWZAHL($PIECE(YFELD,Y,43),0,$LENGTH($PIECE($PIECE(YFELD,Y,43),".",2)))
	. . ;IF PARENT'=1 SET SUM(43)=SUM(43)+$PIECE(YFELD,Y,43)
	. ;
	. WRITE "&nbsp;"
	. WRITE YCR
	. DO EF^WWWTAB
	. ;
	. ;HERSTELLKOSTEN
	. DO NFSTYLE^WWWTAB("text-align:right; font-size:8pt;")
	. IF PARENT=1 WRITE "<B>"
	. ;IF +$PIECE(YFELD,Y,5)=0 SET $PIECE(YFELD,Y,5)=1
	. IF +EBENE'=0 WRITE $$^WWWZAHL($PIECE(YFELD,Y,47)/$PIECE(YFELD,Y,5)*$PIECE(YFELD,Y,39),0,2)
	. ;IF +EBENE'=0 WRITE $$^WWWZAHL($PIECE(YFELD,Y,47),0,2)
	. ;IF PARENT'=1 SET SUM(47)=SUM(47)+$PIECE(YFELD,Y,47)
	. WRITE "&nbsp;"
	. WRITE YCR
	. DO EF^WWWTAB
	. ;
	. ;PRODUKTIONSANWEISUNG
	. DO NFSTYLE^WWWTAB("text-align:left; font-size:8pt;")
	. IF PARENT=1 WRITE "<B>"
	. IF $TRANSLATE($PIECE(YFELD,Y,53),"| ")'="" DO
	. . NEW YKEY,YFORM,YBACK
	. . WRITE YCR,"<A HREF="_""""_LINK
	. . DO ^WWWCGI
	. . WRITE """"
	. . WRITE " TARGET="_""""_YTARGET_""""
	. . WRITE " TITLE="_""""_$$^WWWTRANSLATE($PIECE(YFELD,Y,53),"|",YCR)_""""  ;DATENSATZ BEARBEITEN ;data record 
	. . WRITE ">"
	. . WRITE $EXTRACT($PIECE($PIECE(YFELD,Y,53),"|",1),1,15)
	. . WRITE "</A>"
	. ;
	. WRITE "&nbsp;"
	. WRITE YCR
	. DO EF^WWWTAB
	. ;
	. ;AUSFÜHRUNGSTEXT
	. DO NFSTYLE^WWWTAB("text-align:left; font-size:8pt;")
	. IF PARENT=1 WRITE "<B>"
	. IF $TRANSLATE($PIECE(YFELD,Y,14),"| ")'="" DO
	. . NEW YKEY,YFORM,YBACK
	. . WRITE YCR,"<A HREF="_""""_LINK
	. . DO ^WWWCGI
	. . WRITE """"
	. . WRITE " TARGET="_""""_YTARGET_""""
	. . WRITE " TITLE="_""""_$$^WWWTRANSLATE($PIECE(YFELD,Y,14),"|",YCR)_""""  ;DATENSATZ BEARBEITEN ;data record 
	. . WRITE ">"
	. . WRITE $EXTRACT($PIECE($PIECE(YFELD,Y,14),"|",1),1,15)
	. . WRITE "</A>"
	. ;
	. WRITE "&nbsp;"
	. WRITE YCR
	. DO EF^WWWTAB
	. ;
	. ;QUALITÄTSKONTROLLE ;quality control 
	. DO NFSTYLE^WWWTAB("text-align:left; font-size:8pt;")
	. IF PARENT=1 WRITE "<B>"
	. IF $PIECE(YFELD,Y,174)'="" DO
	. . NEW YKEY,YFORM,YBACK
	. . WRITE YCR,"<A HREF="_""""_LINK
	. . DO ^WWWCGI
	. . WRITE """"
	. . WRITE " TARGET="_""""_YTARGET_""""
	. . WRITE " TITLE="_""""_$$^WWWTRANSLATE($PIECE($GET(^INQPRUEF(YM,YLOCATION,$PIECE(YFELD,Y,174),1)),Y,3),"|",YCR)_""""  ;DATENSATZ BEARBEITEN ;data record 
	. . WRITE ">"
	. . WRITE $PIECE($GET(^INPARA(YM,"QMPARA",SPRACHE,$PIECE(YFELD,Y,174),1)),Y,1)
	. . WRITE "</A>"
	. ;
	. WRITE "&nbsp;"
	. WRITE YCR
	. DO EF^WWWTAB
	
	QUIT
]]></Routine>
</Export>