<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="22" zv="CACHE" ts="2001-01-01 00:00:00">
<Routine name="INDRUCKEDIP6R" type="MAC" languagemode="0" timestamp="58440,0"><![CDATA[
INDRUCKEDIP6R ;INDRUCKEDIP6R;DT;DRUCKEN POSITION RELIESE EDI PRO;19.02.2002
	;
	;/------------------------------------------------------------------\
	;| Description of Function :
	;|		DRUCKEN POSITION RELIESE EDI PRO
	;|
	;| Inputs : 
	;|
	;|
	;| ByRef :
	;|
	;|
	;| Returns :
	;|
	;|
	;| History :
	;|
	;| DT	19.02.2002
	;|
	;\------------------------------------------------------------------/
	;
	;VON ^INDRUCK6
	;DRUCKEN DER POSITION RELIESE ;print the 
	QUIT:$PIECE(YBELEG1,Y,187)=1  ;POSITIONEN NICHT DRUCKEN ;Not print 
	NEW ANZR
	SET ANZR=0  ;ANZAHL RELEASES ;Number 
	SET YEKK=$GET(^INAUFPK(YM,YAUFTRAG,POS,1))  ;EK KONDITION ;Planned Cost 
	IF +$PIECE(YBELEG1,Y,42)=0 IF +$PIECE(YBELEG1,Y,44)=0 IF +$PIECE(YBELEG1,Y,46)=0 IF +$PIECE(YBELEG1,Y,48)=0 IF +$PIECE(YBELEG1,Y,50)=0 IF +$PIECE(YBELEG1,Y,52)=0 IF +$PIECE(YBELEG1,Y,54)=0 IF +$PIECE(YBELEG1,Y,56)=0 IF +$PIECE(YBELEG1,Y,58)=0 QUIT  ;KEINE POSITIONEN AUSGEGEN ;no 
	SET REL="" FOR  SET REL=$ORDER(^INAUFPREL(YM,YAUFTRAG,POS,REL)) QUIT:REL=""  DO
	. SET REL1=$GET(^INAUFPREL(YM,YAUFTRAG,POS,REL,1))    ;GANZ DATENSATZ ;wholly data record 
	. SET ANZR=ANZR+1
	. ;
	. SET BLANKS=0   ;ZUSATZBLANKS WEGEN HTML TAG ;quibble HTML TAG 
	. ;RELEASE NR
	. SET YA(1)=$PIECE(YBELEG1,Y,40)  ;DRUCK 0/1 ;printing 
	. IF YA(1)=1 DO  ;ANZEIGEN ;give notice  ;display 
	. . SET YA(3)=POS_"."_REL  ;  Z.B.--->  2.4
	. . ;DO EDIP^INDRUCK("PO1*"_YA(3))  ;RELEASE
	. . SET YA(33)=YA(3)  ;POS.REF (1)
	. . QUIT
	. ;
	. ;MENGE ;quantum  ;quantity 
	. SET YA(1)=$PIECE(YBELEG1,Y,54)  ;DRUCK 0/1 ;printing 
	. IF YA(1)=1 DO  ;ANZEIGEN ;give notice  ;display 
	. . NEW ME
	. . SET ME=""
	. . IF $PIECE(YBELEG1,Y,44)=1 DO  ;ANZEIGEN MENGENEINHEIT ;display 
	. . . ;QUIT:$PIECE(POS1,Y,40)=""
	. . . ;SET ME=$PIECE($GET(^WWW101(0,"EINHEIT",SPRACHE,$PIECE(POS1,Y,40),1)),Y,1)  ;MENGENEINHEIT
	. . . SET ME=$PIECE(POS1,Y,40)  ;MENGENEINHEIT
	. . . IF +ME=0!(ME=1) SET ME="EA"  ;DFLT: STÃœCK ;spare part 
	. . . QUIT
	. . SET YA(3)=$PIECE(REL1,Y,1) 
	. . IF +$PIECE(YEKK,Y,41)'=0 SET $PIECE(REL1,Y,1)=+J($PIECE(REL1,Y,1)*$PIECE(YEKK,Y,41),0,2)  ;TYBD;9.5.2003  ;UMRECHNUNGSFAKTOR BESTELLEINHEIT
	. . IF $FIND($PIECE(REL1,Y,1),".") SET YA(3)=$PIECE(REL1,Y,1)
	. . IF '$FIND($PIECE(REL1,Y,1),",") IF '$FIND($PIECE(REL1,Y,1),".") SET YA(3)=$PIECE(REL1,Y,1)
	. . ;DO EDIP^INDRUCK("*"_YA(3)_"*"_ME)   ;MENGE
	. . SET YA(33)=YA(33)_"*"_YA(3)_"*"_ME  ;*MENGE*EINHEIT  (2-3)
	. . QUIT
	. ;
	. SET YA(1)=$PIECE(YBELEG1,Y,56)  ;DRUCK 0/1 ;printing 
	. DO  ;IF YA(1)=1 DO  ;ANZEIGEN ;display 
	. . NEW PREIS
	. . ;EINZELPREIS
	. . SET PREIS=+$PIECE(REL1,Y,30)
	. . IF +$PIECE(REL1,Y,1)'=0 SET PREIS=PREIS/$PIECE(REL1,Y,1)
	. . QUIT:+PREIS=0
	. . SET YA(3)=$$^WWWZAHL(PREIS,10,2,YWHR)
	. . ;DO EDIP^INDRUCK("*"_YA(3))   ;PREIS
	. . SET YA(33)=YA(33)_"*"_YA(3)  ;*PREIS (4)
	. ;
	. SET YA(33)=YA(33)_"*PE"  ;*PE (5)
	. SET YA(33)=YA(33)_"*UI"  ;*UI (6)
	. SET YA(33)=YA(33)_"*"  ;*UPC CODE (?) (7)
	. SET YA(33)=YA(33)_"*BP*"_$PIECE(POS1,Y,4)  ;*BUYERS PARTNUMBER(QUALIFIER)*PART NUMBER (8-9)
	. SET YA(33)=YA(33)_"*VC*"_$PIECE(YEKK,Y,41)  ;*VENDOR CODE(?)*VENDOR PART NUMBER (10-11)
	. DO EDIP^INDRUCK("PO1*"_YA(33))   ;ZEILE POSITION
	. ;
	. ;ARTIKELBZEICHNUNG
	. DO EDIP^INDRUCK("PID*F****"_$PIECE(POS1,Y,1))  ;ITEM DESCRIPTION
	. ;
	. ;
	. ;ZUSATZTEXT/LIEFERANSCHRIFT AUF BESTELLUNG ;upon sales order 
	. DO
	. . NEW ADR,ADR2,YN
	. . SET ADR=""
	. . IF $PIECE(REL1,Y,4)="" IF $PIECE(REL1,Y,6)="" IF $PIECE(REL1,Y,7)="" IF $PIECE(REL1,Y,10)="" IF $PIECE(REL1,Y,10)="" QUIT
	. . FOR YI=4,6,7,10,12,14,16,17,20,21,22,24 SET $PIECE(ADR,Y,YI)=$PIECE(REL1,Y,YI)
	. . QUIT:$TRANSLATE(ADR,Y)=""
	. . SET YA(3)=$$^INADRES(ADR,0,1)  ;PLZ NACH ORT ;ZIP within village 
	. . IF $TRANSLATE($PIECE(ADR,Y,17)," ")'="" DO  ;LAND (NUR WENN NICHT WIE LIEFERANT) ;rural when Not such as 
	. . . NEW AUSLAND
	. . . SET AUSLAND=0
	. . . IF $PIECE(YADRES,Y,17)="" QUIT
	. . . IF $PIECE(YADRES,Y,17)'=$PIECE($GET(^WWW0121(0,YM,YLOCATION,1)),Y,17) SET AUSLAND=1  ;AUSLAND ;foreign country 
	. . . IF $PIECE(YADRES,Y,17)'=$PIECE(ADR,Y,17) SET AUSLAND=1  ;AUSLAND ;foreign country 
	. . . QUIT:AUSLAND=0
	. . . SET YA(3)=YA(3)_$PIECE($GET(^WWW100(0,"LAND",SPRACHE,$PIECE(ADR,Y,17),1)),Y,1)_"|"
	. . . QUIT
	. . SET YA(3)=$TRANSLATE(YA(3),"|",",")
	. . IF $EXTRACT($REVERSE(YA(3)))="," SET YA(3)=$REVERSE($EXTRACT($REVERSE(YA(3)),2,99))
	. . SET YA(3)=$$^WWWTEXT(32843)_": "_YA(3)_" "  ;LIEFERANSCHRIFT
	. . IF $PIECE(REL1,Y,2)'="" SET YA(3)=YA(3)_$$^WWWTEXT(32168)_": "_$$^WWWDATE($PIECE(REL1,Y,2))_" "     ;LIEFERTERMIN ;time of delivery 
	. . IF $PIECE(REL1,Y,35)'="" SET YA(3)=YA(3)_$$^WWWTEXT(32847)_": "_$PIECE(REL1,Y,35)_" "     ;REFERENZ ;reference 
	. . IF $PIECE(REL1,Y,31)'="" SET YA(3)=YA(3)_$$^WWWTEXT(32880)_": "_$PIECE(REL1,Y,31)_" "     ;QUOTE NR ;underwriting share 
	. . IF $PIECE(REL1,Y,40)'="" SET YA(3)=YA(3)_$$^WWWTEXT(125)_": "_$TRANSLATE($PIECE(REL1,Y,40),"|"," ")     ;BEMERKUNGEN
	. . DO EDIP^INDRUCK("MSG*"_$EXTRACT(YA(3),1,264))
	. . QUIT
	. ;
	. ;GESAMTPREIS
	. DO
	. . SET PREIS=+$PIECE(REL1,Y,30)
	. . QUIT:+PREIS=0
	. . DO EDIP^INDRUCK("SAC*C*F050***"_$$^WWWZAHL(PREIS,10,2,YWHR)_"*******06")  ;CHARGE AMOUNT TO BE PAID BY CUSTOMER
	. . QUIT
	. QUIT
	QUIT
]]></Routine>
</Export>