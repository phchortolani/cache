<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="22" zv="CACHE" ts="2001-01-01 00:00:00">
<Routine name="WWWDRAGDROP4" type="MAC" languagemode="0" timestamp="58440,0"><![CDATA[
WWWDRAGDROP4()	;WWWDRGDROP4;FIS;BEARBEITEN RETURNVALUE BEI DATENVERÄNDERUNG;28.08.2003  ; Compiled January 7, 2005 15:58:57
	;
	;/------------------------------------------------------------------\
	;| Description of Function :
	;|		BEARBEITEN RETURNVALUE BEI DATENVERÄNDERUNG
	;|
	;| Inputs : 
	;|
	;|
	;| ByRef :
	;|
	;|
	;| Returns :
	;|
	;|
	;| History :
	;|
	;| FIS	28.08.2003  
	;|
	;\------------------------------------------------------------------/
	;
	NEW KEY,SATZ,CHART,CHART1,SATZNEU,SATZALT,LEFT,TOP,ANZ,POSNEU,POSALT,DAUER,ARBSTUNDEN,NOCHANGE,UHRZEIT
	NEW COLUMNS,START,TIMESIZE,HEADLAENG,HEADSIZE,PIXEL,ARBSTUNDEN,BEGINN,STUNDE,YRETVAL,YHTMFORM,KEY2
	SET YRETVAL=""
	SET YHTMFORM="WWW"
	SET CHART=$GET(YCHART)
	IF CHART="" SET CHART=$GET(^WWWDATEN(YM,+$HOROLOG,YUSER,YFORM,"V","CHART",1))
	QUIT:CHART="" YRETVAL
	SET CHART1=$$VORG^WWWDRAGDROP(CHART)   ;VORGABEN CHART
	SET COLUMNS=$GET(^WWWDATEN(YM,+$HOROLOG,YUSER,YFORM,"V","COLUMNS",1))  ;SPALTEN ;split 
	SET START=$GET(^WWWDATEN(YM,+$HOROLOG,YUSER,YFORM,"V","TIMESCALE",1))  ;START ZEITSKALA ;take-off 
	SET TIMESIZE=$GET(^WWWDATEN(YM,+$HOROLOG,YUSER,YFORM,"V","TIMESIZE",1))  ;ANZAHL ANZEIGESTUNDEN PRO TAG ;Number within TAG 
	SET HEADLAENG=$GET(^WWWDATEN(YM,+$HOROLOG,YUSER,YFORM,"V","HEADLAENG",1))  ;ANZAHL LINKS FÜR BESCHREIBUNG ;Number on the left to description 
	SET HEADSIZE=$GET(^WWWDATEN(YM,+$HOROLOG,YUSER,YFORM,"V","HEADSIZE",1))  ;ANZAHL OBEN FÜR HEADER ;Number upstairs to 
	SET BUTTONLINE=$GET(^WWWDATEN(YM,+$HOROLOG,YUSER,YFORM,"V","BUTTONLINE",1))  ;HÖHE BUTTONLINE ;highness 
	SET PIXEL=$GET(^WWWDATEN(YM,+$HOROLOG,YUSER,YFORM,"V","PIXEL",1))  ;FELDGRÖSSE
	IF +PIXEL'>0 SET PIXEL=17
	SET ARBSTUNDEN=$GET(^WWWDATEN(YM,+$HOROLOG,YUSER,YFORM,"V","ARBSTUNDEN",1))  ;ARBEITSSTUNDEN PRO TAG ;within TAG 
	IF +ARBSTUNDEN=0 SET ARBSTUNDEN=8
	SET ARBBEGINN=$GET(^WWWDATEN(YM,+$HOROLOG,YUSER,YFORM,"V","ARBBEGINN",1))  ;ARBEITSBEGINN
	IF +ARBBEGINN=0 SET ARBBEGINN=$PIECE($GET(^INVORG(YM,YM,1)),Y,152)
	KILL ^WWWSOR(YUSER,"UPDATE")
	;DATENSÄTZE
	SET KEY="" FOR  SET KEY=$ORDER(^WWWDATEN(YM,+$HOROLOG,YUSER,YFORM,"V","DATEN",KEY)) QUIT:KEY=""  DO
	. SET SATZALT=$GET(^WWWDATEN(YM,+$HOROLOG,YUSER,YFORM,"V","DATEN",KEY,2))
	. SET SATZNEU=$GET(^WWWDATEN(YM,+$HOROLOG,YUSER,YFORM,"V","DATEN",KEY,1))
	. SET POSALT=$GET(^WWWDATEN(YM,+$HOROLOG,YUSER,YFORM,"V","X-REF",KEY,2))
	. SET POSNEU=$GET(^WWWDATEN(YM,+$HOROLOG,YUSER,YFORM,"V","X-REF",KEY,1))
	. IF $GET(YINUSE)'=1 IF $PIECE(KEY,"%s%",1)'=YKEY IF SATZALT=SATZNEU IF POSALT=POSNEU QUIT  ;KEINE ÄNDERUNG ;no alteration 
	. IF $GET(YINUSE)=1 IF $PIECE(KEY,"%s%",1)'=$GET(YKEY) QUIT  ;KEINE ÄNDERUNG, NUR RÜCKSETZEN
	. SET NOCHANGE=1
	. ;
	. IF +$PIECE(CHART1,Y,21)'=0 IF +$PIECE(CHART1,Y,22)'=0 DO  ;POSITION UND LÄNGE RECHNEN ;And longitude have faith in 
	. . SET BEGINN=$PIECE(SATZNEU,Y,$PIECE(CHART1,Y,21))
	. . SET UHRZEIT=+$PIECE(SATZNEU,Y,$PIECE(CHART1,Y,33))
	. . SET STUNDE=0
	. . IF +UHRZEIT'=0 IF +$GET(ARBBEGINN)'=0 IF UHRZEIT>ARBBEGINN SET STUNDE=$JUSTIFY(((UHRZEIT-ARBBEGINN)/60/60),0,0)
	. . IF STUNDE'<ARBSTUNDEN SET STUNDE=ARBSTUNDEN-1
	. . IF STUNDE<1 SET STUNDE=0
	. . SET DAUER=$PIECE(SATZNEU,Y,$PIECE(CHART1,Y,22))
	. . IF +$PIECE(CHART1,Y,67)'=1 DO
	. . . SET DAUER=$JUSTIFY((DAUER/60/60),0,0)  ;IN STUNDEN ;within procrastinate 
	. . . IF DAUER=0 SET DAUER=1
	. . . IF +$PIECE(CHART1,Y,6)'=1 DO
	. . . . SET DAUER=(DAUER\ARBSTUNDEN)
	. . . . IF DAUER#ARBSTUNDEN'=0 SET DAUER=DAUER+1
	. . . . IF DAUER=0 SET DAUER=1
	. . . . QUIT
	. . . QUIT
	. . IF DAUER=0 SET DAUER=1
	. . IF $PIECE(CHART1,Y,37)=1 SET BEGINN=$$^WWWDRAGDROP8(START,,BEGINN,1)  ;NUR ARBEITSTAGE ;only 
	. . IF BEGINN<START IF +$PIECE(CHART1,Y,6)=1 SET DAUER=(DAUER-((START-BEGINN)*ARBSTUNDEN)+STUNDE) SET BEGINN=START SET STUNDE=0  ;RESTZEIT ANZEIGEN WENN BEGINN FOR START ;display when inauguration take-off 
	. . IF BEGINN<START IF +$PIECE(CHART1,Y,6)'=1 SET DAUER=DAUER-(START-BEGINN) SET BEGINN=START  ;RESTZEIT ANZEIGEN WENN BEGINN FOR START ;display when inauguration take-off 
	. . IF +DAUER<0 SET DAUER=0
	. . SET DAUER=$JUSTIFY((DAUER),0,0)
	. . ;IF $PIECE(CHART1,Y,37)=1 DO
	. . ;.NEW START1
	. . ;.SET BEGINN=$$^WWWDRAGDROP8(START,,BEGINN,1)  ;NUR ARBEITSTAGE
	. . ;.SET START1=$$^WWWDRAGDROP8(START,,START,0)  ;START=FEIERTAG
	. . ;.IF BEGINN<START1 SET DAUER=DAUER-((START1-BEGINN)*ARBSTUNDEN) SET BEGINN=START SET STUNDE=0 ;table-mat table-mat table-mat 
	. . ;.QUIT
	. . SET BEGINN=(BEGINN-START)  ;STARTPUNKT (TAGE AB START) ;Confirm. 
	. . SET $PIECE(POSNEU,"X",2)=((BEGINN*TIMESIZE)+STUNDE)
	. . SET $PIECE(POSNEU,"X",3)=(DAUER-1)
	. . DO
	. . . IF $PIECE(POSNEU,"X",3)<0 SET $PIECE(POSNEU,"X",2)=(COLUMNS-HEADLAENG)+1 SET $PIECE(POSNEU,"X",3)=0 QUIT  ;ENDE VOR BEGINN SKALA ;termination pre- inauguration scale 
	. . . ;IF $PIECE(POSNEU,"X",2)<0 SET $PIECE(POSNEU,"X",2)=(COLUMNS-HEADLAENG)+1 SET $PIECE(POSNEU,"X",3)=0 QUIT  ;START AUSSERHALB SKALA
	. . . IF $PIECE(POSNEU,"X",2)>(COLUMNS-HEADLAENG) SET $PIECE(POSNEU,"X",2)=(COLUMNS-HEADLAENG)+1 SET $PIECE(POSNEU,"X",3)=0 QUIT  ;START AUSSERHALB SKALA ;take-off scale 
	. . . IF (COLUMNS-$PIECE(POSNEU,"X",2)-HEADLAENG-1)<$PIECE(POSNEU,"X",3) SET $PIECE(POSNEU,"X",3)=(COLUMNS-$PIECE(POSNEU,"X",2)-HEADLAENG-1)  ;ENDE AUSSERHALB SKALA ;termination scale 
	. . . IF $PIECE(POSNEU,"X",3)<0 SET $PIECE(POSNEU,"X",3)=0 SET $PIECE(POSNEU,"X",2)=(COLUMNS-HEADLAENG)+1
	. . . QUIT
	. . QUIT
	. ;
	. IF +$PIECE(CHART1,Y,21)'=0 DO  ;START PRÜFEN ;take-off sift 
	. . IF $PIECE(KEY,"%s%",1)'=$GET(YKEY) IF $PIECE(POSNEU,"X",1)=$PIECE(POSALT,"X",1) IF $PIECE(POSNEU,"X",2)=$PIECE(POSALT,"X",2) QUIT  ;IMMER POSITIONIEREN !! ;constantly 
	. . DO POSITION($PIECE(POSNEU,"X",1),$PIECE(POSNEU,"X",2))
	. . SET NOCHANGE=0
	. . QUIT
	. ;
	. IF +$PIECE(CHART1,Y,22)'=0 DO  ;DAUER PRÜFEN ;permanence sift 
	. . IF $PIECE(KEY,"%s%",1)'=$GET(YKEY) IF $PIECE(POSNEU,"X",3)'=0 IF (COLUMNS-$PIECE(POSNEU,"X",2)-HEADLAENG)'<$PIECE(POSNEU,"X",3) IF $PIECE(POSNEU,"X",3)=$PIECE(POSALT,"X",3) QUIT  ;KEINE ÄNDERUNG ;no alteration 
	. . DO DAUER($PIECE(POSNEU,"X",3),$PIECE(SATZNEU,Y,$PIECE(CHART1,Y,22)))
	. . SET NOCHANGE=0
	. . QUIT
	. ;
	. IF +$PIECE(CHART1,Y,20)'=0 DO  ;FARBE PRÜFEN ;tincture sift 
	. . IF +$PIECE(CHART1,Y,54)'=0 IF $PIECE(SATZALT,Y,+$PIECE(CHART1,Y,54))=1 QUIT  ;KEIN HISTOGRAMM UPDATE ;no 
	. . IF $PIECE(POSNEU,"X",2)'<(COLUMNS-HEADLAENG) SET $PIECE(SATZNEU,Y,$PIECE(CHART1,Y,20))="hide"  ;AUSBLENDEN
	. . IF $PIECE(SATZNEU,Y,$PIECE(CHART1,Y,20))=$PIECE(SATZALT,Y,$PIECE(CHART1,Y,20)) QUIT  ;KEINE FARBÄNDERUNG ;no 
	. . DO COLOR($PIECE(SATZNEU,Y,$PIECE(CHART1,Y,20)))
	. . SET NOCHANGE=0
	. . QUIT
	. ;
	. IF $PIECE(CHART1,Y,24)=1 DO  ;UPDATE HISTOGRAMM
	. . IF +$PIECE(CHART1,Y,54)'=0 IF $PIECE(SATZALT,Y,+$PIECE(CHART1,Y,54))=1 QUIT  ;KEIN HISTOGRAMM UPDATE ;no 
	. . IF $PIECE(POSNEU,"X",1)=$PIECE(POSALT,"X",1) IF $PIECE(POSNEU,"X",2)=$PIECE(POSALT,"X",2) IF $PIECE(POSNEU,"X",3)=$PIECE(POSALT,"X",3) QUIT  ;KEINE ÄNDERUNG ;no alteration 
	. . DO DIAGRAM(POSALT,POSNEU)
	. . SET NOCHANGE=0
	. . QUIT
	. ;
	. DO  ;UPDATE BESCHREIBUNG ;description 
	. . DO DESCRIPT(SATZALT,SATZNEU)
	. . ;SET NOCHANGE=0 ;table-mat 
	. . QUIT
	. ;
	. SET ^WWWDATEN(YM,+$HOROLOG,YUSER,YFORM,"V","DATEN",KEY,2)=SATZNEU
	. SET ^WWWDATEN(YM,+$HOROLOG,YUSER,YFORM,"V","X-REF",KEY,2)=POSNEU
	. IF NOCHANGE'=1 SET ^WWWSOR(YUSER,"UPDATE",KEY)=SATZNEU
	. QUIT
	DO UPDATE
	KILL ^WWWSOR(YUSER,"UPDATE")
	QUIT YRETVAL
	
COLOR(COLNR)  ;SET COLOR TO RETVAL ;table-mat 
	NEW COLOR,LEFTOVER,RIGHTOVER,LEFT,KEY2,SORT
	SET COLOR=""
	IF $GET(COLNR)'="" IF $GET(COLNR)'="hide" SET COLOR=$PIECE($GET(^WWW100(0,"FARBE",SPRACHE,COLNR,1)),Y,1)
	IF $GET(COLNR)="hide" SET COLOR="hide"  ;FELD AUSBLENDEN ;field 
	IF COLOR="" SET COLOR="white"
	SET YRETVAL=YRETVAL_" setelementcolor("_""""_$TRANSLATE(KEY,"-.","__")_""""_","_""""_COLOR_""""_",1);"  ;FELD MIT FARBGEBUNG
	QUIT
	SET SORT="" FOR  SET SORT=$ORDER(^WWWDATEN(YM,+$HOROLOG,YUSER,YFORM,"V","DATENn")) QUIT:SORT=""  DO
	. SET KEY2="" FOR  SET KEY2=$ORDER(^WWWDATEN(YM,+$HOROLOG,YUSER,YFORM,"V","DATENn",$PIECE(KEY,"%s%",1),KEY2)) QUIT:KEY2=""  DO
	. . QUIT:$PIECE(KEY,"%s%",2)=KEY2
	. . SET YRETVAL=YRETVAL_" setelementcolor("_""""_$TRANSLATE($PIECE(KEY,"%s%",1),"-.","__")_"%s%"_KEY2_""""_","_""""_COLOR_""""_",1);"
	. . QUIT
	. QUIT
	QUIT
	
POSITION(TOP,LEFT)  ;SET POSITION TO RETVAL ;table-mat 
	NEW EDITBOX
	SET EDITBOX=1
	IF $FIND(KEY,"%s%") SET EDITBOX=2  ;SPLITTING NUR TOOLTIP ;only 
	SET TOP=$GET(TOP)
	SET LEFT=$GET(LEFT)
	IF LEFT=((COLUMNS-HEADLAENG)+1) SET LEFT=LEFT-1
	;SET YRETVAL=YRETVAL_" setelementposition("_""""_$TRANSLATE(KEY,"-.","__")_""""_","_$JUSTIFY((((TOP+HEADSIZE-1)*PIXEL)+1+BUTTONLINE),0,0)_","_$JUSTIFY((((LEFT+HEADLAENG)*PIXEL)+1),0,0)_","_EDITBOX_");"
	SET YRETVAL=YRETVAL_" setelementposition("_""""_$TRANSLATE(KEY,"-.","__")_""""_","_$JUSTIFY((((TOP+HEADSIZE)*PIXEL)+1+BUTTONLINE),0,0)_","_$JUSTIFY((((LEFT+HEADLAENG)*PIXEL)+1),0,0)_","_EDITBOX_");"
	QUIT
	
DAUER(TIME,DAUER)  ;SET WIDTH ;table-mat 
	SET TIME=$GET(TIME)  ;ANZAHL STUNDEN ;Number procrastinate 
	IF $PIECE(POSNEU,"X",2)=((COLUMNS-HEADLAENG)+1) SET TIME=4  ;START AUSSERHALB SKALA ;take-off scale 
	SET YRETVAL=YRETVAL_" setelementsize("_""""_$TRANSLATE(KEY,"-.","__")_""""_","_""""_""""_","_$JUSTIFY((((TIME+1)*PIXEL)-2),0,0)_");"
	IF +$PIECE(CHART1,Y,54)'=0 IF $PIECE(SATZALT,Y,+$PIECE(CHART1,Y,54))=1 QUIT  ;KEIN HISTOGRAMM UPDATE ;no 
	SET DAUER=$$^WWWTIME(DAUER)
	IF +$PIECE(CHART1,Y,68)'=0 DO  ;DATENFELD BESCHRIFTUNG
	. SET DAUER=$PIECE(SATZNEU,Y,$PIECE(CHART1,Y,68))
	. QUIT
	IF (TIME*PIXEL)>31 IF '$FIND(KEY,"%s%") SET YRETVAL=YRETVAL_"setelementtext("_""""_$TRANSLATE(KEY,"-.","__")_""""_","_""""_"&nbsp;"_DAUER_""""_");" QUIT
	IF (TIME*PIXEL)>31 IF $FIND(KEY,"%s%") SET YRETVAL=YRETVAL_"setelementtext("_""""_$TRANSLATE(KEY,"-.","__")_""""_","_""""_"&nbsp;("_$PIECE(KEY,"%s%",2)_") "_DAUER_""""_");" QUIT
	SET YRETVAL=YRETVAL_" setelementtext("_""""_$TRANSLATE(KEY,"-.","__")_""""_","_""""_"&nbsp;"_""""_");"
	QUIT
	
DIAGRAM(XREFALT,XREFNEU) ;UPDATE DIAGRAMM
	NEW YI,ANZ,DATA,WERT
	SET DATA=^WWWDATEN(YM,+$HOROLOG,YUSER,YFORM,"V","DIAGR-DATA",1)
	SET WERT=1
	IF +$PIECE(CHART1,Y,64)'=0 SET WERT=$PIECE(SATZNEU,Y,$PIECE(CHART1,Y,64))  ;HISTOGRAMM SUMMEN ;purr 
	FOR YI=0:1:$PIECE(XREFALT,"X",3) DO  ;LÖSCHEN WERTE AUS DIAGRAMMDATEN ;Delete out of 
	. SET ANZ=$PIECE(DATA,Y,($PIECE(XREFALT,"X",2)+YI+1))
	. SET $PIECE(DATA,Y,($PIECE(XREFALT,"X",2)+YI+1))=(ANZ-WERT)
	. QUIT
	FOR YI=0:1:$PIECE(XREFNEU,"X",3) DO  ;SETZTEN WERTE IN DIAGRAMMDATEN ;within 
	. SET ANZ=$PIECE(DATA,Y,($PIECE(XREFNEU,"X",2)+YI+1))
	. SET $PIECE(DATA,Y,($PIECE(XREFNEU,"X",2)+YI+1))=(ANZ+WERT)
	. QUIT
	SET ^WWWDATEN(YM,+$HOROLOG,YUSER,YFORM,"V","DIAGR-DATA",1)=DATA
	QUIT
	
UPDATE	  ;UPDATE SONSTIGE ELEMENTE
	NEW YNUM,CHARTD1,TYP,YDATEI,KEY,SATZ,COLOR,TOOLTIP
	SET KEY="" FOR  SET KEY=$ORDER(^WWWSOR(YUSER,"UPDATE",KEY)) QUIT:KEY=""  DO
	. SET SATZ=$GET(^WWWSOR(YUSER,"UPDATE",KEY))
	. ;
	. ;UPDATE LINEAL / SUMMENBALKEN ;straight edge 
	. ;----------------------------
	. IF $DATA(^WWWDATEN(YM,+$HOROLOG,YUSER,YFORM,"V","LINEAL")) DO
	. . NEW LINROW,LINPOS,LINKEY,YI,KEYX,WERTE,LEFT,RIGHT,LINEAL,WERTE1,LASTROW
	. . SET WERTE1=$GET(^WWWDATEN(YM,+$HOROLOG,YUSER,YFORM,"V","X-REF",KEY,2))  ;POSITION GEÄNDERTES ELEMENT ;medium 
	. . SET ELEMCOL=$PIECE(WERTE1,"X",1)+1
	. . SET LINROW=$ORDER(^WWWDATEN(YM,+$HOROLOG,YUSER,YFORM,"V","LINEAL",ELEMCOL),-1)
	. . QUIT:LINROW=""
	. . SET LINEAL=$GET(^WWWDATEN(YM,+$HOROLOG,YUSER,YFORM,"V","LINEAL",LINROW,1))  ;BIS ZEIL3 X LINKS X RECHTS ~ KEY1;KEY2;...
	. . SET LINPOS=$PIECE(LINEAL,Y,1)  ;POSITION
	. . SET LINKEY=$PIECE(LINEAL,Y,2)  ;ENTHALTENE KEYS
	. . SET LEFT=""
	. . SET RIGHT=""
	. . FOR YI=1:1  QUIT:$PIECE(LINKEY,";",YI,999)=""  SET KEYX=$PIECE(LINKEY,";",YI) DO
	. . . QUIT:KEYX=""
	. . . IF KEY'=KEYX SET WERTE=$GET(^WWWDATEN(YM,+$HOROLOG,YUSER,YFORM,"V","X-REF",KEYX,2))
	. . . IF KEY=KEYX SET WERTE=WERTE1
	. . . IF LEFT=""!($PIECE(WERTE,"X",2)<LEFT) SET LEFT=$PIECE(WERTE,"X",2)
	. . . IF RIGHT=""!(($PIECE(WERTE,"X",2)+$PIECE(WERTE,"X",3))>RIGHT) SET RIGHT=($PIECE(WERTE,"X",2)+$PIECE(WERTE,"X",3))
	. . . QUIT
	. . ;
	. . IF $PIECE(LINPOS,"X",2)'=LEFT!($PIECE(LINPOS,"X",3)'=RIGHT) DO  ;UPDATE
	. . . IF RIGHT>(COLUMNS-HEADLAENG-1) SET RIGHT=(COLUMNS-HEADLAENG-1)
	. . . IF LEFT>RIGHT NEW LEFTX SET LEFTX=LEFT,LEFT=RIGHT,RIGHT=LEFTX  ;FIS;FALLS AUSSERHALB SKALA;25303;10.03.04
	. . . IF RIGHT>(COLUMNS-HEADLAENG-1) SET RIGHT=(COLUMNS-HEADLAENG-1)  ;VOR UND NACH RECHTSJUSTIERUNG ;pre- And within 
	. . . SET LENGTH=((RIGHT+1)-LEFT)
	. . . SET LENL=(LENGTH\2)  ;LINKE SEITE DFLT. ;left-hand side 
	. . . SET COLOR(0)=""
	. . . SET COLOR(9)=""
	. . . SET COLOR=""
	. . . IF $PIECE(CHART1,Y,40)'=0 SET COLOR=$GET(^WWWDRAGDROPD(0,CHART,$PIECE(CHART1,Y,40),1))
	. . . IF $PIECE(COLOR,Y,23)'="" SET COLOR(0)=$PIECE(COLOR,Y,23)
	. . . IF $PIECE(COLOR,Y,24)'="" SET COLOR(9)=$PIECE(COLOR,Y,24)
	. . . IF COLOR(0)'=COLOR(9) IF COLOR(9)'="" DO  ;2-FARBIG
	. . . . IF COLOR(0)'="" SET COLOR(0)=$PIECE($GET(^WWW100(0,"FARBE",SPRACHE,COLOR(0),1)),Y,1)
	. . . . IF COLOR(9)'="" SET COLOR(9)=$PIECE($GET(^WWW100(0,"FARBE",SPRACHE,COLOR(9),1)),Y,1)
	. . . . IF COLOR(0)="" SET COLOR(0)="limegreen"
	. . . . IF COLOR(9)="" SET COLOR(9)=COLOR(0)
	. . . . SET COLOR(1)=COLOR(0)
	. . . . SET COLOR(2)=COLOR(0)
	. . . . SET LASTRIGHT=0
	. . . . SET LASTROW=$ORDER(^WWWDATEN(YM,+$HOROLOG,YUSER,YFORM,"V","LINEAL",LINROW),-1)
	. . . . IF LASTROW'="" SET LASTRIGHT=$PIECE($PIECE($GET(^WWWDATEN(YM,+$HOROLOG,YUSER,YFORM,"V","LINEAL",LASTROW,1)),Y,1),"X",3)
	. . . . IF LASTRIGHT'=0 IF LASTRIGHT>LEFT SET COLOR(1)=COLOR(9) SET LENL=(LASTRIGHT-LEFT+1)  ;LINKE SEITE ;left-hand side 
	. . . . IF LASTRIGHT>RIGHT SET COLOR(2)=COLOR(9) SET LENL=(LENGTH\2)  ;LINKE SEITE DFLT. ;left-hand side 
	. . . . SET LENR=(LENGTH-LENL)  ;RECHTE SEITE ;right-hand side 
	. . . . SET YRETVAL=YRETVAL_" document.getElementById("_""""_"linleft"_LINROW_""""_").style.width="_""""_((LENL*PIXEL)+3)_"px"_""""_";"
	. . . . SET YRETVAL=YRETVAL_" document.getElementById("_""""_"linright"_LINROW_""""_").style.width="_""""_((LENR*PIXEL)+3)_"px"_""""_";"
	. . . . SET YRETVAL=YRETVAL_" document.getElementById("_""""_"linleft"_LINROW_""""_").style.borderTop="_""""_"5px solid "_COLOR(1)_""""_";"
	. . . . SET YRETVAL=YRETVAL_" document.getElementById("_""""_"linright"_LINROW_""""_").style.borderTop="_""""_"5px solid "_COLOR(2)_""""_";"
	. . . . QUIT
	. . . ;
	. . . SET YRETVAL=YRETVAL_" setelementposition("_""""_"lineal"_LINROW_""""_","_$JUSTIFY((((LINROW+HEADSIZE)*PIXEL)+BUTTONLINE-2),0,0)_","_$JUSTIFY((((LEFT+HEADLAENG)*PIXEL)-3),0,0)_",0);"
	. . . SET YRETVAL=YRETVAL_" setelementsize("_""""_"lineal"_LINROW_""""_","_""""_""""_","_$JUSTIFY((((RIGHT-LEFT+1)*PIXEL)+6),0,0)_");"
	. . . SET ^WWWDATEN(YM,+$HOROLOG,YUSER,YFORM,"V","LINEAL",LINROW,1)=$PIECE(LINPOS,"X",1)_"X"_LEFT_"X"_RIGHT_Y_LINKEY
	. . . QUIT
	. . QUIT
	. ;
	. ;TOOLTIP
	. ;-------
	. SET TOOLTIP=""
	. IF $PIECE(CHART1,Y,30)=1 IF $PIECE(CHART1,Y,29)'="" DO
	. . SET TOOLTIP=$$^WWWTRANSLATE($PIECE(SATZ,Y,$PIECE(CHART1,Y,29)),YCR,"|")
	. . QUIT:TOOLTIP=""
	. . ;SET TOOLTIP=$TRANSLATE($$^WWWTRANSLATE(TOOLTIP,"|","<BR>"),"'"_"""","´´")
	. . SET TOOLTIP=$$^WWWTRANSLATE(TOOLTIP,"|","<BR>")
	. . SET TOOLTIP=$$ESC^WWWENCODE(TOOLTIP)
	. . SET YRETVAL=YRETVAL_" setelementtext("_""""_"tool"_$TRANSLATE(KEY,"-.","__")_""""_","_""""_"<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0><TR><TD ALIGN=LEFT NOWRAP><FONT SIZE=1 FACE=ARIAL>"_TOOLTIP_"</FONT></TD></TR></TABLE>"_""""_",1);"
	. . QUIT
	. QUIT
	QUIT
	
DESCRIPT(SATZALT,SATZNEU)  ;UPDATE TABELLENTEXTE
	DO
	. NEW YNUM,YTEXT,VALUE
	. SET VALUE=""
	. QUIT:SATZALT=SATZNEU    ;WENN SICH NICHTS ÄNDERT ;when yourself nothing 
	. SET YNUM="" FOR  SET YNUM=$ORDER(^WWWDRAGDROPD(0,CHART,YNUM)) QUIT:YNUM=""  DO
	. . SET YFELD=$GET(^WWWDRAGDROPD(0,CHART,YNUM,1))
	. . QUIT:$PIECE(SATZALT,Y,YNUM)=$PIECE(SATZNEU,Y,YNUM)      ;NUR UNTERSCHIEBLICHE DATENSÄTZE ANZEIGEN ;only display 
	. . IF $PIECE(YFELD,Y,5)'=1 QUIT   ;NICHT ÄNDERBAR, NICHT IM HEADER ANZEIGEN
	. . ;
	. . IF $DATA(^WWWDRAGDROPDU(0,CHART,YBED,1)) SET VALUE=$GET(^(1))    ;AUS SETUPUSER ;out of 
	. . IF VALUE'="" IF $PIECE(VALUE,Y,YNUM)'=1 QUIT      ;SPALTE AUS USERSETUP AUSGESCHLOSSEN ;rift out of 
	. . SET YTEXT=$$^WWWDRAGDROPTR(SATZNEU,YFELD)
	. . ;SET YRETVAL=$GET(YRETVAL)_" document.all."_"tab_"_YNUM_"_edit"_$TRANSLATE(KEY,".-","__")_".style.backgroundColor = "_""""_"red"_""""_";"
	. . SET YRETVAL=$GET(YRETVAL)_" document.all."_"tab_"_YNUM_"_edit"_$TRANSLATE(KEY,".-","__")_".innerHTML = "_""""_"<td>&nbsp;"_YTEXT_"</td>"_""""_";"
	. . QUIT
	. QUIT
	QUIT
]]></Routine>
</Export>