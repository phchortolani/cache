<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="22" zv="CACHE" ts="2001-01-01 00:00:00">
<Routine name="INKUNDANG" type="MAC" languagemode="0" timestamp="58440,0"><![CDATA[
INKUNDANG(KUNDE,HIST,VON,BIS) ;INKUNDANG;DT;ERRECHNEN ANGEBOTSSMENGE EINES KUNDEN;4.07.2000
	;
	;/------------------------------------------------------------------\
	;| Description of Function :
	;|		ERRECHNEN ANGEBOTSSMENGE EINES KUNDEN
	;|
	;| Inputs : 
	;|
	;|
	;| ByRef :
	;|
	;|
	;| Returns :
	;|
	;|
	;| History :
	;|
	;| DT	4.07.2000
	;|
	;\------------------------------------------------------------------/
	;
	;VON,BIS WIRKT NUR WENN HIST=5 IST
	;HIST=1 AKTUELLE ANGEBOTE
	;HIST=2 ALLE ANGEBOTE
	;HIST=5 ALLE ANGEBOTE,DIE NICHT AUFTRAG GEWORDEN IST, IN ZEITRAUM ;03.05.2004;FAN;25425; FORECAST  
	NEW ANG,DAT,ANG1,ANGEBOTE,AUFENDE
	SET HIST=$GET(HIST,1)
	SET ANGEBOTE=0  ;KUNDENANGEBOTE
	IF HIST=1 IF $GET(KUNDE)'="" DO  ;SUCHEN ANGEBOTSBESTAND ;seek 
	. SET ANG="" FOR  SET ANG=$ORDER(^INANG1(YM,ANG)) QUIT:ANG=""  DO
	. . SET ANG1=$GET(^INANG(YM,ANG,1))
	. . QUIT:$PIECE(ANG1,Y,1)'=$GET(KUNDE)  ;NICHT RICHTIGER KUNDE ;Not customer 
	. . SET ANGEBOTE=ANGEBOTE+1
	. . QUIT
	. QUIT
	IF HIST=2 IF $GET(KUNDE)'="" DO  ;SUCHEN ANGEBOTSBESTAND ;seek 
	. SET DAT="" FOR  SET DAT=$ORDER(^INANGs(YM,1,$$^WWWUMLAU(KUNDE,1),DAT)) QUIT:DAT=""  DO
	. . SET AUFENDE="" FOR  SET AUFENDE=$ORDER(^INANGs(YM,1,$$^WWWUMLAU(KUNDE,1),DAT,AUFENDE)) QUIT:AUFENDE=""  DO
	. . . SET ANG="" FOR  SET ANG=$ORDER(^INANGs(YM,1,$$^WWWUMLAU(KUNDE,1),DAT,AUFENDE,ANG)) QUIT:ANG=""  DO
	. . . . SET ANGEBOTE=ANGEBOTE+1
	. . . . QUIT
	. . . QUIT
	. . QUIT
	. QUIT
	IF HIST=5 IF $GET(KUNDE)'="" DO  ;SUCHEN ANGEBOTSBESTAND ;seek 
	. S KUNDE=$$^WWWUMLAU(KUNDE,1)
	. SET VON=$GET(VON)
	. SET BIS=$GET(BIS)
	. IF BIS="" SET BIS=$ORDER(^INANGs(YM,1,KUNDE,""),-1)
	. SET DAT=""
	. IF VON'="" SET DAT=$ORDER(^INANGs(YM,1,KUNDE,VON),-1)
	. FOR  SET DAT=$ORDER(^INANGs(YM,1,KUNDE,DAT)) QUIT:DAT]]BIS  QUIT:DAT=""  DO
	. . SET AUFENDE="" FOR  SET AUFENDE=$ORDER(^INANGs(YM,1,KUNDE,DAT,AUFENDE)) QUIT:AUFENDE=""  DO
	. . . SET ANG="" FOR  SET ANG=$ORDER(^INANGs(YM,1,KUNDE,DAT,AUFENDE,ANG)) QUIT:ANG=""  DO
	. . . . Q:$P($G(^INANG(YM,ANG,1)),Y,78)'=""   ;AUFTRAG GEWORDEN ZÃ„HLE NICHT MIT ;order Not by means of 
	. . . . SET ANGEBOTE=ANGEBOTE+1
	. . . . QUIT
	. . . QUIT
	. . QUIT
	. QUIT
	QUIT ANGEBOTE
]]></Routine>
</Export>