<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="22" zv="CACHE" ts="2001-01-01 00:00:00">
<Routine name="WWWBITCOUNT" type="MAC" languagemode="0" timestamp="58440,0"><![CDATA[
WWWBITCOUNT(YDATEI,YLFN,YBIT) ;WWWBITCOUNT;DT;SUMME DER BITS;18.6.2003
	;
	;/------------------------------------------------------------------\
	;| Description of Function :
	;|		SUMME DER BITS
	;|
	;| Inputs : 
	;|
	;|
	;| ByRef :
	;|
	;|
	;| Returns :
	;|
	;|
	;| History :
	;|
	;| DT	18.6.2003
	;|
	;\------------------------------------------------------------------/
	;
	;YDATEI = KLASSE, DIE SUMMIERT WIRD
	;YLFN = DES BIT MAP FELDES
	;YBIT = BIT DER AUSWERTUNG ( GGF PARAMETER / TEXT / ODER 1 ) ;bit the parameter Text Or 
	;YLFN="" DANN GESAMTEN RECORDS
	;YBIT="" DANN ALLE BITS
	;W $$^WWWBITCOUNT("INART")  =ALLE
	;W $$^WWWBITCOUNT("INART",1) =ALLE MIT FELD 1
	;W $$^WWWBITCOUNT("INART",1,"A") ALLE FELD 1 MIT EINTRAG "A"
	NEW RETRUN,COUNT,FILE
	SET RETURN=""
	QUIT:$GET(YDATEI)="" RETURN
	SET YLFN=+$GET(YLFN)
	SET YBIT=$GET(YBIT)
	IF YLFN=0 SET YBIT=1 DO COUNT  ;NUR GESAMTE ANZAHL ;only Number 
	IF YLFN>0 DO
	. IF $PIECE($GET(^WWW001B(0,YDATEI,YLFN,1)),Y,3)=1 DO SUM QUIT   ;BESTIMTER DATENSTREAM
	. IF YBIT="" IF $PIECE($GET(^WWW001B(0,YDATEI,YLFN,1)),Y,4)=1 DO COUNT1   ;GESAMTER DTENSTRAM
	. IF YBIT'="" DO COUNT  ;SUMMENBILDUNG
	. Q
	QUIT RETURN
	
COUNT  ;GESAMTE FILE 
	SET FILE="^"_YDATEI_"b("_""""_$$^WWWYM(YDATEI,0)_""""_","_YLFN_","_""""_YBIT_""""_","_"COUNT"_")"
	SET COUNT="" FOR  SET COUNT=$ORDER(@FILE) QUIT:COUNT=""  DO
	. SET FILE(1)=$GET(@FILE)
	. SET RETURN=RETURN+$BITCOUNT(FILE(1),1)
	. QUIT
	QUIT
	
COUNT1  ;GESAMTE FILE LLE INHALTE
	NEW FILE0
	SET FILE0="^"_YDATEI_"b("_""""_$$^WWWYM(YDATEI,0)_""""_","_YLFN_",YBIT)"
	SET YBIT="" FOR  SET YBIT=$ORDER(@FILE0) QUIT:YBIT=""  DO COUNT
	QUIT
	
SUM  ;SUMME DES FILES
	NEW YBIT,YBITM,YLAST
	SET YBITM=""
	SET YLAST=1
	FOR BIT=1:1:40 SET YBITM=$GET(YBITM)_YLAST_"," SET YLAST=YLAST*2  ;BITM="1,2,4,8,16,32,64,128,,,,,,"
	FOR YBIT=1:1:40 DO
	. SET FILE="^"_YDATEI_"b("_""""_$$^WWWYM(YDATEI,0)_""""_","_YLFN_","_YBIT_","_"COUNT"_")"
	. SET COUNT="" FOR  SET COUNT=$ORDER(@FILE) QUIT:COUNT=""  DO
	. . SET FILE(1)=$GET(@FILE)
	. . SET RETURN=RETURN+($BITCOUNT(FILE(1),1)*$PIECE(YBITM,",",YBIT))  ;MAL DIE WERTIGKEIT ;sometimes who 
	. . QUIT
	. QUIT
	SET RETURN=RETURN/100  ;BETRAG ;Sum 
	QUIT
]]></Routine>
</Export>