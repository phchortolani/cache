<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="22" zv="CACHE" ts="2001-01-01 00:00:00">
<Routine name="INDRUCK4" type="MAC" languagemode="0" timestamp="58440,0"><![CDATA[
INDRUCK4 ;INDRUCK4;DT;DRUCKEN BELEG NAME;24.02.2000  ; Compiled February 28, 2005 16:26:06
	;
	/*------------------------------------------------------------------------------
	; Description of Function :
	;		DRUCKEN BELEG NAME
	;		Print Voucher Name
	;
	; Inputs : 
	;
	;
	; ByRef :
	;
	;
	; Returns :
	;
	;
	; History :
	; 23-Jan-2006	GRF		Doco; Replace space strings with $justify
	; 24.Feb.2000	DT
	;-----------------------------------------------------------------------------*/
	IF YSEITE'=1 IF $PIECE(YBELEG1,Y,11)'=1 QUIT   ;ANSCHRIFT AUCH AUF FOLGESEITEN? ;too upon 
	
	IF +$PIECE(YBELEG1,Y,25)'=0 SET LFN=$PIECE(YBELEG1,Y,25)  ;AB ZEILE ;Confirm. 
	IF LFN="" SET LFN=18
	
	;IF YBELEG=9 SET LFN=LFN-5  ;INTERNER BEREITSTELLUNGSSCHEIN;NICHT RICHTIG; TYBD;8,1,04
	SET YTAB=$EXTRACT($justify("",76),1,+$PIECE(YBELEG1,Y,26))  ;IN SPALTE ;within rift 
	SET A=YTAB
	IF +YSEND'=2 DO
	. SET A=A_"<FONT"
	. IF $PIECE(YBELEG1,Y,22)'="" SET A=A_" SIZE="_$PIECE(YBELEG1,Y,22)
	. ;I $P(YBELEG1,Y,21)'="" S A=A_" FACE="_""""_$P($G(^WWW100(0,"SCHRIFTART",SPRACHE,$P(YBELEG1,Y,21),1)),Y,1)_""""
	. SET A=A_">"
	. IF $PIECE(YBELEG1,Y,21) SET A=A_"<B>"
	
	IF YBELEG=7!(YBELEG=17) IF $GET(YPROFORMA)=1 SET A=A_"PRO FORMA-"  ;PROFORMARECHNUNG ;proforma invoice 
	IF YBELEG=12 DO
	. IF $PIECE(YFELDPZ,Y,14)'="" DO
	. . NEW TXT
	. . SET TXT=$PIECE($GET(^INPARA(YM,"INAUFPZ",SPRACHE,$PIECE(YFELDPZ,Y,14),1)),Y,1)
	. . IF TXT="" SET TXT=$PIECE(YFELDPZ,Y,14)
	. . SET A=A_TXT
	. . SET $PIECE(YBELEG1,Y,23)=""      ;NICHT DOPPELT BELEGTEXT ;Not twin 
	. . QUIT
	. IF $PIECE(YFELDPZ,Y,14)="" DO
	. . IF $PIECE(YBELEG1,Y,23)'="" SET A=A_$PIECE(YBELEG1,Y,23) SET $PIECE(YBELEG1,Y,23)="" QUIT
	. . IF $PIECE(YFELDPZ,Y,1)'=1 SET A=A_$$^WWWTEXT(32335)    ;TEILZAHLUNGSRECHNUNG
	. . IF $PIECE(YFELDPZ,Y,1)=1 SET A=A_$$^WWWTEXT(32336)    ;ANZAHLUNGSRECHNUNG
	
	;SET A=A_$PIECE(YBELEG1,Y,23)_" "
	IF $GET(YTRANSLATE)=1 SET A=A_$$^WWWTEXT(33844)_" "  ;ÜBERSETZUNG;FIS;19.04.04;25558
	IF $GET(YTRANSLATE)'=1 SET A=A_$PIECE(YBELEG1,Y,23)_" "
	IF YBELEG=1  SET A=A_YAUFTRAG                 ;ANGEBOT ;proposition 
	IF YBELEG=2  SET A=A_$PIECE(YAUFTRAG1,Y,78)   ;AB ;Confirm. 
	IF YBELEG=6  SET A=A_$PIECE(YAUFTRAG1,Y,91)   ;LIEFERSCHEIN ;packing slip 
	IF YBELEG=7  SET A=A_$PIECE(YAUFTRAG1,Y,96)   ;RECHNUNG ;tab 
	IF YBELEG=17 SET A=A_$PIECE(YAUFTRAG1,Y,96)   ;GUTSCHRIFT
	IF YBELEG=12 SET A=A_$PIECE(YFELDPZ,Y,7)      ;TEILZAHLUNGSRECHNUNG
	
	;ULM,26.03.03
	IF $PIECE($GET(^INAUF(YM,YAUFTRAG,1)),Y,263)'="" SET A=A_" - "_$$^WWWTEXT(33297)  ;KOPIE$$^WWWTEXT(33297)  ;KOMMISSION
	IF $GET(YCOPY)=1!($PIECE($GET(^INUSER(YM,YBED,1)),Y,25)'="") DO            ;WENN  $P(^INUSER(YM,YBED,1),Y,25)'="" BELEGKOPIE AN...    24.03.02
	. IF YBELEG=7!(YBELEG=17) IF +$PIECE(YAUFTRAG1,Y,97)=+$HOROLOG IF YSEND'=0 QUIT  ;RECHNUNG COPY NICHT AUF MAIL;TYBD;1,6,2004;WENN MAIL UND GLEICHER TAG DANN NICHT KOPIE 
	. IF YBELEG=3 IF +$PIECE(YAUFTRAG1,Y,83)=+$HOROLOG IF YSEND'=0 QUIT  ;BESTELLUNG COPY NICHT AUF MAIL;TYBD;1,6,2004;WENN MAIL UND GLEICHER TAG DANN NICHT KOPIE 
	. NEW COPYTEXT
	. SET COPYTEXT=32097  ;KOPIE
	. IF $PIECE($GET(^INVORG(YM,YM,1)),Y,127)'="" SET COPYTEXT=$PIECE(^(1),Y,127)
	. IF COPYTEXT=" " QUIT
	. IF COPYTEXT="-" QUIT
	. IF COPYTEXT="kein" QUIT
	. IF COPYTEXT="no" QUIT
	. SET A=A_"("_$$^WWWTEXT(COPYTEXT)_")"  ;KOPIE ;copy 
	
	IF +YSEND'=2 DO 
	. IF $PIECE(YBELEG1,Y,21) SET A=A_"</B></FONT>"
	
	DO SPE^INDRUCK
	
	;PROJECT
	IF +$PIECE(YBELEG1,Y,25)'=0 SET LFN=$PIECE(YBELEG1,Y,25)+1  ;AB ZEILE ;Confirm. 
	IF LFN="" SET LFN=19
	IF $PIECE($GET(YAUFTRAG1),Y,8)'="" DO
	. SET YI(1)=$TRANSLATE($PIECE(YBELEG1,Y,17),";",",")   ;WELCHE HINWEISE DATUM USW.
	. FOR YI=1:1 SET YI(2)=$PIECE(YI(1),",",YI) QUIT:YI(2)=""  IF YI(2)=99 DO  QUIT
	. . SET YI(4)=$PIECE($GET(^WWW101(0,"BETREFF",SPRACHE,YI(2),1)),Y,1)       ;TEXT FÜR DRUCK ;Text to printing 
	. . SET YI(5)=$EXTRACT(YI(4)_$justify("",10),1,10)_": "                    ;FORMAT
	. . SET YI(4)=YI(5)
	. . SET YI(4)=YI(4)_$PIECE($GET(YAUFTRAG1),Y,8)  ;PROJECT
	. . SET A=YTAB_YI(4)
	. . DO SPE^INDRUCK
	
	QUIT
]]></Routine>
</Export>