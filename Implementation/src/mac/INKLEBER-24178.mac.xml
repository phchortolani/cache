<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="22" zv="CACHE" ts="2001-01-01 00:00:00">
<Routine name="INKLEBER" type="MAC" languagemode="0" timestamp="58440,0"><![CDATA[
INKLEBER(YKLART,YAUFTRAG,YPOSITION,YKEY) ;INLKEBER;DT;WARENAUFKLEBER;28.08.2000  ; Compiled February 9, 2005 11:22:02
	;
	;/------------------------------------------------------------------\
	;| Description of Function :
	;|		WARENAUFKLEBER
	;|
	;| Inputs : 
	;|
	;|
	;| ByRef :
	;|
	;|
	;| Returns :
	;|
	;|
	;| History :
	;|
	;| DT	28.08.2000  
	;|
	;\------------------------------------------------------------------/
	;
	;YKLART=AUFKLEBERART 1=WAREN
	;YAUFTRAG=AUFTRAGSNUMMER
	;YPOSITION=AUTRAGSPOSITION
	;YKEY=SCHLÜSSEL DES WARENEINGANGES WENN AUS BESTANDSERFASSUNG ;when out of 
	NEW YCOLLI,YCOLLX,YCOLLY,YCHARGE,YLOT,YVERFALL,ARTIKEL,ARTIKEL1,YAUFTRAG1,YPOSITION1,SERIEOK,SERIENNUMMER
	NEW YI,ME,YANZAHL,AART,BET,LAP,WEN,BETRIEB,YGUELTIG,YBARCODE,YTRACKING,YPREIS,YGEWICHT,YVERPACK,YLÄNGE
	NEW YBREITE,YHÖHE
	IF $GET(YKLART)="" SET YKLART=1  ;ART DER AUFKLEBER ;Type the sticker 
	SET BET=""
	SET LAP=""
	SET WEN=""
	SET YCHARGE=""
	SET YLOT=""
	SET YVERFALL=""
	SET YGUELTIG=""
	SET YCOLLI=""
	;U.S. VARIABLEN WERDEN FÜR DIE INKLEBHTML BENÖTIGT, WENN ÜBER INWAUSAUFKL IN INKLEBHTML GESPRUNGEN WIRD.
	;IN DIESER ROUTINE(INKLEBER) ERFOLGT KEINE AUFBEREITUNG DIESER DATEN, SONDERN IN INWAUSAUFKL.
	SET YTRACKING=""
	SET YPREIS=""
	SET YGEWICHT=""
	SET YVERPACK=""
	SET YLÄNGE=""
	SET YBREITE=""
	SET YHÖHE=""
	SET YKEY=$GET(YKEY)
	IF $GET(YKEY)'="" DO
	. SET YAUFTRAG=$PIECE(YKEY,",",1)
	. SET YPOSITION=$PIECE(YKEY,",",2)
	. SET BET=$PIECE(YKEY,",",3)
	. SET LAP=$PIECE(YKEY,",",4)
	. SET WEN=$PIECE(YKEY,",",5)
	. QUIT
	QUIT:$GET(YAUFTRAG)=""
	QUIT:$GET(YPOSITION)=""
	SET YAUFTRAG1=$GET(^INAUF(YM,YAUFTRAG,1))   ;AUFTRAGSDATEN
	SET YPOSITION1=$GET(^INAUFP(YM,YAUFTRAG,YPOSITION,1))  ;POSITIONSDATEN
	SET YARTIKEL=$PIECE(YPOSITION1,Y,4)
	QUIT:YARTIKEL=""   
	SET YARTIKEL1=$GET(^INART(YM,YARTIKEL,1))  ;ARTIKELDATEN
	QUIT:$PIECE($GET(^INAUF(YM,YAUFTRAG,1)),Y,2)=1  ;NICHT BEI EIGENAUFTRAG ;Not next to 
	IF $PIECE(YPOSITION1,Y,131)=0 QUIT  ;KEINE AUFKLEBER ;no sticker 
	SET AART=$PIECE(YPOSITION1,Y,26)  ;ARTIKELART
	QUIT:AART=2  ;LEISTUNG ;performance 
	SET ME=$PIECE(YPOSITION1,Y,40)   ;MENGENEINHEIT
	IF $GET(VORG(11))'=1 IF $PIECE(YPOSITION1,Y,7)'=1  IF $PIECE(YPOSITION1,Y,7)'=3 QUIT  ;NUR BEI BESTELLUNGEN ODER EIGENPRODUKTION ;only next to Or 
	IF $GET(VORG(11))=1 IF $PIECE(YPOSITION1,Y,7)'=1  IF $PIECE(YPOSITION1,Y,7)'=3 IF $PIECE(YPOSITION1,Y,7)'=2 QUIT  ;NUR BEI BESTELLUNGEN ODER EIGENPRODUKTION  ;AUS INAUFKL ;only next to Or out of 
	IF ME<1 SET ME=1  ;IMMER 1 AUFKLEBER ;constantly sticker 
	QUIT:ME=2  ;STUNDEN ;procrastinate 
	QUIT:ME=11  ;STUNDEN ;procrastinate 
	QUIT:ME=10  ;MINUTEN
	SET YANZAHL=1  ;IMMER NUR EIN AUFKLEBER ;constantly only uni- sticker 
	SET MENGE=$PIECE(YPOSITION1,Y,5)   ;MENGE AUS BESTELLUNG ;quantity out of sales order 
	IF BET'="" IF WEN'="" IF LAP'="" DO
	. IF $DATA(^INWEAUF(YM,YAUFTRAG,YPOSITION,BET,LAP,WEN,1)) DO
	. . NEW WEN1
	. . SET WEN1=$GET(^(1))
	. . SET MENGE=$PIECE(WEN1,Y,4)
	. . SET YCOLLI=$PIECE(WEN1,Y,3)
	. . SET YCHARGE=$PIECE(WEN1,Y,2)
	. . SET YLOT=$PIECE(WEN1,Y,19)
	. . SET YVERFALL=$PIECE(WEN1,Y,25)
	. . SET YGUELTIG=$PIECE(WEN1,Y,26)
	. . QUIT
	. QUIT
	IF ME=1!(ME=7)!(ME=9) SET YANZAHL=MENGE
	IF $PIECE(YPOSITION1,Y,126)=1 SET YANZAHL=MENGE   ;ANZAHL= AUFKLEBERMENGE
	IF +$PIECE(YPOSITION1,Y,126)=0 SET YANZAHL=1   ;NICHT ANZAHL= AUFKLEBERMENGE  SONDERN 1 AUFKLEBER ;Not sticker 
	IF AART=4 SET YANZAHL=1   ;KLEINTEILE
	IF +$PIECE(YPOSITION1,Y,131)'=0  SET YANZAHL=$PIECE(YPOSITION1,Y,131)  ;BESTIMMTE ANZAHL AUFKLEBER ;Number sticker 
	IF YKEY'=""
	SET SERIENNUMMER=""
	SET SERIEOK=0
	SET YBARCODE=""
	FOR YI=1:1:YANZAHL DO
	. SET YCOLLX=$PIECE(YPOSITION1,Y,130)
	. IF +YCOLLX=0 SET YCOLLX=1
	. FOR YCOLLY=1:1:YCOLLX DO DRUCK   ;TYBD;1.07.2003;23871;AUSWERTUNG ANZAHL DER COLLI
	. SET YKLEBERANZ=$GET(YKLEBERANZ)+1 
	. IF YKLEBERANZ#5=0 DO FF^WWWW()
	. QUIT   
	QUIT
	
DRUCK ;STARTEN DES AUFKLEBERS ;launching 
	IF BET'="" IF WEN'="" IF LAP'="" DO  ;PRUEFUNG SERIENNUMMER
	. IF $DATA(^INWEAUFS(YM,YAUFTRAG,YPOSITION,BET,LAP,WEN)) DO  ;VORHANDEN ;on hand 
	. . IF SERIEOK=1 IF SERIENNUMMER="" QUIT  ;KEINE SERIENNUMMER MEHR ;no more 
	. . SET SERIENNUMMER=$ORDER(^INWEAUFS(YM,YAUFTRAG,YPOSITION,BET,LAP,WEN,SERIENNUMMER))   ;NEXT SERIENNUMMER
	. . SET SERIEOK=1
	. . QUIT
	. QUIT
	IF $GET(SERIENNUMMER)="" IF $GET(YMENGE)=1 SET SERIENNUMMER=$PIECE(YPOSITION1,Y,56)
	IF YKLART=1 DO   ;AUFKLEBERART1=WARENANNAHME
	. ;
	. ;AUFKLEBERDRUCK NACH HTML-VORLAGE ;within 
	. ;---------------------------------------------------------------------------------------------------------------
	. IF $DATA(^WWWHTML($$^WWWYM("WWWHTML"),"INKLEBHTML",SPRACHE,1)) IF $PIECE($GET(^(1)),Y,1)'="" DO ^INKLEBHTML QUIT
	. ;---------------------------------------------------------------------------------------------------------------
	. ;
	. DO FRAMEON
	. WRITE "<TR>"
	. WRITE "<TH COLSPAN=2 ALIGN=LEFT VALIGN=MIDDLE>"
	. DO HEADER
	. WRITE "</TH>"
	. WRITE "</TR>"
	. ;
	. WRITE "<TR>"
	. WRITE "<TD WIDTH=80%>"
	. WRITE YCR
	. ;
	. WRITE "<TABLE BORDER=0>"
	. ;DO ARTIKEL ;item 
	. DO WENUM
	. DO WEDAT
	. DO VERFALL
	. DO SERIE
	. DO AUFTRAG
	. DO KOMMISSION
	. WRITE "</TABLE>"
	. ;
	. WRITE "<TD ALIGN=MIDDLE VALIGN=MIDDLE>"
	. DO BARCODE
	. WRITE "</TD>"
	. WRITE "</TR>"
	. DO FRAMEOFF
	. WRITE "<BR>"
	. QUIT
	QUIT
	
FRAMEON ;FRAME EINSCHALTEN ;switch in 
	WRITE YCR
	DO FS^WWWTAB("<B>"_$EXTRACT($PIECE($GET(^WWW012(0,YM,1)),Y,1),1,32)_"</B>",4)  ;MANDANT
	WRITE "<TABLE BORDER=0 CELLSPACING=0 WIDTH=100% HEIGHT=100>"
	QUIT
	
FRAMEOFF ;FRAME AUSSCHALTEN ;eliminate 
	WRITE YCR
	WRITE "</TABLE>"
	DO FSE^WWWTAB
	QUIT
	
HEADER ;KOPF ;pate 
	WRITE YCR
	WRITE "<TABLE BORDER=0 WIDTH=100%>"
	WRITE "<TR>"
	WRITE "<TD ALIGN=LEFT NOWRAP>"
	WRITE "<FONT SIZE=3>"
	WRITE "<B>"
	WRITE $EXTRACT($TRANSLATE($PIECE(YPOSITION1,Y,1),"|"," "),1,40)  ;ARTIKELBEZEICHNUNG
	;WRITE $EXTRACT($PIECE($GET(^WWW012(0,YM,1)),Y,1),1,32)  ;MANDANT
	WRITE "</TD>"
	WRITE "<TD ALIGN=RIGHT NOWRAP>"
	WRITE "<FONT SIZE=4>"
	WRITE "<B>"
	WRITE " "
	WRITE $$^WWWTEXT(32118)_":"  ;COLLI
	WRITE "&nbsp;"
	SET YCOLLI=$PIECE(YPOSITION1,Y,130)
	IF +YCOLLI=0 SET YCOLLI=1
	IF YCOLLX>1 WRITE $GET(YCOLLY)_"/"  ;23871;TYBD;01,07,2003;COLLI AUSWERTEN
	WRITE YCOLLI
	WRITE "&nbsp;"
	WRITE "&nbsp;"
	WRITE "&nbsp;"
	WRITE "&nbsp;"
	WRITE $$^WWWTEXT(32024)_":"   ;ARTIKEL ;item 
	WRITE "&nbsp;"
	WRITE $PIECE(YPOSITION1,Y,4)
	WRITE "</B>"
	WRITE "</TD>"
	WRITE "</TR>"
	WRITE "</FONT>"
	WRITE "</TABLE>"
	QUIT
	
AUFTRAG ;AUFTRAG POSITIONSNUMMER ;order 
	WRITE YCR
	WRITE "<TR>"
	WRITE "<TD ALIGN=RIGHT>"
	W "<FONT SIZE=2>"
	;WRITE "<B>"
	WRITE $$^WWWTEXT(32047)_":"  ;AUFTRAG ;mandate  ;order 
	WRITE "&nbsp;"
	WRITE "</TD>"
	WRITE "<TD ALIGN=LEFT>"
	W "<FONT SIZE=2>"
	;WRITE "<B>"
	WRITE YAUFTRAG
	WRITE " - ",YPOSITION
	WRITE " " 
	IF $$^WWWACCESS("",$PIECE($GET(^INVORG(YM,YM,1)),Y,35))=1 DO   ; BERECHTIGUNG
	. IF $PIECE(YAUFTRAG1,Y,1)'="" WRITE $EXTRACT($PIECE($GET(^INKUNDE(YM,$PIECE(YAUFTRAG1,Y,1),1)),Y,8),1,20)
	. IF $PIECE(YAUFTRAG1,Y,12)'="" WRITE $EXTRACT($PIECE($GET(^INLIEF(YM,$PIECE(YAUFTRAG1,Y,12),1)),Y,8),1,20)
	. QUIT
	IF $$^WWWACCESS("",$PIECE($GET(^INVORG(YM,YM,1)),Y,35))'=1 DO   ;KEINE BERECHTIGUNG ;no 
	. IF $PIECE(YAUFTRAG1,Y,1)'="" WRITE $PIECE(YAUFTRAG1,Y,1)," "
	. IF $PIECE(YAUFTRAG1,Y,12)'="" WRITE $PIECE(YAUFTRAG1,Y,12)
	. QUIT
	WRITE "</TD>"
	WRITE "</TR>"
	QUIT
	
WENUM ;CHARGENNUMMER
	WRITE YCR
	WRITE "<TR>"
	WRITE "<TD ALIGN=RIGHT>"
	W "<FONT SIZE=2>"
	;WRITE "<B>"
	WRITE $$^WWWTEXT(32115)_":"   ;CHARGENNUMMER
	WRITE "&nbsp;"
	WRITE "</TD>"
	WRITE "<TD ALIGN=LEFT>"
	W "<FONT SIZE=2>"
	;WRITE "<B>"
	WRITE $GET(YCHARGE)
	;WRITE "</B>"
	WRITE "</TD>"
	WRITE "</TR>"
	QUIT
	
WEDAT ;DATUM ;Date  ;Date Date 
	WRITE YCR
	WRITE "<TR>"
	WRITE "<TD ALIGN=RIGHT>"
	W "<FONT SIZE=2>"
	;WRITE "<B>"
	WRITE $$^WWWTEXT(32117)_":"   ;WARENEINGANGSNUMMER
	WRITE "&nbsp;"
	WRITE "</TD>"
	WRITE "<TD ALIGN=LEFT>"
	W "<FONT SIZE=2>"
	;WRITE "<B>"
	IF WEN'="" DO  ;DATUM UND WARENEINGANG ;Date And receiving 
	. WRITE $$^WWWDATE(WEN)_" "_BET_" / "_LAP
	. QUIT
	W "&nbsp;"
	WRITE "</TD>"
	WRITE "</TR>"
	QUIT
	
VERFALL ;VERFALLSDATUM
	WRITE YCR
	WRITE "<TR>"
	WRITE "<TD ALIGN=RIGHT>"
	W "<FONT SIZE=2>"
	;WRITE "<B>"
	DO             ;VERFALLSDATUM
	. IF $DATA(^WWW0031(0,"INWEAUF",25,SPRACHE,1)) IF $PIECE($GET(^WWW0031(0,"INWEAUF",25,SPRACHE,1)),Y,1)'="" WRITE $PIECE($GET(^(1)),Y,1)  QUIT
	. IF $DATA(^WWW003(0,"INWEAUF",25,1)) IF $PIECE($GET(^WWW003(0,"INWEAUF",25,1)),Y,1)'="" WRITE $PIECE($GET(^(1)),Y,1)  QUIT
	. QUIT
	WRITE ":"
	WRITE "&nbsp;"
	WRITE "</TD>"
	WRITE "<TD ALIGN=LEFT>"
	W "<FONT SIZE=2>"
	;WRITE "<B>"
	IF WEN'="" DO  ;DATUM UND WARENEINGANG ;Date And receiving 
	. WRITE $$^WWWDATE(YVERFALL)
	. QUIT
	WRITE "&nbsp;"
	WRITE "</TD>"
	WRITE "</TR>"
	QUIT
	
SERIE ;SERIENNUMMER
	WRITE YCR
	WRITE "<TR>"
	WRITE "<TD ALIGN=RIGHT>"
	W "<FONT SIZE=2>"
	;WRITE "<B>"
	WRITE $$^WWWTEXT(32116)_":"   ;SERIENNUMMER
	WRITE "&nbsp;"
	WRITE "</TD>"
	WRITE "<TD ALIGN=LEFT>"
	W "<FONT SIZE=2>"
	;WRITE "<B>"
	WRITE $GET(SERIENNUMMER)
	WRITE "</TD>"
	WRITE "</TR>"
	QUIT
	
ARTIKEL ;Artikelbeschreibung ;Labelling 
	WRITE YCR
	WRITE "<TR>"
	WRITE "<TD ALIGN=LEFT COLSPAN=2>"
	WRITE "<B>"
	;WRITE $EXTRACT($TRANSLATE($PIECE(YPOSITION1,Y,1),"|"," "),1,40)
	WRITE "</B>"
	WRITE "</TD>"
	;WRITE "<TD ALIGN=LEFT>"
	;WRITE "</TD>"
	WRITE "</TR>"
	QUIT
	
KOMMISSION      ;KOMMISSION ;errand 
	WRITE YCR
	WRITE "<TR>"
	WRITE "<TD ALIGN=RIGHT>"
	W "<FONT SIZE=2>"
	;WRITE "<B>"
	WRITE $$^WWWTEXT(32114)_":"   ;KOMMISSION ;errand 
	WRITE "&nbsp;"
	WRITE "</TD>"
	WRITE "<TD ALIGN=LEFT>"
	W "<FONT SIZE=2>"
	;WRITE "<B>"
	WRITE $PIECE(YAUFTRAG1,Y,8)
	WRITE "</TD>"
	WRITE "</TR>"
	QUIT
	
BARCODE ;BARCODE
	WRITE YCR
	WRITE "<CENTER>"
	WRITE YCR
	NEW GIF
	SET GIF="gif"_YARTIKEL_".gif"
	;D ^WWWBARC(FILE,BARCODETYPE[B25,B25A,B25I,B25M,B25D,BCB,C39,EAN13],BARCODE,PRUEFSUMMEBILDEN[0,1],LÄNGEDESBARCODES[20],DEHNUNGSFAKTOR[1],KLARSCHRIFTTEXT,HORIZONTALODERVERTIKAL[H,V])
	;DO ^WWWBARC($PIECE($GET(^WWW012(0,YM,1)),Y,49)_GIF,"B25",YARTIKEL,1,60,1,YARTIKEL,"H")
	DO ^WWWBAR(YARTIKEL,,,1)          ;bec;11.12.03;24816;WWWBARCODE DURCH WWWBAR ERSETZT
	WRITE YCR
	WRITE "<IMG SRC="_""""_YGIF_GIF_""""_">"  ;BILD ANZEIGEN ;portrait display 
	WRITE YCR
	WRITE "</CENTER>"
	WRITE YCR
	QUIT
]]></Routine>
</Export>