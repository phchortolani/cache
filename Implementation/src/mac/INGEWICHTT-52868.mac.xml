<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="22" zv="CACHE" ts="2001-01-01 00:00:00">
<Routine name="INGEWICHTT" type="MAC" languagemode="0" timestamp="58440,0"><![CDATA[
INGEWICHTT(YART,YMENGE,YLAENGE,YBREITE,YHOEHE)        ;INGEWICHTT;DT;GESAMTGEWICHT DES ARTIKELTEILS;30.08.2000
	;
	;/------------------------------------------------------------------\
	;| Description of Function :
	;|		GESAMTGEWICHT DES ARTIKELTEILS
	;|
	;| Inputs : 
	;|
	;|
	;| ByRef :
	;|
	;|
	;| Returns :
	;|
	;|
	;| History :
	;|
	;| DT	30.08.2000
	;|
	;\------------------------------------------------------------------/
	;
	;YART=ARTIKELNUMMER
	;YMENGE=ARTIKELTEILEMENGE
	SET YLAENGE=$GET(YLAENGE)
	SET YBREITE=$GET(YBREITE)
	SET YHOEHE=$GET(YHOEHE)
	IF +YLAENGE=0 SET YLAENGE=1  ;MINDESTENS 1
	NEW GEWICHT,TEIL,ARTIKEL1,MATERIAL,YART1,SPGEWICHT,HGEWICHT
	SET GEWICHT=""
	SET YART=$GET(YART)
	SET YMENGE=$GET(YMENGE)
	IF YART="" QUIT GEWICHT
	QUIT:$L(YART)>200 GEWICHT
	IF $DATA(^INARTT(YM,YART)) DO  ;ERRECHNEN GEWICHT DER TEILE ;wt. the 
	. SET TEIL="" FOR  SET TEIL=$ORDER(^INARTT(YM,YART,TEIL)) QUIT:TEIL=""  DO
	. . IF GEWICHT>1000000 QUIT
	. . SET ARTIKEL1=$GET(^INARTT(YM,YART,TEIL,1))  ;ARTIKELTEILEINFO
	. . QUIT:YART=$PIECE(ARTIKEL1,Y,1)  ;GLEICHES TEIL;TYBD;28,11,2004;26567
	. . SET GEWICHT=GEWICHT+$PIECE(ARTIKEL1,Y,6)  ;GEWICHT  ;wt. 
	. . QUIT
	. QUIT
	SET YART1=$GET(^INART(YM,YART,1))
	IF $PIECE(YART1,Y,40)=5 IF +YLAENGE=0 SET YLAENGE=1  ;MINDESTENS 1
	IF $PIECE(YART1,Y,40)=6 IF +YLAENGE=0 SET YLAENGE=1  ;MINDESTENS 1
	IF $PIECE(YART1,Y,40)=12 IF +YLAENGE=0 SET YLAENGE=1  ;MINDESTENS 1
	IF $PIECE(YART1,Y,40)=18 IF +YLAENGE=0 SET YLAENGE=1000  ;MINDESTENS 1000
	IF $PIECE(YART1,Y,40)=20 IF +YLAENGE=0 SET YLAENGE=1000  ;MINDESTENS 1000
	IF +YLAENGE=0 SET YLAENGE=1000  ;MINDESTENS 1000
	SET MATERIAL=$PIECE(YART1,Y,37)  ;MATERIAL
	IF MATERIAL'="" DO
	. IF +YLAENGE'=0 IF +YBREITE'=0 IF +YHOEHE'=0 DO
	. . SET SPGEWICHT=$PIECE($GET(^INMATERIAL(YM,MATERIAL,1)),Y,2)
	. . IF +SPGEWICHT'=0 SET GEWICHT=(YLAENGE/100)*(YBREITE/100)*(YHOEHE/100)*SPGEWICHT   ;GEWICHT IN KG/dm2 ;wt. within 
	. . QUIT
	. QUIT
	SET YGEWICHT=0 ;GEWICHT*MENGE?
	IF $PIECE(YART1,Y,40)=4 SET GEWICHT=YMENGE SET YGEWICHT=1  ;WENN KG DANN KG ;when 
	IF $PIECE(YART1,Y,40)=14 SET GEWICHT=YMENGE/1000 SET YGEWICHT=1  ;WENN G DANN KG/1000 ;when g 
	SET HGEWICHT=$PIECE(YART1,Y,172)  ;HANDELSGEWICHT
	IF $PIECE(YART1,Y,40)'=14 IF $PIECE(YART1,Y,40)'=4 IF +HGEWICHT'=0 DO  ; HG RECHNEN ;have faith in 
	. IF $PIECE(YART1,Y,40)=5 IF +YLAENGE'=0 DO  QUIT  ;LAUFENDER METER ;metre 
	. . SET GEWICHT=YLAENGE*HGEWICHT   ;GEWICHT IN KG/m ;wt. within 
	. . IF YLAENGE'=1 SET YGEWICHT=1
	. . QUIT
	. IF $PIECE(YART1,Y,40)=18 IF +YLAENGE'=0 DO  QUIT  ;LAUFENDER mm
	. . SET GEWICHT=(YLAENGE/1000)*HGEWICHT   ;GEWICHT IN KG/m ;wt. within 
	. . IF YLAENGE'=1000 SET YGEWICHT=1
	. . QUIT
	. IF $PIECE(YART1,Y,40)=6 IF +YLAENGE'=0 IF +YBREITE'=0 DO  QUIT  ;m2
	. . SET GEWICHT=YLAENGE*YBREITE*HGEWICHT   ;GEWICHT IN KG/m ;wt. within 
	. . SET YGEWICHT=1
	. . QUIT
	. IF $PIECE(YART1,Y,40)=12 IF +YLAENGE'=0 IF +YBREITE'=0 IF +YHOEHE'=0 DO  QUIT  ;m3
	. . SET GEWICHT=YLAENGE*YBREITE*YHOEHE*HGEWICHT   ;GEWICHT IN KG/m ;wt. within 
	. . SET YGEWICHT=1
	. . QUIT
	. IF $PIECE(YART1,Y,40)=20 IF +YLAENGE'=0 IF +YBREITE'=0 DO  QUIT   ;mm2
	. . SET GEWICHT=(YLAENGE/1000)*(YBREITE/1000)*HGEWICHT   ;GEWICHT IN KG/m ;wt. within 
	. . SET YGEWICHT=1
	. . QUIT
	. IF +YLAENGE'=0 IF +YBREITE'=0 IF +YHOEHE'=0 DO  QUIT  ;
	. . SET GEWICHT=(YLAENGE/1000)*(YBREITE/1000)*(YHOEHE/1000)*HGEWICHT   ;GEWICHT IN KG/m ;wt. within 
	. . QUIT
	. IF +YLAENGE'=0 IF +YBREITE'=0 DO  QUIT  ;ZB. STÃœCK MIT M*M*HG ;spare part by means of 
	. . SET GEWICHT=(YLAENGE/1000)*(YBREITE/1000)*HGEWICHT   ;GEWICHT IN KG/m ;wt. within 
	. . QUIT
	. IF +YLAENGE'=1 IF +YLAENGE'=1000 DO   ;HG
	. . IF YLAENGE>10 SET GEWICHT=(YLAENGE/1000)*HGEWICHT
	. . IF YLAENGE<10 SET GEWICHT=YLAENGE*HGEWICHT
	. . QUIT
	. QUIT
	IF +$PIECE(YART1,Y,255)=1 DO  
	. SET GEWICHT=$PIECE(YART1,Y,43)  ;KEINE NEURECHNUNG DES GEWICHTES ;no 
	. IF +$PIECE(GEWICHT,".",2)'=0 SET GEWICHT=$JUSTIFY(GEWICHT,0,3)
	. QUIT
	IF GEWICHT="" SET GEWICHT=$PIECE(YART1,Y,43)   ;GEWICHT AUS ARTIKEL, WENN KEIN GEWICHT
	IF GEWICHT>1000000 QUIT 0
	IF $PIECE(YART1,Y,40)'=4 IF $PIECE(YART1,Y,40)'=14 DO
	. IF YGEWICHT=1 QUIT  ;SCHON BERECHNET  ;yet 
	. IF +YMENGE'=0 SET GEWICHT=GEWICHT*YMENGE
	. QUIT
	IF +GEWICHT=0 SET GEWICHT=""
	IF +$PIECE(GEWICHT,".",2)=0 QUIT $JUSTIFY(GEWICHT,0,0)  ;KEINE NACHKOMMA ;no 
	QUIT $JUSTIFY(GEWICHT,0,3)  ;MAX 3 NACHKOMMA = g
]]></Routine>
</Export>