<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="22" zv="CACHE" ts="2001-01-01 00:00:00">
<Routine name="INDRUCKEDIP2" type="MAC" languagemode="0" timestamp="58440,0"><![CDATA[
INDRUCKEDIP2
	;-------------------------------------------------------------------------------
	; Description of Function :
	;		DRUCKEN ANSCHRIFT EDI
	;
	; Inputs : 
	;
	;
	; ByRef :
	;
	;
	; Returns :
	;
	;
	; History :
	; 19.06.2002	DT
	;-------------------------------------------------------------------------------
	NEW YKUNDEX,YADRESX
	
	SET YKUNDEX=YKUNDE  ;ZWISCHENSPEICHERN
	SET YADRESX=YADRES
	IF $PIECE($G(YVERBAND1),Y,71)=1 DO  ;VERBAND ERHÃ„LT RECHNUNG ;ligature tab 
	. SET YKUNDE=YVERBAND
	. SET YADRES=YVERBAND1
	
	QUIT:YBETRIEB=""
	
	SET YBETRIEB1=$GET(^WWW0121(0,YM,YBETRIEB,1))
	SET QUAL="SE"
	IF YBELEG=3  SET QUAL="BY"  ;BESTELLUNG ;sales order 
	IF YBELEG=13 SET QUAL="BY"  ;BESTELLUNG STORNO  
	IF YBELEG=10 SET QUAL="BY"  ;ANFRAGE
	;DO EDI^INDRUCK("NAD+"_QUAL_"+++"_$PIECE(YBETRIEB1,Y,2)_":"_$PIECE(YBETRIEB1,Y,3)_"+"_$PIECE(YBETRIEB1,Y,4)_"+"_$PIECE(YBETRIEB1,Y,8)_"+"_$PIECE(YBETRIEB1,Y,6)_"++"_$P(YBETRIEB1,Y,17))
	
	;EIGENE ADRESSE ;address 
	SET QUAL="SE"
	IF YBELEG=3  SET QUAL="BY"  ;BESTELLUNG ;sales order 
	IF YBELEG=13 SET QUAL="BY"  ;BESTELLUNG STORNO  
	IF YBELEG=10 SET QUAL="BY"  ;ANFRAGE
	SET A="N1*"_QUAL_"*"_$PIECE(YBETRIEB1,Y,2)_"*9*"_$PIECE($GET(^INVORG(YM,YM,1)),Y,101)
	DO EDIP^INDRUCK(A)
	SET A="N3*"_$PIECE(YBETRIEB1,Y,3)_"**"
	DO EDIP^INDRUCK(A)
	SET A="N4*"_$PIECE(YBETRIEB1,Y,8)_"*"_$PIECE(YBETRIEB1,Y,4)_"*"_$PIECE(YBETRIEB1,Y,6)_"*"_$PIECE(YBETRIEB1,Y,17)
	DO EDIP^INDRUCK(A)
	
	;ANDERE ADRESSE ;address 
	SET QUAL="BY"
	IF YBELEG=3  SET QUAL="SE"  ;BESTELLUNG ;sales order
	IF YBELEG=13 SET QUAL="SE"  ;BESTELLUNG STORNO   
	IF YBELEG=10 SET QUAL="SE"  ;ANFRAGE
	SET A="N1*"_QUAL_"*"_$PIECE(YADRES,Y,4)_"*9*"_$PIECE($GET(YADRES),Y,201)
	DO EDIP^INDRUCK(A)
	SET A="N3*"_$PIECE(YADRES,Y,6)_"*"_$PIECE(YADRES,Y,7)_"*"
	DO EDIP^INDRUCK(A)
	SET A="N4*"_$PIECE(YADRES,Y,16)_"*"_$PIECE(YADRES,Y,10)_"*"_$PIECE(YADRES,Y,12)_"*"_$PIECE(YBETRIEB1,Y,17)
	DO EDIP^INDRUCK(A)
	SET YKUNDE=YKUNDEX   ;ZURUECK   
	SET YADRES=YADRESX
	QUIT
	
]]></Routine>
</Export>