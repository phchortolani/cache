<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="22" zv="CACHE" ts="2001-01-01 00:00:00">
<Routine name="WWWPROMIT" type="MAC" languagemode="0" timestamp="58440,0"><![CDATA[
WWWPROMIT ;WWWPROMIT;DT;PROTOKOLLDATEI JE MITARBEITER;27.12.1999
	;
	;/------------------------------------------------------------------\
	;| Description of Function :
	;|		PROTOKOLLDATEI JE MITARBEITER
	;|
	;| Inputs : 
	;|
	;|
	;| ByRef :
	;|
	;|
	;| Returns :
	;|
	;|
	;| History :
	;|
	;| DT	27.12.1999
	;|
	;\------------------------------------------------------------------/
	;
	;ausdruck der Protokolldatei ;who 
	NEW ANZM,UES,YDATEI,DATUM,UHR,YDATUM,YQ
	WRITE "<FONT FACE=ARIAL>"
	WRITE "<FONT SIZE=1>"
	SET VORG(1)=$TRANSLATE(VORG(1),",",";")
	IF $TRANSLATE(VORG(1),";")="" SET VORG(1)=""
	IF VORG(2)="" SET VORG(2)=+$HOROLOG
	IF VORG(3)="" SET VORG(3)=+$HOROLOG
	SET VORG(4)=$GET(VORG(4))
	IF VORG(4)="" DO ^WWWINFO($$^WWWTEXT(32310)) QUIT  ;KEINE AUSWAHL GETROFFEN ;no Selection 
	;BEARBEITEN ÜBERSCHRIFT ;superscription 
	;DATUM;UHRZEIT;BEDIENER;KEY;ALT/NEU
	SET UES(1)=$$^WWWTEXT(124)_Y_$$^WWWTEXT(187)_Y_$$^WWWTEXT(232)_Y_$$^WWWTEXT(184)_Y_$$^WWWTEXT(129)_"/"_$$^WWWTEXT(130)_Y
	DO ^WWWBACK
	SET ANZM=0
	SET YDATEI="" FOR  SET YDATEI=$ORDER(^WWWPRO(YM,YDATEI))  QUIT:YDATEI=""  DO
	. IF VORG(1)'="" QUIT:'$FIND(";"_VORG(1)_";",";"_YDATEI_";")
	. SET YQ=1
	. ;SET DATUM=VORG(2)-1 FOR YDATUM=1:1:30 SET DATUM=$ORDER(^WWWPRO(YM,YDATEI,DATUM)) QUIT:DATUM=""  QUIT:DATUM>VORG(3)  DO  QUIT:YQ=0
	. SET DATUM=VORG(2)-1 FOR YDATUM=1:1 SET DATUM=$ORDER(^WWWPRO(YM,YDATEI,DATUM)) QUIT:DATUM=""  QUIT:DATUM>VORG(3)  DO  QUIT:YQ=0
	. . SET UHR="" FOR  SET UHR=$ORDER(^WWWPRO(YM,YDATEI,DATUM,UHR)) QUIT:UHR=""  DO  QUIT:YQ=0
	. . . IF $DATA(^WWWPRO(YM,YDATEI,DATUM,UHR,VORG(4))) SET YQ=0
	. . . QUIT
	. . QUIT
	. QUIT:YQ=1
	. DO UPUEB  ;DRUCKEN ÜBERSCHRIFT ;print superscription 
	. DO DRUCK   ;WERTE DRUCKEN ;print 
	. DO STOP^WWWTAB  ;ENDE TABELLE ;termination tabulation 
	. WRITE "<BR><BR>"
	. QUIT
	IF ANZM=0 WRITE "<FONT SIZE=2 color=red><B>"_$$^WWWTEXT(46)_"</B></font>&nbsp;"  ;KEINE DATEN VOHANDEN
	QUIT
	
DRUCK ;AUSWERTUNG DRUCKEN ;print 
	NEW BED,UHR,DATUM,KEY,ALT,NEU,ART,YDATUM,YDDSATZ
	SET YDDSATZ=0
	DO
	. SET DATUM=VORG(2)-1 FOR YDATUM=1:1:30 SET DATUM=$ORDER(^WWWPRO(YM,YDATEI,DATUM)) QUIT:DATUM=""  QUIT:DATUM>VORG(3)  DO
	. . SET UHR="" FOR  SET UHR=$ORDER(^WWWPRO(YM,YDATEI,DATUM,UHR)) QUIT:UHR=""  DO
	. . . SET BED=VORG(4)
	. . . SET KEY="" FOR  SET KEY=$ORDER(^WWWPRO(YM,YDATEI,DATUM,UHR,BED,KEY)) QUIT:KEY=""  DO
	. . . . SET ALT=$GET(^WWWPRO(YM,YDATEI,DATUM,UHR,BED,KEY,0,1))
	. . . . SET NEU=$GET(^WWWPRO(YM,YDATEI,DATUM,UHR,BED,KEY,1,1))
	. . . . WRITE !
	. . . . WRITE YCR
	. . . . SET ANZM=ANZM+1
	. . . . ;
	. . . . DO NL^WWWTAB
	. . . . DO NF^WWWTAB
	. . . . WRITE $$^WWWDATE(DATUM)
	. . . . DO ZW^WWWTAB
	. . . . WRITE $$^WWWTIME(UHR)
	. . . . DO ZW^WWWTAB
	. . . . WRITE $PIECE($GET(^WWW013(0,BED,1)),Y,1)  ;BEDIENER
	. . . . DO ZW^WWWTAB
	. . . . WRITE KEY   ;SCHLÜSSEL ;wrench 
	. . . . DO ZW^WWWTAB
	. . . . WRITE $$^WWWTEXT(129)  ;ALT ;stale 
	. . . . SET YLFN="" FOR  SET YLFN=$ORDER(^WWW003(0,YDATEI,YLFN)) QUIT:YLFN=""  DO
	. . . . . DO ZW^WWWTAB
	. . . . . SET YINHALT=$PIECE(ALT,Y,YLFN)
	. . . . . IF YINHALT'=$PIECE(NEU,Y,YLFN) WRITE "<FONT COLOR=RED>"
	. . . . . ;IF YINHALT'="" DO DATEN^WWWSEAR3 WRITE YINHALT
	. . . . . IF YINHALT'="" SET YINHALT=$$^WWWFORMAT(YDATEI,"D",YLFN,YINHALT) WRITE $TRANSLATE(YINHALT,"<>"_"""","()´")
	. . . . . ; 
	. . . . . IF YINHALT="" WRITE "&nbsp;"
	. . . . . QUIT
	. . . . DO EF^WWWTAB
	. . . . DO EL^WWWTAB
	. . . . ; AB HIER NEUER DATENSATZ ;Confirm. here is data record 
	. . . . WRITE !
	. . . . WRITE YCR
	. . . . DO NL^WWWTAB
	. . . . DO NF^WWWTAB
	. . . . WRITE "&nbsp;"
	. . . . DO ZW^WWWTAB
	. . . . WRITE "&nbsp;"
	. . . . DO ZW^WWWTAB
	. . . . WRITE "&nbsp;"
	. . . . DO ZW^WWWTAB
	. . . . WRITE "&nbsp;"
	. . . . DO ZW^WWWTAB
	. . . . WRITE $$^WWWTEXT(130)  ;neu ;recent 
	. . . . SET YLFN="" FOR  SET YLFN=$ORDER(^WWW003(0,YDATEI,YLFN)) QUIT:YLFN=""  DO
	. . . . . DO ZW^WWWTAB
	. . . . . SET YINHALT=$PIECE(NEU,Y,YLFN)
	. . . . . IF YINHALT'=$PIECE(ALT,Y,YLFN) WRITE "<FONT COLOR=RED>"
	. . . . . ;IF YINHALT'="" DO DATEN^WWWSEAR3 WRITE YINHALT
	. . . . . IF YINHALT'="" S YINHALT=$$^WWWFORMAT(YDATEI,"D",YLFN,YINHALT) WRITE $TRANSLATE(YINHALT,"<>"_"""","()´")
	. . . . . IF YINHALT="" WRITE "&nbsp;"
	. . . . . QUIT
	. . . . DO EF^WWWTAB
	. . . . DO EL^WWWTAB
	. . . . QUIT
	. . . QUIT
	. . QUIT
	. QUIT
	IF ANZM=0 DO
	. NEW YLFN
	. SET YDDSATZ=YDDSATZ+1
	. SET ANZM=ANZM+1
	. WRITE "<TD NOWRAP VALIGN=TOP COLSPAN=4"
	. IF $GET(YDDSATZ)'="" DO 
	. . IF $GET(YDDSATZ)#2=1 WRITE " BGCOLOR="_YWHITE
	. . IF $GET(YDDSATZ)#2=0 WRITE " BGCOLOR="_YGRAY
	. . QUIT
	. WRITE ">"
	. WRITE "<FONT SIZE=1>"
	. WRITE $$^WWWTEXT(46)_"&nbsp;"  ;KEINE DATEN VOHANDEN
	. DO NF^WWWTAB
	. WRITE "&nbsp;"
	. DO EF^WWWTAB
	. SET YLFN="" FOR  SET YLFN=$ORDER(^WWW003(0,YDATEI,YLFN)) QUIT:YLFN=""  DO
	. . DO NF^WWWTAB
	. . WRITE "&nbsp;"
	. . DO EF^WWWTAB
	. . QUIT
	. DO EL^WWWTAB
	. QUIT
	QUIT
	
UPUEB ;ÜBERSCHRIFT TABELLE ;superscription tabulation 
	WRITE "<CENTER>"
	WRITE "<FONT SIZE=3>"
	DO START00^WWWTAB
	DO NL^WWWTAB
	DO NHWO^WWWTAB
	WRITE $$^WWWTEXT(123)_" "_YDATEI
	WRITE "<BR>"
	WRITE $$^WWWDATE(VORG(2))_" - "_$$^WWWDATE(VORG(3))
	WRITE "<BR>"
	WRITE "("_VORG(4)_") "_$PIECE($GET(^WWW013(0,VORG(4),1)),Y,1)
	DO EH^WWWTAB
	DO EL^WWWTAB
	DO STOP^WWWTAB
	WRITE "<BR>"
	WRITE "</CENTER>"
	WRITE "</FONT>"
	DO START100^WWWTAB  ;STARTEN DER ÜBERSCHRIFT ;launching the superscription 
	DO NL^WWWTAB
	FOR I=1:1 QUIT:$PIECE(UES(1),Y,I,99)=""  DO NHW^WWWTAB WRITE $PIECE(UES(1),Y,I) DO EH^WWWTAB
	SET YLFN="" FOR  SET YLFN=$ORDER(^WWW003(0,YDATEI,YLFN)) QUIT:YLFN=""  DO
	. DO NHW^WWWTAB
	. WRITE $EXTRACT($PIECE(^WWW003(0,YDATEI,YLFN,1),Y,1),1,20)
	. DO EH^WWWTAB
	. QUIT
	DO EL^WWWTAB
	QUIT
]]></Routine>
</Export>