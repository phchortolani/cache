<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="22" zv="CACHE" ts="2001-01-01 00:00:00">
<Routine name="INPROPRODU2" type="MAC" languagemode="0" timestamp="58440,0"><![CDATA[
INPROPRODU2(YAUFTRAG,YPOS,YTEIL,YKEY,YALLES,YTYP)
#include COMSYS
#include INConst
	;-------------------------------------------------------------------------------
	; Description of Function :
	;		PRODUKTIONSANWEISUNG PRUCKEN
	;
	;	AUFRUF AUS DER ZEITÜBERSICHT DER PRODUKTION ;out of the the production 
	;	YTEST      ;BEC;24783;08.12.03;ZUM TEST, DRUCKT FERTIGUNGSANWEISUNG OHNE AUFTRAG 
	;	AUFRUF VON ARTIKELVERWALTUNG
	;	NEUE ROUTINE ZUM DRUCKEN DER FERTIGUNGSANWEISUNG  ;routine print the 
	; 
	; Inputs : 
	;	YAUFTRAG	
	;	YPOS		
	;	YTEIL		
	;	YKEY		ITEMNUMBER (FROM ITEM MASTER)
	;	YALLES		AUFRUF AUS FRENDFERTIGUNG
	;				=1			ALLE ANWEISUNGEN
	;				=9,3,4,5,6	ÜBERGABE AUS IMFREMDFERT FÜR AUSDRUCK
	;	YTYP					=1 ZUM ARTIKEL, =0 AUFTRAG
	;	
	; ByRef :
	;
	;
	; Returns :
	;
	;
	; History :
	; 27-Sep-2006	GRF		Doco; duplicate get YKEY/YALLES removed; YINVORG & macros;
	; 						YCR
	; 08.12.2003	BEC
	;-------------------------------------------------------------------------------
	new ANZEIGE,ABANZEIGE,BISANZEIGE,FBEGINN,FMASCH,FPLATZ,GEB,GESAMTZEIT,MITKOM,MITSTRUKTUR,MITZEITEN
	NEW UNTERPUNKT,UNTERTX,YAUF,YDATEI,YDATEI1,YERROR,YGESAMT,YHTML,YI,YINVORG,YSTEMPEL,YPOS,YTEIL1,ZEITFACT
	
	SET YKEY   = $GET(YKEY)              ;SCHLUESSEL AUS FORMULAR(BEARBEITEN DER FERTIGUNG) !KEINE WIEDERHOLUNG ;out of the repetition 
	IF YKEY="" QUIT:$GET(YAUFTRAG)=""
	IF YKEY="" QUIT:$GET(YPOS)=""
	
	SET YTYP   =+$GET(YTYP)
	SET YALLES = $GET(YALLES) 
	SET YTEIL  = $GET(YTEIL)
	
	SET YERROR   = ""
	SET YSTEMPEL = ""
	KILL ^WWWSOR(YUSER)         ;LÖSCHEN ZWISCHENDATEI ;Delete 
	SET YINVORG = $GET(^INVORG(YM,YM,1))
	SET YHTML   = +$$$INVORGPrintManufactureInstructn(YINVORG)       ; D110
	IF YTYP=0 DO SORTORDER      ;AUFBEREITEN SORTDATEI AUS  AUFTRAG  ;out of order 
	IF YTYP=1 DO SORTITEM       ;AUFBEREITEN SORTDATEI AUS ARTIKEL   ;out of item 
	;DO ^INPROPROHTML(YSTEMPEL)
	DO DRUCK     ;DRUCKEN FERTIGUNGSANWEISUNG ;print 
	;MUESSEN NOCH UMGESTELLT WERDEN ;yet will 
	DO ZEICHNUNG
	DO MATERIAL
	IF $PIECE(YINVORG,Y,120)=1 DO FERTIGMELDUNG
	QUIT
	
SORTITEM       ;AUFBEREITEN SORTDATEI AUS ARTIKEL ;out of item 
	NEW EBENE,KEY,SUCH,YART,YINVORG
	
	SET YKEY=$GET(YKEY)
	SET YART=YKEY
	SET YAUF=""
	SET YPOS=""
	SET YTEIL=""
	IF YART="" DO ^WWWINFO($$^WWWTEXT(46)) QUIT   ;  - keine Daten vorhanden )  ;None Data on hand 
	SET YSTEMPEL=YART   ;FERTIGUNGSNUMMER
	;DRUCKEN VOM KLEINARTIKEL BIS ZUM FERTIGEN PRODUKT ;print until 
	SET GESAMTZEIT=0  ;GESAMTZEIT DER GEPLANTEN FERTIGUNG ;the 
	SET UNTERPUNKT=0
	
	SET YINVORG = $GET(^INVORG(YM,YM,1))                    ; 27-Sep-2006
	SET MITKOM      = $$$INVORGCustOnManufactureInstructn(YINVORG)      ; D19   MIT KOMMISSIONEN? ;by means of 
	SET MITSTRUKTUR = $$$INVORGProductionOrdersWithSecti(YINVORG)       ; D27   MIT TEILESTRUKTUR? 1=JA ;by means of 
	SET MITZEITEN   = $$$INVORGManufacturingInstructionW1(YINVORG)      ; D42   OHNE EINZELZEITEN?  1=OHNE ;without 
	
	;+++++++++++++++++++++++++++++++++++++++
	;  YXL				objINARTXL
	;  YART1			objINART
	; -------------------------------------
	;  YDATEI			^INARTXL
	;+++++++++++++++++++++++++++++++++++++++
	
	;ZUSAMMENBAUEN DER DATEI ZUM DURCHSUCHEN DER EBENE ;the data file scour the plain 
	;OBERTEIL
	SET EBENE=0
	SET EBENE(EBENE)=$GET(EBENE(EBENE))+1
	SET ^WWWSOR(YUSER,"STRUCT","F",EBENE,0)=YART
	SET COLUMNS=0
	
	;UNTERTEILE
	SET SUCH="^INARTXL("_""""_YM_""""_","_""""_YART_""""
	SET SUCH=SUCH_")"
	FOR  DO  QUIT:SUCH=""
	. SET SUCH=$QUERY(@SUCH)
	. ;IF $PIECE(SUCH,",",2)'=YART SET SUCH=""  QUIT  ;FALSCHER ARTIKEL
	. IF $TRANSLATE($PIECE(SUCH,",",2),"""")'=YART SET SUCH=""  QUIT  ;BEC;25879;ALPHANUMMERISCH
	. SET EBENE=$LENGTH($PIECE(SUCH,",",3,99),",")
	. SET KEY=YART_","_$TRANSLATE($PIECE(SUCH,",",3,99),")")  ;TEILEKEY
	. IF $DATA(@SUCH)=11 DO   ;FERTIGUNGSTEIL
	. . SET EBENE(EBENE)=$GET(EBENE(EBENE))+1
	. . SET COLUMNS=COLUMNS+1
	. . IF $LENGTH(KEY,",")'>2 SET COL=+$PIECE(KEY,",",EBENE+1)
	. . IF $LENGTH(KEY,",")>2 SET COL=+$PIECE(KEY,",",EBENE)
	. . FOR  QUIT:'$DATA(^WWWSOR(YUSER,"ORDER",YART,"STRUCT","F",EBENE,COL))  SET COL=COL+1
	. . SET ^WWWSOR(YUSER,"ORDER",YART,"STRUCT","F",EBENE,COL)=KEY  ;FERTIGUNGSTEIL
	. ;
	. IF $PIECE(@SUCH,Y,26)=2 SET ^WWWSOR(YUSER,"ORDER",YART,"STRUCT","L",EBENE,KEY)="" QUIT  ;LEISTUNG ;performance 
	. IF ($PIECE(@SUCH,Y,40)=2)!($PIECE(@SUCH,Y,40)=10)!($PIECE(@SUCH,Y,40)=11) SET ^WWWSOR(YUSER,YART,"STRUCT","L",EBENE,KEY)="" QUIT  ;FREMDLEISTUNG
	. SET ^WWWSOR(YUSER,"ORDER",YART,"STRUCT","M",EBENE,KEY)="" QUIT  ;MATERIAL
	
	SET EBENE=""
	FOR  SET EBENE=$ORDER(^WWWSOR(YUSER,"ORDER",YART,"STRUCT","F",EBENE)) QUIT:EBENE=""  DO
	. SET COL=""
	. FOR  SET COL=$ORDER(^WWWSOR(YUSER,"ORDER",YART,"STRUCT","F",EBENE,COL)) QUIT:COL=""  DO
	. . IF (COL+1)>COLUMNS SET COLUMNS=(COL+1)
	
	;FERTIGUNGSPLATZ/BEGINN/MASCHIENE
	SET YXL   = $GET(^INARTXL(YM,YART,1))
	SET YART1 = $GET(^INART(YM,YART,1))
	SET FBEGINN=$$^WWWDATE(+$HOROLOG)  ;FERTIGUNGSBEGINN
	SET FPLATZ=$PIECE(YART1,Y,61)
	IF FPLATZ'="" SET FPLATZ=$EXTRACT($PIECE($GET(^INPRONEST(YM,FPLATZ,1)),Y,1),1,12)   ;FERTIGUNGSPLATZ
	SET FMASCH="" 
	IF $PIECE(YART1,Y,57)'="" SET FMASCH=$EXTRACT($PIECE($GET(^INMASCH(YM,$PIECE(YART1,Y,57),1)),Y,1),1,12) ;FERTIGUNGSMASCHINE
	IF $PIECE(YART1,Y,57)'="" IF $PIECE($GET(^INMASCH(YM,$PIECE(YART1,Y,57),1)),Y,36)'="" DO
	. SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"ABTEILUNG")=$PIECE($GET(^WWW0124(YM,$PIECE($GET(^INMASCH(YM,$PIECE(YART1,Y,57),1)),Y,36),1)),Y,1)
	
	SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"DATUM")=$$^WWWDATE(+$HOROLOG)
	SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"KOMMISSIONSVORGANG")=$PIECE(YART1,Y,301)   ;NUR HTMLBELEGE ;only 
	DO ANWEISART
	QUIT
	
SORTORDER      ;AUFBEREITEN SORTDATEI AUS  AUFTRAG  ;out of order 
	IF YKEY'="" DO 
	. SET YAUFTRAG=$PIECE(YKEY,",",1)
	. SET YPOS=$PIECE(YKEY,",",2)
	. SET YTEIL=$PIECE(YKEY,",",3)
	
	QUIT:YAUFTRAG=""
	QUIT:YPOS=""
	
	SET YSTEMPEL=""   ;FERTIGUNGSNUMMER
	IF '$DATA(^INAUFPT(YM,YAUFTRAG,YPOS)) SET YERROR=$$^WWWTEXT(32988) QUIT                    ;tybd 30.04.2002; wegen nachkalkulation
	IF YTEIL'="" SET YSTEMPEL=$PIECE($GET(^INAUFPT(YM,YAUFTRAG,YPOS,YTEIL,1)),Y,165)           ;FERTIHUNGSNUMMER MIT TEIL  ;by means of part 
	IF YTEIL="" IF YSTEMPEL="" SET YSTEMPEL=$PIECE($GET(^INAUFP(YM,YAUFTRAG,YPOS,1)),Y,165)    ;OHNE TEIL /GESAMTAUFTRAG ;without part 
	IF YSTEMPEL="" DO ^INPROSTEMPEL(YAUFTRAG,YPOS_","_YTEIL,"",1)                              ;STEMPELNUMMER HOLEN ;send for 
	;DRUCKEN VOM KLEINARTIKEL BIS ZUM FERTIGEN PRODUKT ;print until 
	SET GESAMTZEIT=0  ;GESAMTZEIT DER GEPLANTEN FERTIGUNG ;the 
	SET UNTERPUNKT=0
	QUIT:YSTEMPEL=""
	SET YSTEMPEL1=$GET(^INPROSTEMP(YM,YSTEMPEL,1))                   ;STEMPELDATEN
	IF YSTEMPEL1="" SET YSTEMPEL1=$GET(^INPROSTEMP1(YM,YSTEMPEL,1))  ;AUS HISTORISCHEN STEMPELDATEN ;out of 
	SET YLFN=$PIECE(YSTEMPEL1,Y,6)
	SET YAUF=$PIECE(YSTEMPEL1,Y,1)
	QUIT:$GET(YAUF)=""
	SET YPOS=$PIECE(YSTEMPEL1,Y,3)
	QUIT:$GET(YPOS)=""
	SET MITKOM=$PIECE($GET(^INVORG(YM,YM,1)),Y,19)   		;MIT KOMMISSIONEN? ;by means of 
	SET MITSTRUKTUR=$PIECE($GET(^INVORG(YM,YM,1)),Y,27)   	;MIT TEILESTRUKTUR? 1=JA ;by means of 
	SET MITZEITEN=$PIECE($GET(^INVORG(YM,YM,1)),Y,42)   	;OHNE EINZELZEITEN?  1=OHNE ;without 
	;ZUSAMMENBAUEN DER DATEI ZUM DURCHSUCHEN DER EBENE ;the data file scour the plain 
	KILL YDATEI
	DO
	. SET YDATEI="^INAUFPXL("_""""_YM_""""
	. FOR YI=1:1 QUIT:$PIECE(YLFN,",",YI)=""  DO  
	. . SET YDATEI=YDATEI_","_""""_$PIECE(YLFN,",",YI)_""""
	. . SET YDATEI(YI)=YDATEI_")"  ;FÜR UNTERDATEIEN ;to 
	. ;
	. SET YDATEI(0)=YDATEI_")"
	. SET YXL=$GET(@(YDATEI(0)))   ;POSITIONSDATEN
	. ;
	. SET $PIECE(@(YDATEI(0)),Y,165)=YSTEMPEL
	. IF $PIECE(@(YDATEI(0)),Y,83)="" DO   ;WANN GEDRUCKT ;when 
	. . SET $PIECE(@(YDATEI(0)),Y,83)=+$HOROLOG
	. . SET $PIECE(@(YDATEI(0)),Y,51)=+$HOROLOG
	. . SET $PIECE(@(YDATEI(0)),Y,84)=$PIECE($HOROLOG,",",2)
	. . SET $PIECE(@(YDATEI(0)),Y,85)=YBED
	. . SET $PIECE(@(YDATEI(0)),Y,52)=YBED
	. ;
	. SET YDATEISUCH=YDATEI_","_"ANZEIGE"_")"  ;LAUFVARIABLE FÜR UNTERTEILE DATEN ;to 
	. SET YDATEI=YDATEI_","_"YI"_")"  ;LAUFVARIABLE FÜR UNTERTEILE DATEN ;to 
	
	;FERTIGUNGSPLATZ/BEGINN/MASCHIENE
	SET FBEGINN  =$PIECE(YXL,Y,168)  ;FERTIGUNGSBEGINN
	SET FPLATZ(0)=$PIECE(YXL,Y,61)
	SET FPLATZ="" 
	IF $PIECE(YXL,Y,61)'="" SET FPLATZ=$EXTRACT($PIECE($GET(^INPRONEST(YM,$PIECE(YXL,Y,61),1)),Y,1),1,12) ;FERTIGUNGSPLATZ
	SET FMASCH="" 
	IF $PIECE(YXL,Y,57)'="" SET FMASCH=$EXTRACT($PIECE($GET(^INMASCH(YM,$PIECE(YXL,Y,57),1)),Y,1),1,12) ;FERTIGUNGSMASCHINE
	IF $PIECE(YXL,Y,57)'="" IF $PIECE($GET(^INMASCH(YM,$PIECE(YXL,Y,57),1)),Y,36)'="" DO
	. SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"ABTEILUNG")=$PIECE($GET(^WWW0124(YM,$PIECE($GET(^INMASCH(YM,$PIECE(YXL,Y,57),1)),Y,36),1)),Y,1)
	
	SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"DATUM")=$$^WWWDATE(+$HOROLOG)
	SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"KOMMISSIONSVORGANG")=$PIECE($GET(^INART(YM,$PIECE(YXL,Y,4),1)),Y,301)   ;NUR HTMLBELEGE ;only 
	SET FIXPLATZ="" 
	DO
	. SET ANZEIGE=""
	. FOR  SET ANZEIGE=$ORDER(@(YDATEISUCH),-1) QUIT:ANZEIGE=""  DO  QUIT:FIXPLATZ'=""  ;SUCHEN IN UNTERTEILEDATEI WENN UNTERSCHIEDLICHE FERTIGUNGSMASCHIENEN ODER PLÄTZE ;seek within when Or 
	. . SET YXL1=$GET(@(YDATEISUCH))
	. . IF ($PIECE(YXL1,Y,40)=2)!($PIECE(YXL1,Y,40)=10)!($PIECE(YXL1,Y,40)=11) IF $PIECE(YXL1,Y,61)'="" SET FIXPLATZ=$PIECE(YXL1,Y,61) 
	
	IF FIXPLATZ="" SET FIXPLATZ=FPLATZ(0)
	IF FIXPLATZ'="" DO  ;NACHTRÄGLICH EINTRAGEN VON UNTEN NACH OBEN ;supplementary underneath within upstairs 
	. SET ANZEIGE=""
	. FOR  SET ANZEIGE=$ORDER(@(YDATEISUCH),-1) QUIT:ANZEIGE=""  DO  ;SUCHEN IN UNTERTEILEDATEI WENN UNTERSCHIEDLICHE FERTIGUNGSMASCHIENEN ODER PLÄTZE ;seek within when Or 
	. . SET YXL1=$GET(@(YDATEISUCH))
	. . IF $PIECE(YXL1,Y,40)=2!($PIECE(YXL1,Y,40)=10)!($PIECE(YXL1,Y,40)=11) IF $PIECE(YXL1,Y,61)'="" SET FIXPLATZ=$PIECE(YXL1,Y,61) QUIT
	. . SET $PIECE(@(YDATEISUCH),Y,61)=FIXPLATZ
	
	IF FIXPLATZ'="" SET FPLATZ=$EXTRACT($PIECE($GET(^INPRONEST(YM,FIXPLATZ,1)),Y,1),1,12) ;FERTIGUNGSPLATZ IN KLARSCHRIFT ;within 
	SET ANZEIGE    = 0  ;SUCHVARIABLE FUER FERTIGUNGSZWISCHENTEILE
	SET ABANZEIGE  = 0  ;AB TEILE POS ;Confirm. 
	SET BISANZEIGE = 0  ;BIS TEILEPOS ;until 
	SET YGESAMT    = 0  ;SUMME FÜR AUSFÜHRUNGSZEIT ;sum to execution time 
	KILL ^INPROSTEMPT(YM,YSTEMPEL)   ;Löschen der alten stempeldatei ;Delete who 
	FOR UNTERTX=1:1 SET ANZEIGE=$ORDER(@(YDATEISUCH)) QUIT:ANZEIGE=""  DO  ;SUCHEN IN UNTERTEILEDATEI WENN UNTERSCHIEDLICHE FERTIGUNGSMASCHIENEN ODER PLÄTZE ;seek within when Or 
	. SET YXL1=$GET(@(YDATEISUCH))                     ;DATENSATZ ;data record 
	. SET FPLATZ(1)=$PIECE(YXL1,Y,61)                  ;FERTIGUNGSPLATZ DES DATENSATZES
	. IF FIXPLATZ="" SET FIXPLATZ=FPLATZ(1)            ;WENN KEINE VORGABE ;when no default 
	. QUIT:UNTERTX=1                                   ;NICHT BEIM ERSTEN TEIL ;Not part 
	. QUIT:FIXPLATZ=FPLATZ(1)                          ;GLEICHER PLATZ ;same square 
	. SET BISANZEIGE=ANZEIGE                           ;NICHT DRUCKEN  (BISANZEIGE SOLL AUF NEXT  ;Not print upon 
	. IF $PIECE(YXL1,Y,168)'="" SET FBEGINN=$PIECE(YXL1,Y,168)  ;FERTIGUNGSBEGINN
	. IF FIXPLATZ'="" SET FPLATZ=$EXTRACT($PIECE($GET(^INPRONEST(YM,FIXPLATZ,1)),Y,1),1,12) ;FERTIGUNGSPLATZ IN KLARSCHRIFT ;within 
	. ;
	. DO ANWEIS                                        ;DRUCKEN ZWISCHENANWEISUNG ;print 
	. IF $ORDER(@(YDATEISUCH))'="" DO FF^WWWW()        ;FORMFEED
	. SET FIXPLATZ=FPLATZ(1)                           ;NEUER VORGABE PLATZ ;default square 
	. SET ABANZEIGE=ANZEIGE                            ;NÄCHSTE ANZEIGE AB ;next Show Confirm. 
	
	IF FIXPLATZ'="" SET FPLATZ=$EXTRACT($PIECE($GET(^INPRONEST(YM,FIXPLATZ,1)),Y,1),1,12) ;FERTIGUNGSPLATZ IN KLARSCHRIFT ;within 
	SET ANZEIGE=BISANZEIGE,ABANZEIGE=ANZEIGE
	IF ANZEIGE'="" IF $ORDER(@(YDATEISUCH))'=""!($GET(@(YDATEISUCH))'="") SET BISANZEIGE=999999 DO ANWEIS   ;REST DRUCKEN ;residue print 
	SET ANZEIGE="" IF $ORDER(@(YDATEISUCH))="" DO ANWEIS                                ;KEINE TEILE NUR HAUPTTEIL ;no only 
	IF $DATA(^INPROSTEMP(YM,YSTEMPEL))  SET $PIECE(^INPROSTEMP(YM,YSTEMPEL,1),Y,19)  = GESAMTZEIT
	IF $DATA(^INPROSTEMP1(YM,YSTEMPEL)) SET $PIECE(^INPROSTEMP1(YM,YSTEMPEL,1),Y,19) = GESAMTZEIT
	IF FPLATZ'="" SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"FERTIGUNGSPLATZ")    = FPLATZ     ;FERTIGUNGSPLATZ
	IF FMASCH'="" SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"FERTIGUNGSMASCHINE") = FMASCH     ;FERTIGUNGSMASCHINE
	DO        ;OFFENE MENGE ;quantity 
	. NEW VERT,SUM,SATZ
	. SET SUM=0
	. SET VERT="" FOR  SET VERT=$ORDER(^INAUFPREL(YM,YAUF,YPOS,VERT)) QUIT:VERT=""  DO
	. . SET SATZ=$GET(^INAUFPREL(YM,YAUF,YPOS,VERT,1))
	. . QUIT:+$HOROLOG<$PIECE(SATZ,2)  ;LIEFERTERMIN DER ABRUFPOSITION LIEGT NACH TAGESDATUM DES DRUCKES ;time of delivery the within 
	. . SET SUM=SUM+(+$PIECE(SATZ,Y,1))
	. ;
	. IF '$DATA(^INAUFPREL(YM,YAUF,YPOS)) SET SUM=$PIECE(YXL,Y,5)
	. SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"MENGEOFFEN")=SUM
	
	DO  ;NEUAUFBAU DER TEILE ;the 
	. NEW YAUFTRAG,SATZ
	. QUIT:YAUF=""
	. SET YAUFTRAG=YAUF
	. QUIT:YPOS=""
	. SET SATZ=$GET(^INAUFP(YM,YAUFTRAG,YPOS,1))
	. DO ^INAUFTEILE(YAUFTRAG,YPOS)
	
	QUIT
	
ANWEIS       ;BEGINN DER ANWEISUNGSAUFBEREITUNG ;inauguration the 
	NEW YSEITE
	
	SET YSEITE=1
	;-----------------------------------KOPF AUFBEREITUNG DES KOPFES--------------------------
	;SUCHEN UNTERPUNKT ;seek 
	SET UNTERPUNKT=0
	SET YZWEITSCHRIFT=""  ;KEIN WIEDERHOLUNGSDRUCK ;no 
	IF $PIECE(YXL,Y,165)=YSTEMPEL SET YZWEITSCHRIFT=$$^WWWTEXT(32296)  ;WIEDERHOLUNGSDRUCK
	SET YI=""  FOR  SET YI=$ORDER(@(YDATEI)) QUIT:YI=""  DO  QUIT:+UNTERPUNKT'=0  ;SUCHEN IN UNTERTEILEDATEI ;seek within 
	. QUIT:YI<$GET(ABANZEIGE)  ;ERST AB DIESEM TEIL ;only Confirm. part 
	. QUIT:YI=$GET(BISANZEIGE)  ;NUR BIS ZU DIESEM TEIL ;only until within part 
	. QUIT:YI>$GET(BISANZEIGE)  ;NUR BIS ZU DIESEM TEIL ;only until within part 
	. SET YXL1=$GET(@(YDATEI))
	. ;;IF $PIECE(YXL1,Y,40)=2!($PIECE(YXL1,Y,40)=10)!($PIECE(YXL1,Y,40)=11) DO  ;NUR WENN LEISTUNG
	. ;;. SET UNTERPUNKT=YI
	. ;
	. IF $PIECE(YXL1,Y,26)="" IF $PIECE(YXL1,Y,4)'="" SET $PIECE(YXL1,Y,26)=$PIECE($GET(^INART(YM,$PIECE(YXL1,Y,4),1)),Y,26)  ;FIS;31.10.03;24360
	. DO  ;FIS;08.07.03;23889
	. . IF $PIECE(YXL1,Y,40)=2!($PIECE(YXL1,Y,40)=10)!($PIECE(YXL1,Y,40)=11) IF $PIECE(YXL1,Y,26)'=1 DO  QUIT  ;NUR WENN LEISTUNG (AUSSER FREMDLEISTUNG) ;only when performance 
	. . . SET UNTERPUNKT=YI
	. . ;
	. . IF +UNTERPUNKT=0 SET UNTERPUNKT="X"_YI
	
	IF YSTEMPEL="" SET YSTEMPEL=" "
	SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERPUNKT")=$EXTRACT(100+(+UNTERPUNKT),2,3)     ;UNTERPUNKT
	SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"ZWEITSCHIFT")=YZWEITSCHRIFT                      ;ZWEITSCHRIFT
	SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"FERTIGUNGSBEGINN")=FBEGINN                       ;FERTIGUNGSBEGINN
	
	;--------------------AUFTRAG AUFBEREITEN AUFTRAGSINFORMATIONEN
	SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"AUFTRAGSNUMMER")=YAUF                             ;Auftragsnummer ;Order No.  ;Order No. Order 
	IF YAUF'="" SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"AUFTRAGSINFORMATION")=$TRANSLATE($$^WWWUML($PIECE($GET(^INAUF(YM,YAUF,1)),Y,13)),"|")     ;AUFTRAGSINFORMATION
	SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"AUSFUEHRUNG")=$EXTRACT($TRANSLATE($$^WWWUML($PIECE(YXL,Y,14)),"|"),1,25)     ;AUSFUEHRUNGSTEXT
	SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"FERTIGUNGSPLATZ")=FPLATZ                                                     ;FERTIGUNGSPLATZ
	IF YAUF'="" SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"KOMMISION")=$$^WWWUML($PIECE($GET(^INAUF(YM,YAUF,1)),Y,8))       ;Kommissionsnummer   ;Consignment No. 
	IF YPOS'="" IF YAUF'="" IF $PIECE($GET(^INAUFP(YM,YAUF,YPOS,1)),Y,56)'="" SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"SERIENNUMMER")=$$^WWWUML($PIECE($GET(^INAUF(YM,YAUF,1)),Y,8))      ;SERIENNUMMER DER POSITION ;the 
	SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"POSITION")=YPOS                                            ;POSITION
	IF YAUF'="" SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"ARTIKELNUMMER")    =$PIECE($GET(^INAUFP(YM,YAUF,YPOS,1)),Y,4)    ;ARTIKELNUMMER 
	IF YAUF'="" SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"TEXTHAUPTPOSITION")=$PIECE($GET(^INAUFP(YM,YAUF,YPOS,1)),Y,4)    ;TEXT DER HAUPTPOSITION  ;Text the 
	SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"NEXTFERTIGUNGSPLATZ")=$$^INPROFERTPL(YLFN)
	IF YAUF'="" IF $PIECE($GET(^INAUF(YM,YAUF,1)),Y,1)'="" DO
	. SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"BESTELLER")=$PIECE($GET(^INKUNDE(YM,$PIECE($GET(^INAUF(YM,YAUF,1)),Y,1),1)),Y,8)         ;BESTELLER
	
	;--------------------------------------------------------TEIL ; PRODUKTIONSTEIL---------------------------
	;TEILEBESCHREIBUNG / BARCODE
	IF MITSTRUKTUR=1 DO   ;WENN DIE STRUKTUR MIT ANGEZEIGT WERDEN SOLL ;when who texture by means of will 
	. NEW YI
	. FOR YI=2:1 QUIT:$PIECE(YLFN,",",YI)=""  DO 
	. . SET YXLT=$GET(@(YDATEI(YI)))   ;POSITIONSDATEN
	. . SET YTEIL=$PIECE(YXLT,Y,4)     ;ARTIKELNUMMER
	. . SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"TEIL",YI)=YTEIL        ;ARTIKELNUMMER
	. . SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"TEILINFO",YI)=$TRANSLATE($$^WWWUML($PIECE(YXLT,Y,1)),"|")     ;ARTIKELINFORMATION TEIL ;part 
	
	IF MITSTRUKTUR'=1 DO
	. SET YTEIL=$PIECE(YXL,Y,4)   ;ARTIKELNUMMER
	. SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"TEIL",1)=YTEIL        ;ARTIKELNUMMER
	. SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"TEILINFO",1)=$TRANSLATE($$^WWWUML($PIECE(YXLT,Y,1)),"|")     ;ARTIKELINFORMATION TEIL ;part 
	
	SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"MENGE")=$$^WWWZAHL($PIECE(YXL,Y,39),0,$LENGTH($PIECE($PIECE(YXL,Y,39),".",2)))     ;AUFBEREITETE MENGE ;quantity 
	IF $PIECE(YXL,Y,40)'="" SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"MENGENEINHEIT")=$PIECE($GET(^WWW101(0,"EINHEIT",SPRACHE,$PIECE(YXL,Y,40),1)),Y,1)   ;MENGENEINHEIT
	;WENN MEHR EINHEITEN ZU PRODUZIEREN SIND ;when more within produce 
	SET ZEITFACT=$PIECE(YXL,Y,39)  ;GESAMTMENGE
	IF $PIECE(YXL,Y,5)>0 DO
	. NEW YTEMP
	. SET YTEMP=" ("_$PIECE(YXL,Y,5)
	. IF $PIECE(YXL,Y,39)>0 SET YTEMP=YTEMP_" X "_($PIECE(YXL,Y,39)/$PIECE(YXL,Y,5))
	. SET YTMEP=YTEMP_")"
	. SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"GESAMTMENGE")=YTEMP        ;GESAMTMENGE
	
	SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"ARTIKELBESCHREIBUNG")=$TRANSLATE($$^WWWUML($PIECE(YXL,Y,14)),"|")     ;ARTIKELBESCHREIBUNG
	SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"PRODUKTIONSANWEISUNG")=$TRANSLATE($$^WWWUML($PIECE(YXL,Y,53),1),"|")  ;PRODUKTIONSANWEISUNG
	IF $PIECE(YXL,Y,4)'="" IF $PIECE($GET(^INART(YM,$PIECE(YXL,Y,4),1)),Y,40)'="" IF $PIECE($GET(^INART(YM,$PIECE(YXL,Y,4),1)),Y,186)'="" DO
	. SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"LIEFERUNG")=$PIECE($GET(^INART(YM,$PIECE(YXL,Y,4),1)),Y,187)_" "_$PIECE($GET(^WWW101(0,"EINHEIT",SPRACHE,$PIECE($GET(^INART(YM,$PIECE(YXL,Y,4),1)),Y,40),1)),Y,1)
	. SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"LIEFERUNGTRANSPO")=$PIECE($GET(^INTRANSPACK(YM,$PIECE($GET(^INART(YM,$PIECE(YXL,Y,4),1)),Y,186),1)),Y,1)        ;TRANSPORTVERPACKUNG
	
	DO  ;QUALITÄTSSICHERUNG ;quality protection 
	. NEW QPRUEF
	. SET QPRUEF=""
	. IF $GET(YTEIL)'="" SET QPRUEF=$PIECE($GET(^INART(YM,YTEIL,1)),Y,174)  ;ARTIKEL MIT QUALITÄTSPRUEFUNG ;item by means of 
	. IF YAUF'="" IF YPOS'="" IF $GET(YTEIL)="" SET QPRUEF=$PIECE($GET(^INAUFP(YM,YAUF,YPOS,1)),Y,174)  ;ARTIKEL MIT QUALITÄTSPRUEFUNG ;item by means of 
	. IF YTEIL'=""  SET QPRUEF   =$PIECE($GET(^INART(YM,YTEIL,1)),Y,174)    ;ARTIKEL MIT QUALITÄTSPRUEFUNG ;item by means of 
	. IF QPRUEF'="" SET QPRUEF(1)=$PIECE($GET(^INQPRUEF(YM,YLOCATION,QPRUEF,1)),Y,3) IF QPRUEF(1)'="" DO  ;ACHTUNG ARTIKEL MIT QUA ;estimation item by means of 
	. . SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"QPRUEF")=$PIECE($GET(^INPARA(YM,"QMPARA",SPRACHE,QPRUEF,1)),Y,1)_": "      ;QUALITÄTSPRUEFUNG
	. . SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"QPRUEFINFO")=$TRANSLATE($$^WWWUML(QPRUEF(1)),"|")     ;PRUEF-INFORMATION
	
	SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"BAR")=YSTEMPEL_$EXTRACT(100+(+UNTERPUNKT),2,3)
	;-----------------------------------AUFBEREITEN DER UNTERTEILE-------------------------------------
	SET YI="" IF $ORDER(@(YDATEI))="" QUIT  ;KEINE TEILE VORHANDEN=KEIN DRUCK ;no printing 
	NEW YDAUER,YRZEIT,YI,YII,WHANZ,ZPOS,YXL1KEY
	SET YDAUER=0
	SET YRZEIT=0
	SET YSEITE=1
	SET YII=0  ;LAUFENDE NUMMER ;numeral 
	SET WHANZ=+$PIECE(YINVORG,Y,92)  ;WARENHERKUNFT ANZEIGEN ;display 
	SET ZPOS=+$PIECE(YINVORG,Y,93)   ;ZEICHNUNGSPOSITIONEN ANZEIGEN ;display 
	
	;UNTERTEILEBESCHREIBUNG
	SET YI=""  FOR  SET YI=$ORDER(@(YDATEI)) QUIT:YI=""  DO  ;SUCHEN IN UNTERTEILEDATEI ;seek within 
	. QUIT:YI<ABANZEIGE  ;ERST AB DIESEM TEIL ;only Confirm. part 
	. QUIT:YI=BISANZEIGE  ;NUR BIS ZU DIESEM TEIL ;only until within part 
	. QUIT:YI>BISANZEIGE  ;NUR BIS ZU DIESEM TEIL ;only until within part 
	. SET YXL1=$GET(@(YDATEI))
	. QUIT:YXL1=""  ;KEIN DATENSATZ VORHANDEN ;no data record on hand 
	. IF $DATA(@(YDATEI))=1 SET $PIECE(@(YDATEI),Y,165)=YSTEMPEL   ;WENN UNTERSTES TEIL ;when part 
	. ;
	. SET YXL1KEY=$PIECE($PIECE(YDATEI,",",2,99),")",1)  ;RÜCKHOLEN TEILEKEY ZUR SPEICHERUNG;FIS;09.09.03;24243
	. SET YXL1KEY=$REVERSE($PIECE($REVERSE(YXL1KEY),",",2,99))
	. SET YXL1KEY=$TRANSLATE(YXL1KEY,"""")_","_YI
	. ;--------------------------------------------------------------------
	. ;SPEICHERN HERSTELLKOSTEN UND MASCHINENSTUNDENSATZ FÜR VORKALKULATION ;Save And machine hour rate to preliminary costing 
	. IF $GET(@(YDATEI))'="" DO
	. . IF +$PIECE(@(YDATEI),Y,250)=0 SET $PIECE(@(YDATEI),Y,250)=$PIECE(@(YDATEI),Y,47)  ;HERSTELLKOSTEN VORKALKULATION ;preliminary costing 
	. . IF $PIECE(@(YDATEI),Y,26)=2 DO  ;MASCHINEN+BEDIENERSTUNDENSATZ SETZEN ;typeset 
	. . . NEW KALK,YFELD
	. . . SET YFELD=@(YDATEI)
	. . . IF +($PIECE(YFELD,Y,251)+$PIECE(YFELD,Y,252))'=0 QUIT  ;BEREITS GESETZT ;yet staid 
	. . . SET KALK=$$^INMASCHKOST(2)
	. . . SET $PIECE(@(YDATEI),Y,251)=$PIECE(KALK,Y,1)
	. . . SET $PIECE(@(YDATEI),Y,252)=$PIECE(KALK,Y,2)
	. ;--------------------------------------------------------------------
	. NEW YTEILSUM
	. SET YTEILSUM=""
	. ; FIXME : Remove unnecessary DO level   <GRF>
	. DO
	. . DO    ;AUSWERTEN DER MENGEN, WENN TEILE GLEICH
	. . . NEW YARTTX,Q,YARTTC,TEILE1
	. . . SET TEILE1=YXL1
	. . . SET YTEILSUM=1
	. . . SET Q=0
	. . . SET YARTTX=YI FOR  SET YI=$ORDER(@YDATEI) QUIT:YI=""  DO  QUIT:Q=1
	. . . . IF YI<ABANZEIGE  SET Q=1 SET YI=YARTTX QUIT   ;ERST AB DIESEM TEIL ;only Confirm. part 
	. . . . IF YI=BISANZEIGE SET Q=1 SET YI=YARTTX QUIT   ;NUR BIS ZU DIESEM TEIL ;only until within part 
	. . . . IF YI>BISANZEIGE SET Q=1 SET YI=YARTTX QUIT   ;NUR BIS ZU DIESEM TEIL ;only until within part 
	. . . . SET YARTTC=$GET(@(YDATEI))  ;TEILE INFO
	. . . . IF $PIECE(YARTTC,Y,1,40)'=$PIECE(TEILE1,Y,1,40) SET Q=1 SET YI=YARTTX QUIT  ;NICHT GLEICH ;Not without delay 
	. . . . SET YARTTX=YI
	. . . . ;
	. . . . SET YTEILSUM=YTEILSUM+1
	. . . . IF $DATA(@(YDATEI))=1 SET $PIECE(@(YDATEI),Y,165)=YSTEMPEL   ;WENN UNTERSTES TEIL ;when part 
	. . . . ;--------------------------------------------------------------------
	. . . . ;SPEICHERN HERSTELLKOSTEN UND MASCHINENSTUNDENSATZ FÜR VORKALKULATION ;Save And machine hour rate to preliminary costing 
	. . . . IF $GET(@(YDATEI))'="" DO
	. . . . . IF +$PIECE(@(YDATEI),Y,250)=0 SET $PIECE(@(YDATEI),Y,250)=$PIECE(@(YDATEI),Y,47)  ;HERSTELLKOSTEN VORKALKULATION ;preliminary costing 
	. . . . . IF $PIECE(@(YDATEI),Y,26)=2 DO  ;MASCHINEN+BEDIENERSTUNDENSATZ SETZEN ;typeset 
	. . . . . . NEW KALK,YFELD
	. . . . . . SET YFELD=@(YDATEI)
	. . . . . . IF +($PIECE(YFELD,Y,251)+$PIECE(YFELD,Y,252))'=0 QUIT  ;BEREITS GESETZT ;yet staid 
	. . . . . . SET KALK=$$^INMASCHKOST(2)
	. . . . . . SET $PIECE(@(YDATEI),Y,251)=$PIECE(KALK,Y,1)
	. . . . . . SET $PIECE(@(YDATEI),Y,252)=$PIECE(KALK,Y,2)
	. . . . ;
	. . . . ;SET $PIECE(YXL1,Y,5)=$PIECE(YXL1,Y,5)+$PIECE(YARTTC,Y,5)     ;MEHRERE STUECKE ALLES GLEICH  MENGE
	. . . . ;SET $PIECE(YXL1,Y,43)=$PIECE(YXL1,Y,43)+$PIECE(YARTTC,Y,43)  ;MEHRERE STUECKE ALLES GLEICH  GEWICHT
	. . . . ;SET $PIECE(YXL1,Y,45)=$PIECE(YXL1,Y,45)+$PIECE(YARTTC,Y,45)  ;MEHRERE STUECKE ALLES GLEICH  ZEIT
	. . . . ;SET $PIECE(YXL1,Y,70)=$PIECE(YXL1,Y,70)+$PIECE(YARTTC,Y,70)  ;MEHRERE STUECKE ALLES GLEICH  RUESTZEIT
	. . . . ;SET $PIECE(YXL1,Y,47)=$PIECE(YXL1,Y,47)+$PIECE(YARTTC,Y,47)  ;MEHRERE STUECKE ALLES GLEICH  WERT
	. . . ;
	. . . IF YI="" SET YI=$ORDER(@YDATEI,-1)
	. ;
	. SET YII=YII+1   ;LAUFENDE NUMMER ;numeral 
	. SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE",YI,"LFN")=YII     ;LAUFENDE NUMMER ;numeral 
	. ;
	. SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE",YI,"ARTIKEL")=$$^WWWUML($PIECE(YXL1,Y,4))     ;ARTIKEL NUMMER ;item numeral 
	. SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE",YI,"ZPOS")=$PIECE(YXL1,Y,18)       ;ZPOSITION
	. SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE",YI,"BEZEICHNUNG")=$$^WWWUML($PIECE(YXL1,Y,1))        ;SUCHBEZEICHNUNG MIT TEXT ;by means of Text 
	. IF $PIECE(YXL1,Y,53)'="" SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE",YI,"PRODUKTIONSANWEISUNG")="<BR> "_$$^WWWTEXT(32358)_": "_$TRANSLATE($$^WWWUML($PIECE(YXL1,Y,53)),"|")   
	. ;
	. ;
	. IF WHANZ=1 IF $PIECE(YXL1,Y,7)'="" DO  ;WARENHERKUNFT
	. . SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE",YI,"WARENHERKUNFT")="<BR>("_$PIECE($GET(^WWW101(0,"WARENHERKUNFT1",SPRACHE,$PIECE(YXL1,Y,7),1)),Y,1)_")"
	. ;
	. IF $GET(YTEILSUM)>1 SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE",YI,"YTEILSUM")=YTEILSUM_" X "   ;ANZAHL DER SUMMEN ;Number the purr 
	. IF +$PIECE(YXL1,Y,5)'=0 DO
	. . QUIT:$PIECE(YXL1,Y,40)=2  ;MINUTEN
	. . QUIT:$PIECE(YXL1,Y,40)=10  ;STUNDEN ;procrastinate 
	. . QUIT:$PIECE(YXL1,Y,40)=11  ;INDUSTRIEMINUTEN
	. . ;WRITE $$^WWWUML($PIECE(YXL1,Y,5))
	. . SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE",YI,"MENGE")=$$^WWWZAHL($PIECE(YXL1,Y,5),0,$LENGTH($PIECE($PIECE(YXL1,Y,5),".",2)))    ;MENGE ;quantum  ;quantity 
	. . ;
	. . SET GEB=""
	. . IF $PIECE(YXL1,Y,244)'="" SET GEB=1  ;BESTAND BEREITS BERICHTIGT ;yet 
	. . ;IF '$DATA(^INPROSTEMPT(YM,YSTEMPEL,YII,1)) D
	. . ;TEILENUMMER = (100+ARBEITSGANG)_$E(1000+LFN,2,4) Z.B.: ARBEITSGANG 05, TEIL 3 = 105003
	. . IF $EXTRACT(UNTERPUNKT)="X" DO  ;FIS;08.07.03;23889
	. . . IF $DATA(^INPROSTEMPT(YM,YSTEMPEL,"100"_$EXTRACT(1000+YII,2,4),1)) SET UNTERPUNKT=0 QUIT
	. . . SET UNTERPUNKT=$EXTRACT(UNTERPUNKT,2,9)
	. . ;
	. . IF '$DATA(^INPROSTEMPT(YM,YSTEMPEL,YII,1)) IF '$DATA(^INPROSTEMPT(YM,YSTEMPEL,(100+UNTERPUNKT)_$EXTRACT(1000+YII,2,4),1)) DO  ;SPEICHERN BESTANDSVERÄNDERUNGSDATEI  ;Save 
	. . . IF $GET(YTEILSUM)>1 SET ^INPROSTEMPT(YM,YSTEMPEL,(100+UNTERPUNKT)_$EXTRACT(1000+YII,2,4),1)=Y_Y_Y_$PIECE(YXL1,Y,4)_Y_($PIECE(YXL1,Y,39)*YTEILSUM)_Y_GEB_Y_Y_$PIECE(YXL1,Y,1)_Y_YXL1KEY QUIT  ;FIS, 05.08.02
	. . . SET ^INPROSTEMPT(YM,YSTEMPEL,(100+UNTERPUNKT)_$EXTRACT(1000+YII,2,4),1)=Y_Y_Y_$PIECE(YXL1,Y,4)_Y_$PIECE(YXL1,Y,39)_Y_GEB_Y_Y_$PIECE(YXL1,Y,1)_Y_YXL1KEY  ;YXLKEY:FIS;09.09.03;24243
	. . ;
	. . SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE",YI,"MENGENEINHEIT")=$PIECE($GET(^WWW101(0,"EINHEIT",SPRACHE,$PIECE(YXL1,Y,40),1)),Y,1)    ;MENGENEINHEIT
	. ;
	. IF +$PIECE(YXL1,Y,70)'=0 DO
	. . IF $PIECE(YXL1,Y,40)'=2 IF $PIECE(YXL1,Y,40)'=10 IF $PIECE(YXL1,Y,40)'=11 QUIT  ;NUR BEI LEISTUNG ;only next to performance 
	. . SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE",YI,"RUESTZEIT")=$$^WWWTIME($PIECE(YXL1,Y,70))                ;RÜSTZEIT ;setup time 
	. . SET YRZEIT=YRZEIT+$PIECE(YXL1,Y,70)
	. ;
	. IF +$PIECE(YXL1,Y,45)'=0 DO
	. . IF $PIECE(YXL1,Y,40)'=2 IF $PIECE(YXL1,Y,40)'=10 IF $PIECE(YXL1,Y,40)'=11 QUIT  ;NUR BEI LEISTUNG ;only next to performance 
	. . IF MITZEITEN'=1 SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE",YI,"FERTIGUNGSZEIT")=$$^WWWTIME($PIECE(YXL1,Y,45))      ;FERTIGUNGSZEIT
	. . SET YDAUER=YDAUER+$PIECE(YXL1,Y,45)
	
	IF +$GET(YII)>48 SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE","SUMME","YSEITE")=YSEITE+1  ;ÜBER 2 SEITEN ;via sidelong 
	
	;SUMME FÜR GESAMT-AUSFÜHRUNGSZEIT ;sum to 
	IF +YDAUER'=0 DO
	. IF +ZEITFACT'=0 SET YGESAMT=YGESAMT+(YDAUER*ZEITFACT)+YRZEIT QUIT
	. SET YGESAMT=YGESAMT+YDAUER+YRZEIT
	
	;SUMME ;sum 
	IF +YDAUER'=0 DO
	. IF +YRZEIT'=0                 SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE","SUMME","SUMRUESTZEIT")     =$$^WWWTIME(YRZEIT)
	. IF +YDAUER'=0 IF MITZEITEN'=1 SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE","SUMME","SUMFERTIGUNGSZEIT")=$$^WWWTIME(YDAUER)
	. SET $PIECE(@(YDATEI(0)),Y,166)=YGESAMT  ;FERTIGUNGSZEIT DER ANWEISUNG ;the 
	
	IF +YDAUER'=0 IF +ZEITFACT'=0 DO
	. IF +YDAUER'=0 IF MITZEITEN'=1 SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE","SUMME","SUMGESAMTZEIT")=$$^WWWTIME(YDAUER*ZEITFACT+YRZEIT)
	. SET $PIECE(@(YDATEI(0)),Y,166)=YGESAMT  ;FERTIGUNGSZEIT DER ANWEISUNG ;the 
	. IF $QLENGTH(YDATEI(0))=3 DO
	. . NEW DATEIX,POSX
	. . SET DATEIX=$TRANSLATE($PIECE(YDATEI(0),"(",2),")"_"""")
	. . ;SET POSX="^INAUFP("_DATEIX_",1)"  ;FIS;29.07.05;SR13080
	. . SET POSX="^INAUFP("_$$^WWWKEYBUILD(DATEIX)_",1)"  ;FIS;29.07.05;SR13080
	. . SET $PIECE(@(POSX),Y,166)=YGESAMT  ;FERTIGUNGSZEIT DER ANWEISUNG ;the 
	. ;
	. SET GESAMTZEIT=GESAMTZEIT+(YDAUER*ZEITFACT)+YRZEIT
	
	QUIT 
	
ANWEISART       ;BEGINN DER ANWEISUNGSAUFBEREITUNG ;inauguration the 
	NEW YSEITE
	
	SET YSEITE=1
	SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE","SUMME","YSEITE")=YSEITE
	;-----------------------------------KOPF AUFBEREITUNG DES KOPFES--------------------------
	;SUCHEN UNTERPUNKT ;seek 
	SET UNTERPUNKT=0
	SET YZWEITSCHRIFT=""  ;KEIN WIEDERHOLUNGSDRUCK ;no 
	IF $PIECE(YXL,Y,165)=YSTEMPEL SET YZWEITSCHRIFT=$$^WWWTEXT(32296)  ;WIEDERHOLUNGSDRUCK
	IF YSTEMPEL="" SET YSTEMPEL=" "
	SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERPUNKT")=$EXTRACT(100+(+UNTERPUNKT),2,3)     ;UNTERPUNKT
	SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"ZWEITSCHIFT")=YZWEITSCHRIFT                      ;ZWEITSCHRIFT
	SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"FERTIGUNGSBEGINN")=FBEGINN                       ;FERTIGUNGSBEGINN
	;--------------------AUFTRAG AUFBEREITEN AUFTRAGSINFORMATIONEN
	SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"AUFTRAGSNUMMER")=YAUF                             ;Auftragsnummer ;Order No.  ;Order No. Order 
	SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"AUSFUEHRUNG")=$EXTRACT($TRANSLATE($$^WWWUML($PIECE(YXL,Y,14)),"|"),1,25)   ;AUSFUEHRUNGSTEXT
	SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"FERTIGUNGSPLATZ")=FPLATZ                           ;FERTIGUNGSPLATZ
	SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"POSITION")=YPOS                                          ;POSITION
	SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"ARTIKELNUMMER")=YART                ;ARTIKELNUMMER 
	;--------------------------------------------------------TEIL ; PRODUKTIONSTEIL---------------------------
	;TEILEBESCHREIBUNG / BARCODE
	;IF MITSTRUKTUR=1 DO   ;WENN DIE STRUKTUR MIT ANGEZEIGT WERDEN SOLL ;when who texture by means of will 
	DO
	. SET YTEIL=""
	. IF YART'="" SET YTEIL=$GET(^INART(YM,YART,1))           ;ARTIKELNUMMER
	. SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"TEIL",1)=YART       ;ARTIKELNUMMER
	. SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"TEILINFO",1)=$TRANSLATE($$^WWWUML($PIECE(YTEIL,Y,1)),"|")     ;ARTIKELINFORMATION TEIL ;part 
	. SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"ARTIKELBESCHREIBUNG")=$PIECE(YTEIL,Y,1)       ;ARTIKELBESCHREIBUNG
	. SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"PRODUKTIONSANWEISUNG")=$TRANSLATE($$^WWWUML($PIECE(YTEIL,Y,53),1),"|")  ;PRODUKTIONSANWEISUNG
	
	SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"MENGE")=1     ;AUFBEREITETE MENGE ;quantity 
	IF $PIECE(YXL,Y,40)'="" SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"MENGENEINHEIT")=$PIECE($GET(^WWW101(0,"EINHEIT",SPRACHE,$PIECE(YXL,Y,40),1)),Y,1)   ;MENGENEINHEIT
	;WENN MEHR EINHEITEN ZU PRODUZIEREN SIND ;when more within produce 
	SET ZEITFACT=$PIECE(YXL,Y,39)  ;GESAMTMENGE
	SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"GESAMTMENGE")="(1 X 1)"        ;GESAMTMENGE
	IF $PIECE(YXL,Y,4)'="" IF $PIECE($GET(^INART(YM,$PIECE(YXL,Y,4),1)),Y,40)'="" IF $PIECE($GET(^INART(YM,$PIECE(YXL,Y,4),1)),Y,186)'="" DO
	. SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"LIEFERUNG")=$PIECE($GET(^INART(YM,$PIECE(YXL,Y,4),1)),Y,187)_" "_$PIECE($GET(^WWW101(0,"EINHEIT",SPRACHE,$PIECE($GET(^INART(YM,$PIECE(YXL,Y,4),1)),Y,40),1)),Y,1)
	. SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"LIEFERUNGTRANSPO")=$PIECE($GET(^INTRANSPACK(YM,$PIECE($GET(^INART(YM,$PIECE(YXL,Y,4),1)),Y,186),1)),Y,1)        ;TRANSPORTVERPACKUNG
	
	DO  ;QUALITÄTSSICHERUNG ;quality protection 
	. NEW QPRUEF
	. SET QPRUEF=""
	. IF $GET(YTEIL)'="" SET QPRUEF=$PIECE(YTEIL,Y,174)  ;ARTIKEL MIT QUALITÄTSPRUEFUNG ;item by means of 
	. IF YAUF'="" IF YPOS'="" IF $GET(YTEIL)="" SET QPRUEF=$PIECE($GET(^INAUFP(YM,YAUF,YPOS,1)),Y,174)  ;ARTIKEL MIT QUALITÄTSPRUEFUNG ;item by means of 
	. IF YTEIL'=""  SET QPRUEF   =$PIECE(YTEIL,Y,174)  ;ARTIKEL MIT QUALITÄTSPRUEFUNG ;item by means of 
	. IF QPRUEF'="" SET QPRUEF(1)=$PIECE($GET(^INQPRUEF(YM,YLOCATION,QPRUEF,1)),Y,3) IF QPRUEF(1)'="" DO  ;ACHTUNG ARTIKEL MIT QUA ;estimation item by means of 
	. . SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"QPRUEF")=$PIECE($GET(^INPARA(YM,"QMPARA",SPRACHE,QPRUEF,1)),Y,1)_": "      ;QUALITÄTSPRUEFUNG
	. . SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"QPRUEFINFO")=$TRANSLATE($$^WWWUML(QPRUEF(1)),"|")     ;PRUEF-INFORMATION
	
	SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"BAR")=YSTEMPEL_$EXTRACT(100+(+UNTERPUNKT),2,3)
	
	;-----------------------------]]><![CDATA[------AUFBEREITEN DER UNTERTEILE-------------------------------------
	NEW YDAUER,YRZEIT,YI,YII,WHANZ,ZPOS,YXL1KEY
	
	SET YDAUER=0
	SET YRZEIT=0
	SET YSEITE=1
	SET YII=0  ;LAUFENDE NUMMER ;numeral 
	SET WHANZ=+$PIECE(YINVORG,Y,92)  ;WARENHERKUNFT ANZEIGEN ;display 
	SET ZPOS=+$PIECE(YINVORG,Y,93)   ;ZEICHNUNGSPOSITIONEN ANZEIGEN ;display 
	;UNTERTEILEBESCHREIBUNG - LEISTUNG ;performance 
	NEW SUMFERT,SUMRUEST
	SET SUMFERT=0
	SET SUMRUEST=0
	SET FPLATZ=$GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"FERTIGUNGSPLATZ"))
	SET FMASCH=$GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"FERTIGUNGSMASCHINE"))
	SET YI=""
	FOR  SET YI=$ORDER(^WWWSOR(YUSER,"ORDER",YART,"STRUCT","L",YI)) QUIT:YI=""  DO  ;SUCHEN IN UNTERTEILEDATEI ;seek within 
	. SET YIKEY=""
	. FOR  SET YIKEY=$ORDER(^WWWSOR(YUSER,"ORDER",YART,"STRUCT","L",YI,YIKEY)) QUIT:YIKEY=""  DO
	. . ;SET YXL1="^INARTXL("_""""_YM_""""_","_$PIECE(YIKEY,",",1,2)_")"
	. . SET YXL1="^INARTXL("_""""_YM_""""_","_""""_$PIECE(YIKEY,",",1)_""""_","_""""_$PIECE(YIKEY,",",2)_""""_")"      ;BEC;25879;08.06.04;ALPHANUMMERISCHE ARTIKEL
	. . SET YXL1=$GET(@YXL1)
	. . IF FPLATZ="" DO
	. . . QUIT:$PIECE(YXL1,Y,4)=""
	. . . SET FPLATZ=$PIECE($GET(^INART(YM,$PIECE(YXL1,Y,4),1)),Y,61) 
	. . . IF FPLATZ'="" SET FPLATZ=$EXTRACT($PIECE($GET(^INPRONEST(YM,FPLATZ,1)),Y,1),1,12)   ;FERTIGUNGSPLATZ
	. . . SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"FERTIGUNGSPLATZ")=FPLATZ
	. . . QUIT:FMASCH=""
	. . . SET FMASCH=$EXTRACT($PIECE($GET(^INMASCH(YM,$PIECE(YXL1,Y,4),1)),Y,1),1,12)         ;FERTIGUNGSMASCHINE
	. . . IF FMASCH'="" SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"FERTIGUNGSMASCHINE")=FMASCH
	. . ;
	. . ;SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE",YI,"MENGE")=$PIECE(YXL1,Y,5)    ;MENGE
	. . ;IF $PIECE(YXL1,Y,40)'="" SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE",$PIECE(YIKEY,",",2),"MENGENEINHEIT")=$PIECE($GET(^WWW101(0,"EINHEIT",SPRACHE,$PIECE(YXL1,Y,40),1)),Y,1)    ;MENGENEINHEIT
	. . SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE",$PIECE(YIKEY,",",2),"ARTIKEL")=$PIECE(YXL1,Y,4)
	. . SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE",$PIECE(YIKEY,",",2),"BEZEICHNUNG")=$PIECE(YXL1,Y,1)
	. . SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE",$PIECE(YIKEY,",",2),"LFN")=$PIECE(YIKEY,",",2)
	. . SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE",$PIECE(YIKEY,",",2),"ZPOS")=$PIECE(YXL1,Y,18)
	. . SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE",$PIECE(YIKEY,",",2),"FERTIGUNGSZEIT")=$$^WWWTIME($PIECE(YXL1,Y,45))
	. . SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE",$PIECE(YIKEY,",",2),"RUESTZEIT")=$$^WWWTIME($PIECE(YXL1,Y,70))
	. . SET SUMFERT=$GET(SUMFERT)+$PIECE(YXL1,Y,45)
	. . SET SUMRUEST=$GET(SUMRUEST)+$PIECE(YXL1,Y,70)
	
	IF +SUMRUEST'=0 SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE","SUMME","SUMRUESTZEIT")     =$$^WWWTIME(+SUMRUEST) 
	IF +SUMFERT'=0  SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE","SUMME","SUMFERTIGUNGSZEIT")=$$^WWWTIME(+SUMFERT) 
	IF MITZEITEN'=1 SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE","SUMME","SUMGESAMTZEIT")    =$$^WWWTIME(+SUMRUEST+SUMFERT)
	;UNTERTEILEBESCHREIBUNG - MATERIAL
	SET YI=""
	FOR  SET YI=$ORDER(^WWWSOR(YUSER,"ORDER",YART,"STRUCT","M",YI)) QUIT:YI=""  DO  ;SUCHEN IN UNTERTEILEDATEI ;seek within 
	. SET YIKEY=""
	. FOR  SET YIKEY=$ORDER(^WWWSOR(YUSER,"ORDER",YART,"STRUCT","M",YI,YIKEY)) QUIT:YIKEY=""  DO
	. . ;SET YXL1="^INARTXL("_""""_YM_""""_","_$PIECE(YIKEY,",",1,2)_")"
	. . SET YXL1="^INARTXL("_""""_YM_""""_","_""""_$PIECE(YIKEY,",",1)_""""_","_""""_$PIECE(YIKEY,",",2)_""""_")"      ;BEC;25879;08.06.04;ALPHANUMMERISCHE ARTIKEL
	. . SET YXL1=$GET(@YXL1)
	. . SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE",$PIECE(YIKEY,",",2),"MENGE")=$PIECE(YXL1,Y,5)    ;MENGE ;quantity 
	. . IF $PIECE(YXL1,Y,40)'="" SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE",$PIECE(YIKEY,",",2),"MENGENEINHEIT")=$PIECE($GET(^WWW101(0,"EINHEIT",SPRACHE,$PIECE(YXL1,Y,40),1)),Y,1)    ;MENGENEINHEIT
	. . SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE",$PIECE(YIKEY,",",2),"ARTIKEL")     = $PIECE(YXL1,Y,4)
	. . SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE",$PIECE(YIKEY,",",2),"BEZEICHNUNG") = $PIECE(YXL1,Y,1)
	. . SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE",$PIECE(YIKEY,",",2),"LFN")         = $PIECE(YIKEY,",",2)
	. . SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE",$PIECE(YIKEY,",",2),"ZPOS")        = $PIECE(YXL1,Y,18)
	
	IF +$GET(YII)>48 SET ^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE","SUMME","YSEITE")=YSEITE+1  ;ÜBER 2 SEITEN ;via sidelong 
	QUIT  
	
ZEICHNUNG
	IF YHTML=1  DO ^INPROZEIHTML(YSTEMPEL)
	IF YHTML'=1 DO ^INPROZEICHN(YSTEMPEL)
	QUIT
	
MATERIAL
	IF YHTML=1  DO ^INPROMATHTML(YSTEMPEL)
	IF YHTML'=1 DO ^INPROMATERIAL(YSTEMPEL)
	QUIT
	
FERTIGMELDUNG     ;FERTIGMELDUNG
	IF $PIECE(YINVORG,Y,120)=1 QUIT     ;KEINE FERTIGMELDUNG ;no 
	IF YHTML=1  DO ^INPROFERTHTML(YSTEMPEL)
	IF YHTML'=1 DO ^INPROFERTMELDUNG(YSTEMPEL)
	QUIT
	
DRUCK     ;DRUCKEN FERTIGUNGSANWEISUNG  ;print 
	NEW YSTEMPEL,YZWEITSCHRIFT,FBEGINN
	
	IF YERROR'="" WRITE YERROR QUIT   ;ANZEIGEN FEHLERMELDUNG ;display error message 
	SET YSTEMPEL=""
	FOR  SET YSTEMPEL = $ORDER(^WWWSOR(YUSER,"ORDER",YSTEMPEL)) QUIT:YSTEMPEL=""  DO 
	. SET UNTERPUNKT    = $GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERPUNKT"))
	. SET YZWEITSCHRIFT = $GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"ZWEITSCHIFT"))    
	. SET FBEGINN       = $GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"FERTIGUNGSBEGINN"))   
	. ;
	. IF YHTML=1 DO DRUCKHTML      ;DRUCKT HTMLBELEGE
	. IF YHTML'=1 DO DRUCKBELEG    ;DRUCKT HTMLBELEGE
	;. KILL ^TEST MERGE ^TEST=^WWWSOR(YUSER)
	
	QUIT   
	
DRUCKHTML    ;DRUCKT HTMLBELEGE
	;@HELP@
	;Verwendbare Sonder-Tags:
	;<FERTIGUNGSNUMMER></FERTIGUNGSNUMMER>          = NUMMER UND UNTERNUMMER (ARBEITSGANG) DER FERTIGUNGSANWEISUNG ;numeral And the 
	;<FERTIGUNGSBEGINN></FERTIGUNGSBEGINN>          = GEPLANTES DATUM DER FERTIGUNG ;Date the 
	;<AUFTRAG></AUFTRAG>                            = AUFTRAGSNUMMER
	;<POSITION></POSITION>                          = AUFTRAGSPOSITION
	;<ARTIKEL></ARTIKEL>                            = ARTIKELNUMMER UND BEZEICHNUNG DER AUFTRAGSPOSITION ;And notation the 
	;<KOMMISSION></KOMMISSION>                      = KOMMISSION/PROJEKT/VORGANGSNUMMER
	;<TEIL></TEIL>                                  = ARTIKELNUMMER UND BEZEICHNUNG DES ZU PRODUZIERENDEN TEILES ;And notation within 
	;<AUSFUEHRUNG></AUSFUEHRUNG>                    = AUSFÜHRUNGSTEXT
	;<MENGE></MENGE>                                = ZU PRODUZIERENDE MENGE ;within quantity 
	;<FERTIGUNGSPLATZ></FERTIGUNGSPLATZ>            = FERTIGUNGSPLATZ
	;<PRODUKTIONSANWEISUNG></PRODUKTIONSANWEISUNG>  = PRODUKTIONSANWEISUNGEN DER FERTIGUNG ;the 
	;<ABTEILUNG></ABTEILUNG>                        = ZUSTÄNDIGE ABTEILUNG ;speciality 
	;<NEXTFERTIGUNGSPLATZ></NEXTFERTIGUNGSPLATZ>    = NÄCHSTER FERTIGUNGSPLATZ NACH FERTIGUNG ;within 
	;<BESTELLER></BESTELLER>                        = KUNDENINFORMATIONEN BEI BESTELLUNGEN ;next to 
	;<QUALITAETSPRUEFUNG></QUALITAETSPRUEFUNG>      = QUALITÄTS-PRÜFUNGSVORSCHRIFTEN
	;<BARCODE></BARCODE>                            = BARCODE DER FERTIGUNGSNUMMER ;the 
	;<DATUM></DATUM>                                = TAGESDATUM DES AUSDRUCKES
	;<MAXTEILE>40</MAXTEILE>                        = MAXIMALE ANZAHL UNTERTEILE JE BLATT (AUSDRUCK) ;Number once sheet 
	;..<UNTERTEILE>                                     = AB HIER ANGABEN DER UNTERTEILE
	;....<LFN>.)</LFN>                                  = LFD. NUMMER DES UNTERTEILS (AUFZÄHLUNGSSYMBOL OPTIONAL)
	;....<ARTIKEL></ARTIKEL>                            = ARTIKELNUMMER DES UNTERTEILS
	;....<BEZEICHNUNG></BEZEICHNUNG>                    = ARTIKELBEZEICHNUNG DES UNTERTEILS
	;....<PRODUKTIONSANWEISUNG></PRODUKTIONSANWEISUNG>  = PRODUKTIONSANWEISUNGEN DER FERTIGUNG
	;....<WARENHERKUNFT></WARENHERKUNFT>                = WARENHERKUNFT DES UNTERTEILS
	;....<MENGE></MENGE>                                = BENÖTIGTE MENGE FÜR DIE PRODUKTION
	;....<FERTIGUNGSZEIT></FERTIGUNGSZEIT>              = DAUER DES ARBEITSSCHRITTES (AUSFÜHRUNGSZEIT)
	;....<RUESTZEIT></RUESTZEIT>                        = MASCHINENRÜSTZEIT
	;..</UNTERTEILE>                                   
	;<GESDAUER></GESDAUER>                           = GESAMT AUSFÜHRUNGSZEIT DER LEISTUNGEN ;total execution time the LEISTUNGEN 
	;<GESRUESTZEIT></GESRUESTZEIT>                   = GESAMTRÜSTZEIT
	;<GESAMTZEIT><GESAMTZEIT>                        = GESAMT FERTIGUNGSDAUER ;total 
	;<SEITE></SEITE>                                 = SEITENANGABE (UNTER BERÜCKSICHTIGUNG DER <MAXTEILE>) ;the 
	;<ANLAGEn>..HTML-TEXT...</ANLAGEn>               = HTML-CODE FÜR EINE ANLAGE JE ABTEILUNG(n) Z.B. ERFASSUNGSLISTE
	;@END@
	SET HTML=$PIECE($GET(^WWWHTML($$^WWWYM("WWWHTML"),"INPROPROHTML",SPRACHE,1)),Y,1)  ;MANDANT-KEY=MANDANTÜBERGREIFEND  
	IF HTML="" DO CREATE
	FOR YI1=1:1:1200 SET YI(1)=$PIECE(HTML,"|",YI1) DO  QUIT:$FIND(YI(1),"</HTML>")  ;LESEN HTML-CODE ;read 
	. ;IF YTYP'=1 DO TRANSLATE  ;UMWANDELN SONDER-TAGS ;transmute 
	. DO TRANSLATE
	. DO
	. . NEW I,YZWS,YII
	. . FOR YII=1:1 SET YZWS=$PIECE(YI(1),"|",YII) QUIT:$PIECE(YI(1),"|",YII,999)=""  DO
	. . . WRITE YZWS   ;$$^WWWUML(YZWS,1)
	. . . WRITE $CHAR(13)_$CHAR(10)
	
	DO FF^WWWW()
	QUIT
	
DRUCKBELEG    ;DRUCKT HTMLBELEGE
	DO       ; FIXME : Remove unnecessary DO level   <GRF>
	. NEW YSEITE
	. SET YSEITE=1
	. WRITE YCR
	. DO START100^WWWTAB  
	. WRITE "<TR>"
	. WRITE "<TD NOWRAP>"
	. ;-------------------------------------- KOPF ANFANG -------------------------------------------------
	. WRITE "<TABLE BORDER=0 WIDTH=100%>"
	. WRITE "<TR>"
	. WRITE "<TH NOWRAP VALIGN=TOP ALIGN=LEFT>"
	. WRITE "<FONT SIZE=3>"
	. WRITE $$^WWWTEXT(32126),": "_YSTEMPEL_" "   ;FERTIGUNGSNUMMER
	. WRITE $GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERPUNKT"))_" "   ;UNTERPUNKT
	. WRITE $GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"ZWEITSCHRIFT"))_" "   ;ZWEITSCHRIFT
	. WRITE "</TH>"
	. WRITE "<TH VALIGN=TOP NOWRAP ALIGN=RIGHT>"
	. WRITE "<FONT SIZE=2>"
	. WRITE $$^WWWTEXT(32128),": "
	. WRITE $GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"FERTIGUNGSBEGINN"))    ;FERTIGUNGSBEGINN
	. IF $GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"FERTIGUNGSBEGINN"))="" DO
	. . WRITE "&nbsp;"
	. . WRITE "&nbsp;"
	. . WRITE "&nbsp;"
	. . WRITE "&nbsp;"
	. . WRITE "&nbsp;"
	. . WRITE "&nbsp;"
	. . WRITE "&nbsp;"
	. . WRITE "&nbsp;"
	. . WRITE "&nbsp;"
	. . WRITE "&nbsp;"
	. ;
	. WRITE "</TH>"
	. WRITE "</TR>"
	. WRITE "</TABLE>"
	. ;------------------------------------------ KOPF ENDE -----------------------
	. ;
	. WRITE "</TD>"
	. WRITE "</TR>",YCR
	. ;
	. WRITE "<TR>"
	. WRITE "<TD>"
	. ;------------------------------------------- Auftrag ---------------------------
	. ;
	. WRITE "<TABLE BORDER=0 WIDTH=100%>"
	. ;
	. ;Auftragsnummer ;Order No.  ;Order No. Order 
	. WRITE "<TR>"
	. WRITE "<TD ALIGN=RIGHT WIDTH=100>"
	. WRITE "<FONT SIZE=2>"
	. WRITE $$^WWWTEXT(32047),": "        ;AUFTGSNUMMER
	. WRITE "</TD>"
	. WRITE "<TD ALIGN=LEFT>"
	. WRITE "<FONT SIZE=2>"
	. WRITE $GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"AUFTRAGSNUMMER"))
	. WRITE "&nbsp;"
	. ;
	. ;NUR WENN GEWÜNSCHT ;only when 
	. IF $PIECE(YINVORG,Y,19)=1 DO   		           ;MIT KOMMISSIONEN?=1  ;by means of 
	. . WRITE $GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"AUFTRAGSINFORMATION"))  ;AUFTRAGSINFORMATION
	. ;
	. WRITE "</TD>"
	. WRITE "<TD ALIGN=LEFT NOWRAP WIDTH=25%>"
	. WRITE "<FONT SIZE=2>"
	. WRITE $$^WWWTEXT(32129),": "      ;FERTIGUNGSORT
	. WRITE $GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"FERTIGUNGSPLATZ"))
	. WRITE "&nbsp;"
	. WRITE "</TD>"
	. WRITE "</TR>",YCR
	. ;
	. ;Kommission ;Consignation 
	. WRITE "<TR>"
	. WRITE "<TD ALIGN=RIGHT WIDTH=100>"
	. WRITE "<FONT SIZE=2>"
	. WRITE "&nbsp;"
	. IF $PIECE(YINVORG,Y,19)=1 WRITE $$^WWWTEXT(32114),": "        ;kommission
	. WRITE "</TD>"
	. WRITE "<TD ALIGN=LEFT VALIGN=TOP>"
	. WRITE "<FONT SIZE=2>"
	. IF $PIECE(YINVORG,Y,19)=1 WRITE $GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"KOMMISION")),"&nbsp;"  ;kommissionsnummer
	. IF $GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"SERIENNUMMER"))'="" WRITE "SN: "_$GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"SERIENNUMMER"))  ;SERIENNUMMER DER POSITION ;the 
	. WRITE "&nbsp;"
	. WRITE "</TD>"
	. WRITE "<TD ALIGN=LEFT NOWRAP WIDTH=25%>"
	. WRITE "<FONT SIZE=2>"
	. WRITE $$^WWWTEXT(32130),": "     ;FERIGUNGSSTART
	. WRITE "&nbsp;"
	. WRITE "&nbsp;"
	. WRITE "&nbsp;"
	. WRITE "&nbsp;"
	. WRITE "&nbsp;"
	. WRITE "&nbsp;"
	. WRITE "&nbsp;"
	. WRITE "&nbsp;"
	. WRITE "&nbsp;"
	. WRITE "&nbsp;"
	. WRITE "&nbsp;"
	. WRITE "&nbsp;"
	. WRITE "&nbsp;"
	. WRITE "</TD>"
	. WRITE "</TR>",YCR
	. ;
	. WRITE "<TR>"
	. WRITE "<TD NOWRAP ALIGN=RIGHT WIDTH=100>"
	. WRITE "<FONT SIZE=2>"
	. WRITE $$^WWWTEXT(32041),": "          ;position
	. WRITE "</TD>"
	. WRITE "<TD ALIGN=LEFT>"
	. WRITE "<FONT SIZE=2>"
	. WRITE $GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"POSITION"))      ;POSITION
	. ;WRITE "&nbsp;"
	. ;WRITE "&nbsp;"
	. DO  ;IF $PIECE(YXL,Y,4)'=$PIECE($GET(^INAUFP(YM,YAUF,YPOS,1)),Y,4) DO   ;nur wenn nicht gleich
	. . WRITE " ("_$GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"ARTIKELNUMMER"))_") "  ;ARTIKELNUMMER 
	. . WRITE $GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"TEXTHAUPTPOSITION"))  ;TEXT DER HAUPTPOSITION ;Text the 
	. . QUIT
	. WRITE "</TD>"
	. WRITE "<TD ALIGN=LEFT WIDTH=20%>"
	. WRITE "<FONT SIZE=2>"
	. WRITE $$^WWWTEXT(32131),": "      ;FERTIGUNGSENDE
	. WRITE "&nbsp;"
	. WRITE "</TD>"
	. WRITE "</TR>",YCR
	. ;
	. ;ANZEIGEN NÄCHSTER FERTIGUNGSPLATZ (VOM OBERTEIL) ;display 
	. IF $PIECE($GET(^INVORG(YM,YM,1)),Y,102)=1 DO
	. . NEW FPL
	. . SET FPL=$GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"FERTIGUNGSPLATZ"))
	. . IF FPL'="" DO
	. . . WRITE YCR,"<TR>"
	. . . WRITE "<TD NOWRAP COLSPAN=2>"
	. . . WRITE "&nbsp;"
	. . . WRITE "</TD>"
	. . . WRITE "<TD NOWRAP ALIGN=LEFT WIDTH=20%>"
	. . . WRITE "<FONT SIZE=2>"
	. . . WRITE $$^WWWTEXT(33095),": "          ;NÄCHSTER FERTIGUNGSORT
	. . . WRITE $EXTRACT($PIECE($GET(^INPRONEST(YM,FPL,1)),Y,1),1,12) ;FERTIGUNGSPLATZ IN KLARSCHRIFT ;within 
	. . . WRITE "&nbsp;"
	. . . WRITE "</TD>"
	. . . WRITE "</TR>"
	. ;
	. WRITE "</TABLE>",YCR
	. ;
	. ;------------------------------------------- Ende Auftrag ----------------------- 
	. ;
	. ;       
	. ;--------------------------------------------ANFANG TEIL ------------------------
	. ;
	. ;
	. WRITE "<TABLE BORDER=0 WIDTH=100%>"
	. ;
	. ;TEILEBESCHREIBUNG / BARCODE
	. WRITE "<TR>"
	. WRITE "<TD NOWRAP ALIGN=RIGHT VALIGN=TOP WIDTH=100>"
	. WRITE "<FONT SIZE=2>"
	. WRITE $$^WWWTEXT(32127),": "        ;POSITIONSTEIL
	. WRITE "</TD>"
	. WRITE "<TD ALIGN=LEFT VALIGN=TOP>"
	. WRITE "<FONT SIZE=2>"
	. ;
	. DO   ;ANGEZEIGT WIRD MIT OHNE STUKTUR, JE NACH AUFBEREITUNG
	. . NEW YI
	. . SET YI="" FOR  SET YI=$ORDER(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"TEIL",YI)) QUIT:YI=""  DO 
	. . . WRITE "("_$GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"TEIL",YI))_")"   ;ARTIKELNUMMER
	. . . WRITE "&nbsp;"
	. . . WRITE $GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"TEILINFO",YI))  ;ARTIKELINFORMATION TEIL ;part 
	. . . WRITE "<BR>"
	. ;
	. WRITE "<BR>"
	. WRITE "<B>"
	. WRITE $$^WWWTEXT(32025),": "
	. WRITE $GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"MENGE"))   ;AUFBEREITETE MENGE ;quantity 
	. WRITE " "
	. WRITE $GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"MENGENEINHEIT"))   ;MENGENEINHEIT
	. WRITE "</B>"
	. ;
	. ;WENN MEHR EINHEITEN ZU PRODUZIEREN SIND ;when more within produce 
	. WRITE $GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"GESAMTMENGENE")) 
	. ;
	. WRITE "<BR>"
	. WRITE $GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"ARTIKELBESCHREIBUNG"))   ;ARTIKELBESCHREIBUNG
	. WRITE "<BR>"
	. WRITE $GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"PRODUKTIONSANWEISUNG"))  ;PRODUKTIONSANWEISUNG
	. ;
	. DO     ;QUALITÄTSSICHERUNG ;quality protection 
	. . NEW QPRUEF
	. . SET QPRUEF=$GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"QPRUEF")) 
	. . IF QPRUEF'="" DO 
	. . . WRITE "<BR>"
	. . . WRITE QPRUEF_": "
	. . . WRITE $GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"QPRUEFINFO"))  ;PRUEF-INFORMATION
	. ;
	. WRITE "</TD>"
	. WRITE "<TD WIDTH=80 NOWRAP ALIGN=LEFT VALIGN=MIDDLE>"
	. WRITE "<FONT SIZE=2>"
	. DO ^WWWBAR($GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"BAR")))
	. WRITE "&nbsp;"
	. WRITE "&nbsp;"
	. WRITE "</TD>"
	. WRITE "</TR>"
	. ;
	. WRITE "</TABLE>",YCR
	. ;
	. ;
	. ;--------------------------------------------ENDE TEIL --------------------------
	. WRITE "</TD>"
	. WRITE "</TR>",YCR
	. ;
	. WRITE "<TR>"
	. WRITE "<TD>"
	. ;
	. ;----------------------------------BEGINN UNTERTEILE----------------------
	. ;
	. WRITE "<TABLE BORDER=0 WIDTH=100%>"
	. ;
	. SET YI="" IF '$DATA(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE")) QUIT  ;KEINE TEILE VORHANDEN=KEIN DRUCK ;no printing 
	. ;
	. DO
	. . WRITE "<TR>"
	. . WRITE "<TH ALIGN=RIGHT>"
	. . WRITE "<FONT SIZE=2>"
	. . WRITE "&nbsp; "
	. . WRITE "</TH>"
	. . ;
	. . WRITE "<TH ALIGN=RIGHT>"
	. . WRITE "<FONT SIZE=2>"
	. . WRITE $$^WWWTEXT(32024)   ;"Artikel"
	. . WRITE "&nbsp;"
	. . WRITE "</TH>"
	. . ;
	. . WRITE "<TH ALIGN=LEFT>"
	. . WRITE "<FONT SIZE=2>"
	. . WRITE $$^WWWTEXT(31408)     ;"Beschreibung "
	. . WRITE "&nbsp;"
	. . WRITE "</TH>"
	. . WRITE "<TH ALIGN=RIGHT>"
	. . WRITE "<FONT SIZE=2>"
	. . WRITE $$^WWWTEXT(32025)   ;"Menge"
	. . WRITE "&nbsp;"
	. . WRITE "</TH>"
	. . ;
	. . WRITE "<TH ALIGN=RIGHT>"
	. . WRITE "<FONT SIZE=2>"
	. . WRITE $$^WWWTEXT(32137)    ;"RÜSTZEIT"
	. . WRITE "&nbsp;"
	. . WRITE "</TH>"
	. . ;
	. . WRITE "<TH ALIGN=RIGHT>"
	. . WRITE "<FONT SIZE=2>"
	. . IF MITZEITEN'=1 WRITE $$^WWWTEXT(32132)    ;"FERTIGUNGSDauer"
	. . WRITE "&nbsp;"
	. . WRITE "</TH>"
	. . WRITE "</TR>",YCR
	. ;
	. NEW YI
	. SET YI=""
	. FOR  SET YI=$ORDER(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE",YI)) QUIT:YI=""  DO
	. . QUIT:YI="SUMME"    ;SUMME  ;sum 
	. . WRITE "<TR>"
	. . WRITE "<TD VALIGN=TOP ALIGN=RIGHT>"
	. . WRITE "<FONT SIZE=2>"
	. . WRITE $GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE",YI,"LFN"))_".)"   ;LAUFENDE NUMMER ;numeral 
	. . WRITE "&nbsp;"
	. . WRITE "</TD>"
	. . ;
	. . WRITE "<TD VALIGN=TOP ALIGN=RIGHT WIDTH=8% NOWRAP>"
	. . WRITE "<FONT SIZE=2>"
	. . WRITE $GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE",YI,"ARTIKEL"))     ;ARTIKELNUMMER
	. . WRITE "&nbsp;"
	. . WRITE "</TD>"
	. . ;
	. . WRITE "<TD VALIGN=TOP ALIGN=LEFT WIDTH=50%>"
	. . WRITE "<FONT SIZE=2>"
	. . SET ZPOS=$GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE",YI,"ZPOS"))
	. . IF ZPOS'="" WRITE "("_ZPOS_")&nbsp;"
	. . WRITE $GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE",YI,"BEZEICHNUNG"))            ;SUCHBEZEICHNUNG MIT TEXT ;by means of Text 
	. . WRITE $GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE",YI,"PRODUKTIONSANWEISUNG"))   ;PRODUKTIONSANWEISUNG
	. . WRITE $GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE",YI,"WARENHERKUNFT"))          ;WARENHERKUNFT
	. . WRITE "&nbsp;"
	. . WRITE "</TD>"
	. . ;
	. . WRITE "<TD VALIGN=TOP ALIGN=RIGHT WIDTH=27%>"
	. . WRITE "<FONT SIZE=2>"
	. . WRITE $GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE",YI,"YTEILSUM"))   
	. . IF $DATA(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE",YI,"MENGE")) DO
	. . . WRITE $GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE",YI,"MENGE"))           ;MENGE   ;quantity 
	. . . ;
	. . . WRITE "&nbsp;"
	. . . WRITE $GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE",YI,"MENGENEINHEIT"))   ;MENGENEINHEIT
	. . ;
	. . WRITE "&nbsp;"
	. . WRITE "</TD>"
	. . ;
	. . WRITE "<TD VALIGN=TOP ALIGN=RIGHT WIDTH=8%>"
	. . WRITE "<FONT SIZE=2>"
	. . WRITE $GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE",YI,"RUESTZEIT"))      ;RUESTZEITEN
	. . WRITE "&nbsp;"
	. . WRITE "</TD>"
	. . ;
	. . WRITE "<TD VALIGN=TOP ALIGN=RIGHT WIDTH=15%>"
	. . WRITE "<FONT SIZE=2>"
	. . WRITE $GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE",YI,"FERTIGUNGSZEIT"))      ;AUSFÜHRUNGSZEIT ;execution time 
	. . WRITE "&nbsp;"
	. . WRITE "</TD>"
	. . WRITE "</TR>",YCR
	. ;
	. ;SUMME FÜR GESAMT-AUSFÜHRUNGSZEIT ;sum to 
	. IF $DATA(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE","SUMME","SUMRUESTZEIT")) DO
	. . WRITE "<TR>"
	. . WRITE "<TD ALIGN=LEFT>"
	. . WRITE "<FONT SIZE=2>"
	. . WRITE "&nbsp;"
	. . WRITE "</TD>"
	. . ;
	. . WRITE "<TD ALIGN=LEFT>"
	. . WRITE "<FONT SIZE=2>"
	. . WRITE "&nbsp;"
	. . WRITE "</TD>"
	. . ;
	. . WRITE "<TD ALIGN=RIGHT>"
	. . WRITE "<FONT SIZE=2>"
	. . WRITE "&nbsp;"
	. . WRITE "</TD>"
	. . WRITE "<TD ALIGN=RIGHT>"
	. . WRITE "<FONT SIZE=2>"
	. . WRITE "&nbsp;"
	. . WRITE "</TD>"
	. . ;
	. . WRITE "<TD ALIGN=RIGHT NOWRAP VALIGN=MIDDLE>"
	. . WRITE "<FONT SIZE=2>"
	. . WRITE "<hr>"
	. . WRITE "&nbsp;"
	. . WRITE $GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE","SUMME","SUMRUESTZEIT"))      ;GESAMT RUESTZEIT ;total 
	. . WRITE "&nbsp;"
	. . WRITE "</TD>"
	. . ;
	. . WRITE "<TD ALIGN=RIGHT NOWRAP VALIGN=MIDDLE>"
	. . WRITE "<FONT SIZE=2>"
	. . WRITE "<hr>"
	. . WRITE "&nbsp;"
	. . WRITE $GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE","SUMME","SUMFERTIGUNGSZEIT"))      ;GESAMT AUSFÜHRUNGSZEIT ;total execution time 
	. . WRITE "&nbsp;"
	. . WRITE "</TD>"
	. . WRITE "</TR>",YCR
	. ;
	. IF $DATA(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE","SUMME","GESAMTZEIT"))      ;GESAMTZEIT
	. . WRITE "<TR>"
	. . WRITE "<TD ALIGN=LEFT>"
	. . WRITE "<FONT SIZE=2>"
	. . WRITE "&nbsp;"
	. . WRITE "</TD>"
	. . ;
	. . WRITE "<TD ALIGN=LEFT>"
	. . WRITE "<FONT SIZE=2>"
	. . WRITE "&nbsp;"
	. . WRITE "</TD>"
	. . ;
	. . WRITE "<TD ALIGN=RIGHT>"
	. . WRITE "<FONT SIZE=2>"
	. . WRITE "&nbsp;"
	. . WRITE "</TD>"
	. . ;
	. . WRITE "<TD ALIGN=RIGHT>"
	. . WRITE "<FONT SIZE=2>"
	. . WRITE "&nbsp;"
	. . WRITE "</TD>"
	. . ;
	. . WRITE "<TD ALIGN=RIGHT NOWRAP VALIGN=MIDDLE>"
	. . WRITE "<FONT SIZE=2>"
	. . WRITE "<hr>"
	. . WRITE "&nbsp;"
	. . IF MITZEITEN'=1 WRITE $$^WWWTEXT(32181)  ;GESAMTZEIT
	. . WRITE "&nbsp;"
	. . WRITE "</TD>"
	. . ;
	. . WRITE "<TD ALIGN=RIGHT NOWRAP VALIGN=MIDDLE>"
	. . WRITE "<FONT SIZE=2>"
	. . WRITE "<hr>"
	. . WRITE "&nbsp;"
	. . WRITE $GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE","SUMME","GESAMTZEIT")) 
	. . WRITE "&nbsp;"
	. . WRITE "</TD>"
	. . WRITE "</TR>"
	. ;
	. WRITE "</TABLE>",YCR
	. ;
	. ;
	. ;----------------------------------ENDE UNTERTEILE----------------------
	. ;
	. WRITE "</TD>"
	. WRITE "</TR>"
	. ;
	. WRITE "</TABLE>",YCR
	. SET YPROSEITE=$GET(YPROSEITE)+1
	. WRITE YCR,"<font size=1><br>["_YBED_", "_$$^WWWDATE($HOROLOG)_","_$$^WWWTIME($HOROLOG)_" "
	. IF YSEITE'=1 WRITE $GET(YPROSEITE)_"-" SET YPROSEITE=YPROSEITE+YSEITE-1  ;VON-BIS BEI MEHREREN SEITEN ;next to sidelong 
	. WRITE $GET(YPROSEITE)
	. WRITE "]</font>"
	. DO FF^WWWW()
	
	QUIT
	
TRANSLATE   ;UMWANDELN ALLGEMEINE SONDER-TAGS ;transmute 
	;NEW MASCH
	;FESTLEGEN MAXIMALE ANZAHL UNTERTEILE PRO SEITE ;Number within side 
	;----------------------------------------------
	SET SEITE=1
	IF $DATA(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE")) SET UNTER=1
	SET MAXTEILE=48
	IF $FIND(YI(1),"<MAXTEILE>") DO
	. SET MAXTEILE=$PIECE($PIECE(YI(1),"<MAXTEILE>",2),"</MAXTEILE>",1)
	. SET YI(1)=$PIECE(YI(1),"<MAXTEILE>",1)_$PIECE(YI(1),"</MAXTEILE>",2)
	. SET MAXTEILE=+MAXTEILE
	
	IF $FIND(YI(1),"<UNTERTEILE>") DO
	. ;
	. NEW ZEILE,YII,YTEMP,VAR1
	. SET ZEILE=$PIECE($PIECE(YI(1),"<UNTERTEILE>",2),"</UNTERTEILE>",1)
	. SET YII="" IF '$DATA(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE")) QUIT    ;KEINE UNTERTEILE VORHANDEN=KEIN DRUCK ;no printing 
	. ;
	. FOR VAR="LFN","ARTIKEL","BEZEICHNUNG","PRODUKTIONSANWEISUNG","WARENHERKUNFT","MENGE","FERTIGUNGSZEIT","RUESTZEIT" DO
	. . IF $FIND(ZEILE,"<"_VAR_">") DO
	. . . SET YTEMP=""
	. . . SET YI=""
	. . . FOR  SET YI=$ORDER(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE",YI)) QUIT:YI=""  DO
	. . . . QUIT:YI="SUMME"  
	. . . . SET VAR1=$GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE",YI,VAR))
	. . . . IF VAR="LFN" SET VAR1=VAR1_".)"
	. . . . IF VAR="MENGE" SET VAR1=VAR1_"&nbsp;"_$GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE",YI,"MENGENEINHEIT"))
	. . . . SET YTEMP=YTEMP_VAR1_"<br>"
	. . . ;
	. . . IF YTEMP="" SET YTEMP="&nbsp:"
	. . . SET ZEILE=$PIECE(ZEILE,"<"_VAR_">",1)_YTEMP_$PIECE(ZEILE,"</"_VAR_">",2)
	. ;
	. SET YI(1)=$PIECE(YI(1),"<UNTERTEILE>",1)_ZEILE_$PIECE(YI(1),"</UNTERTEILE>",2)
	
	;MASCHINE ;machine 
	IF $FIND(YI(1),"<MASCHINE>") DO
	. NEW YTEMP
	. SET YTEMP=$GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"FERTIGUNGSPLATZ"))
	. SET YTEMP=YTEMP_" "_$GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"FERTIGUNGSMASCHINE"))
	. SET YI(1)=$PIECE(YI(1),"<MASCHINE>",1)_YTEMP_$PIECE(YI(1),"</MASCHINE>",2)
	
	;SUMME RÜSTZEIT ;sum setup time 
	IF $FIND(YI(1),"<GESRUESTZEIT>") DO
	. NEW YTEMP
	. SET YTEMP=$GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE","SUMME","SUMRUESTZEIT"))_"&nbsp;"
	. SET YI(1)=$PIECE(YI(1),"<GESRUESTZEIT>",1)_YTEMP_$PIECE(YI(1),"</GESRUESTZEIT>",2)
	
	;SUMME DAUER ;sum permanence 
	IF $FIND(YI(1),"<GESDAUER>") DO
	. NEW YTEMP
	. SET YTEMP=$GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE","SUMME","SUMFERTIGUNGSZEIT"))_"&nbsp;"
	. SET YI(1)=$PIECE(YI(1),"<GESDAUER>",1)_YTEMP_$PIECE(YI(1),"</GESDAUER>",2)
	 
	;SUMME TOTAL ;sum whole 
	IF $FIND(YI(1),"<GESAMTZEIT>") DO
	. NEW YTEMP
	. SET YTEMP=$GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE","SUMME","SUMGESAMTZEIT"))_"&nbsp;"
	. SET YI(1)=$PIECE(YI(1),"<GESAMTZEIT>",1)_YTEMP_$PIECE(YI(1),"</GESAMTZEIT>",2)
	
	IF $FIND(YI(1),"<FERTIGUNGSNUMMER>") DO
	. NEW YTEMP
	. SET YTEMP=YSTEMPEL_"&nbsp;"_$GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE","UNTERPUNKT"))_"&nbsp;"
	. SET YTEMP=YTEMP_$GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE","ZWEITSCHRIFT"))
	. SET YI(1)=$PIECE(YI(1),"<FERTIGUNGSNUMMER>",1)_YTEMP_$PIECE(YI(1),"</FERTIGUNGSNUMMER>",2)
	
	IF $FIND(YI(1),"<LIEFERUNG>") DO  ;z.B. 36 SATZ/KARTON - AUS UMVERPACKUNGSAUFKLEBER  ;e.g. out of 
	. NEW YTEMP
	. SET YTEMP=$GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"LIEFERUNG"))
	. SET YTEMP=YTEMP_"/"_$GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"LIEFERUNGTRANSPO"))
	. SET YI(1)=$PIECE(YI(1),"<LIEFERUNG>",1)_YTEMP_$PIECE(YI(1),"</LIEFERUNG>",2)
	
	IF $FIND(YI(1),"<ARTIKEL>") DO  ;ARTIKEL (NUMMER) BEZEICHNUNG ;item notation 
	. NEW YTEMP
	. SET YTEMP="("_$GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"ARTIKELNUMMER"))_")"
	. SET YTEMP=YTEMP_"&nbsp;"_$GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"ARTIKELBESCHREIBUNG"))
	. SET YI(1)=$PIECE(YI(1),"<ARTIKEL>",1)_YTEMP_$PIECE(YI(1),"</ARTIKEL>",2)
	
	IF $FIND(YI(1),"<MENGE>") DO  ;MENGE ;quantum  ;quantity 
	. NEW YTEMP
	. SET YTEMP=$GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"MENGE"))
	. SET YTEMP=YTEMP_"&nbsp;"_$GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"MENGENEINHEIT"))
	. SET YTEMP=YTEMP_"&nbsp;"_$GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"GESAMTMENGE"))
	. SET YI(1)=$PIECE(YI(1),"<MENGE>",1)_YTEMP_$PIECE(YI(1),"</MENGE>",2)
	
	IF $FIND(YI(1),"<AUFTRAG>") DO  ;AUFTRAG ;mandate  ;order 
	. NEW YTEMP
	. SET YTEMP=$GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"AUFTRAGSNUMMER"))
	. SET YI(1)=$PIECE(YI(1),"<AUFTRAG>",1)_YTEMP_$PIECE(YI(1),"</AUFTRAG>",2)
	
	;TAGS GLEICH MIT BEZEICHNUNG SORDDATEI UND TAG ;in the daytime without delay by means of notation And TAG 
	FOR VAR="FERTIGUNGSBEGINN","DATUM","ABTEILUNG","FERTIGUNGSPLATZ","NEXTFERTIGUNGSPLATZ","POSITION","BESTELLER","KOMMISSION","PRODUKTIONSANWEISUNG","AUSFUEHRUNG","MENGEOFFEN" DO
	. NEW YTEMP
	. IF $FIND(YI(1),"<"_VAR_">") DO
	. . SET YTEMP=$GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,VAR))
	. . SET YI(1)=$PIECE(YI(1),"<"_VAR_">",1)_YTEMP_$PIECE(YI(1),"</"_VAR_">",2)
	
	IF $FIND(YI(1),"<BARCODE>") DO  ;
	. NEW BARCODE
	. SET BARCODE=$GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"BAR"))
	. IF BARCODE'="" DO
	. . DO ^WWWBAR(BARCODE,,,1)
	. . SET YI(1)=$PIECE(YI(1),"<BARCODE>",1)_"<img src="_""""_YGIF_"gif"_BARCODE_".gif"_""""_">"_$PIECE(YI(1),"</BARCODE>",2)
	
	IF $FIND(YI(1),"<KOMMISSION>") DO  ;KOMMISSION ;errand 
	. IF MITKOM=1 SET YI(1)=$PIECE(YI(1),"<KOMMISSION>",1)_"&nbsp;"_$PIECE(YI(1),"</KOMMISSION>",2) QUIT   ;KEIN DRUCK
	. SET YTEMP=$GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"KOMMISIONSVORGANG"))   ;VORGANGSNUMMER
	. ;SET YI(1)=$PIECE(YI(1),"<KOMMISSION>",1)_$TRANSLATE($$^WWWUML($PIECE($GET(^INAUF(YM,YAUF,1)),Y,13)),"|")_" "_$$^WWWUML($PIECE($GET(^INAUF(YM,YAUF,1)),Y,8))_$PIECE(YI(1),"</KOMMISSION>",2)
	. SET YI(1)=$PIECE(YI(1),"<KOMMISSION>",1)_YTEMP_$PIECE(YI(1),"</KOMMISSION>",2)  ;VORGANGSNUMMER
	
	IF $FIND(YI(1),"<TEIL>") DO  ;PRODUKTIONSTEIL
	. ;                           ;ANGEZEIGT WIRD MIT OHNE STUKTUR, JE NACH AUFBEREITUNG
	. NEW YII,YTEMP,TEIL
	. SET YTEMP=""
	. SET YII=""
	. FOR  SET YII=$ORDER(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"TEIL",YII)) QUIT:YII=""  DO 
	. . SET TEIL="("_$GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"TEIL",YII))_")"_"&nbsp;"   ;ARTIKELNUMMER
	. . SET TEIL=TEIL_$GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"TEILINFO",YII))_"<BR>"   ;ARTIKELINFORMATION TEIL ;part 
	. . SET YTEMP=YTEMP_TEIL
	. ;
	. SET YI(1)=$PIECE(YI(1),"<TEIL>",1)_YTEMP_$PIECE(YI(1),"</TEIL>",2)
	
	IF $FIND(YI(1),"<MENGE>") DO  ;MENGE ;quantum  ;quantity 
	. NEW YTEMP
	. SET YTEMP=$GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"GESAMTMENGE")) 
	. SET YI(1)=$PIECE(YI(1),"<MENGE>",1)_YTEMP_$PIECE(YI(1),"</MENGE>",2)
	
	IF $FIND(YI(1),"<ARBEITSGANG>") DO  ;
	. SET YI(1)=$PIECE(YI(1),"<ARBEITSGANG>",1)_"ARBEITSGANG"_$PIECE(YI(1),"</ARBEITSGANG>",2)
	
	;PRODUKTIONSMENGE
	IF $FIND(YI(1),"<PRODUKTIONSMENGE>") DO
	. SET YTEMP=$GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"PRODUKTIONSMENGE"))
	. SET YI(1)=$PIECE(YI(1),"<PRODUKTIONSMENGE>",1)_YTEMP_$PIECE(YI(1),"</PRODUKTIONSMENGE>",2)
	
	IF $FIND(YI(1),"<QUALITAETSPRUEFUNG>") DO  ;
	. NEW QPRUEF,YTEMP
	. SET YTEMP =$GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"QPRUEF"))
	. SET QPRUEF=$GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"QPRUEFINFO"))
	. IF QPRUEF'="" SET YTEMP=YTEMP_" : "_QPRUEF
	. SET YI(1)=$PIECE(YI(1),"<QUALITAETSPRUEFUNG>",1)_YTEMP_$PIECE(YI(1),"</QUALITAETSPRUEFUNG>",2)
	
	IF $FIND(YI(1),"<SEITE>") DO
	. SET YPROSEITE=$GET(^WWWSOR(YUSER,"ORDER",YSTEMPEL,"UNTERTEILE","SUMME","YSEITE"))
	. IF ($GET(SEITE)=1)!(UNTER=0) SET YI(1)=$PIECE(YI(1),"<SEITE>",1)_$GET(YPROSEITE)_$PIECE(YI(1),"</SEITE>",2) QUIT  ;SEITE ;side 
	. SET YI(1)=$PIECE(YI(1),"<SEITE>",1)_YPROSEITE_"-"_(YPROSEITE+SEITE-1)_$PIECE(YI(1),"</SEITE>",2)  ;SEITE VON-BIS ;side 
	. SET YPROSEITE=YPROSEITE+SEITE-1
	
	;ANHANG JE ABTEILUNG ;supporters once speciality 
	IF $FIND(YI(1),"<ANLAGE") DO
	. NEW ANLAGE,ABTEILUNG
	. SET ANLAGE=$PIECE($PIECE(YI(1),"<ANLAGE",2),">",1)
	. SET ABTEILUNG=""
	. IF $PIECE(YXL,Y,57)'="" SET ABTEILUNG=$PIECE($GET(^INMASCH(YM,$PIECE(YXL,Y,57),1)),Y,36)
	. IF ABTEILUNG=""      SET YI(1)=$PIECE(YI(1),"<ANLAGE"_ANLAGE_">",1)_$PIECE(YI(1),"</ANLAGE"_ANLAGE_">",2) QUIT
	. IF ABTEILUNG'=ANLAGE SET YI(1)=$PIECE(YI(1),"<ANLAGE"_ANLAGE_">",1)_$PIECE(YI(1),"</ANLAGE"_ANLAGE_">",2) QUIT
	. SET YI(1)=$PIECE(YI(1),"<ANLAGE"_ANLAGE_">",1)_$PIECE($PIECE(YI(1),"<ANLAGE"_ANLAGE_">",2),"</ANLAGE"_ANLAGE_">",1)_$PIECE(YI(1),"</ANLAGE"_ANLAGE_">",2)
	
	IF YAUF'="" IF YPOS'="" DO  ;ALLGEMEINE DATENFELDER AUFTRAGSPOSITION
	. NEW ZEILE,YDATEI,YFELD
	. SET ZEILE=YI(1)
	. SET YDATEI="INAUFP"
	. SET YFELD=$GET(^INAUFP(YM,YAUF,YPOS,1))
	. DO ^INRELNAME  ;DURCHSUCHEN ZEILE NACH DATENFELDERN ;scour within 
	. SET YI(1)=ZEILE
	
	QUIT
	
CREATE ;HTML-VORLAGE BILDEN / CREATE DEFAULT IF THERE IS NONE (JUST IN CASE) ;shape within 
	
	; FIXME : There is no longer an initial HTML to build on <GRF> - grows to over 14000 chars
	
	;SET HTML="<html>"
	;SET HTML=HTML_"|"_"<head>"
	;SET HTML=HTML_"|"_"<meta http-equiv=expires content=0>"
	;SET HTML=HTML_"|"_"<meta http-equiv="_""""_"Content-Type"_""""_" content="_""""_"text/html; charset=iso-8859-1"_""""_">"  ;EUROPEAN FONT-TYPE
	;SET HTML=HTML_"|"_"<title>Fertigungsanweisung</title>"
	;SET HTML=HTML_"|"_"</head>"
	SET HTML=HTML_"|"_"<style>"
	SET HTML=HTML_"|"_" <!--"
	SET HTML=HTML_"|"_" body {background-color:white;}"
	SET HTML=HTML_"|"_" table.border {border:1px solid black;}"
	SET HTML=HTML_"|"_" td.border {border:1px solid black;}"
	SET HTML=HTML_"|"_" //-->"
	SET HTML=HTML_"|"_"</style>"
	;SET HTML=HTML_"|"_"<body>"
	;SET HTML=HTML_"|"_"<table border=0 cellspacing=0 cellpadding=0>"
	;SET HTML=HTML_"|"_"<tr><td>"
	;SET HTML=HTML_"|"_"<fieldset>"
	;SET HTML=HTML_"|"_"<legend><font face=arial size=3><b><mandant></mandant></b></font></legend>"
	;SET HTML=HTML_"|"_"<table BORDER=0 CELLSPACING=4 CELLPADDING=0 WIDTH="_""""_"400"_""""_" >"
	;SET HTML=HTML_"|"_"<tr>"
	;SET HTML=HTML_"|"_"<td>"
	;SET HTML=HTML_"|"_"<center>"
	;SET HTML=HTML_"|"_"<table BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH="_""""_"100%"_""""_">"
	;SET HTML=HTML_"|"_"<tr>"
	;SET HTML=HTML_"|"_"<td VALIGN=BOTTOM>"
	SET HTML=HTML_"|"_"<table BORDER=0 CELLSPACING=4 CELLPADDING=4 WIDTH="_""""_"650"_""""_">"
	SET HTML=HTML_"|"_"<tr>"
	SET HTML=HTML_"|"_"<td colspan=4 align=left valign=top nowrap>"
	SET HTML=HTML_"|"_"<font face=arial size=3><b><FERTIGUNGSPLATZ></FERTIGUNGSPLATZ></b></font>"
	SET HTML=HTML_"|"_"</td>"
	SET HTML=HTML_"|"_"</tr>"
	SET HTML=HTML_"|"_"<tr>"
	SET HTML=HTML_"|"_"<td align=left valign=top nowrap>"
	SET HTML=HTML_"|"_"<font face=arial size=2><b>Produktionsauftrag: <FERTIGUNGSNUMMER></FERTIGUNGSNUMMER></font></b>"
	SET HTML=HTML_"|"_"</td>"
	SET HTML=HTML_"|"_"<td align=left valign=top nowrap>"
	SET HTML=HTML_"|"_"<font face=arial size=2> für Auftrag:  <AUFTRAG></AUFTRAG>-<POSITION></POSITION></font>"
	SET HTML=HTML_"|"_"</td>"
	SET HTML=HTML_"|"_"<td align=left ]]><![CDATA[valign=top nowrap>"
	SET HTML=HTML_"|"_"<font face=arial size=2> vom: <DATUM></DATUM></font>"
	SET HTML=HTML_"|"_"</td>"
	SET HTML=HTML_"|"_"</tr>"
	SET HTML=HTML_"|"_"<tr>"
	SET HTML=HTML_"|"_"<td colspan=1 align=left valign=top nowrap>"
	SET HTML=HTML_"|"_"<font face=arial size=2> Artikel: <ARTIKEL></ARTIKEL><br> Zch.Nr.: <D273></D273><br> Auf.Dat.: <D193></D193></font>"
	SET HTML=HTML_"|"_"</td>"
	SET HTML=HTML_"|"_"<td colspan=2  align=left valign=top nowrap>"
	SET HTML=HTML_"|"_"<font face=arial size=2> Firma: <BESTELLER></BESTELLER><br> Index: <D274></D274><br> Lieferung: <LIEFERUNG></LIEFERUNG>  <br>Zu prod. Menge: <B><MENGE></MENGE></B></font>"
	SET HTML=HTML_"|"_"</td>"
	SET HTML=HTML_"|"_"<td colspan=3 align=left valign=top nowrap>"
	SET HTML=HTML_"|"_"<font face=arial size=2>VG.Nr.: <br><KOMMISSION></KOMMISSION></font>"
	SET HTML=HTML_"|"_"</td>"
	SET HTML=HTML_"|"_"</tr>"
	SET HTML=HTML_"|"_"<tr>"
	SET HTML=HTML_"|"_"<td colspan=2 align=left valign=top nowrap>"
	SET HTML=HTML_"|"_"<font face=arial size=2> Zu produzieren:<b> <TEIL></TEIL> <AUSFUEHRUNG></AUSFUEHRUNG></b><br>Summe&nbsp;Offen/Bestellt:&nbsp;<MENGEOFFEN></MENGEOFFEN>/<PRODUKTIONSMENGE></PRODUKTIONSMENGE>"
	SET HTML=HTML_"|"_"</td>"
	SET HTML=HTML_"|"_"<td colspan=2 align=left valign=top nowrap>"
	SET HTML=HTML_"|"_"<font face=arial size=2><BARCODE></BARCODE>"
	SET HTML=HTML_"|"_"</td>"
	SET HTML=HTML_"|"_"</tr>"
	SET HTML=HTML_"|"_"<tr>"
	SET HTML=HTML_"|"_"<td colspan=2 align=left valign=top nowrap>"
	SET HTML=HTML_"|"_"<font face=arial size=2> "
	SET HTML=HTML_"|"_"</td>"
	SET HTML=HTML_"|"_"<td colspan=2 align=left valign=top nowrap>"
	SET HTML=HTML_"|"_"<font face=arial size=2> Arbeitsplatz: <MASCHINE></MASCHINE>"
	SET HTML=HTML_"|"_"</td>"
	SET HTML=HTML_"|"_"</tr>"
	SET HTML=HTML_"|"_"<tr>"
	SET HTML=HTML_"|"_"<td colspan=2 align=left valign=top>"
	SET HTML=HTML_"|"_"<font face=arial size=2> <b>QM-Prüfung: </b><QUALITAETSPRUEFUNG></QUALITAETSPRUEFUNG>"
	SET HTML=HTML_"|"_"</td>"
	SET HTML=HTML_"|"_"<td colspan=2 align=left valign=top nowrap>"
	SET HTML=HTML_"|"_"<font face=arial size=2> nächster Arbeitsplatz: <NEXTFERTIGUNGSPLATZ></NEXTFERTIGUNGSPLATZ>"
	SET HTML=HTML_"|"_"</td>"
	SET HTML=HTML_"|"_"</tr>"
	SET HTML=HTML_"|"_"</table>"
	;AB HIER UNTERTEILE ;Confirm. here is 
	SET HTML=HTML_"|"_"<MAXTEILE>48</MAXTEILE><UNTERTEILE>"
	SET HTML=HTML_" "_"<table BORDER=0 CELLSPACING=1 CELLPADDING=1 WIDTH="_""""_"100%"_""""_">"
	SET HTML=HTML_" "_"<tr>"
	SET HTML=HTML_" "_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	SET HTML=HTML_" "_"<font face=arial size=2><b>lfd.Nr.</font>"
	SET HTML=HTML_" "_"</td>"
	SET HTML=HTML_" "_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	SET HTML=HTML_" "_"<font face=arial size=2><b>Artikel</font>"
	SET HTML=HTML_" "_"</td>"
	SET HTML=HTML_" "_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	SET HTML=HTML_" "_"<font face=arial size=2><b>Bezeichnung</font>"
	SET HTML=HTML_" "_"</td>"
	SET HTML=HTML_" "_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	SET HTML=HTML_" "_"<font face=arial size=2><b>Warenherkunft</font>"
	SET HTML=HTML_" "_"</td>"
	SET HTML=HTML_" "_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	SET HTML=HTML_" "_"<font face=arial size=2><b>Menge</font>"
	SET HTML=HTML_" "_"</td>"
	SET HTML=HTML_" "_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	SET HTML=HTML_" "_"<font face=arial size=2><b>Rüstzeit</font>"
	SET HTML=HTML_" "_"</td>"
	SET HTML=HTML_" "_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	SET HTML=HTML_" "_"<font face=arial size=2><b>Dauer</font>"
	SET HTML=HTML_" "_"</td>"
	SET HTML=HTML_" "_"</tr>"
	SET HTML=HTML_" "_"<tr>"
	SET HTML=HTML_" "_"<td class="_""""_"border"_""""_" align=right valign=top nowrap>"
	SET HTML=HTML_" "_"<font face=arial size=2><LFN> .)</LFN></font>"
	SET HTML=HTML_" "_"</td>"
	SET HTML=HTML_" "_"<td class="_""""_"border"_""""_" align=right valign=top nowrap>"
	SET HTML=HTML_" "_"<font face=arial size=2><ARTIKEL></ARTIKEL></font>"
	SET HTML=HTML_" "_"</td>"
	SET HTML=HTML_" "_"<td class="_""""_"border"_""""_" align=left valign=top nowrap>"
	SET HTML=HTML_" "_"<font face=arial size=2><BEZEICHNUNG></BEZEICHNUNG></font>"
	SET HTML=HTML_" "_"</td>"
	SET HTML=HTML_" "_"<td class="_""""_"border"_""""_" align=left valign=top nowrap>"
	SET HTML=HTML_" "_"<font face=arial size=2><WARENHERKUNFT></WARENHERKUNFT></font>"
	SET HTML=HTML_" "_"</td>"
	SET HTML=HTML_" "_"<td class="_""""_"border"_""""_" align=right valign=top nowrap>"
	SET HTML=HTML_" "_"<font face=arial size=2><MENGE></MENGE></font>"
	SET HTML=HTML_" "_"</td>"
	SET HTML=HTML_" "_"<td class="_""""_"border"_""""_" align=right valign=top nowrap>"
	SET HTML=HTML_" "_"<font face=arial size=2><RUESTZEIT></RUESTZEIT></font>"
	SET HTML=HTML_" "_"</td>"
	SET HTML=HTML_" "_"<td class="_""""_"border"_""""_" align=right valign=top nowrap>"
	SET HTML=HTML_" "_"<font face=arial size=2><FERTIGUNGSZEIT></FERTIGUNGSZEIT></font>"
	SET HTML=HTML_" "_"</td>"
	SET HTML=HTML_" "_"</tr>"
	SET HTML=HTML_" "_"<tr>"
	SET HTML=HTML_" "_"<td COLSPAN=5 class="_""""_"border"_""""_" align=RIGHT valign=top nowrap>"
	SET HTML=HTML_" "_"<font face=arial size=2>&nbsp;</font>"
	SET HTML=HTML_" "_"</td>"
	SET HTML=HTML_" "_"<td class="_""""_"border"_""""_" class="_""""_"border"_""""_" align=RIGHT valign=top nowrap>"
	SET HTML=HTML_" "_"<font face=arial size=2><B><GESRUESTZEIT></GESRUESTZEIT></B></font>"
	SET HTML=HTML_" "_"</td>"
	SET HTML=HTML_" "_"<td class="_""""_"border"_""""_" class="_""""_"border"_""""_" align=RIGHT valign=top nowrap>"
	SET HTML=HTML_" "_"<font face=arial size=2><B><GESDAUER></GESDAUER></B></font>"
	SET HTML=HTML_" "_"</td>"
	SET HTML=HTML_" "_"</tr>"
	SET HTML=HTML_" "_"<tr>"
	SET HTML=HTML_" "_"<td COLSPAN=7 class="_""""_"border"_""""_" align=RIGHT valign=top nowrap>"
	SET HTML=HTML_" "_"<font face=arial size=2><B><GESAMTZEIT></GESAMTZEIT></B></font>"
	SET HTML=HTML_" "_"</td>"
	SET HTML=HTML_" "_"</tr>"
	SET HTML=HTML_" "_"</table>"
	SET HTML=HTML_" "_"</UNTERTEILE>"
	SET HTML=HTML_"|"_"<br>"
	;AB HIER LISTE STUNDENLEISTUNG ;Confirm. here is list 
	SET HTML=HTML_"|"_"<ANLAGE4>"
	SET HTML=HTML_"|"_"<table border=0 CELLSPACING=1 CELLPADDING=1 WIDTH="_""""_"100%"_""""_" >"
	SET HTML=HTML_"|"_"<tr>"
	SET HTML=HTML_"|"_"<td colspan=6 align=left valign=top nowrap>"
	SET HTML=HTML_"|"_"<font face=arial size=2> Stundenleistung: </font>"
	SET HTML=HTML_"|"_"</td>"
	SET HTML=HTML_"|"_"<td colspan=3 align=left valign=top nowrap>"
	SET HTML=HTML_"|"_"<font face=arial size=2> Form: </font>"
	SET HTML=HTML_"|"_"</td>"
	SET HTML=HTML_"|"_"</tr>"
	SET HTML=HTML_"|"_"<tr>"
	SET HTML=HTML_"|"_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	SET HTML=HTML_"|"_"<font face=arial size=2> Datum </font>"
	SET HTML=HTML_"|"_"</td>"
	SET HTML=HTML_"|"_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	SET HTML=HTML_"|"_"<font face=arial size=2> PersonalNr.<br>und Name </font>"
	SET HTML=HTML_"|"_"</td>"
	SET HTML=HTML_"|"_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	SET HTML=HTML_"|"_"<font face=arial size=2> Std </font>"
	SET HTML=HTML_"|"_"</td>"
	SET HTML=HTML_"|"_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	SET HTML=HTML_"|"_"<font face=arial size=2> Gut <br> Stück </font>"
	SET HTML=HTML_"|"_"</td>"
	SET HTML=HTML_"|"_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	SET HTML=HTML_"|"_"<font face=arial size=2> Gesamt- <br> Gutstück </font>"
	SET HTML=HTML_"|"_"</td>"
	SET HTML=HTML_"|"_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	SET HTML=HTML_"|"_"<font face=arial size=2> Zyklen/ <br>Schicht </font>"
	SET HTML=HTML_"|"_"</td>"
	SET HTML=HTML_"|"_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	SET HTML=HTML_"|"_"<font face=arial size=2> Zyklen/<br> Gesamt </font>"
	SET HTML=HTML_"|"_"</td>"
	SET HTML=HTML_"|"_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	SET HTML=HTML_"|"_"<font face=arial size=2> QS/ <br> frei </font>"
	SET HTML=HTML_"|"_"</td>"
	SET HTML=HTML_"|"_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	SET HTML=HTML_"|"_"<font face=arial size=2> Mat.verlust beim <br> Abspritzen in gr </font>"
	SET HTML=HTML_"|"_"</td>"
	SET HTML=HTML_"|"_"</tr>"
	FOR YI=1:1:10 DO
	. SET HTML=HTML_"|"_"<tr>"
	. SET HTML=HTML_"|"_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	. SET HTML=HTML_"|"_"<font face=arial size=2>&nbsp;</font>"
	. SET HTML=HTML_"|"_"</td>"
	. SET HTML=HTML_"|"_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	. SET HTML=HTML_"|"_"<font face=arial size=2>&nbsp;</font>"
	. SET HTML=HTML_"|"_"</td>"
	. SET HTML=HTML_"|"_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	. SET HTML=HTML_"|"_"<font face=arial size=2>&nbsp;</font>"
	. SET HTML=HTML_"|"_"</td>"
	. SET HTML=HTML_"|"_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	. SET HTML=HTML_"|"_"<font face=arial size=2>&nbsp;</font>"
	. SET HTML=HTML_"|"_"</td>"
	. SET HTML=HTML_"|"_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	. SET HTML=HTML_"|"_"<font face=arial size=2>&nbsp;</font>"
	. SET HTML=HTML_"|"_"</td>"
	. SET HTML=HTML_"|"_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	. SET HTML=HTML_"|"_"<font face=arial size=2>&nbsp;</font>"
	. SET HTML=HTML_"|"_"</td>"
	. SET HTML=HTML_"|"_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	. SET HTML=HTML_"|"_"<font face=arial size=2>&nbsp;</font>"
	. SET HTML=HTML_"|"_"</td>"
	. SET HTML=HTML_"|"_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	. SET HTML=HTML_"|"_"<font face=arial size=2>&nbsp;</font>"
	. SET HTML=HTML_"|"_"</td>"
	. SET HTML=HTML_"|"_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	. SET HTML=HTML_"|"_"<font face=arial size=2>&nbsp;</font>"
	. SET HTML=HTML_"|"_"</td>"
	. SET HTML=HTML_"|"_"</tr>"
	
	SET HTML=HTML_"|"_"</table>"
	SET HTML=HTML_"|"_"</ANLAGE4>"
	SET HTML=HTML_"|"_"Seite: <SEITE></SEITE>"
	;SET HTML=HTML_"|"_"</body>"
	;SET HTML=HTML_"|"_"</html>"
	SET $PIECE(^WWWHTML($$^WWWYM("WWWHTML"),"INPROPROHTML","DE",1),Y,1)=HTML
	SET $PIECE(^WWWHTML($$^WWWYM("WWWHTML"),"INPROPROHTML","DE",1),Y,2)="Fertigungsanweisung"
	QUIT
]]></Routine>
</Export>