<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="22" zv="CACHE" ts="2001-01-01 00:00:00">
<Routine name="INANGPTT" type="MAC" languagemode="0" timestamp="58440,0"><![CDATA[
INANGPTT  ;INANGPTT;DT;POSITIONS ARTIKELTEILESTRUKTUR TABELLE ANZEIGE eines ANGEBOTES bei Artikelteileanlage;11.11.2000  ; Compiled February 15, 2005 10:01:36
	;
	;/------------------------------------------------------------------\
	;| Description of Function :
	;|		POSITIONS ARTIKELTEILESTRUKTUR TABELLE ANZEIGE eines ANGEBOTES bei Artikelteileanlage
	;|
	;| Inputs : 
	;|
	;|
	;| ByRef :
	;|
	;|
	;| Returns :
	;|
	;|
	;| History :
	;|
	;| 10-AUG-2005   TYBD    SR13166 : ADD BACKBUTTON 
	;| DT	11.11.2000  
	;|
	;\------------------------------------------------------------------/
	;
	;
	;(C) BY DITMAR TYBUSSEK
	;DIESES PROGRAMM ZEIGT DIE TABELLE DER TEILE IN DER POSITIONS - ARTIKEL- STRUKTUR - ERFASSUNG AN ;this programme who tabulation the within the texture logging upon 
	;VERSCHIEBEN DER TEILE IST MÖGLICH ;defer the potential 
	NEW AUFPARTIKEL,ZUSATZ,ART,ARTT,ARTX,KEINEUNTERTEILE,TEILE,GEWICHT,DAUER,RDAUER,WERT,TART,YANG,YPOS,MENGE,ARTIKEL,YANGPXL0,YANGPXL1,YANGPXL2,MENGEP,TEILEXIST
	;
	;ACHTUNG YPARA=ENTHÄLT DIE STRUKTUR ZURUECK ZUM OBERARTIKEL (WENN AUSWAHL UNTER/UNTERARTIKEL) ;estimation who texture Selection 
	QUIT:YKEY=""
	SET YANG=$PIECE(YKEY,",",1)
	QUIT:YANG=""
	SET YPOS=$PIECE(YKEY,",",2)
	QUIT:YPOS=""
	;
	SET YLISTEN=$GET(YLISTEN)
	SET VERSCHNITT=$PIECE($GET(^INVORG(YM,YM,1)),Y,10)  ;VERSCHNITT IN % ;within 
	;
	SET YPARA=$GET(YPARA)  ;ARTIKELTEILEBENE
	FOR  QUIT:$EXTRACT(YPARA)'=","  SET YPARA=$EXTRACT(YPARA,2,99)  ;KOMMA HERAUSFILTERN ;comma 
	SET YPARAX=YPARA  ;SICHERN YPARA FÜR SPÄTERE VERWENDUNG ;safeguard to 
	;
	;
	;
	;FÜR DIE GESAMMTSUMME ;to who 
	SET GEWICHT=0
	SET DAUER=0
	SET RDAUER=0
	SET WERT=0
	S ZUSATZ=0
	S TEILEXIST=0
	;
	SET YDDSATZ=0  ;ANZEIGE WEISS ;Show 
	;
	IF $TRANSLATE(YPARA,",")'="" DO   ;ZURUECK ZU OBERARTIKEL ;within 
	. NEW YPARA,YPARA1,YPARA2,YKEY,YBACK,YI,TEILETEXT
	. SET YKEY=YANG_","_YPOS
	. SET YPARA=$PIECE(YPARAX,",",1,$LENGTH(YPARAX,",")-1)
	. WRITE "<A"
	. WRITE " TITLE=""" DO  WRITE """"  ;TEXT
	. . WRITE $PIECE($GET(^INANGP(YM,YANG,YPOS,1)),Y,1)   ;HAUPTPOSITION
	. . FOR YI=1:1 QUIT:$PIECE(YPARAX,",",YI)=""  DO  ;Teile aufbauen ;parts construct 
	. . . IF YI=2 WRITE "   "
	. . . DO 
	. . . . WRITE $CHAR(13)
	. . . . FOR YI(1)=1:1:YI WRITE "   "
	. . . . WRITE "\__"
	. . . . QUIT
	. . . SET TEILETEXT="("_$PIECE($GET(^INANGPT(YM,YANG,YPOS,$TRANSLATE($PIECE(YPARAX,",",1,YI),",",".")_".",1)),Y,4)_") "_$PIECE($GET(^INANGPT(YM,YANG,YPOS,$TRANSLATE($PIECE(YPARAX,",",1,YI),",",".")_".",1)),Y,1)   ;OBERTEIL ANZEIGEN ;display 
	. . . WRITE $PIECE(YPARAX,",",YI)_" "_TEILETEXT
	. . . QUIT
	. . QUIT
	. WRITE " HREF="""_YAKTION_"EP=WWWFORM&YFORM=INANGPTT1"
	. SET YBACK="INANG,INANGP,"   ;YBACK
	. DO ^WWWCGI
	. WRITE """>"
	. WRITE "<FONT SIZE=2>"
	. WRITE YCR,"<IMG SRC="""_YGIF_"hback.gif"" TITLE="""_$$^WWWTEXT(32108)_""" id=""BUTTON_BACK"" border=0 VSPACE=0>"   ;backbutton;TYBD;SR13166
	. WRITE "<B>"
	. WRITE $$^WWWTEXT(32108)  ;ÜBERGEORDNETE ARTIKEL ;item 
	. WRITE "</B>"
	. ;WRITE YCR,"<IMG SRC="""_YGIF_"teile.gif"" TITLE="""_$$^WWWTEXT(32108)_""" width=18 height=18 border=0 VSPACE=0>"   ;übergeordneter Artikel
	. WRITE "</A>"
	. WRITE "&nbsp;"
	. WRITE "&nbsp;"
	. WRITE "&nbsp;"
	. WRITE "&nbsp;"
	. WRITE "&nbsp;"
	. WRITE "<B>"_$GET(TEILETEXT)_"</B>"
	. QUIT
	;
	WRITE "<BR>"
	;
	;
	;Start anzeige
	;
	;ANZEIGE ERFASSTE WERTE ;Show 
	DO ^WWWFRAME(0)
	WRITE YCR
	;
	DO KOPF ;DRUCKEN KOPFZEILE ;print 
	;
	;
	;EINZELTEILE ANZEIGEN ;display 
	SET ARTX=0   ;KEINE TEILE ;no 
	;
	;
	;ZUSAMMENSTELLEN LAUFVARIABLE
	SET YANGPXL="^INANGPXL("""_YM_""","""_YANG_""","""_YPOS_""""
	FOR YI=1:1 QUIT:$PIECE(YPARA,",",YI)=""  SET YANGPXL=YANGPXL_","_$PIECE(YPARA,",",YI)
	SET YANGPXL1=YANGPXL_",ARTT,ARTTT)"  ;PRUEFUNG AUF UNTERPOSITIONEN ;upon 
	SET YANGPXL2=YANGPXL_",ARTT)"  ;PRUEFUNG AUF UNTERPOSITIONEN ;upon 
	SET YANGPXL0=""  ;KEINE VORPOSITION ;no 
	IF $PIECE(YPARA,",",1)'="" SET YANGPXL0=YANGPXL_")"  ;PRUEFUNG VOR-POSITION
	SET YANGPXL=YANGPXL_",ARTT)"  ;LAUF GLOBAL ;trend 
	;
	SET MENGE=$PIECE($GET(^INANGP(YM,YANG,YPOS,1)),Y,5)  ;MENGE DER POS ;quantum the 
	SET MENGEP=$PIECE($GET(^INANGP(YM,YANG,YPOS,1)),Y,39)  ;GERECHNETE PRODUKTIONSMENGE ÜBERGEORDNETES TEIL  ;FIS;23.09.04 ;whack 
	IF $DATA(^INANGPT(YM,YANG,YPOS)) DO
	. IF $PIECE($GET(^INANGP(YM,YANG,YPOS,1)),Y,40)=2 SET MENGE=1,MENGEP=1
	. IF $PIECE($GET(^INANGP(YM,YANG,YPOS,1)),Y,40)=10 SET MENGE=1,MENGEP=1
	. IF $PIECE($GET(^INANGP(YM,YANG,YPOS,1)),Y,40)=11 SET MENGE=1,MENGEP=1
	. QUIT
	SET ARTIKEL=$PIECE($GET(^INANGP(YM,YANG,YPOS,1)),Y,4)  ;MENGE DER POS ;quantum the 
	SET AUFPARTIKEL=ARTIKEL  ;TYBD;28,12,2004
	IF YANGPXL0'="" DO  ;WENN UNTERTEIL DES UNTERTEILS ;when 
	. SET MENGE=$PIECE($GET(@YANGPXL0),Y,5)  ;GERECHNETE MENGE  ÜERGEORDNETES TEIL ;quantum whack 
	. SET MENGEP=$PIECE($GET(@YANGPXL0),Y,39)  ;GERECHNETE PRODUKTIONSMENGE ÜBERGEORDNETES TEIL  ;FIS;23.09.04 ;whack 
	. IF $PIECE($GET(@YANGPXL0),Y,40)=2 SET MENGE=1,MENGEP=1  ;FIS;25.05.04;25780  ;LEISTUNG IN LEISTUNG
	. IF $PIECE($GET(@YANGPXL0),Y,40)=10 SET MENGE=1,MENGEP=1  ;FIS;25.05.04;25780  ;LEISTUNG IN LEISTUNG
	. IF $PIECE($GET(@YANGPXL0),Y,40)=11 SET MENGE=1,MENGEP=1  ;FIS;25.05.04;25780  ;LEISTUNG IN LEISTUNG
	. SET ARTIKEL=$PIECE($GET(@YANGPXL0),Y,4)  ;ARTIKELNUMMER
	. QUIT
	;
	SET ARTT="" FOR  SET ARTT=$ORDER(@YANGPXL) QUIT:ARTT=""  DO   ;SUCHEN TEILE ;seek 
	. SET TEILE=$GET(@YANGPXL)  ;LESEN UNTERTEILDATENSATZ ;read
	. I TEILE'="" S TEILEXIST=1
	. NEW YTEILSUM
	. SET YTEILSUM=""
	. IF YLISTEN=1 DO
	. . DO  ;IF $PIECE(TEILE,Y,40)'=1 DO  ;AUSWERTEN DER MENGEN, WENN TEILE GLEICH
	. . . NEW YARTTX,Q,YARTTC,TEILE1
	. . . SET TEILE1=TEILE
	. . . SET YTEILSUM=1
	. . . SET Q=0
	. . . SET YARTTX=ARTT FOR  SET ARTT=$ORDER(@YANGPXL) QUIT:ARTT=""  DO  QUIT:Q=1
	. . . . SET YARTTC=$GET(@YANGPXL)  ;TEILE INFO
	. . . . IF $PIECE(YARTTC,Y,1,40)'=$PIECE(TEILE1,Y,1,40) SET Q=1 SET ARTT=YARTTX QUIT  ;NICHT GLEICH ;Not without delay 
	. . . . SET YARTTX=ARTT
	. . . . ;
	. . . . SET YTEILSUM=YTEILSUM+1
	. . . . ;SET $PIECE(TEILE,Y,5)=$PIECE(TEILE,Y,5)+$PIECE(YARTTC,Y,5)  ;MEHRERE STUECKE ALLES GLEICH  MENGE
	. . . . SET $PIECE(TEILE,Y,43)=$PIECE(TEILE,Y,43)+$PIECE(YARTTC,Y,43)  ;MEHRERE STUECKE ALLES GLEICH  GEWICHT ;divers whatsoever without delay wt. 
	. . . . SET $PIECE(TEILE,Y,45)=$PIECE(TEILE,Y,45)+$PIECE(YARTTC,Y,45)  ;MEHRERE STUECKE ALLES GLEICH  ZEIT ;divers whatsoever without delay time 
	. . . . SET $PIECE(TEILE,Y,70)=$PIECE(TEILE,Y,70)+$PIECE(YARTTC,Y,70)  ;MEHRERE STUECKE ALLES GLEICH  RUESTZEIT ;divers whatsoever without delay 
	. . . . SET $PIECE(TEILE,Y,47)=$PIECE(TEILE,Y,47)+$PIECE(YARTTC,Y,47)  ;MEHRERE STUECKE ALLES GLEICH  WERT ;divers whatsoever without delay worthy 
	. . . . QUIT
	. . . IF ARTT="" SET ARTT=$ORDER(@YANGPXL,-1)
	. . . QUIT
	. . QUIT
	. IF $DATA(@YANGPXL)'=11 DO  ;FIS;25.05.04;25780;RUESTZEIT NUR BEI LEISTUNG
	. . IF $PIECE(TEILE,Y,40)=2 QUIT
	. . IF $PIECE(TEILE,Y,40)=10 QUIT
	. . IF $PIECE(TEILE,Y,40)=11 QUIT
	. . SET $PIECE(TEILE,Y,70)=""
	. . QUIT
	. DO ANZEIGE
	. QUIT
	;
	IF $GET(YDDSATZ)<10 DO
	. NEW YBLANKLINE
	. SET YBLANKLINE=$GET(YDDSATZ)
	. FOR YBLANKLINE=YBLANKLINE:1:10 DO
	. . WRITE "<TR>"
	. . SET YDDSATZ=YDDSATZ+1
	. . FOR YI=1:1:17 DO
	. . . WRITE "<TD NOWRAP VALIGN=TOP"
	. . . IF YDDSATZ#2=1 WRITE " BGCOLOR="_YWHITE
	. . . WRITE ">"
	. . . WRITE "<FONT SIZE=2>"
	. . . WRITE "&nbsp;"
	. . . WRITE "</TD>"
	. . . WRITE YCR
	. . . QUIT
	. . QUIT
	. QUIT
	;
	DO GESAMT   ;SUMMENZEILE
	;
	DO ^WWWFRAME(1)
	IF ARTX=0 WRITE YCR,$$^WWWTEXT(32109),YCR   ;kein POSITIONSTEILE vorhanden ;not on hand 
	QUIT
	;
	;
	
GESAMT ;ENDEZEILE GESAMTWERTE
	;
	WRITE "<TR>"
	;
	FOR YI=1:1:10 DO
	. WRITE "<TH BGCOLOR="_YDARKGRAY_">"
	. IF YLISTEN'=1 WRITE "<FONT SIZE=2>"
	. IF YLISTEN=1 WRITE "<FONT SIZE=1>"
	. WRITE "&nbsp;"  ;POSITIONIERUNG
	. WRITE YCR,"</TH>"
	. QUIT
	;
	WRITE "<TH ALIGN=RIGHT BGCOLOR="_YDARKGRAY_">"
	IF YLISTEN'=1 WRITE "<FONT SIZE=2>"
	IF YLISTEN=1 WRITE "<FONT SIZE=1>"
	WRITE $$^WWWZAHL(GEWICHT,0,1)
	;
	WRITE "&nbsp;"
	WRITE YCR,"</TH>"
	;
	;
	WRITE "<TH ALIGN=RIGHT BGCOLOR="_YDARKGRAY_">"
	IF YLISTEN'=1 WRITE "<FONT SIZE=2>"
	IF YLISTEN=1 WRITE "<FONT SIZE=1>"
	WRITE $$^WWWTIME(DAUER)
	WRITE "&nbsp;"
	WRITE YCR,"</TH>"
	;
	SET RDAUER=RDAUER*$$^INPROLOS(ARTIKEL,MENGE)  ;JE LOSGRÖßE ;once 
	;
	;
	WRITE "<TH ALIGN=RIGHT BGCOLOR="_YDARKGRAY_">"
	IF YLISTEN'=1 WRITE "<FONT SIZE=2>"
	IF YLISTEN=1 WRITE "<FONT SIZE=1>"
	WRITE $$^WWWTIME(RDAUER)
	WRITE "&nbsp;"
	WRITE YCR,"</TH>"
	;
	;
	WRITE "<TH NOWRAP ALIGN=RIGHT BGCOLOR="_YDARKGRAY_">"
	IF YLISTEN'=1 WRITE "<FONT SIZE=2>"
	IF YLISTEN=1 WRITE "<FONT SIZE=1>"
	WRITE $$^WWWZAHL(WERT,0,2,YWHR)
	WRITE "&nbsp;"
	WRITE YCR,"</TH>"
	;
	FOR YI=1:1:3 DO
	. WRITE "<TH BGCOLOR="_YDARKGRAY_">"
	. IF YLISTEN'=1 WRITE "<FONT SIZE=2>"
	. IF YLISTEN=1 WRITE "<FONT SIZE=1>"
	. WRITE "&nbsp;"  ;längen
	. WRITE YCR,"</TH>"
	. QUIT
	;
	WRITE YCR,"</TR>"
	;
	SET ZUSATZ=""
	IF ARTIKEL'="" SET ZUSATZ=$PIECE($GET(^INART(YM,ARTIKEL,1)),Y,74)+$PIECE($GET(^INART(YM,ARTIKEL,1)),Y,75)
	IF YANGPXL0'="" DO  ;FIS;ZUSATZKOSTEN AUS AUFTRAG HOLEN;10.09.04;26268
	. SET ZUSATZ=$PIECE(@YANGPXL0,Y,74)+$PIECE(@YANGPXL0,Y,75)
	. QUIT
	IF YANGPXL0="" DO  ;FIS;ZUSATZKOSTEN AUS AUFTRAG HOLEN;10.09.04;26268
	. SET ZUSATZ=$PIECE($GET(^INANGP(YM,YANG,YPOS,1)),Y,74)+$PIECE($GET(^INANGP(YM,YANG,YPOS,1)),Y,75)
	. QUIT
	IF +ZUSATZ'=0 IF +$GET(MENGE)'=0 SET ZUSATZ=ZUSATZ*($$^INPROLOS($GET(ARTIKEL),$GET(MENGEP))/MENGE)  ;FIS;13.09.04;26268
	IF +ZUSATZ'=0 DO
	. WRITE "<TR>"
	. FOR YI=1:1:13 DO
	. . WRITE "<TH BGCOLOR="_YDARKGRAY_">"
	. . IF YLISTEN'=1 WRITE "<FONT SIZE=2>"
	. . IF YLISTEN=1 WRITE "<FONT SIZE=1>"
	. . WRITE "&nbsp;"  ;POSITIONIERUNG
	. . WRITE YCR,"</TH>"
	. . QUIT
	. WRITE "<TH NOWRAP ALIGN=RIGHT BGCOLOR="_YDARKGRAY_">"
	. IF YLISTEN'=1 WRITE "<FONT SIZE=2>"
	. IF YLISTEN=1 WRITE "<FONT SIZE=1>"
	. WRITE $$^WWWZAHL(ZUSATZ,0,2,YWHR)
	. WRITE "&nbsp;"
	. WRITE YCR,"</TH>"
	. FOR YI=1:1:3 DO
	. . WRITE "<TH BGCOLOR="_YDARKGRAY_">"
	. . IF YLISTEN'=1 WRITE "<FONT SIZE=2>"
	. . IF YLISTEN=1 WRITE "<FONT SIZE=1>"
	. . WRITE "&nbsp;"  ;längen
	. . WRITE YCR,"</TH>"
	. . QUIT
	. WRITE YCR,"</TR>"
	. QUIT
	;
	WRITE "<TR>"
	;
	FOR YI=1:1:12 DO
	. WRITE "<TH BGCOLOR="_YDARKGRAY_">"
	. IF YLISTEN'=1 WRITE "<FONT SIZE=2>"
	. IF YLISTEN=1 WRITE "<FONT SIZE=1>"
	. WRITE "&nbsp;"  ;POSITIONIERUNG
	. WRITE YCR,"</TH>"
	. QUIT
	;
	SET RWERT=0 
	DO
	. NEW WG,BETR,STDWERT
	. SET BETR=$GET(YLOCATION)
	. IF BETR="" SET BETR=$ORDER(^INKALK(YM,""))
	. IF BETR="" SET BETR=$ORDER(^WWW0121(0,YM,""))
	. IF BETR="" SET BETR=1
	. SET WG=$PIECE($GET(^INVORG(YM,YM,1)),Y,13)
	. IF WG="" SET WG=$ORDER(^INKALK(YM,BETR,""))
	. IF WG="" SET WG=0
	. SET STDWERT=$PIECE($GET(^INKALK(YM,BETR,WG,1)),Y,1)/60/60
	. SET RWERT=$JUSTIFY(RDAUER*STDWERT,0,2)
	. QUIT
	;
	;
	WRITE "<TH ALIGN=RIGHT BGCOLOR="_YDARKGRAY_">"
	IF YLISTEN'=1 WRITE "<FONT SIZE=2>"
	IF YLISTEN=1 WRITE "<FONT SIZE=1>"
	WRITE $$^WWWZAHL(RWERT,0,2)
	WRITE "&nbsp;"
	WRITE YCR,"</TH>"
	;
	;
	WRITE "<TH NOWRAP ALIGN=RIGHT BGCOLOR="_YDARKGRAY_">"
	IF YLISTEN'=1 WRITE "<FONT SIZE=2>"
	IF YLISTEN=1 WRITE "<FONT SIZE=1>"
	WRITE $$^WWWZAHL(WERT*MENGE+ZUSATZ+RWERT,0,2,YWHR)
	WRITE "&nbsp;"
	WRITE YCR,"</TH>"
	;
	FOR YI=1:1:3 DO
	. WRITE "<TH BGCOLOR="_YDARKGRAY_">"
	. IF YLISTEN'=1 WRITE "<FONT SIZE=2>"
	. IF YLISTEN=1 WRITE "<FONT SIZE=1>"
	. WRITE "&nbsp;"  ;längen
	. WRITE YCR,"</TH>"
	. QUIT
	IF YANGPXL0="" DO
	. QUIT:'$DATA(^INANGP(YM,YANG,YPOS,1))  ;TYBD;29,9,2004;FEHLER IN BILDAUFBEREITUNG
	. ;SET $PIECE(^INANGP(YM,YANG,YPOS,1),Y,43)=GEWICHT*MENGE
	. IF $PIECE(^INANGP(YM,YANG,YPOS,1),Y,4)'="" IF $PIECE($GET(^INART(YM,$PIECE($GET(^INANGP(YM,YANG,YPOS,1)),Y,4),1)),Y,255)'=1 SET $PIECE(^INANGP(YM,YANG,YPOS,1),Y,43)=$GET(GEWICHT)*$GET(MENGE)  ;FIS;21.09.04;26400;GEWICHT NICHT RECHNEN
	. ;IF +DAUER'=0 SET $PIECE(^INANGP(YM,YANG,YPOS,1),Y,45)=$J(DAUER*MENGE,0,0)
	. ;SET $PIECE(^INANGP(YM,YANG,YPOS,1),Y,45)=$J(DAUER*MENGE,0,0)  ;TYBD;3,6,2004;IMMER AUCH WENN 0 DAUER GESAMT;25778;
	. IF $GET(TEILEXIST)=1 SET $PIECE(^INANGP(YM,YANG,YPOS,1),Y,45)=$JUSTIFY(DAUER*MENGE,0,0)  ;FIS;15,2,2005;27318;NUR RECHNEN, WENN UNTERTEILE VORHANDEN
	. SET $PIECE(^INANGP(YM,YANG,YPOS,1),Y,70)=RDAUER*$$^INPROLOS(ARTIKEL,MENGE)
	. SET $PIECE(^INANGP(YM,YANG,YPOS,1),Y,71)=RWERT
	. DO NEU
	. SET $PIECE(^INANGP(YM,YANG,YPOS,1),Y,47)=$$^INANGKOST(YANG,YPOS)
	. SET YOK=$$^INANGPNETTO(YANG,YPOS)
	. QUIT
	IF YANGPXL0'="" DO
	. SET $PIECE(@YANGPXL0,Y,43)=GEWICHT*MENGE
	. ;IF +DAUER'=0 SET $PIECE(@YANGPXL0,Y,45)=$J(DAUER*MENGE,0,0)
	. ;SET $PIECE(@YANGPXL0,Y,45)=$JUSTIFY(DAUER*MENGE,0,0)   ;TYBD;3,6,2004;IMMER AUCH WENN 0 DAUER GESAMT;25778;
	. IF $GET(TEILEXIST)=1 SET $PIECE(@YANGPXL0,Y,45)=$JUSTIFY(DAUER*MENGE,0,0)   ;FIS;15,2,2005;27318;NUR RECHNEN, WENN UNTERTEILE VORHANDEN
	. SET $PIECE(@YANGPXL0,Y,70)=RDAUER*$$^INPROLOS(ARTIKEL,MENGE)
	. SET $PIECE(@YANGPXL0,Y,71)=RWERT
	. ;SET ZUSATZ=ZUSATZ*$$^INPROLOS(ARTIKEL,MENGE)  ;FIS;13.09.04;26268
	. IF +$GET(MENGEP)'=0 SET ZUSATZ=(ZUSATZ/MENGEP)  ;FIS;23.09.04;26268
	. DO
	. . NEW ARTT
	. . SET ARTT=""
	. . SET ARTT=$ORDER(@YANGPXL2)
	. . IF ARTT'="" SET $PIECE(@YANGPXL0,Y,47)=WERT*MENGE  ;+ZUSATZ  ;TEILE VORHANDEN ;on hand 
	. . QUIT
	. ;SET $PIECE(@YANGPXL0,Y,47)=WERT*MENGE+ZUSATZ
	. DO NEU
	. SET $PIECE(^INANGP(YM,YANG,YPOS,1),Y,47)=$$^INANGKOST(YANG,YPOS)
	. QUIT
	;
	IF $G(ZUSATZ(1))=1 DO
	. WRITE "<TR>"
	. WRITE "<TD COLSPAN=17>"
	. WRITE YCR,"<font size=2 color="_YRED_">"
	. WRITE YCR,"&nbsp;*&nbsp;"_$$^WWWTEXT(34091)  ;artikel enthält Zusatzkosten
	. WRITE "<BR>&nbsp;&nbsp;&nbsp;"_$$^WWWTEXT(34092)  ;Zusatzkosten WERDEN ERST DURCH DIE KALKULATION NEU BERECHNET
	. WRITE YCR,"</font>"
	. WRITE YCR,"</td></tr>"
	. QUIT
	QUIT
	;
	;
	
ANZEIGE ;DER ARTIKELTEILE ;the 
	;
	SET ARTX=1  ;TEIL VORHANDEN = SUMME ANZEIGEN ;whack on hand sum display 
	SET YDDSATZ=YDDSATZ+1  ;ANZEIGE WEISS ;Show 
	WRITE YCR
	WRITE "<TR>"
	;
	;
	;
	;LÖSCHEN ;Delete 
	WRITE "<TD NOWRAP VALIGN=MIDDLE"
	;
	;I YDDSATZ#2=1 W " BGCOLOR="_YWHITE
	IF $PIECE(TEILE,Y,20)'="" DO   ;FARBKENNUNG UND TEXT ;And Text 
	. NEW YCOL
	. SET YCOL=$PIECE($GET(^INARTPARA(YM,SPRACHE,$PIECE(TEILE,Y,20),1)),Y,2)
	. SET YALT=$PIECE($GET(^INARTPARA(YM,SPRACHE,$PIECE(TEILE,Y,20),1)),Y,1)
	. IF YCOL'="" WRITE " BGCOLOR="_$PIECE($GET(^WWW100(0,"FARBE",SPRACHE,YCOL,1)),Y,1)
	. QUIT
	WRITE " WIDTH=24>"
	WRITE "<A onClick='return doLink(this)' HREF=""JavaScript:if (confirm(' ("_YANG_","_YPOS_","_YPARA_","_ARTT_") "_$PIECE(TEILE,Y,1)_"  "_$$^WWWTEXT(321)_"')) window.location='"
	WRITE YAKTION_"EP=WWWMANU&YEXEC=*D|PROC^INANGPTT"
	WRITE "&YPARA1="_YANG_","_YPOS_","_YPARA_","_ARTT
	WRITE "&YFUNCT1=KILL"
	DO ^WWWCGI
	WRITE "';"">"
	WRITE YCR,"<IMG SRC="""_YGIF_"del.gif"" TITLE="""_$$^WWWTEXT(41)_""" width=18 height=18 border=0 VSPACE=0>"
	WRITE "</A>"
	WRITE "</TD>"
	WRITE YCR
	;
	;
	;TEILE DER TEILE ;the 
	SET KEINEUNTERTEILE=1
	SET ARTTT="" 
	SET ARTTT=$ORDER(@YANGPXL1)
	IF ARTTT'="" SET KEINEUNTERTEILE=0  ;TEIL IM TEIL VORHANDEN ;whack whack on hand 
	IF $GET(AUFPARTIKEL)'="" IF $GET(AUFPARTIKEL)=$PIECE($GET(TEILE),Y,4) SET KEINEUNTERTEILE=2  ;TYBD;28,12,2004
	DO  ;TEILE der teile  ;who 
	. WRITE YCR
	. SET YBACK1=YBACK
	. NEW YPARA,YBACK,YKEY
	. ;
	. SET YPARA=YPARAX
	. IF YPARA'="" SET YPARA=YPARA_","
	. SET YPARA=YPARA_ARTT   ;NEUES UNTERTEIL ;something new 
	. ;
	. SET YKEY=YANG_","_YPOS
	. WRITE "<TD NOWRAP VALIGN=MIDDLE"
	. ;I YDDSATZ#2=1 W " BGCOLOR="_YWHITE
	. IF $PIECE(TEILE,Y,20)'="" DO   ;FARBKENNUNG UND TEXT ;And Text 
	. . NEW YCOL
	. . SET YCOL=$PIECE($GET(^INARTPARA(YM,SPRACHE,$PIECE(TEILE,Y,20),1)),Y,2)
	. . SET YALT=$PIECE($GET(^INARTPARA(YM,SPRACHE,$PIECE(TEILE,Y,20),1)),Y,1)
	. . IF YCOL'="" WRITE " BGCOLOR="_$PIECE($GET(^WWW100(0,"FARBE",SPRACHE,YCOL,1)),Y,1)
	. . QUIT
	. WRITE " WIDTH=24>"
	. IF YLISTEN'=1 WRITE "<FONT SIZE=2>"
	. IF YLISTEN=1 WRITE "<FONT SIZE=1>"
	. IF KEINEUNTERTEILE'=2 WRITE "<A HREF="""_YAKTION_"EP=WWWFORM&YFORM=INANGPTT1"
	. IF KEINEUNTERTEILE'=2 SET YBACK=""   ;YBACK1
	. IF KEINEUNTERTEILE'=2 DO ^WWWCGI
	. IF KEINEUNTERTEILE'=2 WRITE """>"
	. IF KEINEUNTERTEILE=2 WRITE YCR,"<IMG SRC="""_YGIF_"blank.gif"" TITLE="""_$$^WWWTEXT(32107)_""" width=18 height=18 border=0 VSPACE=0>"
	. IF KEINEUNTERTEILE=1 WRITE YCR,"<IMG SRC="""_YGIF_"blank.gif"" TITLE="""_$$^WWWTEXT(32107)_""" width=18 height=18 border=0 VSPACE=0>"
	. IF KEINEUNTERTEILE=0 WRITE YCR,"<IMG SRC="""_YGIF_"teile.gif"" TITLE="""_$$^WWWTEXT(32107)_""" width=18 height=18 border=0 VSPACE=0>"
	. WRITE "</A>"
	. QUIT
	WRITE "</TD>"
	WRITE YCR
	;
	;
	;
	;AUF UND UP ;upon And 
	WRITE YCR
	WRITE "<TD NOWRAP VALIGN=MIDDLE"
	;
	;I YDDSATZ#2=1 W " BGCOLOR="_YWHITE
	WRITE " WIDTH=20>"
	IF YLISTEN'=1 WRITE "<FONT SIZE=2>"
	IF YLISTEN=1 WRITE "<FONT SIZE=1>"
	;
	;EINE POSITION HOCHRÜCKEN ;one 
	WRITE "<A HREF="""_YAKTION_"EP=WWWMANU&YEXEC=*D|PROC^INANGPTT"
	DO
	. SET YBACK1=YBACK
	. NEW YBACK
	. WRITE "&YPARA1="_YANG_","_YPOS_","_YPARA_","_ARTT
	. WRITE "&YFUNCT1=UP"
	. SET YBACK=YBACK1
	. DO ^WWWCGI
	. QUIT
	WRITE """>"
	WRITE "<IMG SRC="""_YGIF_"scrup.gif"" TITLE="""_$$^WWWTEXT(32015)_""" border=0 VSPACE=0>"
	WRITE "</A>"
	;
	;EINE POSITION HERUNTER ;one 
	WRITE "<A HREF="""_YAKTION_"EP=WWWMANU&YEXEC=*D|PROC^INANGPTT"
	;
	DO
	. SET YBACK1=YBACK
	. NEW YBACK
	. WRITE "&YPARA1="_YANG_","_YPOS_","_YPARA_","_ARTT
	. WRITE "&YFUNCT1=DOWN"
	. SET YBACK=YBACK1
	. DO ^WWWCGI
	. QUIT
	WRITE """>"
	WRITE "<IMG SRC="""_YGIF_"scrdown.gif"" TITLE="""_$$^WWWTEXT(32016)_""" border=0 VSPACE=0>"
	WRITE "</A>"
	WRITE "</TD>"
	WRITE YCR
	;
	;
	DO  ;TEILENUMMER
	. ;
	. SET YBACK1=YBACK
	. NEW YBACK,YKEY
	. ;
	. SET YKEY=YANG_","_YPOS_","
	. IF YPARA'="" SET YKEY=YKEY_$TRANSLATE(YPARA,",",".")_"."
	. SET YKEY=YKEY_ARTT_"."  ;TEILESTRUKTUR
	. ;
	. WRITE "<TD NOWRAP VALIGN=MIDDLE"
	. IF YDDSATZ#2=1 WRITE " BGCOLOR="_YWHITE
	. WRITE " ALIGN=RIGHT>"
	. IF YLISTEN'=1 WRITE "<FONT SIZE=2>"
	. IF YLISTEN=1 WRITE "<FONT SIZE=1>"
	. WRITE "<A TITLE="""_$$^WWWTEXT(32061)_""" HREF="""_YAKTION_"EP=WWWFORM&YFORM=INANGPT"
	. SET YBACK=YBACK1_"INANGPTT1,"
	. DO ^WWWCGI
	. WRITE """>"
	. WRITE ARTT
	. WRITE "&nbsp;"
	. WRITE "</A>"
	. WRITE "</TD>"
	. QUIT
	;
	;
	;
	;AUF UND UP  ZEICHNUNGSPOSITIONEN ;upon And 
	WRITE YCR
	WRITE "<TD NOWRAP VALIGN=MIDDLE"
	;
	;I YDDSATZ#2=1 W " BGCOLOR="_YWHITE
	WRITE " WIDTH=20>"
	IF YLISTEN'=1 WRITE "<FONT SIZE=2>"
	IF YLISTEN=1 WRITE "<FONT SIZE=1>"
	;
	;EINE POSITION + IN DER ZEICHNUNG ;one within the drawing 
	WRITE "<A HREF="""_YAKTION_"EP=WWWMANU&YEXEC=*D|PROCZ^INANGPTT"
	DO
	. SET YBACK1=YBACK
	. NEW YBACK
	. WRITE "&YPARA1="_YANG_","_YPOS_","_YPARA_","_ARTT
	. WRITE "&YFUNCT1=UP"
	. SET YBACK=YBACK1
	. DO ^WWWCGI
	. QUIT
	WRITE """>"
	WRITE "<IMG SRC="""_YGIF_"scrup.gif"" TITLE="""_$$^WWWTEXT(32015)_""" border=0 VSPACE=0>"
	WRITE "</A>"
	;
	;EINE POSITION - IN DER ZEICHNUNG ;one within the drawing 
	WRITE "<A HREF="""_YAKTION_"EP=WWWMANU&YEXEC=*D|PROCZ^INANGPTT"
	DO
	. SET YBACK1=YBACK
	. NEW YBACK
	. WRITE "&YPARA1="_YANG_","_YPOS_","_YPARA_","_ARTT
	. WRITE "&YFUNCT1=DOWN"
	. SET YBACK=YBACK1
	. DO ^WWWCGI
	. QUIT
	WRITE """>"
	WRITE "<IMG SRC="""_YGIF_"scrdown.gif"" TITLE="""_$$^WWWTEXT(32016)_""" border=0 VSPACE=0>"
	WRITE "</A>"
	WRITE "</TD>"
	WRITE YCR
	;
	;
	FOR YI=18,4,1,5,40,43,45,70,47,15,16,17 DO  ;AUSGABE DER DATENTABELLE ;expenses the 
	. WRITE YCR
	. SET YBACK1=YBACK
	. NEW YBACK,YKEY
	. SET YKEY=YANG_","_YPOS_","_ARTT
	. WRITE "<TD"
	. I YLISTEN'=1 WRITE " NOWRAP"
	. W " VALIGN=MIDDLE"
	. IF YDDSATZ#2=1 WRITE " BGCOLOR="_YWHITE
	. IF YI=4!(YI=5)!(YI=45)!(YI=47)!(YI=43)!(YI=18) WRITE " ALIGN=RIGHT"
	. WRITE ">"
	. IF YLISTEN'=1 WRITE "<FONT SIZE=2>"
	. IF YLISTEN=1 WRITE "<FONT SIZE=1>"
	. ;
	. DO   ;IN ANGEBOTSARTIKEL SPRINGEN UND ARTIKEL ÄNDERN ;within leap And item alter 
	. . NEW YKEY
	. . SET YKEY=YANG_","_YPOS_","
	. . IF YPARA'="" SET YKEY=YKEY_$TRANSLATE(YPARA,",",".")_"."
	. . SET YKEY=YKEY_ARTT_"."  ;TEILESTRUKTUR
	. . WRITE "<A"
	. . WRITE " TITLE="""
	. . IF +VERSCHNITT=0!(YI'=8) WRITE $$^WWWTEXT(32060)   ;ARTIKEL BEARBEITEN ;item 
	. . IF +VERSCHNITT'=0&(YI=8) WRITE $$^WWWTEXT(32120)_" "_VERSCHNITT_"%"
	. . IF YI=1!(YI=4) DO
	. . . NEW YARTART
	. . . QUIT:$PIECE(TEILE,Y,4)=""
	. . . SET YARTART=$PIECE(TEILE,Y,26)   ;ARTIKELART
	. . . IF YARTART'="" WRITE $CHAR(13)_$PIECE($GET(^WWW101(0,"ARTIKEL-ART",SPRACHE,YARTART,1)),Y,1)
	. . . QUIT
	. . WRITE """"
	. . WRITE " HREF="""_YAKTION_"EP=WWWFORM&YFORM=INANGPT"
	. . SET YBACK=YBACK1_"INANGPTT1,"  ; ZURÜCK ;retro- 
	. . DO ^WWWCGI
	. . QUIT
	. WRITE """>"
	. SET YTYPE=6  ;TEXTFORMAT
	. IF YI=43 SET YTYPE=12   ;GEWICHT ;wt. 
	. IF YI=5 SET YTYPE=12   ;MENGE ;quantum 
	. IF YI=15 SET YTYPE=12   ;LÄNGE ;longitude 
	. IF YI=16 SET YTYPE=12   ;BREITE ;width 
	. IF YI=17 SET YTYPE=12   ;HÖHE ;highness 
	. IF YI=45 SET YTYPE=7  ;UHRZEITFORMAT
	. IF YI=70 SET YTYPE=7  ;UHRZEITFORMAT
	. IF YI=47 SET YTYPE=8   ;BETRAGSFORMAT
	. IF YI=40 IF $PIECE(TEILE,Y,YI)'="" SET $PIECE(TEILE,Y,YI)=$PIECE($GET(^WWW101(0,"EINHEIT",SPRACHE,$PIECE(TEILE,Y,YI),1)),Y,1)  ;EINHEIT ZUORDNEN FÜR DEN AUSDRUCK ;unity refer to term 
	. IF YI=5 IF $GET(YTEILSUM)>1 WRITE YTEILSUM_"X"   ;ANZAHL DER SUMMEN ;Number the purr 
	. IF YI=47 IF +$PIECE(TEILE,Y,74)'=0!(+$PIECE(TEILE,Y,75)'=0) DO  ;ARTIKEL MIT ZUSATZKOSTEN KENNZEICHEN;FIS;21.12.2004;26268
	. . WRITE "<font color="_YRED_">*</font>"
	. . SET ZUSATZ(1)=1  ;MERKEN FÜR FUSSTEXT
	. . QUIT
	. WRITE $$^WWWTR(0,YTYPE,$PIECE(TEILE,Y,YI))  ;MIT UMFORMUNG ;by means of transformation 
	. ;
	. IF YI=43 IF $GET(ARTIKEL)'=$PIECE(TEILE,Y,4) SET GEWICHT=GEWICHT+$PIECE(TEILE,Y,YI)  ;ADDIEREN ;sum up 
	. IF YI=45 IF $GET(ARTIKEL)'=$PIECE(TEILE,Y,4) SET DAUER=DAUER+$PIECE(TEILE,Y,YI)  ;ADDIEREN ;sum up 
	. IF YI=70 IF $GET(ARTIKEL)'=$PIECE(TEILE,Y,4) SET RDAUER=RDAUER+$PIECE(TEILE,Y,YI)  ;ADDIEREN ;sum up 
	. IF YI=47 IF $GET(ARTIKEL)'=$PIECE(TEILE,Y,4) SET WERT=WERT+$PIECE(TEILE,Y,YI)  ;ADDIEREN + KOSTEN ;sum up taste 
	. ;
	. WRITE "&nbsp;"
	. WRITE "</A>"
	. WRITE "</TD>"
	. QUIT
	;
	WRITE YCR
	WRITE "</TR>"
	WRITE YCR
	QUIT
	;
	;
	
KOPF ;kopf der anzeigetabelle ;who 
	;
	W "<THEAD>"
	IF YLISTEN=1 DO
	. WRITE "<TR>"
	. NEW YI
	. FOR YI=1:1:17 DO
	. . WRITE YCR
	. . WRITE "<TH VALIGN=TOP NOWRAP ALIGN=LEFT"
	. . WRITE " BGCOLOR="_YDARKGRAY
	. . WRITE ">"
	. . WRITE "<FONT SIZE=1>"
	. . IF YI=8 DO 
	. . . QUIT:YANG=""
	. . . Q:YPOS=""
	. . . WRITE $$^WWWTEXT(32178)_": "_YANG_"-"_YPOS  ;AUFTRAGSNUMMER (32178ANGEBOT)
	. . . W "  ",$P($G(^INANGP(YM,YANG,YPOS,1)),Y,4)_" "
	. . . W " (",$P($G(^INANGP(YM,YANG,YPOS,1)),Y,1)_") "
	. . WRITE "&nbsp;"
	. . WRITE "</TH>"
	. . QUIT
	. WRITE YCR
	. WRITE "</TR>"
	. WRITE YCR
	. QUIT
	;
	WRITE "<TR>"
	;
	WRITE "<TH BGCOLOR="_YDARKGRAY_" >"
	IF YLISTEN'=1 WRITE "<FONT SIZE=2>"
	IF YLISTEN=1 WRITE "<FONT SIZE=1>"
	WRITE "&nbsp;"   ;LÖSCHEN
	WRITE YCR,"</TH>"
	;
	WRITE "<TH BGCOLOR="_YDARKGRAY_" WIDTH=24>"
	IF YLISTEN'=1 WRITE "<FONT SIZE=2>"
	IF YLISTEN=1 WRITE "<FONT SIZE=1>"
	WRITE "&nbsp;"    ;TEILE DER TEILE VORHANDEN
	WRITE YCR,"</TH>"
	;
	WRITE "<TH BGCOLOR="_YDARKGRAY_" WIDTH=20>"
	IF YLISTEN'=1 WRITE "<FONT SIZE=2>"
	IF YLISTEN=1 WRITE "<FONT SIZE=1>"
	WRITE "<A TITLE="""_$$^WWWTEXT(32151)_""""  ;FERTIGUNGSPOSITION
	W " HREF=#>"
	WRITE "&nbsp;P&nbsp;"  ;POSITIONIERUNG
	W "</A>"
	WRITE YCR,"</TH>"
	;
	WRITE "<TH NOWRAP ALIGN=RIGHT BGCOLOR="_YDARKGRAY_">"
	IF YLISTEN'=1 WRITE "<FONT SIZE=2>"
	IF YLISTEN=1 WRITE "<FONT SIZE=1>"
	WRITE "<A TITLE="""_$$^WWWTEXT(32151)_""""  ;FERTIGUNGSPOSITION
	WRITE " HREF=#>"
	SET TEXT=$PIECE($GET(^WWW0021(0,"INANGP",2,SPRACHE,1)),Y,1)  ;SPRACHENTEXT
	IF TEXT="" SET TEXT=$PIECE($GET(^WWW002(0,"INANGP",2,1)),Y,2)  ;POSITION
	WRITE "P-"_TEXT
	WRITE "</A>"
	WRITE YCR,"</TH>"
	;
	WRITE "<TH BGCOLOR="_YDARKGRAY_" WIDTH=20>"
	IF YLISTEN'=1 WRITE "<FONT SIZE=2>"
	IF YLISTEN=1 WRITE "<FONT SIZE=1>"
	WRITE "<A TITLE="""_$$^WWWTEXT(32152)_""""  ;ZEICHNUNGSPOSITION
	WRITE " HREF=#>"
	WRITE "&nbsp;Z&nbsp;"  ;ZEICHNUNGS POSITIONIERUNG
	WRITE "</A>"
	WRITE YCR,"</TH>"
	;
	;
	FOR YI=18,4,1,5,40,43,45,70,47,15,16,17 DO  ;AUSGABE DER DATENTABELLE ;expenses the 
	. WRITE "<TH ALIGN=LEFT NOWRAP BGCOLOR="_YDARKGRAY_">"
	. IF YLISTEN'=1 WRITE "<FONT SIZE=2>"
	. IF YLISTEN=1 WRITE "<FONT SIZE=1>"
	. IF YI=18 WRITE "<A TITLE="""_$$^WWWTEXT(32152)_"""" WRITE " HREF=#>" ;ZEICHNUNGSPOSITION
	. SET TEXT=$PIECE($GET(^WWW0031(0,"INANGP",YI,SPRACHE,1)),Y,1)  ;SPRACHENTEXT
	. IF TEXT="" SET TEXT=$PIECE($GET(^WWW003(0,"INANGP",YI,1)),Y,2)  ;DATENFELD ;data item 
	. WRITE TEXT
	. IF YI=18 WRITE "</A>"
	. WRITE YCR,"</TH>"
	. QUIT
	WRITE YCR,"</TR>"
	;
	QUIT
	;
	
PROC ;BEARBEITUNG DER FUNKTIONEN BEI BUTTON AUF AB UND LÖSCHEN ;adaptation the next to upon Confirm. And Delete 
	;
	;
	KILL ^WWWSOR(YUSER,"NEU")
	NEW YI,DATEI,ARTT,ARTT1,DATEI1,DATEI2,DATEI3,YYMAX
	SET YFUNCT1=$GET(%(YQUERY,"YFUNCT1"))  ;FUNKTION (UP DOWN KILL)
	SET YPARA1=$GET(%(YQUERY,"YPARA1"))   ;ARTIKEL UND TEILENUMMER ;item And 
	SET YANG=$PIECE(YPARA1,",",1)
	SET YPOS=$PIECE(YPARA1,",",2)
	SET ARTT=$TRANSLATE($PIECE(YPARA1,",",3,99),".""",",")  ;TEILE AUS INANGPXL ;out of 
	FOR  QUIT:$EXTRACT(ARTT)'=","  SET ARTT=$EXTRACT(ARTT,2,99)  ;KOMMA HERAUSFILTERN ;comma 
	;
	IF YFUNCT1="KILL" DO   ;LÖSCHEN DATENSATZ ;Delete data record 
	. QUIT:YANG=""  QUIT:YPOS=""  QUIT:ARTT=""
	. SET DATEI="^INANGPXL("""_YM_""","""_YANG_""","_YPOS
	. FOR YI=1:1 QUIT:$PIECE(ARTT,",",YI)=""  SET DATEI=DATEI_","_$PIECE(ARTT,",",YI)
	. SET DATEI=DATEI_")"
	. SET YSTEMPEL=$PIECE($GET(@(DATEI)),Y,165)
	. IF YSTEMPEL'="" DO
	. . KILL ^INPROSTEMP(YM,YSTEMPEL)  
	. . KILL ^INPROSTEMP0(YM,YSTEMPEL)  
	. . KILL ^INPROSTEMP1(YM,YSTEMPEL)  
	. . KILL ^INPROSTEMPT(YM,YSTEMPEL)
	. . QUIT  
	. KILL @DATEI  ;LÖSCHEN DATEN TEILESTUKTUR ;Delete 
	. DO NEU  ;NEUANGBAU
	. QUIT
	;
	;
	IF YFUNCT1="UP" DO   ;EINE POSITION HERANG ;one 
	. N YZWS
	. SET YYMAX=1
	. QUIT:YANG=""  QUIT:YPOS=""  QUIT:ARTT=""
	. ;DATEI ORIGINAL ;data file 
	. SET DATEI="^INANGPXL("""_YM_""","""_YANG_""","_YPOS
	. FOR YI=1:1 QUIT:$PIECE(ARTT,",",YI)=""  SET DATEI=DATEI_","_$PIECE(ARTT,",",YI) SET YYMAX=YI
	. SET DATEI=DATEI_")"
	. ;
	. IF $PIECE(ARTT,",",YYMAX)<2 Q  ;ZU HOCH ;within towering 
	. ;
	. ;DATEI ZWISCHENSICHERN ;data file 
	. SET DATEI1="^WWWSOR("""_YUSER_""",""HELP"","""_YM_""","""_YANG_""","_YPOS
	. FOR YI=1:1 QUIT:$PIECE(ARTT,",",YI)=""  DO
	. . IF YI'=YYMAX SET DATEI1=DATEI1_","_$PIECE(ARTT,",",YI)
	. . IF YI=YYMAX SET DATEI1=DATEI1_","_($PIECE(ARTT,",",YI)-1)  ;LETZTE -1 ;last 
	. . QUIT
	. SET DATEI1=DATEI1_")"
	. SET YSTEMPEL=$PIECE($G(@DATEI),Y,165)
	. ;SET $PIECE(@DATEI,Y,165)=""
	. ;IF YSTEMPEL'="" DO
	. . KILL ^INPROSTEMP(YM,YSTEMPEL)  
	. . KILL ^INPROSTEMP0(YM,YSTEMPEL)  
	. . KILL ^INPROSTEMP1(YM,YSTEMPEL)  
	. . KILL ^INPROSTEMPT(YM,YSTEMPEL)
	. . QUIT  
	. MERGE @DATEI1=@DATEI
	. ;
	. KILL @DATEI  ;LÖSCHEN DATEN ALTE TEILESTUKTUR ;Delete 
	. ;DATEI ORIGINAL 2 ;data file 
	. SET DATEI2="^INANGPXL("""_YM_""","""_YANG_""","_YPOS
	. FOR YI=1:1 QUIT:$PIECE(ARTT,",",YI)=""  DO
	. . IF YI'=YYMAX SET DATEI2=DATEI2_","_$PIECE(ARTT,",",YI)
	. . IF YI=YYMAX SET DATEI2=DATEI2_","_($PIECE(ARTT,",",YI)-1)  ;LETZTE -1 ;last 
	. . QUIT
	. SET DATEI2=DATEI2_")"
	. ;DATEI ZWISCHENSICHERN ;data file 
	. SET DATEI3="^INANGPXL("""_YM_""","""_YANG_""","_YPOS
	. FOR YI=1:1 QUIT:$PIECE(ARTT,",",YI)=""  DO
	. . SET DATEI3=DATEI3_","_$PIECE(ARTT,",",YI)
	. . QUIT
	. SET DATEI3=DATEI3_")"
	. SET YSTEMPEL=$PIECE($G(@DATEI2),Y,165)
	. ;SET $PIECE(@DATEI2,Y,165)=""
	. ;IF YSTEMPEL'="" DO
	. . KILL ^INPROSTEMP(YM,YSTEMPEL)  
	. . KILL ^INPROSTEMP0(YM,YSTEMPEL)  
	. . KILL ^INPROSTEMP1(YM,YSTEMPEL)  
	. . KILL ^INPROSTEMPT(YM,YSTEMPEL)
	. . QUIT  
	. I $TR($G(@DATEI2),Y_3)'="" MERGE @DATEI3=@DATEI2   ;EINEN HERUNTER
	. KILL @DATEI2  ;LÖSCHEN DATEN ALTE TEILESTUKTUR ;Delete 
	. I $TR($G(@DATEI1),Y_3)'="" MERGE @DATEI2=@DATEI1
	. K @DATEI1
	. DO NEU  ;NEUANGBAU
	. QUIT
	;
	;
	IF YFUNCT1="DOWN" DO   ;EINE POSITION HERUNTER ;one 
	. SET YYMAX=1
	. QUIT:YANG=""  QUIT:YPOS=""  QUIT:ARTT=""
	. ;DATEI ORIGINAL ;data file 
	. SET DATEI="^INANGPXL("""_YM_""","""_YANG_""","_YPOS
	. FOR YI=1:1 QUIT:$PIECE(ARTT,",",YI)=""  SET DATEI=DATEI_","_$PIECE(ARTT,",",YI) S YYMAX=YI
	. SET DATEI=DATEI_")"
	. ;DATEI ZWISCHENSICHERN ;data file 
	. SET DATEI1="^WWWSOR("""_YUSER_""",""HELP"","""_YM_""","""_YANG_""","_YPOS
	. FOR YI=1:1 QUIT:$PIECE(ARTT,",",YI)=""  DO
	. . IF YI'=YYMAX SET DATEI1=DATEI1_","_$PIECE(ARTT,",",YI)
	. . IF YI=YYMAX SET DATEI1=DATEI1_","_($PIECE(ARTT,",",YI)+1)  ;LETZTE +1 ;last 
	. . QUIT
	. SET DATEI1=DATEI1_")"
	. SET YSTEMPEL=$PIECE($G(@DATEI),Y,165)
	. ;SET $PIECE(@DATEI,Y,165)=""
	. ;IF YSTEMPEL'="" DO
	. . KILL ^INPROSTEMP(YM,YSTEMPEL)  
	. . KILL ^INPROSTEMP0(YM,YSTEMPEL)  
	. . KILL ^INPROSTEMP1(YM,YSTEMPEL)  
	. . KILL ^INPROSTEMPT(YM,YSTEMPEL)
	. . QUIT  
	. M @DATEI1=@DATEI
	. KILL @(DATEI)  ;LÖSCHEN DATEN ALTE TEILESTUKTUR ;Delete 
	. ;DATEI ORIGINAL 2 ;data file 
	. SET DATEI2="^INANGPXL("""_YM_""","""_YANG_""","_YPOS
	. FOR YI=1:1 QUIT:$PIECE(ARTT,",",YI)=""  DO
	. . IF YI'=YYMAX SET DATEI2=DATEI2_","_$PIECE(ARTT,",",YI)
	. . IF YI=YYMAX SET DATEI2=DATEI2_","_($PIECE(ARTT,",",YI)+1)  ;LETZTE +1 ;last 
	. . QUIT
	. SET DATEI2=DATEI2_")"
	. ;DATEI ZWISCHENSICHERN ;data file 
	. SET DATEI3="^INANGPXL("""_YM_""","""_YANG_""","_YPOS
	. FOR YI=1:1 QUIT:$PIECE(ARTT,",",YI)=""  DO
	. . SET DATEI3=DATEI3_","_$PIECE(ARTT,",",YI)
	. . QUIT
	. SET DATEI3=DATEI3_")"
	. SET YSTEMPEL=$PIECE($G(@DATEI2),Y,165)
	. ;SET $PIECE(@DATEI2,Y,165)=""
	. ;IF YSTEMPEL'="" DO
	. . KILL ^INPROSTEMP(YM,YSTEMPEL)  
	. . KILL ^INPROSTEMP0(YM,YSTEMPEL)  
	. . KILL ^INPROSTEMP1(YM,YSTEMPEL)  
	. . KILL ^INPROSTEMPT(YM,YSTEMPEL)
	. . QUIT  
	. I $TR($G(@(DATEI2)),Y_3)'="" MERGE @DATEI3=@DATEI2   ;EINEN HERUNTER
	. KILL @DATEI2  ;LÖSCHEN DATEN ALTE TEILESTUKTUR ;Delete 
	. I $TR($G(@(DATEI1)),Y_3)'="" MERGE @DATEI2=@DATEI1
	. K @DATEI1
	. DO NEU  ;NEUANGBAU
	. QUIT
	;
	IF YANG'="" IF YPOS'="" DO NEU   ;NEUANGBAU
	;
	;
	QUIT:$GET(YSONDERFUNKTION)=1  ;SONDERFUNKTIONSAUFRUF AUS INANGPTT2 ;out of 
	;
	SET YFORM="INANGPTT1"
	SET %(YQUERY,"YFORM")=YFORM
	SET %("VAR","YFORM")=YFORM
	DO ^WWWFORM
	QUIT
	;
	;
	
PROCZ ;BEARBEITUNG DER FUNKTIONEN BEI BUTTON ANG AB UND LÖSCHEN  FÜR ZEICHNUNGSPOSITIONEN ;adaptation the next to Confirm. And Delete to 
	;
	;
	NEW YI,DATEI
	SET YFUNCT1=$GET(%(YQUERY,"YFUNCT1"))  ;FUNKTION (UP DOWN KILL)
	SET YPARA1=$GET(%(YQUERY,"YPARA1"))   ;ARTIKEL UND TEILENUMMER ;item And 
	SET YANG=$PIECE(YPARA1,",",1)
	SET YPOS=$PIECE(YPARA1,",",2)
	SET ARTT=$TRANSLATE($PIECE(YPARA1,",",3,99),".""",",")  ;TEILE AUS INANGPXL ;out of 
	FOR  QUIT:$EXTRACT(ARTT)'=","  SET ARTT=$EXTRACT(ARTT,2,99)  ;KOMMA HERAUSFILTERN ;comma 
	;
	IF YFUNCT1="UP" DO   ;EINE POSITION HERAUF ;one upwards 
	. IF YANG'="" IF YPOS'="" IF ARTT'="" DO
	. . SET DATEI="^INANGPXL("""_YM_""","""_YANG_""","_YPOS
	. . FOR YI=1:1 QUIT:$PIECE(ARTT,",",YI)=""  SET DATEI=DATEI_","_$PIECE(ARTT,",",YI)
	. . SET DATEI=DATEI_")"
	. . SET YI=$PIECE($GET(@DATEI),Y,18)
	. . SET YI=YI+1
	. . SET $P(@DATEI,Y,18)=YI
	. . QUIT
	. QUIT      
	IF YFUNCT1="DOWN" DO   ;EINE POSITION HERUNTER ;one 
	. IF YANG'="" IF YPOS'="" IF ARTT'="" DO
	. . SET DATEI="^INANGPXL("""_YM_""","""_YANG_""","_YPOS
	. . FOR YI=1:1 QUIT:$PIECE(ARTT,",",YI)=""  SET DATEI=DATEI_","_$PIECE(ARTT,",",YI)
	. . SET DATEI=DATEI_")"
	. . SET YI=$PIECE($GET(@DATEI),Y,18)
	. . SET YI=YI-1
	. . I YI<1 S YI=""
	. . SET $P(@DATEI,Y,18)=YI
	. . QUIT
	. QUIT      
	SET YFORM="INANGPTT1"
	SET %(YQUERY,"YFORM")=YFORM
	SET %("VAR","YFORM")=YFORM
	DO ^WWWFORM
	QUIT
	;
	;
	
NEU ;NEU AUFBAU DER INANGPT  (EINSPRUNG VON AUSSEN) ;recent the 
	;
	;
	NEW SUCH,SUCH1,YYI
	SET SUCH="^INANGPXL("""_YM_""","""_YANG_""",-1)"
	KILL ^INANGPT(YM,YANG,YPOS)
	FOR  DO  QUIT:SUCH=""
	. SET SUCH=$QUERY(@SUCH)
	. IF $TRANSLATE($PIECE(SUCH,",",2),"""")'=YANG SET SUCH="" QUIT  ;21.06.04;FAN;25794; WENN alphanumerischen Auftragsnummern SOLL DATEN AUCH AUFBAUEN.
	. ;IF $PIECE(SUCH,",",2)'=YANG SET SUCH="" QUIT  ;21.06.04;FAN;25794; WENN alphanumerischen Auftragsnummern SOLL DATEN AUCH AUFBAUEN.
	. IF $PIECE(SUCH,",",3)=YPOS DO
	. . SET SUCH1=@SUCH
	. . SET SUCH(1)=$PIECE($P(SUCH,")",1),",",4,99)
	. . SET SUCH(0)=$LENGTH(SUCH(1),",")  ;ANZAHL DER ,
	. . ;
	. . ;RUESTZEIT NUR BEI LEISTUNGEN GÜLTIG;FIS;25.05.04;25780
	. . IF +$PIECE(SUCH1,Y,70)'=0 IF $DATA(@SUCH)'=11 DO  ;KEINE UNTERTEILE ;no 
	. . . IF $PIECE(SUCH1,Y,40)'=2 IF $PIECE(SUCH1,Y,40)'=10 IF $PIECE(SUCH1,Y,40)'=11 SET $PIECE(SUCH1,Y,70)=""  ;KEINE LEISTUNG=KEINE RÜSTZEIT ;no setup time 
	. . . QUIT
	. . ;
	. . ;BERECHNEN DER BENÖTIGTEN MENGE ;calculate the quantum 
	. . SET SUCH(3)=$PIECE($G(^INANGP(YM,YANG,YPOS,1)),Y,5)  ;BASISMENGE
	. . SET SUCH("M",+SUCH(0))=$PIECE(SUCH1,Y,5)
	. . FOR YYI=1:1:SUCH(0) IF +$GET(SUCH("M",YYI))'=0 SET SUCH(3)=SUCH(3)*$GET(SUCH("M",YYI))
	. . SET $PIECE(SUCH1,Y,39)=SUCH(3)   ;MENGE FÜR PRODUKTION ;quantum to production 
	. . ;
	. . SET SUCH(2)=""
	. . FOR YYI=1:1:SUCH(0) SET SUCH(2)=SUCH]]><![CDATA[(2)_$PIECE(SUCH(1),",",YYI)_"."
	. . SET ^INANGPT(YM,YANG,YPOS,SUCH(2),1)=SUCH1
	. . SET @SUCH=SUCH1
	. . QUIT
	. QUIT
	QUIT
	;
	;
	
LIST(YKEY) ;LISTE DER ANGEBOTSTEILE ;list the 
	;
	NEW YLISTEN
	SET YLISTEN=1
	DO ^WWWBACK
	DO INANGPTT
	QUIT
]]></Routine>
</Export>