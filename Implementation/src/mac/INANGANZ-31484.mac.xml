<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="22" zv="CACHE" ts="2001-01-01 00:00:00">
<Routine name="INANGANZ" type="MAC" languagemode="0" timestamp="58440,0"><![CDATA[
INANGANZ(YANG,YLIST) ;INANGANZ;FIS;ANZEIGEN ANGEBOTSPOSITIONEN;13.07.2001  ; Compiled March 9, 2005 14:00:04
	;
	;/------------------------------------------------------------------\
	;| Description of Function :
	;|		ANZEIGEN ANGEBOTSPOSITIONEN
	;|
	;| Inputs : 
	;|
	;|
	;| ByRef :
	;|
	;|
	;| Returns :
	;|
	;|
	;| History :
	;|
	;| FIS	13.07.2001  
	;|
	;\------------------------------------------------------------------/
	;
	;
	;EINSPRUNG AUS INANG ;out of 
	;
	;YLIST=1 LISTENFORM MIT HEADER ;by means of 
	SET YANG=$GET(YANG)
	IF YANG'="" IF $DATA(^INANGGOEP(YM,YANG)) DO ^INANGGOEANZ(YANG) QUIT  ;KOSTENAUFTELLUNGEN (ALTERNATIVE ANGEBOTSVERWALTUNG GÖBEL)
	;
	NEW POS,ANZM,YDDSATZ,YFELD,KOST,BUTTON,GRUPOS,ANGART,RUEST,VKANZ,FREMDWHR,YANG1
	SET YLIST=$GET(YLIST)
	SET ANZM=0
	SET BUTTON=1  ;KILL/MOVE ANZEIGEN ;display 
	SET GRUPOS=0  ;KEINE GRUPPENPOSITION ;no 
	SET YDDSATZ=0
	SET SUM(1)=0  ;SUMME HERSTELLKOSTEN ;sum 
	SET SUM(2)=0  ;SUMME RÜSTZEIT ;sum setup time 
	SET SUM(3)=0  ;SUMMER EINZELPREISE ;buzzer 
	SET SUM(4)=0  ;SUMME EINZELPREISE FREMDWÄHRUNG ;sum 
	SET ANGART=$P($GET(^INANG(YM,YANG,1)),Y,2)
	SET RUEST=""  ;KEINE ANZEIGE WENN KEINE RÜSTZEITEN VORHANDEN ;no Show when no on hand 
	SET FREMDWHR=0  ;FOREIGN CURRENCY;FIS;27.08.04;26316
	;
	QUIT:$GET(YANG)=""
	SET YANG1=$GET(^INANG(YM,YANG,1))
	IF $ORDER(^INANGP(YM,YANG,""))="" SET BUTTON=0  ;BUTTON NICHT ANZEIGEN ;Not display 
	IF $PIECE($GET(^INANG(YM,YANG,1)),Y,228)=1 SET BUTTON=0  ;NICHT MEHR ÄNDERBAR ;Not more 
	DO  ;ANZEIGE VON GRUPPENPOSITIONEN WENN VORHANDEN / PRÜFEN OB ÄNDERBER ;Show when on hand sift whether 
	. NEW POSX
	. SET POSX="" FOR  SET POSX=$ORDER(^INANGP(YM,YANG,POSX)) QUIT:POSX=""  DO
	. . IF $PIECE($GET(^INANGP(YM,YANG,POSX,1)),Y,247)'="" SET GRUPOS=1  ;GRUPPENPOSITIONEN ANZEIGEN ;display 
	. . IF $PIECE($GET(^INANGP(YM,YANG,POSX,1)),Y,248)=1 SET BUTTON=0  ;NICHT MEHR ÄNDERBAR ;Not more 
	. . IF $PIECE($GET(^INANGP(YM,YANG,POSX,1)),Y,70)'=0 SET RUEST=1  ;ANZEIGE WENN RÜSTZEITEN VORHANDEN ;Show when on hand 
	. . IF $PIECE(YANG1,Y,2)=2 IF $PIECE(YANG1,Y,51)'="" IF $PIECE(YANG1,Y,51)'=YWHR SET FREMDWHR=1  ;FOREIGN CURRENCY;FIS;27.08.04;26316
	. . QUIT
	. QUIT
	IF $PIECE($GET(^INVORG(YM,YM,1)),Y,114)=1 SET RUEST=""
	;
	SET VKANZ=0
	IF $PIECE($GET(^INVORG(YM,YM,1)),Y,139)=1 IF $PIECE($GET(^INANG(YM,YANG,1)),Y,2)=0 SET VKANZ=1  ;VERKAUFSPREIS IN KUNDENVERTRÄGEN ANZEIGEN ;within display 
	;
	;
	;
	;DO ^WWWFRAME(2,,,,1)  ;TABLE AN
	;DO ^WWWFRAME(0,,,,1)  ;TABLE AN  ;TYBD;060203  ;11,2,2004;TYBD;HINTERGRUNDFARBE
	IF YANG'="" IF $DATA(^INANGP(YM,YANG)) DO ^WWWFRAME(2,,,,1)  ;TABLE AN  ;11,2,2004;TYBD;HINTERGRUNDFARBE
	DO
	. IF YANG="" DO ^WWWFRAME(0) QUIT
	. IF '$DATA(^INANGP(YM,YANG)) DO ^WWWFRAME(0,,,,0)  ;TABLE AN  TYBD;6.2.03  ;11,2,2004;TYBD;HINTERGRUNDFARBE
	. QUIT
	;
	DO HEADER
	DO
	. SET POS="" FOR  SET POS=$ORDER(^INANGP(YM,YANG,POS)) QUIT:POS=""  DO
	. . SET YFELD=$GET(^INANGP(YM,YANG,POS,1))
	. . QUIT:YFELD=""
	. . DO ANZ
	. . QUIT
	. QUIT
	IF ANZM=0!(YDDSATZ<10) DO
	. NEW YBLANKLINE
	. SET YBLANKLINE=$GET(YDDSATZ)
	. FOR YBLANKLINE=YBLANKLINE:1:10 DO ZEILE
	. QUIT
	DO SUMME
	I VKANZ=1 DO RABATT  ;FIS;28.07.04
	DO ^WWWFRAME(1)  ;TABLE AUS ;out of 
	QUIT
	;
	;
	
ANZ   ;
 
    ;-------------------------------------------------------------------------------
    ; Method Usage
    ;
    ; Params:
    ;
    ; Returns:
    ;
    ; History:
    ; 23-Jun-2006	Pablo	SRBR014041: Currency symbol must appear on the correct side of the numeric value
    ;-------------------------------------------------------------------------------
 
	SET ANZM=ANZM+1
	;
	;
	IF $PIECE(YFELD,Y,30)'="" IF $GET(KUNDE)'="" IF $PIECE($GET(^INKUNDEK(YM,KUNDE,$PIECE(YFELD,Y,30),1)),Y,25)=1 SET $PIECE(YFELD,Y,66)=4 ;SET GUELTIG=0 ;TYBD;9,12,2004;WARENGRUPPE NICHT FÜR DEN KUNDEN
	;
	DO NL^WWWTAB
	IF BUTTON=1 DO
	. ;----------------------------------DELETE BUTTON----------------------------------------
	. DO NF^WWWTAB
	. DO  ;LÖSCHEN ;Delete 
	. . NEW YKEY,YFORM
	. . WRITE "<A HREF="_""""
	. . WRITE "JavaScript:if (confirm('"_" ("_YANG_","_POS_")  "_$$^WWWTEXT(321)_"')) window.location='"
	. . WRITE YAKTION_"EP=WWWMANU&YEXEC=*D|KILL^INANGANZ&YFORM=INANGANZ&YKEY="_YANG_","_POS  ;LÖSCHEN ;Delete 
	. . DO ^WWWCGI
	. . WRITE "'"
	. . WRITE """"
	. . WRITE ">"
	. . QUIT
	. WRITE "<IMG SRC="_""""_YGIF_"del.gif"_""""
	. WRITE "ALT="_$$^WWWTEXT(50)
	. WRITE " width=18 height=18 border=0 VSPACE=0>"
	. WRITE "</A>"
	. DO EF^WWWTAB
	. WRITE YCR
	. ;
	. DO NF^WWWTAB
	. ;----------------------------------VERSCHIEBEN----------------------------------------
	. DO  
	. . NEW YKEY,YFORM
	. . WRITE "<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=*D|MOVE^INANGANZ(0)&YFORM=INANGANZ&YKEY="_YANG_","_POS  ;HÖHER ;superior 
	. . DO ^WWWCGI
	. . WRITE """"
	. . WRITE ">"
	. . QUIT
	. WRITE "<IMG SRC="_""""_YGIF_"scrup.gif"_""""
	. WRITE "ALT="_$$^WWWTEXT(32015)
	. WRITE " border=0 VSPACE=0>"
	. WRITE "</A>"
	. DO  ;VERSCHIEBEN NACH UNTEN ;defer within underneath 
	. . NEW YKEY,YFORM
	. . WRITE "<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=*D|MOVE^INANGANZ(1)&YFORM=INANGANZ&YKEY="_YANG_","_POS  ;TIEFER
	. . DO ^WWWCGI
	. . WRITE """"
	. . WRITE ">"
	. . QUIT
	. WRITE "<IMG SRC="_""""_YGIF_"scrdown.gif"_""""
	. WRITE "ALT="_$$^WWWTEXT(32016)
	. WRITE " border=0 VSPACE=0>"
	. WRITE "</A>"
	. DO EF^WWWTAB
	. WRITE YCR
	. QUIT
	;
	DO ZW^WWWTAB
	;
	;----------------------------------POSITION----------------------------------------
	WRITE "<font size=2>"
	DO
	. NEW YKEY,YFORM,YBACK
	. WRITE "<A HREF="_""""_YAKTION_"EP=WWWFORM&YFORM=INANGP&YKEY="_YANG_","_POS_"&YBACK=INANGBANZ,INANG,"
	. DO ^WWWCGI
	. WRITE """"
	. WRITE " TITLE="_""""_$$^WWWTEXT(32552)_""""
	. WRITE ">"
	. QUIT
	WRITE POS  ;POSITION
	WRITE "</A>"
	WRITE "</font>"
	WRITE YCR
	;
	DO ZW^WWWTAB
	;
	;----------------------------------ARTIKELBEZEICHNUNG----------------------------------------
	WRITE "<font size=2>"
	DO
	. NEW YKEY,YFORM,YBACK
	. WRITE "<A HREF="_""""_YAKTION_"EP=WWWFORM&YFORM=INANGP&YKEY="_YANG_","_POS_"&YBACK=INANGBANZ,INANG,"
	. DO ^WWWCGI
	. WRITE """"
	. WRITE " TITLE="_""""_$$^WWWTEXT(32552)_""""
	. WRITE ">"
	. QUIT
	WRITE $EXTRACT($PIECE(YFELD,Y,1),1,15)  ;ARTIKELBEZEICHNUNG
	WRITE "&nbsp;"
	WRITE "</A>"
	WRITE "</font>"
	WRITE YCR
	;
	DO ZW^WWWTAB
	;
	;----------------------------------ARTIKELNUMMER----------------------------------------
	WRITE "<font size=2>"
	DO
	. NEW YKEY,YFORM,YBACK
	. WRITE "<A HREF="_""""_YAKTION_"EP=WWWFORM&YFORM=INANGP&YKEY="_YANG_","_POS_"&YBACK=INANGBANZ,INANG,"
	. DO ^WWWCGI
	. WRITE """"
	. WRITE " TITLE="_""""_$$^WWWTEXT(32552)_""""
	. WRITE ">"
	. QUIT
	WRITE $PIECE(YFELD,Y,4)  ;ARTIKELNUMMER
	WRITE "</A>"
	WRITE "</font>"
	WRITE YCR
	;
	IF GRUPOS=1 DO
	. DO ZW^WWWTAB
	. ;----------------------------------POSITIONSGRUPPE----------------------------------------
	. WRITE "<font size=2>"
	. DO
	. . NEW YKEY,YFORM,YBACK
	. . WRITE "<A HREF="_""""_YAKTION_"EP=WWWFORM&YFORM=INANGP&YKEY="_YANG_","_POS_"&YBACK=INANGBANZ,INANG,"
	. . DO ^WWWCGI
	. . WRITE """"
	. . WRITE " TITLE="_""""_$$^WWWTEXT(32552)_""""
	. . WRITE ">"
	. . QUIT
	. IF $PIECE(YFELD,Y,247)'="" DO
	. . IF $DATA(^INANGPARA(YM,YANG,$PIECE(YFELD,Y,247),1)) WRITE $EXTRACT($PIECE(^(1),Y,1),1,20) QUIT  ;POSITIONSGRUPPE
	. . WRITE $PIECE(YFELD,Y,247)
	. . QUIT
	. IF $PIECE(YFELD,Y,247)="" WRITE "&nbsp;"
	. WRITE "</A>"
	. WRITE "</font>"
	. WRITE YCR
	. QUIT
	;
	DO ZWR^WWWTAB
	;
	;----------------------------------MENGE----------------------------------------
	WRITE "<font size=2>"
	DO
	. NEW YKEY,YFORM,YBACK
	. WRITE "<A HREF="_""""_YAKTION_"EP=WWWFORM&YFORM=INANGP&YKEY="_YANG_","_POS_"&YBACK=INANGBANZ,INANG,"
	. DO ^WWWCGI
	. WRITE """"
	. WRITE " TITLE="_""""_$$^WWWTEXT(32552)_""""
	. WRITE ">"
	. QUIT
	;
	;WRITE $EXTRACT(+$PIECE(YFELD,Y,5),1,15)  ;MENGE
	WRITE $$^WWWZAHL($PIECE(YFELD,Y,5),0,$LENGTH($PIECE($PIECE(YFELD,Y,5),".",2)))  ;MENGE ;quantum 
	WRITE "</A>"
	WRITE "</font>"
	WRITE YCR
	;
	DO ZW^WWWTAB
	;
	;----------------------------------MENGENEINHEIT----------------------------------------
	WRITE "<font size=2>"
	DO
	. NEW YKEY,YFORM,YBACK
	. WRITE "<A HREF="_""""_YAKTION_"EP=WWWFORM&YFORM=INANGP&YKEY="_YANG_","_POS_"&YBACK=INANGBANZ,INANG,"
	. DO ^WWWCGI
	. WRITE """"
	. WRITE " TITLE="_""""_$$^WWWTEXT(32552)_""""
	. WRITE ">"
	. QUIT
	IF $PIECE(YFELD,Y,40)'="" DO
	. WRITE $EXTRACT($P($GET(^WWW101(0,"EINHEIT",SPRACHE,$PIECE(YFELD,Y,40),1)),Y,1),1,15)  ;MENGENEINHEIT
	. QUIT
	WRITE "</A>"
	IF $PIECE(YFELD,Y,40)="" WRITE "&nbsp;"
	WRITE "</font>"
	WRITE YCR
	;
	DO ZW^WWWTAB
	;
	;----------------------------------OPTIONAL----------------------------------------
	WRITE "<font size=2>"
	DO
	. NEW YKEY,YFORM,YBACK
	. WRITE "<A HREF="_""""_YAKTION_"EP=WWWFORM&YFORM=INANGP&YKEY="_YANG_","_POS_"&YBACK=INANGBANZ,INANG,"
	. DO ^WWWCGI
	. WRITE """"
	. WRITE " TITLE="_""""_$$^WWWTEXT(32552)_""""
	. WRITE ">"
	. QUIT
	IF $PIECE(YFELD,Y,11)'="" DO
	. WRITE $EXTRACT($GET(^WWW101(0,"OPTIONAL",SPRACHE,$PIECE(YFELD,Y,11),1)),1,15)  ;OPTIONAL
	. QUIT
	WRITE "</A>"
	IF $PIECE(YFELD,Y,11)="" WRITE "&nbsp;"
	WRITE "</font>"
	WRITE "&nbsp;"
	WRITE YCR
	;
	DO ZW^WWWTAB
	;
	;----------------------------------WARENHERKUNFT----------------------------------------
	WRITE "<font size=2>"
	DO
	. NEW YKEY,YFORM,YBACK
	. WRITE "<A HREF="_""""_YAKTION_"EP=WWWFORM&YFORM=INANGP&YKEY="_YANG_","_POS_"&YBACK=INANGBANZ,INANG,"
	. DO ^WWWCGI
	. WRITE """"
	. WRITE " TITLE="_""""_$$^WWWTEXT(32552)_""""
	. WRITE ">"
	. QUIT
	IF $PIECE(YFELD,Y,7)'="" DO
	. WRITE $EXTRACT($PIECE($GET(^WWW101(0,"WARENHERKUNFT",SPRACHE,$PIECE(YFELD,Y,7),1)),Y,1),1,15)  ;WARENHERKUNFT
	. QUIT
	WRITE "</A>"
	IF $PIECE(YFELD,Y,7)="" WRITE "&nbsp;"
	WRITE "</font>"
	WRITE YCR
	;
	DO ZW^WWWTAB
	;
	;----------------------------------KUNDENTEXT----------------------------------------
	WRITE "<font size=2>"
	DO
	. NEW YKEY,YFORM,YBACK
	. WRITE "<A HREF="_""""_YAKTION_"EP=WWWFORM&YFORM=INANGP&YKEY="_YANG_","_POS_"&YBACK=INANGBANZ,INANG,"
	. DO ^WWWCGI
	. WRITE """"
	. WRITE " TITLE="_""""_$$^WWWTEXT(32552)_""""
	. WRITE ">"
	. QUIT
	I $PIECE(YFELD,Y,10)'="" DO
	. WRITE $EXTRACT($PIECE($PIECE(YFELD,Y,10),"|",1),1,15)  ;KUNDENTEXT
	. Q
	WRITE "</A>"
	IF $PIECE(YFELD,Y,10)="" WRITE "&nbsp;"
	WRITE "</font>"
	WRITE YCR
	;
	DO ZW^WWWTAB
	;
	;----------------------------------AUSFÜHRUNGSTEXT----------------------------------------
	WRITE "<font size=2>"
	DO
	. NEW YKEY,YFORM,YBACK
	. WRITE "<A HREF="_""""_YAKTION_"EP=WWWFORM&YFORM=INANGP&YKEY="_YANG_","_POS_"&YBACK=INANGBANZ,INANG,"
	. DO ^WWWCGI
	. WRITE """"
	. WRITE " TITLE="_""""_$$^WWWTEXT(32552)_""""
	. WRITE ">"
	. QUIT
	IF $PIECE(YFELD,Y,14)'="" DO
	. WRITE $EXTRACT($PIECE($PIECE(YFELD,Y,14),"|",1),1,15)  ;AUSFÜHRUNGSTEXT
	. IF $EXTRACT($PIECE($PIECE(YFELD,Y,14),"|",1),1,15)="" WRITE "&nbsp;"
	. QUIT
	WRITE "</A>"
	IF $PIECE(YFELD,Y,14)="" WRITE "&nbsp;"
	WRITE "</font>"
	WRITE YCR
	;
	;------------------------- EINZELPREIS FREMDWÄHRUNG;26316;FIS;27.08.04-------------------
	IF FREMDWHR=1 IF +$GET(VKANZ)=0 DO
	. DO ZWR^WWWTAB
	. ; 
	. WRITE "<font size=2>"
	. DO
	. . NEW YKEY,YFORM,YBACK
	. . WRITE "<A HREF="_""""_YAKTION_"EP=WWWFORM&YFORM=INANGP&YKEY="_YANG_","_POS_"&YBACK=INANGBANZ,INANG,"
	. . DO ^WWWCGI
	. . WRITE """"        ; BEARBEITEN ANGEBOTSPOSITION
	. . WRITE " TITLE="_""""_$$^WWWTEXT(32552)_""""
	. . WRITE ">"
	. . QUIT
	. NEW EINZELEK,WHRF,FORMAT,ORDERMENGE
	. SET EINZELEK=$PIECE($GET(^INANGPK(YM,YANG,POS,1)),Y,68)
	. SET ORDERMENGE=$PIECE($GET(^INANGPK(YM,YANG,POS,1)),Y,16)  ;BEZUGSMENGE;FIS;14.10.04;26544
	. IF +ORDERMENGE=0 SET ORDERMENGE=$PIECE(YFELD,Y,5)  ;FIS;14.10.04;26544
	. SET EINZELEK=EINZELEK*ORDERMENGE  ;GESAMT-EK ANZEIGEN;FIS;14.10.04;26544
	. SET WHRF=$PIECE($GET(^INANGPK(YM,YANG,POS,1)),Y,78)
	. IF +EINZELEK'=0 DO
	. . IF $PIECE(YFELD,Y,205)=1!($PIECE(YFELD,Y,9)=1) WRITE "<STRIKE>"  ;GESPERRT ;DISABLED 
	. . SET SUM(4)=SUM(4)+EINZELEK
	. . SET EINZELEK=$$^WWWZAHL(EINZELEK,0,2)
	. . ;IF +WHRF'=0 WRITE $$^WWWTR(0,12,WHRF)_" x "
	. . WRITE EINZELEK_" "_$PIECE($GET(^WWWWAE(0,$PIECE(YANG1,Y,51),1)),Y,2)
	. . IF $PIECE(YFELD,Y,205)=1!($PIECE(YFELD,Y,9)=1) WRITE "<STRIKE>"  ;GESPERRT ;DISABLED 
	. . QUIT
	. WRITE "&nbsp;"
	. WRITE "</A>"
	. WRITE "</font>"
	. WRITE YCR
	. QUIT
	;
	;---WEM;#23753;22.07.2003
	DO ZWR^WWWTAB
	;
	;----------------------------------EINZELPREIS----------------------------------------
	WRITE "<font size=2>"
	DO
	. NEW YKEY,YFORM,YBACK
	. WRITE "<A HREF="_""""_YAKTION_"EP=WWWFORM&YFORM=INANGP&YKEY="_YANG_","_POS_"&YBACK=INANGBANZ,INANG,"
	. DO ^WWWCGI
	. WRITE """"        ; BEARBEITEN ANGEBOTSPOSITION
	. WRITE " TITLE="_""""_$$^WWWTEXT(32552)_""""
	. WRITE ">"
	. QUIT
	IF +$GET(VKANZ)=0 DO   ;EINZEL EK ANZEIGEN ;Planned Cost display 
	. NEW EINZELEK
	. ;SET EINZELEK=$PIECE($GET(^INANGPK(YM,YANG,POS,1)),Y,12)
	. SET EINZELEK=$PIECE($GET(^INANGPK(YM,YANG,POS,1)),Y,47)   ;TYBD;7,10,2004
	. IF +EINZELEK'=0 DO
	. . ;SET SUM(3)=SUM(3)+EINZELEK ;table-mat 
	. . IF $PIECE(YFELD,Y,11)'=1 SET SUM(3)=SUM(3)+EINZELEK  ;NICHT WENN OPTIONAL;FIS;10.08.04;26236
	. . SET EINZELEK=$$^WWWZAHL(EINZELEK,0,2,YWHR)
	. . WRITE $PIECE(EINZELEK," ",1)_" "_$PIECE(EINZELEK," ",2) // SRBR014041
	. . QUIT
	. QUIT
	IF +$GET(VKANZ)'=0 DO   ;EINZEL VK ANZEIGEN ;Sale display 
	. NEW EINZELVK
	. IF +$PIECE(YFELD,Y,118)'=0 DO
	. . SET EINZELVK=$$^WWWZAHL(+$PIECE(YFELD,Y,118),0,2,YWHR)
	. . WRITE $PIECE(EINZELVK," ",1)_" "_$PIECE(EINZELVK," ",2) // SRBR014041
	. . ;SET SUM(3)=SUM(3)+$PIECE(YFELD,Y,118)
	. . IF $PIECE(YFELD,Y,11)'=1 SET SUM(3)=SUM(3)+$PIECE(YFELD,Y,118)  ;NICHT WENN OPTIONAL;FIS;10.08.04;26236
	. . QUIT
	. QUIT
	WRITE "&nbsp;"
	WRITE "</A>"
	WRITE "</font>"
	WRITE YCR
	;
	;---ENDE
	DO ZWR^WWWTAB
	;
	;----------------------------------HERSTELLKOSTEN ODER VK PREIS----------------------------------------
	WRITE "<font size=2>"
	DO
	. NEW YKEY,YFORM,YBACK
	. WRITE "<A HREF="_""""_YAKTION_"EP=WWWFORM&YFORM=INANGP&YKEY="_YANG_","_POS_"&YBACK=INANGBANZ,INANG,"
	. DO ^WWWCGI
	. WRITE """"
	. WRITE " TITLE="_""""_$$^WWWTEXT(32552)_""""
	. WRITE ">"
	. QUIT
	;
	IF +$GET(VKANZ)=0 DO   ;TYBD;2.5.2003
	. SET KOST=$$^WWWZAHL(+$PIECE(YFELD,Y,47),0,2,YWHR)  ;HERSTELLKOSTEN
	. WRITE $PIECE(KOST," ",1)_" "_$PIECE(KOST," ",2) // SRBR014041
	. ;SET SUM(1)=SUM(1)+$PIECE(YFELD,Y,47)
	. IF $PIECE(YFELD,Y,11)'=1 SET SUM(1)=SUM(1)+$PIECE(YFELD,Y,47)  ;NICHT WENN OPTIONAL;FIS;10.08.04;26236
	. QUIT
	;
	IF +$GET(VKANZ)'=0 DO   ;TYBD;2.5.2003
	. SET KOST=$$^WWWZAHL(+$PIECE(YFELD,Y,123),0,2,YWHR)  ;VKPREIS
	. WRITE $PIECE(KOST," ",1)_" "_$PIECE(KOST," ",2) // SRBR014041
	. ;SET SUM(1)=SUM(1)+$PIECE(YFELD,Y,123)
	. IF $PIECE(YFELD,Y,11)'=1 SET SUM(1)=SUM(1)+$PIECE(YFELD,Y,123)  ;NICHT WENN OPTIONAL;FIS;10.08.04;26236
	. QUIT
	;
	WRITE "&nbsp;"
	WRITE "</A>"
	WRITE "</font>"
	WRITE YCR
	;
	;
	;----------------------------------RÜSTKOSTEN----------------------------------------
	IF RUEST=1 DO
	. DO ZWR^WWWTAB
	. WRITE "<font size=2>"
	. DO
	. . NEW YKEY,YFORM,YBACK
	. . WRITE "<A HREF="_""""_YAKTION_"EP=WWWFORM&YFORM=INANGP&YKEY="_YANG_","_POS_"&YBACK=INANGBANZ,INANG,"
	. . DO ^WWWCGI
	. . WRITE """"
	. . WRITE " TITLE="_""""_$$^WWWTEXT(32552)_""""
	. . WRITE ">"
	. . QUIT
	. IF +$PIECE(YFELD,Y,70)'=0 WRITE $$^WWWTIME(+$PIECE(YFELD,Y,70))  ;RÜSTZEIT ;setup time 
	. WRITE "</A>"
	. ;IF +$PIECE(YFELD,Y,70)=0 WRITE "&nbsp;"
	. ;SET SUM(2)=SUM(2)+$PIECE(YFELD,Y,70)  ;NICHT WENN OPTIONAL;FIS;10.08.04;26236
	. IF $PIECE(YFELD,Y,11)'=1 SET SUM(2)=SUM(2)+$PIECE(YFELD,Y,70)  ;NICHT WENN OPTIONAL;FIS;10.08.04;26236
	. WRITE "&nbsp;"
	. WRITE "</font>"
	. WRITE YCR
	. QUIT
	;
	;
	;--;WEM;#23753;HINZUGEFÜGT
	DO ZW^WWWTAB
	;
	;----------------------------------UMSATZSTEUER----------------------------------------
	WRITE "<font size=2>"
	DO
	. NEW YKEY,YFORM,YBACK
	. WRITE "<A HREF="_""""_YAKTION_"EP=WWWFORM&YFORM=INANGP&YKEY="_YANG_","_POS_"&YBACK=INANGBANZ,INANG,"
	. DO ^WWWCGI
	. WRITE """"
	. WRITE " TITLE="_""""_$$^WWWTEXT(32552)_""""
	. WRITE ">"
	. QUIT
	IF $PIECE(YFELD,Y,36)'="" IF $P($G(^WWW101(0,"MWST",SPRACHE,$PIECE(YFELD,Y,36),1)),Y,1)'=""  DO
	. WRITE +$P($G(^WWW101(0,"MWST",SPRACHE,$PIECE(YFELD,Y,36),1)),Y,1)   ;USt. ;tax 
	. QUIT
	IF $PIECE(YFELD,Y,36)="" WRITE "&nbsp;"
	WRITE "</A>"
	WRITE "</font>"
	WRITE YCR
	;
	;--END
	DO EF^WWWTAB
	DO EL^WWWTAB
	QUIT
	;
	;
	
HEADER ;UEBERSCHRIFT
	;
	WRITE "<THEAD>"
	IF YLIST=1 DO
	. NEW YI
	. FOR YI=1:1:12 DO   ;WEM;#23753;bis+2
	. . WRITE YCR
	. . WRITE "<TH VALIGN=TOP NOWRAP ALIGN=LEFT"
	. . WRITE " BGCOLOR="_YDARKGRAY
	. . WRITE ">"
	. . WRITE "<FONT SIZE=2>"
	. . IF YI=2 WRITE $$^WWWTEXT(32178)_": "_YANG  ; (ANGEBOT)
	. . ;
	. . WRITE "&nbsp;"
	. . WRITE "</TH>"
	. . QUIT
	. WRITE YCR
	. WRITE "</TR>"
	. WRITE YCR
	. WRITE "<TR>"
	. QUIT
	;
	;
	IF BUTTON=1 DO
	. WRITE "<TH VALIGN=TOP NOWRAP ALIGN=LEFT"
	. WRITE " BGCOLOR="_YDARKGRAY
	. WRITE ">"
	. WRITE "<FONT SIZE=2>"
	. WRITE "&nbsp;"
	. WRITE "</TH>"
	. WRITE YCR
	. WRITE "<TH VALIGN=TOP NOWRAP ALIGN=LEFT"
	. WRITE " BGCOLOR="_YDARKGRAY
	. WRITE ">"
	. WRITE "<FONT SIZE=2>"
	. WRITE "&nbsp;"
	. WRITE "</TH>"
	. WRITE YCR
	. QUIT
	WRITE "<TH VALIGN=TOP NOWRAP ALIGN=LEFT"
	WRITE " BGCOLOR="_YDARKGRAY
	WRITE ">"
	WRITE "<FONT SIZE=2>"
	WRITE $$^WWWTEXT(32041)  ;POS.
	WRITE "</TH>"
	WRITE YCR
	WRITE "<TH VALIGN=TOP NOWRAP ALIGN=LEFT"
	WRITE " BGCOLOR="_YDARKGRAY
	WRITE ">"
	WRITE "<FONT SIZE=2>"
	DO             ;ARTIKELBEZEICHNUNG
	. W $E($$^WWWFELDNAME("INANGP","D",1),Y,15)
	. QUIT
	WRITE "</TH>"
	WRITE YCR
	WRITE "<TH VALIGN=TOP NOWRAP ALIGN=LEFT"
	WRITE " BGCOLOR="_YDARKGRAY
	WRITE ">"
	WRITE "<FONT SIZE=2>"
	WRITE $$^WWWTEXT(32110)  ;ART.-NR.
	;
	;DO             ;ARTIKELNUMMER
	. QUIT
	WRITE "</TH>"
	WRITE YCR
	IF GRUPOS=1 DO
	. WRITE "<TH VALIGN=TOP NOWRAP ALIGN=LEFT"
	. WRITE " BGCOLOR="_YDARKGRAY
	. WRITE ">"
	. WRITE "<FONT SIZE=2>"
	. DO             ;POSITIONSGRUPPE
	. . W $E($$^WWWFELDNAME("INANGP","D",247),Y,15)
	. . QUIT
	. WRITE "</TH>"
	. WRITE YCR
	. QUIT
	WRITE "<TH VALIGN=TOP NOWRAP ALIGN=LEFT"
	WRITE " BGCOLOR="_YDARKGRAY
	WRITE ">"
	WRITE "<FONT SIZE=2>"
	DO             ;MENGE ;quantum 
	. W $E($$^WWWFELDNAME("INANGP","D",5),Y,15)
	. QUIT
	WRITE "</TH>"
	WRITE YCR
	WRITE "<TH VALIGN=TOP NOWRAP ALIGN=LEFT"
	WRITE " BGCOLOR="_YDARKGRAY
	WRITE ">"
	WRITE "<FONT SIZE=2>"
	DO             ;MENGENEINHEIT
	. W $E($$^WWWFELDNAME("INANGP","D",40),Y,15)
	. QUIT
	WRITE "</TH>"
	WRITE YCR
	WRITE "<TH VALIGN=TOP NOWRAP ALIGN=LEFT"
	WRITE " BGCOLOR="_YDARKGRAY
	WRITE ">"
	WRITE "<FONT SIZE=2>"
	DO             ;OPTIONAL
	. W $E($$^WWWFELDNAME("INANGP","D",11),1,15)
	. QUIT
	WRITE "</TH>"
	WRITE YCR
	WRITE "<TH VALIGN=TOP NOWRAP ALIGN=LEFT"
	WRITE " BGCOLOR="_YDARKGRAY
	WRITE ">"
	WRITE "<FONT SIZE=2>"
	DO             ;WARENHERKUNFT
	. W $E($$^WWWFELDNAME("INANGP","D",7),1,15)
	. QUIT
	WRITE "</TH>"
	WRITE YCR
	WRITE "<TH VALIGN=TOP NOWRAP ALIGN=LEFT"
	WRITE " BGCOLOR="_YDARKGRAY
	WRITE ">"
	WRITE "<FONT SIZE=2>"
	DO             ;KUNDENTEXT
	. W $E($$^WWWFELDNAME("INANGP","D",10),1,15)
	. QUIT
	WRITE "</TH>"
	WRITE YCR
	WRITE "<TH VALIGN=TOP NOWRAP ALIGN=LEFT"
	WRITE " BGCOLOR="_YDARKGRAY
	WRITE ">"
	WRITE "<FONT SIZE=2>"
	WRITE $$^WWWTEXT(32027)  ;AUSFÜHRUNG ;execution 
	;
	;DO             ;AUSFÜHRUNGSTEXT
	. ;QUIT
	WRITE "</TH>"
	;
	IF FREMDWHR=1 IF +$GET(VKANZ)=0 DO
	. WRITE "<TH VALIGN=TOP NOWRAP ALIGN=LEFT"
	. WRITE " BGCOLOR="_YDARKGRAY
	. WRITE ">"
	. WRITE "<FONT SIZE=2>"
	. WRITE $EXTRACT($$^WWWFELDNAME("INANGPK","D",68),Y,25)
	. WRITE "</TH>"
	. WRITE YCR
	. QUIT
	;
	;---WEM,#23753;22.07.2003
	WRITE "<TH VALIGN=TOP NOWRAP ALIGN=LEFT"
	WRITE " BGCOLOR="_YDARKGRAY
	WRITE ">"
	WRITE "<FONT SIZE=2>"
	IF +$GET(VKANZ)=0  DO
	. ;WRITE $EXTRACT($$^WWWFELDNAME("INANGPK","D",12),Y,25)
	. WRITE $EXTRACT($$^WWWFELDNAME("INANGPK","D",47),Y,25)  ;TYBD;7,10,2004
	. ;WRITE $$^WWWTEXT(32134)  ;EINZEL-EK  ;ALT->33540 EINZELPREIS
	. QUIT
	IF +$GET(VKANZ)'=0  DO
	. WRITE $EXTRACT($$^WWWFELDNAME("INANGP","D",118),Y,25)
	. ;WRITE $$^WWWTEXT(32327)   ;EINZEL-VK  
	. QUIT
	WRITE "</TH>"
	WRITE YCR
	;
	;--ENDE
	WRITE YCR
	WRITE "<TH VALIGN=TOP NOWRAP ALIGN=LEFT"
	WRITE " BGCOLOR="_YDARKGRAY
	WRITE ">"
	WRITE "<FONT SIZE=2>"
	IF +$GET(VKANZ)=0 DO             ;HERSTELLKOSTEN  ;TYBD;2.5.2003
	. WRITE $EXTRACT($$^WWWFELDNAME("INANGP","D",47),Y,15)
	. QUIT
	IF +$GET(VKANZ)'=0 DO             ;Verkaufspreis ;Sales Price  ;Sales Price Sales 
	. WRITE $EXTRACT($$^WWWFELDNAME("INANGP","D",123),Y,15)
	. QUIT
	WRITE "</TH>"
	WRITE YCR
	IF RUEST=1 DO
	. WRITE "<TH VALIGN=TOP NOWRAP ALIGN=LEFT"
	. WRITE " BGCOLOR="_YDARKGRAY
	. WRITE ">"
	. WRITE "<FONT SIZE=2>"
	. DO             ;RÜSTZEIT ;setup time 
	. . W $E($$^WWWFELDNAME("INANGP","D",70),1,15)
	. . QUIT
	. WRITE "</TH>"
	. WRITE YCR
	. QUIT
	;
	;---;WEM;#23753;HINZUGEFÜGT
	WRITE "<TH VALIGN=TOP NOWRAP ALIGN=LEFT"
	WRITE " BGCOLOR="_YDARKGRAY
	WRITE ">"
	WRITE "<FONT SIZE=2>"
	WRITE $$^WWWTEXT(33541)  ;USt. ;tax 
	WRITE "</TH>"
	WRITE YCR
	;
	;---END
	WRITE "</THEAD>"
	QUIT
	;
	
ZEILE ;LEERZEILE ;blank line  ;blank line shiny 
	;
	NEW YI,YII
	S YDDSATZ=YDDSATZ+1
	WRITE "<TR>"
	SET YII=12  ;WEM;#23753;YII+2
	IF BUTTON=1 SET YII=14   ;WEM;#23753;YII+2
	IF $G(RUEST)=1 SET YII=YII+1
	IF GRUPOS=1 SET YII=YII+1  ;BEC 06.03.03
	IF FREMDWHR=1 IF +$GET(VKANZ)=0 SET YII=YII+1
	FOR YI=1:1:YII DO
	. WRITE "<TD VALIGN=TOP NOWRAP ALIGN=LEFT"
	. IF YDDSATZ#2'=0 WRITE " BGCOLOR="_YWHITE
	. WRITE ">"
	. WRITE "<FONT SIZE=2>"
	. WRITE "&nbsp;"
	. WRITE "</TD>"
	. WRITE YCR
	. QUIT
	WRITE "</TR>"
	QUIT
	;
	
SUMME ;SUMMENZEILE
 
    ;-------------------------------------------------------------------------------
    ; Method Usage
    ;
    ; Params:
    ;
    ; Returns:
    ;
    ; History:
    ; 23-Jun-2006	Pablo	SRBR014041: Currency symbol must appear on the correct side of the numeric value
    ;-------------------------------------------------------------------------------
 
	DO NL^WWWTAB
	NEW YI,YII,SUMME
	SET YII=9   ;WEM;#23753;YII+1
	IF BUTTON=1 SET YII=YII+2
	IF GRUPOS=1 SET YII=YII+1
	IF FREMDWHR=1 IF +$GET(VKANZ)=0 IF $PIECE(YANG1,Y,2)'=2 SET YII=YII+1  ;FIS;27.08.04;26316
	FOR YI=1:1:YII DO
	. WRITE "<TD VALIGN=TOP NOWRAP ALIGN=LEFT"
	. WRITE " BGCOLOR="_YDARKGRAY
	. WRITE ">"
	. WRITE "<FONT SIZE=2>"
	. WRITE "&nbsp;"
	. WRITE "</TD>"
	. WRITE YCR
	. QUIT
	;
	IF FREMDWHR=1 IF +$GET(VKANZ)=0 IF $PIECE(YANG1,Y,2)=2 DO  ;SUMME FREMDWÄHRUNG;FIS;14.10.04;26544
	. WRITE "<TD VALIGN=TOP NOWRAP ALIGN=RIGHT"
	. WRITE " BGCOLOR="_YDARKGRAY
	. WRITE ">"
	. WRITE "<FONT SIZE=2>"
	. WRITE $$^WWWZAHL(SUM(4),0,2)_" "_$PIECE($GET(^WWWWAE(0,$PIECE(YANG1,Y,51),1)),Y,2)
	. WRITE "&nbsp;"
	. WRITE "</TD>"
	. WRITE YCR
	. QUIT
	;
	;--WEM;#23753;22.07.2003
	WRITE "<TD VALIGN=TOP NOWRAP ALIGN=RIGHT"
	WRITE " BGCOLOR="_YDARKGRAY
	WRITE ">"
	WRITE "<FONT SIZE=2>"
	SET SUMME=$$^WWWZAHL(SUM(3),0,2,YWHR)  ;EINZELPREIS
	;WRITE $PIECE(SUMME," ",2)_" "_$PIECE(SUMME," ",1)  ;KEINE SUMME BEI EINZELEK/VK
	WRITE "&nbsp;"
	WRITE "</TD>"
	WRITE YCR
	;
	;---ENDE
	WRITE "<TD VALIGN=TOP NOWRAP ALIGN=RIGHT"
	WRITE " BGCOLOR="_YDARKGRAY
	WRITE ">"
	WRITE "<FONT SIZE=2>"
	SET SUMME=$$^WWWZAHL(SUM(1),0,2,YWHR)  ;HERSTELLKOSTEN
	WRITE $PIECE(SUMME," ",1)_" "_$PIECE(SUMME," ",2) // SRBR014041
	W "&nbsp;"
	WRITE "</TD>"
	WRITE YCR
	IF RUEST=1 DO
	. WRITE "<TD VALIGN=TOP NOWRAP ALIGN=RIGHT"
	. WRITE " BGCOLOR="_YDARKGRAY
	. WRITE ">"
	. WRITE "<FONT SIZE=2>"
	. WRITE $$^WWWTIME(SUM(2))  ;RÜSTKOSTEN
	. W "&nbsp;"
	. WRITE "</TD>"
	. WRITE YCR
	. Q
	WRITE "<TD VALIGN=TOP NOWRAP ALIGN=LEFT"
	WRITE " BGCOLOR="_YDARKGRAY
	WRITE ">"
	WRITE "<FONT SIZE=2>"
	WRITE "&nbsp;"
	WRITE "</TD>"
	WRITE YCR
	DO EL^WWWTAB
	QUIT
	;
	
RABATT ;GESAMTRABATT;FIS;28.07.04;26150
	;
	NEW YI,YII,SUMME,RABATT
	SET RABATT=$PIECE($GET(^INANG(YM,YANG,1)),Y,71)
	QUIT:+RABATT=0
	;
	DO NL^WWWTAB
	NEW YI,YII,SUMME
	SET YII=9   ;WEM;#23753;YII+1
	IF BUTTON=1 SET YII=YII+2
	IF GRUPOS=1 SET YII=YII+1
	FOR YI=1:1:YII DO
	. WRITE "<TD VALIGN=TOP NOWRAP ALIGN=LEFT"
	. WRITE " BGCOLOR="_YDARKGRAY
	. WRITE ">"
	. WRITE "<FONT SIZE=2>"
	. WRITE "&nbsp;"
	. WRITE "</TD>"
	. WRITE YCR
	. QUIT
	;
	WRITE "<TD VALIGN=TOP NOWRAP ALIGN=RIGHT COLSPAN=2"
	WRITE " BGCOLOR="_YDARKGRAY
	WRITE ">"
	WRITE "<FONT SIZE=2>"
	WRITE (RABATT*-1)_"% "_$$^WWWTEXT(33939)  ;GESAMTRABATT
	WRITE " = "
	SET SUMME=$$^WWWZAHL((SUM(1)-(SUM(1)/100*RABATT)),0,2,YWHR)  ;HERSTELLKOSTEN
	WRITE $PIECE(SUMME," ",2)_" "_$PIECE(SUMME," ",1)
	WRITE "&nbsp;"
	WRITE "</TD>"
	WRITE YCR
	;
	IF RUEST=1 DO
	. WRITE "<TD VALIGN=TOP NOWRAP ALIGN=RIGHT"
	. WRITE " BGCOLOR="_YDARKGRAY
	. WRITE ">"
	. WRITE "<FONT SIZE=2>"
	. WRITE "&nbsp;"
	. WRITE "</TD>"
	. QUIT
	;
	WRITE YCR
	WRITE "<TD VALIGN=TOP NOWRAP ALIGN=LEFT"
	WRITE " BGCOLOR="_YDARKGRAY
	WRITE ">"
	WRITE "<FONT SIZE=2>"
	WRITE "&nbsp;"
	WRITE "</TD>"
	DO EL^WWWTAB
	QUIT
	;
	;-----------------------------------------------------------------------------------------
	;AB HIER:  EXECUTE DURCH LINK ;Confirm. EXECUTE trans- 
	
MOVE(SORT) ;VERSCHIEBEN ANGEBOTSPOSITION ;defer 
	;
	NEW AUF,POS,POSX,POSS
	SET SORT=+$GET(SORT)
	IF SORT=0 SET SORT=-1
	DO
	. SET AUF=$PIECE($GET(YKEY),",",1)
	. QUIT:AUF=""
	. SET POS=$PIECE($GET(YKEY),",",2)
	. QUIT:POS=""
	. SET POSS=POS
	. DO SUCHPOSX
	. DO CHANGE
	. QUIT
	KILL SORT
	SET YFORM="INANG"
	SET %(YQUERY,"YFORM")=YFORM
	SET %("VAR","YFORM")=YFORM
	DO ^WWWFORM
	QUIT
	;
	
SUCHPOSX ;SUCH MIT WECHLE POS TAUSCHEN ? ;by means of barter 
	;
	IF SORT=1 SET POSX=POSS+1 IF '$DATA(^INANGP(YM,AUF,POSX)) QUIT  ;NEUE NUMMER ;numeral 
	IF SORT=-1 SET POSX=POSS-1 IF POSX>0 IF '$DATA(^INANGP(YM,AUF,POSX)) QUIT  ;NEUE NUMMER ;numeral 
	SET POSX=$ORDER(^INANGP(YM,AUF,POSS),SORT)  ;TAUSCHEN ;barter 
	QUIT:POSX="" 
	QUIT:POSS=""
	IF $PIECE(^INANGP(YM,AUF,POSX,1),Y,248)=1 DO
	. SET POSS=POSX DO SUCHPOSX
	. QUIT
	QUIT
	;
	
CHANGE ;TAUSCHEN POSITIONEN ;barter 
	;
	KILL ^WWWSOR(YUSER)
	QUIT:POS=""
	QUIT:POSX=""
	;
	MERGE ^WWWSOR(YUSER,"INANGP",AUF,POS)=^INANGP(YM,AUF,POS)
	DO ^WWWSKILL("INANGP",AUF_","_POS)
	MERGE ^WWWSOR(YUSER,"INANGPK",AUF,POS)=^INANGPK(YM,AUF,POS)
	DO ^WWWSKILL("INANGPK",AUF_","_POS)
	MERGE ^WWWSOR(YUSER,"INANGPXL",AUF,POS)=^INANGPXL(YM,AUF,POS)
	KILL ^INANGPXL(YM,AUF,POS)
	MERGE ^WWWSOR(YUSER,"INANGPT",AUF,POS)=^INANGPT(YM,AUF,POS)
	KILL ^INANGPT(YM,AUF,POS)
	MERGE ^WWWSOR(YUSER,"INANGPIMPACT",AUF,POS)=^INANGPIMPACT(YM,AUF,POS)  ;FIS;09.03.05;27445
	KILL ^INANGPIMPACT(YM,AUF,POS)
	;
	MERGE ^INANGP(YM,AUF,POS)=^INANGP(YM,AUF,POSX)
	DO ^WWWSKILL("INANGP",AUF_","_POSX)
	DO ^WWWSSORT("INANGP",AUF_","_POS)
	MERGE ^INANGPK(YM,AUF,POS)=^INANGPK(YM,AUF,POSX)
	DO ^WWWSKILL("INANGPK",AUF_","_POSX)
	DO ^WWWSSORT("INANGPK",AUF_","_POS)
	MERGE ^INANGPXL(YM,AUF,POS)=^INANGPXL(YM,AUF,POSX)
	KILL ^INANGPXL(YM,AUF,POSX)
	MERGE ^INANGPT(YM,AUF,POS)=^INANGPT(YM,AUF,POSX)
	KILL ^INANGPT(YM,AUF,POSX)
	MERGE ^INANGPIMPACT(YM,AUF,POS)=^INANGPIMPACT(YM,AUF,POSX)
	KILL ^INANGPIMPACT(YM,AUF,POSX)
	;
	MERGE ^INANGP(YM,AUF,POSX)=^WWWSOR(YUSER,"INANGP",AUF,POS)
	DO ^WWWSSORT("INANGP",AUF_","_POSX)
	MERGE ^INANGPK(YM,AUF,POSX)=^WWWSOR(YUSER,"INANGPK",AUF,POS)
	DO ^WWWSSORT("INANGPK",AUF_","_POSX)
	MERGE ^INANGPXL(YM,AUF,POSX)=^WWWSOR(YUSER,"INANGPXL",AUF,POS)
	MERGE ^INANGPT(YM,AUF,POSX)=^WWWSOR(YUSER,"INANGPT",AUF,POS)
	MERGE ^INANGPIMPACT(YM,AUF,POSX)=^WWWSOR(YUSER,"INANGPIMPACT",AUF,POS)
	;
	KILL ^WWWSOR(YUSER)
	QUIT
	;
	;
	
KILL ;LÖSCHEN ANGEBOTSPOSITION ;Delete 
	;
	NEW AUF,POS
	DO
	. SET AUF=$PIECE($GET(YKEY),",",1)
	. QUIT:AUF=""
	. SET POS=$PIECE($GET(YKEY),",",2)
	. QUIT:POS=""
	. DO ^INANGKILL(AUF_","_POS)
	. ;DO NEUSORT
	. QUIT
	SET YFORM="INANG"
	SET %(YQUERY,"YFORM")=YFORM
	SET %("VAR","YFORM")=YFORM
	DO ^WWWFORM
	QUIT
	;
	
NEUSORT ;NEUSORTIERUNG POSITIONEN
	;
	NEW POSALT,POSNEU
	KILL ^WWWSOR(YUSER)
	SET POSALT="" FOR  SET POSALT=$ORDER(^INANGP(YM,AUF,POSALT)) QUIT:POSALT=""  DO
	. MERGE ^WWWSOR(YUSER,"INANGP",AUF,POSALT)=^INANGP(YM,AUF,POSALT)
	. DO ^WWWSKILL("INANGP",AUF_","_POSALT)
	. MERGE ^WWWSOR(YUSER,"INANGPK",AUF,POSALT)=^INANGPK(YM,AUF,POSALT)
	. DO ^WWWSKILL("INANGPK",AUF_","_POSALT)
	. MERGE ^WWWSOR(YUSER,"INANGPXL",AUF,POSALT)=^INANGPXL(YM,AUF,POSALT)
	. KILL ^INANGPXL(YM,AUF,POSALT)
	. MERGE ^WWWSOR(YUSER,"INANGPT",AUF,POSALT)=^INANGPT(YM,AUF,POSALT)
	. KILL ^INANGPT(YM,AUF,POSALT)
	. MERGE ^WWWSOR(YUSER,"INANGPIMPACT",AUF,POSALT)=^INANGPIMPACT(YM,AUF,POSALT)  ;FIS;09.03.05;27445
	. KILL ^INANGPIMPACT(YM,AUF,POSALT)
	. QUIT
	SET POSNEU=0
	SET POSALT="" FOR  SET POSALT=$ORDER(^WWWSOR(YUSER,"INANGP",AUF,POSALT)) QUIT:POSALT=""  DO
	. SET POSNEU=POSNEU+1
	. MERGE ^INANGP(YM,AUF,POSNEU)=^WWWSOR(YUSER,"INANGP",AUF,POSALT)
	. DO ^WWWSSORT("INANGP",AUF_","_POSNEU)
	. MERGE ^INANGPK(YM,AUF,POSNEU)=^WWWSOR(YUSER,"INANGPK",AUF,POSALT)
	. DO ^WWWSSORT("INANGPK",AUF_","_POSNEU)
	. MERGE ^INANGPXL(YM,AUF,POSNEU)=^WWWSOR(YUSER,"INANGPXL",AUF,POSALT)
	. MERGE ^INANGPT(YM,AUF,POSNEU)=^WWWSOR(YUSER,"INANGPT",AUF,POSALT)
	. MERGE ^INANGPIMPACT(YM,AUF,POSNEU)=^WWWSOR(YUSER,"INANGPIMPACT",AUF,POSALT)  ;FIS;09.03.05;27445
	. QUIT
	KILL ^WWWSOR(YUSER)
	QUIT
]]></Routine>
</Export>