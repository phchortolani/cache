<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="22" zv="CACHE" ts="2001-01-01 00:00:00">
<Routine name="INANGSORTI0" type="MAC" languagemode="0" timestamp="58440,0"><![CDATA[
INANGSORTI0 ;INANGSORTI0;DT;BUTTON FÜR DIE AUSWAHL NACH SORTIMENTEN, VERKAUFSARTIKEL ODER KOSTENAUFSTELLUNGEN;30.04.2001
	;
	;/------------------------------------------------------------------\
	;| Description of Function :
	;|		BUTTON FÜR DIE AUSWAHL NACH SORTIMENTEN, VERKAUFSARTIKEL ODER KOSTENAUFSTELLUNGEN
	;|
	;| Inputs : 
	;|
	;|
	;| ByRef :
	;|
	;|
	;| Returns :
	;|
	;|
	;| History :
	;|
	;| DT	30.04.2001
	;|
	;\------------------------------------------------------------------/
	;
	QUIT:YSEITE>1
	WRITE YCR,"<A class=link onClick='SAVENOW();'>"	//SR13195
	WRITE YCR,"<IMG SRC="""_YGIF_"ok.gif""  ALIGN=ABSBOTTOM TITLE=ok border=0></A>"
	;OK BUTTON  ;IN SEPARATEM FENSTER;FIS;23902;04.07.03
	DO
	. NEW YI
	. WRITE YCR
	. DO VAR^WWWCGI
	. WRITE "<A onClick='return doLink(this)' HREF=""JavaScript:if (document."_YHTMFORM_".Y"_YFORM_"M104.value != '')"		//SR13195
	. WRITE " var parameter=window.open("
	. WRITE "'"_YAKTION_"EP=WWWMANU&YEXEC=*D|CALL^INANGARTSUCH(\'' + escape(document."_YHTMFORM_".Y"_YFORM_"M104.value) + '\')"_YI_"&KUNDE="_$G(KUNDE)_"'"
	. WRITE ",'Artikelsuche','resizable=yes'); else alert('"_$$^WWWTEXT(32310)_"');"""
	. WRITE ">"
	. WRITE "<img src="""_YGIF_"searchf.gif"" ALIGN=ABSBOTTOM TITLE="""_$$^WWWTEXT(33526)_""" BORDER=0></A>"  ;ARTIKEL SUCHEN ;item seek 
	. WRITE YCR
	. QUIT
	DO  ;ERSTELLEN DES BUTTONS
	. Q:$P($G(YFELD),Y,12)'=""  ;LIEFERANTENBESTELLUNG 
	. IF $ORDER(^INARTs(YM,6,""))=" " QUIT:$ORDER(^INARTs(YM,6," "))=""  ;KEINE SORTIMENTE ;no 
	. ;
	. QUIT:YHID=2
	. QUIT:YHID=1  ;NICHT WENN NUR HIDDEN ;Not when only 
	. ;W "&nbsp;"
	. WRITE YCR
	. WRITE "<A HREF="""
	. ;SET URL=YAKTION_"EP=WWWFORM&YFORM=INANGSORTI&YUSER="_YUSER_"&YBED="_YBED_"&YTRAKT="_YTRAKT_"&YUCI="_$GET(YUCI)_"&YM="_YM_"&YKEY="_YKEY
	. SET URL=YAKTION_"EP=WWWMANU1&YEXEC=D|START^INANGSORTI0&YUSER="_YUSER_"&YBED="_YBED_"&YTRAKT="_YTRAKT_"&YUCI="_$GET(YUCI)_"&YM="_YM_"&YKEY="_YKEY
	. SET OPT="HEIGHT=500,WIDTH=400,SCROLLBARS=YES,RESIZEABLE=YES"
	. WRITE "javascript:var parameter=window.open('"_URL_"','Sortiment','"_OPT_"');"  
	. WRITE """"
	. WRITE ">"
	. WRITE YCR,"<IMG SRC="""_YGIF_"search1.gif"" ALIGN=ABSBOTTOM TITLE="""_$$^WWWTEXT(148)_""" border=0>"
	. WRITE "</A>"
	. QUIT
	;IF $GET(YKEY)'="" IF $PIECE($GET(^INANG(YM,YKEY,1)),Y,2)=0 DO  ;VERKAUFSARTIKEL
	IF $$^WWWACCESS(99,$PIECE($GET(^INVORG(YM,YM,1)),Y,35),YBED)=1 DO  ;Artikel dieses Kunden suchen ;Item this Customers seek 
	. QUIT:$PIECE($GET(YFELD),Y,1)=""  ;KEIN KUNDE ;no lore 
	. WRITE YCR
	. WRITE "<A HREF="""
	. SET URL=YAKTION_"EP=WWWMANU1&YEXEC=D|START1^INANGSORTI0&YUSER="_YUSER_"&YBED="_YBED_"&YTRAKT="_YTRAKT_"&YUCI="_$GET(YUCI)_"&YM="_YM_"&YKEY="_YKEY
	. SET OPT="HEIGHT=600,WIDTH=700,SCROLLBARS=YES,RESIZEABLE=YES"
	. WRITE "javascript:var parameter=window.open('"_URL_"','Sortiment','"_OPT_"');"  
	. WRITE """"
	. WRITE ">"
	. WRITE YCR,"<IMG SRC="""_YGIF_"kunde-b.gif"" ALIGN=ABSBOTTOM TITLE="""_$$^WWWTEXT(32976)_""" border=0>"    ;Artikel dieses Kunden suchen ;Item this Customers seek 
	. WRITE "</A>"
	. QUIT
	DO    ;Artikel dieses LIEFERNANT suchen ;Item this seek 
	. QUIT:$PIECE($GET(YFELD),Y,12)=""  ;KEIN LIEFERANT ;no purveyor 
	. WRITE YCR
	. WRITE "<A HREF="""
	. SET URL=YAKTION_"EP=WWWMANU1&YEXEC=D|START2^INANGSORTI0&YUSER="_YUSER_"&YBED="_YBED_"&YTRAKT="_YTRAKT_"&YUCI="_$GET(YUCI)_"&YM="_YM_"&YKEY="_YKEY
	. SET OPT="HEIGHT=600,WIDTH=700,SCROLLBARS=YES,RESIZEABLE=YES"
	. WRITE "javascript:var parameter=window.open('"_URL_"','Item','"_OPT_"');"  
	. WRITE """"
	. WRITE ">"
	. WRITE YCR,"<IMG SRC="""_YGIF_"search1.gif"" ALIGN=ABSBOTTOM TITLE="""_$$^WWWTEXT(33296)_""" border=0>"    ;Artikel dieses Kunden suchen ;Item this Customers seek 
	. WRITE "</A>"
	. QUIT
	IF $GET(YKEY)'="" IF '$DATA(^INANGP(YM,YKEY)) DO
	. NEW YYKEY,YFORM,YBACK
	. QUIT:$GET(YAUSWAHL)'=""  ;ANLEGEN ANGEBOTSPOSITION ;put onto 
	. SET YYKEY=YKEY
	. NEW YKEY
	. SET YKEY=$PIECE(YYKEY,",",1)
	. QUIT:$PIECE($GET(YFELD),Y,1)=""  ;KEIN KUNDE ;no lore 
	. WRITE YCR
	. WRITE "<A HREF="""
	. WRITE YAKTION_"EP=WWWFORM&YFORM=INANGGOEP&YBACK=INANG,"  ;&YKEY="_YKEY
	. DO ^WWWCGI  
	. WRITE """"
	. WRITE ">"
	. WRITE YCR,"<IMG SRC="""_YGIF_"menu.gif"" ALIGN=ABSBOTTOM TITLE="""_$$^WWWTEXT(33124)_""" border=0>"    ;ERFASSEN KOSTENAUFSTELLUNG ;Edit 
	. WRITE "</A>"
	. QUIT
	QUIT
	
START ;AUSWERTEN VARIABELEN UND STARTEN INANGSORTI (ANZEIGE DATEN) ;And launching 
	NEW (%request,%session,%KEY,%,%ZCS,%CGIEVAR)
	DO ^WWWVAR  ;VORGABEN SETZEN ;typeset 
	;&FILE=DATEI DIE ANGEZEIGT WIRD (STANDARD=WWWEXPLORE) ;who 
	;&FIX=FESTER ERSTER KEY (NUR WENN &FILE) ;premier KEY when 
	;&RECORD=FELDER DIE ANGEZEIGT WERDEN SOLLEN (STANDARD=1) ;who will should 
	;&OFFSET=STRUKTUR (WIRD GEBILDET)
	;&HEAD=TEXT FÜR HEADER ;to 
	SET %(YQUERY,"TARGET")=$GET(YTARGET)  ;TARGET DER AUSGABE ;the expenses 
	SET %(YQUERY,"FILE")="INSORTIMENT"
	SET %(YQUERY,"FIX")=YM
	SET %(YQUERY,"RECORD")="1,40"  ;FELDER, DIE ANGEZEIGT WERDEN (1,2,3,4)
	SET %(YQUERY,"YUCI")=$GET(YUCI)  ;NAMESPACE
	SET %(YQUERY,"HEAD")=$$^WWWTEXT(32024)
	SET %(YQUERY,"YKEY")=YKEY
	SET %(YQUERY,"YTRAKT")=YTRAKT
	SET %(YQUERY,"FORM")="INANG"   ;ERSTELLEN AUFTRAG ;mandate 
	SET %(YQUERY,"OFFSET")=""   ;ANZEIGE AB SUBSCRIPT ;Show Confirm. 
	MERGE %KEY=%(YQUERY)
	DO ^INAUFSORTI
	QUIT
	
START1
	NEW (%request,%session,%KEY,%,%ZCS,%CGIEVAR)
	DO ^WWWVAR  ;VORGABEN SETZEN ;typeset 
	IF $GET(YKEY)="" WRITE $$^WWWTEXT(374)_" !" QUIT  ;DATENSATZ AUSWÄHLEN ! ;data record pick out 
	IF $PIECE($GET(^INANG(YM,YKEY,1)),Y,2)'=0 WRITE $$^WWWTEXT(46) QUIT  ;KEINE DATEN VORHANDEN ;no on hand 
	SET %(YQUERY,"TARGET")=$GET(YTARGET)  ;TARGET DER AUSGABE ;the expenses 
	SET %(YQUERY,"FILE")="INSORTIMENT"
	SET %(YQUERY,"FIX")=YM
	SET %(YQUERY,"RECORD")="1,40"  ;FELDER, DIE ANGEZEIGT WERDEN (1,2,3,4)
	SET %(YQUERY,"YUCI")=$GET(YUCI)  ;NAMESPACE
	SET %(YQUERY,"HEAD")=$$^WWWTEXT(32024)
	SET %(YQUERY,"YKEY")=YKEY
	SET %(YQUERY,"YTRAKT")=YTRAKT
	SET %(YQUERY,"FORM")="INANG"   ;ERSTELLEN AUFTRAG ;mandate 
	SET %(YQUERY,"OFFSET")=""   ;ANZEIGE AB SUBSCRIPT ;Show Confirm. 
	MERGE %KEY=%(YQUERY)
	SET YKUNDE=$P($G(^INANG(YM,YKEY,1)),Y,1)
	Q:YKUNDE=""
	SET VORG(1)=YKUNDE
	SET VORG(2)=""        ;VON WENN "" DANN +$H-VORGABE TAGE
	SET VORG(3)=1         ;ÖFFENE AUFTRAG ;mandate 
	SET VORG(4)=1         ;ABGESCHLOSSENE AUFTRAG ;mandate 
	SET VORG(5)=""        ;KLASSE ;groovy 
	SET VORG(6)=""        ;WG ;IG 
	SET VORG(7)=""       ;BIS WENN "" DANN +$H
	DO ^INKUNDEARTIKEL(1)
	Q
	
START2 ;artikel des Lieferanten ;Suppliers 
	NEW (%request,%session,%KEY,%,%ZCS,%CGIEVAR)
	DO ^WWWVAR  ;VORGABEN SETZEN ;typeset 
	IF $GET(YKEY)="" WRITE $$^WWWTEXT(374)_" !" QUIT  ;DATENSATZ AUSWÄHLEN ! ;data record pick out 
	IF $PIECE($GET(^INANG(YM,YKEY,1)),Y,12)="" WRITE $$^WWWTEXT(46) QUIT  ;KEINE DATEN VORHANDEN ;no on hand 
	SET YKEY=$PIECE($GET(^INANG(YM,YKEY,1)),Y,12)
	SET YFORM="INANG"
	DO ^WWWFORMX
	DO ^WWWSTART()
	DO ^WWWBODY(2)
	SET YNOLINK=1  ;KEIN LINK ;no 
	DO ^INLIEFART
	QUIT
	;START2  ;ALT;FIS; 01.04.04
	NEW (%request,%session,%KEY,%,%ZCS,%CGIEVAR)
	DO ^WWWVAR  ;VORGABEN SETZEN ;typeset 
	IF $GET(YKEY)="" WRITE $$^WWWTEXT(374)_" !" QUIT  ;DATENSATZ AUSWÄHLEN ! ;data record pick out 
	SET %(YQUERY,"FILE")="INSORTIMENT"
	SET %(YQUERY,"FIX")=YM
	SET %(YQUERY,"RECORD")="1,40"  ;FELDER, DIE ANGEZEIGT WERDEN (1,2,3,4)
	SET %(YQUERY,"YUCI")=$GET(YUCI)  ;NAMESPACE
	SET %(YQUERY,"HEAD")=$$^WWWTEXT(32024)
	SET %(YQUERY,"YKEY")=YKEY
	SET %(YQUERY,"YTRAKT")=YTRAKT
	SET %(YQUERY,"FORM")="INANG"   ;ERSTELLEN AUFTRAG ;mandate 
	SET %(YQUERY,"OFFSET")=""   ;ANZEIGE AB SUBSCRIPT ;Show Confirm. 
	MERGE %KEY=%(YQUERY)
	SET YKUNDE=$GET(YKEY)
	SET VORG(1)=YKUNDE
	SET VORG(2)=""        ;VON WENN "" DANN +$H-VORGABE TAGE
	SET VORG(3)=1         ;ÖFFENE AUFTRAG ;mandate 
	SET VORG(4)=1         ;ABGESCHLOSSENE AUFTRAG ;mandate 
	SET VORG(5)=""        ;KLASSE ;groovy 
	SET VORG(6)=""        ;WG ;IG 
	SET VORG(7)=""       ;BIS WENN "" DANN +$H
	DO ^INKUNDEARTIKEL(1)
	Q
]]></Routine>
</Export>