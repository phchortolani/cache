<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="22" zv="CACHE" ts="2001-01-01 00:00:00">
<Routine name="WWWLNG5" type="MAC" languagemode="0" timestamp="58440,0"><![CDATA[
WWWLNG5 ;WWWLNG5;DT;FRAGE NACH SPRACHENTEXTEN UND TAUSCHEN ;26.10.1998
	;
	;/------------------------------------------------------------------\
	;| Description of Function :
	;|		FRAGE NACH SPRACHENTEXTEN UND TAUSCHEN 
	;|
	;| Inputs : 
	;|
	;|
	;| ByRef :
	;|
	;|
	;| Returns :
	;|
	;|
	;| History :
	;|
	;| DT	26.10.1998
	;|
	;\------------------------------------------------------------------/
	;
	NEW YWWW,NACH,VON,N,F,ABW,LNG,TEXT0,TEXT1,TEXT,AUTOMATIC,SCHLUE0,SCHLUE1,I,NEU
	;VORG(1)= SPRACHE ;Language 
	;VORG(2)= TAUSCHEN VON  TEXT ;barter Text 
	;VORG(3)= TAUSCHEN NACH  TEXT ;barter within Text 
	;VORG(4)= NUR WWWFORMULARE ;only 
	DO ^WWWVORG
	SET QUIT=0
	SET NEU=1
	SET VON="DE"
	SET NACH=$GET(VORG(1))
	IF NACH="" SET NACH="EN"
	SET YWWW=0
	IF $GET(VORG(4))'=1 SET YWWW=1      ;BEC;26298;10.09.04;AUCH NICHT WWWs
	SET FROM=$GET(VORG(2))
	QUIT:FROM=""
	SET TO=$GET(VORG(3))
	QUIT:TO=""
	FOR  DO FRAGE  QUIT:QUIT=1
	DO ^WWWINFO($$^WWWTEXT(30013))
	QUIT
	
FRAGE ;
	SET Q=0
	IF Q=0 SET F="" FOR  SET F=$ORDER(^WWW009(0,VON,F)) QUIT:F=""  DO  QUIT:Q=1
	. IF NEU=0 QUIT:$GET(^WWW009(0,NACH,F,1))'=""
	. SET TEXT0=$PIECE(^WWW009(0,VON,F,1),Y,1)
	. SET TEXT1=$PIECE($GET(^WWW009(0,NACH,F,1)),Y,1)
	. SET SCHLUE0="^WWW009(0,"_VON_","_F_",1)"
	. SET SCHLUE1="^WWW009(0,"_NACH_","_F_",1)"
	. DO UEBER
	. SET Q=1
	. DO TEXTERF
	. QUIT
	QUIT:Q=1
	SET F="" FOR  SET F=$ORDER(^WWW100(0,F)) QUIT:F=""  QUIT:Q=1  SET N="" FOR  SET N=$ORDER(^WWW100(0,F,VON,N)) QUIT:N=""  DO  QUIT:Q=1
	. QUIT:Q=1
	. IF NEU=0 QUIT:$DATA(^WWW100(0,F,NACH,N))
	. SET TEXT0=$PIECE(^WWW100(0,F,VON,N,1),Y,1)
	. QUIT:TEXT0=""
	. SET TEXT1=$PIECE($GET(^WWW100(0,F,NACH,N,1)),Y,1)
	. SET SCHLUE0="^WWW100(0,"_F_","_VON_","_N_",1)"
	. SET SCHLUE1="^WWW100(0,"_F_","_NACH_","_N_",1)"
	. DO UEBER
	. SET Q=1
	. DO TEXTERF
	. QUIT
	QUIT:Q=1
	SET F="" FOR  SET F=$ORDER(^WWW101(0,F)) QUIT:F=""  SET N="" FOR  SET N=$ORDER(^WWW101(0,F,VON,N)) QUIT:N=""  DO  QUIT:Q=1
	. QUIT:Q=1
	. IF NEU=0 QUIT:$DATA(^WWW101(0,F,NACH,N))
	. SET TEXT0=$PIECE(^WWW101(0,F,VON,N,1),Y,1)
	. SET TEXT1=$PIECE($GET(^WWW101(0,F,NACH,N,1)),Y,1)
	. SET SCHLUE0="^WWW101(0,"_F_","_VON_","_N_",1)"
	. SET SCHLUE1="^WWW101(0,"_F_","_NACH_","_N_",1)"
	. DO UEBER
	. SET Q=1
	. DO TEXTERF
	. QUIT
	QUIT:Q=1
	SET F="" FOR  SET F=$ORDER(^INPARA(YM,F)) QUIT:F=""  QUIT:Q=1  SET N="" FOR  SET N=$ORDER(^INPARA(YM,F,VON,N)) QUIT:N=""  DO  QUIT:Q=1
	. QUIT:Q=1
	. QUIT:$EXTRACT(F,1,5)="WAREN"
	. IF NEU=0 QUIT:$DATA(^INPARA(YM,F,NACH,N))
	. SET TEXT0=$PIECE(^INPARA(YM,F,VON,N,1),Y,1)
	. QUIT:TEXT0=""
	. SET TEXT1=$PIECE($GET(^INPARA(YM,F,NACH,N,1)),Y,1)
	. SET SCHLUE0="^INPARA(YM,"_F_","_VON_","_N_",1)"
	. SET SCHLUE1="^INPARA(YM,"_F_","_NACH_","_N_",1)"
	. DO UEBER
	. SET Q=1
	. DO TEXTERF
	. QUIT
	QUIT:Q=1
	SET F="" FOR  SET F=$ORDER(^WWW004(0,F)) QUIT:F=""  QUIT:Q=1  SET N="" FOR  SET N=$ORDER(^WWW004(0,F,N)) QUIT:N=""  DO  QUIT:Q=1
	. IF NACH="DE" IF $FIND(F,"@net")!($FIND(F,"Demo"))!($FIND(F,"Time")) QUIT
	. IF YWWW=0 IF $FIND(F,"@net") QUIT  ;KEINE WWW´S   ;no 
	. QUIT:Q=1
	. IF NEU=0 QUIT:$GET(^WWW0041(0,F,N,NACH,1))'=""
	. SET TEXT0=$PIECE(^WWW004(0,F,N,1),Y,1)
	. IF $GET(^WWW0041(0,F,N,VON,1))'="" SET TEXT0=$PIECE($GET(^WWW0041(0,F,N,VON,1)),Y,1)
	. SET TEXT1=$PIECE($GET(^WWW0041(0,F,N,NACH,1)),Y,1)
	. SET SCHLUE0="^WWW004(0,"_F_","_N_",1)"
	. SET SCHLUE1="^WWW0041(0,"_F_","_N_","_NACH_",1)"
	. DO UEBER
	. SET Q=1
	. DO TEXTERF
	. QUIT
	QUIT:Q=1
	SET F="" FOR  SET F=$ORDER(^WWW003(0,F)) QUIT:F=""  QUIT:Q=1  SET N="" FOR  SET N=$ORDER(^WWW003(0,F,N)) QUIT:N=""  DO  QUIT:Q=1
	. IF NACH="DE" IF $EXTRACT(F)="W"!($EXTRACT(F)="I")!($EXTRACT(F,1,3)="TER") QUIT
	. IF YWWW=1 IF $EXTRACT(F,1,3)'="WWW" QUIT  ;NUR WWW´S  ;only 
	. IF YWWW=0 IF $EXTRACT(F,1,3)="WWW" QUIT  ;KEINE WWW´S  ;no 
	. QUIT:Q=1
	. SET TEXT0=$PIECE(^WWW003(0,F,N,1),Y,2)
	. IF NEU=0 QUIT:$TRANSLATE($PIECE($GET(^WWW0031(0,F,N,NACH,1)),Y,1),"| ")'=""
	. IF $GET(^WWW0031(0,F,N,VON,1))'="" SET TEXT0=$PIECE($GET(^WWW0031(0,F,N,VON,1)),Y,1)
	. SET TEXT1=$PIECE($GET(^WWW0031(0,F,N,NACH,1)),Y,1)
	. SET SCHLUE0="^WWW003(0,"_F_","_N_",1)"
	. SET SCHLUE1="^WWW0031(0,"_F_","_N_","_NACH_",1)"
	. DO UEBER
	. SET Q=1
	. DO TEXTERF
	. QUIT
	QUIT:Q=1
	SET F="" FOR  SET F=$ORDER(^WWW002(0,F)) QUIT:F=""  QUIT:Q=1  SET N="" FOR  SET N=$ORDER(^WWW002(0,F,N)) QUIT:N=""  DO  QUIT:Q=1
	. IF NACH="DE" IF $EXTRACT(F)="W"!($EXTRACT(F)="I")!($EXTRACT(F,1,3)="TER") QUIT 
	. IF YWWW=1 IF $EXTRACT(F,1,3)'="WWW" QUIT  ;NUR WWW´S  ;only 
	. IF YWWW=0 IF $EXTRACT(F,1,3)="WWW" QUIT  ;KEINE WWW´S  ;no 
	. QUIT:Q=1
	. SET TEXT0=$PIECE(^WWW002(0,F,N,1),Y,2)
	. IF NEU=0 QUIT:$GET(^WWW0021(0,F,N,NACH,1))'=""
	. IF $GET(^WWW0021(0,F,N,VON,1))'="" SET TEXT0=$PIECE($GET(^WWW0021(0,F,N,VON,1)),Y,1)
	. SET TEXT1=$PIECE($GET(^WWW0021(0,F,N,NACH,1)),Y,1)
	. SET SCHLUE0="^WWW002(0,"_F_","_N_",1)"
	. SET SCHLUE1="^WWW0021(0,"_F_","_N_","_NACH_",1)"
	. DO UEBER
	. SET Q=1
	. DO TEXTERF
	. QUIT
	SET F="" FOR  SET F=$ORDER(^WWW001(0,F)) QUIT:F=""  DO  QUIT:Q=1
	. IF NACH="DE" IF $EXTRACT(F)="W"!($EXTRACT(F)="I")!($EXTRACT(F,1,3)="TER") QUIT 
	. IF YWWW=1 IF $EXTRACT(F,1,3)'="WWW" QUIT  ;NUR WWW´S  ;only 
	. IF YWWW=0 IF $EXTRACT(F,1,3)="WWW" QUIT  ;KEINE WWW´S  ;no 
	. QUIT:Q=1
	. IF NEU=0 QUIT:$GET(^WWW0011(0,F,NACH,1))'=""
	. SET TEXT0=$PIECE(^WWW001(0,F,1),Y,1)
	. QUIT:TEXT0=""
	. IF $GET(^WWW0011(0,F,VON,1))'="" SET TEXT0=$PIECE($GET(^WWW0011(0,F,VON,1)),Y,1)
	. SET TEXT1=$PIECE($GET(^WWW0011(0,F,NACH,1)),Y,1)
	. SET SCHLUE0="^WWW001(0,"_F_",1)"
	. SET SCHLUE1="^WWW0011(0,"_F_","_NACH_",1)"
	. DO UEBER
	. SET Q=1
	. DO TEXTERF
	. QUIT
	SET F="" FOR  SET F=$ORDER(^WWW122(0,F)) QUIT:F=""  QUIT:Q=1  SET N="" FOR  SET N=$ORDER(^WWW122(0,F,N)) QUIT:N=""  DO  QUIT:Q=1
	. IF NACH="DE" IF $EXTRACT(F)="W"!($EXTRACT(F)="I")!($EXTRACT(F,1,3)="TER") QUIT 
	. IF YWWW=1 IF $EXTRACT(F,1,3)'="WWW" QUIT  ;NUR WWW´S  ;only 
	. IF YWWW=0 IF $EXTRACT(F,1,3)="WWW" QUIT  ;KEINE WWW´S  ;no 
	. QUIT:Q=1
	. SET TEXT0=$PIECE(^WWW122(0,F,N,1),Y,12)
	. IF NEU=0 QUIT:$GET(^WWW1221(0,F,N,NACH,1))'=""
	. QUIT:$PIECE($GET(^WWW122(0,F,N,1)),Y,1)'=""   ;DATEN AUS DATEI VORHANDEN ;out of data file on hand 
	. QUIT:TEXT0=""
	. IF $GET(^WWW1221(0,F,N,VON,1))'="" SET TEXT0=$PIECE($GET(^WWW1221(0,F,N,VON,1)),Y,1)
	. SET TEXT1=$PIECE($GET(^WWW1221(0,F,N,NACH,1)),Y,1)
	. SET SCHLUE0="^WWW122(0,"_F_","_N_",1)"
	. SET SCHLUE1="^WWW1221(0,"_F_","_N_","_NACH_",1)"
	. DO UEBER
	. SET Q=1
	. DO TEXTERF
	. QUIT
	SET F="" FOR  SET F=$ORDER(^WWW1210(0,F)) QUIT:F=""  QUIT:Q=1  SET N="" FOR  SET N=$ORDER(^WWW1210(0,F,N)) QUIT:N=""  DO  QUIT:Q=1
	. IF NACH="DE" IF $EXTRACT(F)="W"!($EXTRACT(F)="I")!($EXTRACT(F,1,3)="TER") QUIT 
	. IF YWWW=1 IF $EXTRACT(F,1,3)'="WWW" QUIT  ;NUR WWW´S  ;only 
	. IF YWWW=0 IF $EXTRACT(F,1,3)="WWW" QUIT  ;KEINE WWW´S  ;no 
	. QUIT:Q=1
	. IF NEU=0 QUIT:$GET(^WWW1211(0,F,N,NACH,1))'=""
	. SET TEXT0=$PIECE(^WWW1210(0,F,N,1),Y,1)
	. IF $GET(^WWW1211(0,F,N,VON,1))'="" SET TEXT0=$PIECE($GET(^WWW1211(0,F,N,VON,1)),Y,1)
	. SET TEXT1=$PIECE($GET(^WWW1211(0,F,N,NACH,1)),Y,1)
	. SET SCHLUE0="^WWW1210(0,"_F_","_N_",1)"
	. SET SCHLUE1="^WWW1211(0,"_F_","_N_","_NACH_",1)"
	. DO UEBER
	. SET Q=1
	. DO TEXTERF
	. QUIT
	SET F="" FOR  SET F=$ORDER(^WWW1203(0,F)) QUIT:F=""  QUIT:Q=1  SET N="" FOR  SET N=$ORDER(^WWW1203(0,F,VON,N)) QUIT:N=""  DO  QUIT:Q=1
	. IF NACH="DE" IF $EXTRACT(F)="W"!($EXTRACT(F)="I")!($EXTRACT(F,1,3)="TER") QUIT 
	. IF YWWW=1 IF $EXTRACT(F,1,3)'="WWW" QUIT  ;NUR WWW´S  ;only 
	. IF YWWW=0 IF $EXTRACT(F,1,3)="WWW" QUIT  ;KEINE WWW´S  ;no 
	. QUIT:Q=1
	. IF NEU=0 QUIT:$GET(^WWW1203(0,F,NACH,N,1))'=""
	. SET TEXT0=$PIECE(^WWW1203(0,F,VON,N,1),Y,1)
	. SET TEXT1=$PIECE($GET(^WWW1203(0,F,NACH,N,1)),Y,1)
	. SET SCHLUE0="^WWW1203(0,"_F_","_VON_","_N_",1)"
	. SET SCHLUE1="^WWW1203(0,"_F_","_NACH_","_N_",1)"
	. DO UEBER
	. SET Q=1
	. DO TEXTERF
	. QUIT
	SET F="" FOR  SET F=$ORDER(^WWW124(0,F)) QUIT:F=""  QUIT:Q=1  SET N="" FOR  SET N=$ORDER(^WWW124(0,F,VON,N)) QUIT:N=""  DO  QUIT:Q=1
	. IF NACH="DE" IF $EXTRACT(F)="W"!($EXTRACT(F)="I")!($EXTRACT(F,1,3)="TER") QUIT 
	. IF YWWW=1 IF $EXTRACT(F,1,3)'="WWW" QUIT  ;NUR WWW´S  ;only 
	. IF YWWW=0 IF $EXTRACT(F,1,3)="WWW" QUIT  ;KEINE WWW´S  ;no 
	. QUIT:Q=1
	. IF NEU=0 QUIT:$PIECE($GET(^WWW124(0,F,NACH,N,1)),Y,1)'=""
	. SET TEXT0=$PIECE(^WWW124(0,F,VON,N,1),Y,1)
	. SET TEXT1=$PIECE($GET(^WWW124(0,F,NACH,N,1)),Y,1)
	. SET SCHLUE0="^WWW124(0,"_F_","_VON_","_N_",1)"
	. SET SCHLUE1="^WWW124(0,"_F_","_NACH_","_N_",1)"
	. DO UEBER
	. SET Q=1
	. DO TEXTERF
	. QUIT
	SET F="" FOR  SET F=$ORDER(^WWW120(0,F)) QUIT:F=""  DO  QUIT:Q=1
	. IF NACH="DE" IF $EXTRACT(F)="W"!($EXTRACT(F)="I")!($EXTRACT(F,1,3)="TER") QUIT
	. IF YWWW=1 IF $EXTRACT(F,1,3)'="WWW" QUIT  ;NUR WWW´S  ;only 
	. IF YWWW=0 IF $EXTRACT(F,1,3)="WWW" QUIT  ;KEINE WWW´S  ;no 
	. QUIT:Q=1
	. IF NEU=0 QUIT:$GET(^WWW1201(0,F,NACH,1))'=""
	. SET TEXT0=$PIECE(^WWW120(0,F,1),Y,1)
	. QUIT:TEXT0=""
	. IF $GET(^WWW1201(0,F,VON,1))'="" SET TEXT0=$PIECE($GET(^WWW1201(0,F,VON,1)),Y,1)
	. SET TEXT1=$PIECE($GET(^WWW1201(0,F,NACH,1)),Y,1)
	. SET SCHLUE0="^WWW120(0,"_F_",1)"
	. SET SCHLUE1="^WWW1201(0,"_F_","_NACH_",1)"
	. DO UEBER
	. SET Q=1
	. DO TEXTERF
	. QUIT
	SET F="" FOR  SET F=$ORDER(^WWW127(0,F)) QUIT:F=""  QUIT:Q=1  SET N="" FOR  SET N=$ORDER(^WWW127(0,F,N)) QUIT:N=""  QUIT:Q=1  SET O="" FOR  SET O=$ORDER(^WWW127(0,F,N,O)) QUIT:O=""  DO  QUIT:Q=1
	. IF NACH="DE" IF $EXTRACT(F)="W"!($EXTRACT(F)="I")!($EXTRACT(F,1,3)="TER") QUIT
	. IF YWWW=1 IF $EXTRACT(F,1,3)'="WWW" QUIT  ;NUR WWW´S  ;only 
	. IF YWWW=0 IF $EXTRACT(F,1,3)="WWW" QUIT  ;KEINE WWW´S  ;no 
	. QUIT:Q=1
	. SET TEXT0=$PIECE($GET(^WWW127(0,F,N,O,VON,1)),Y,1)
	. IF NEU=0 QUIT:$GET(^WWW127(0,F,N,O,NACH,1))'=""
	. QUIT:TEXT0=""
	. SET TEXT1=$PIECE($GET(^WWW127(0,F,N,O,NACH,1)),Y,1)
	. SET SCHLUE0="^WWW127(0,"_F_","_N_","_O_","_VON_",1)"
	. SET SCHLUE1="^WWW127(0,"_F_","_N_","_O_","_NACH_",1)"
	. DO UEBER
	. SET Q=1
	. DO TEXTERF
	. QUIT
	QUIT:Q=1
	SET QUIT=1
	QUIT
	
UEBER ;UEBERSETZUNG
	QUIT
	
TEXTERF ;ERFASSUNG ;logging 
	SET Q=0
	QUIT:TEXT1=""
	QUIT:'$FIND(TEXT1,FROM)
	SET Q=0
	SET TEXT0=TEXT1_"*~~*"
	FOR  QUIT:$PIECE(TEXT0,FROM,2,999)=""  SET TEXT0=$PIECE(TEXT0,FROM,1)_TO_$PIECE(TEXT0,FROM,2,999)
	SET TEXT0=$PIECE(TEXT0,"*~~*",1)
	QUIT:$TRANSLATE(SCHLUE1," |_")=""
	SET SCHLUE=""
	FOR I=1:1 QUIT:$PIECE(SCHLUE1,",",I)=""  DO
	. SET SCH=$PIECE(SCHLUE1,",",I)
	. IF $PIECE(SCHLUE1,",",I+1)'="" IF I'=1 SET SCH=""""_SCH_""""
	. SET SCHLUE=SCHLUE_SCH
	. IF $PIECE(SCHLUE1,",",I+1)'="" SET SCHLUE=SCHLUE_","
	. QUIT
	IF $TRANSLATE(TEXT0," |_")'="" SET $PIECE(@SCHLUE,Y,1)=$TRANSLATE(TEXT0,""""_"'","´´")
	QUIT
]]></Routine>
</Export>