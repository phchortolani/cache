<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="22" zv="CACHE" ts="2001-01-01 00:00:00">
<Routine name="INDRUCK2" type="MAC" languagemode="0" timestamp="58440,0"><![CDATA[
INDRUCK2 ;INDRUCK2;DT;DRUCKEN ANSCHRIFT;22.02.2000  ; Compiled March 3, 2005 11:19:53
	;
	;/------------------------------------------------------------------\
	;| Description of Function :
	;|		DRUCKEN ANSCHRIFT
	;|
	;| Inputs : 
	;|
	;|
	;| ByRef :
	;|
	;|
	;| Returns :
	;|
	;|
	;| History :
	;| 30-May-2005		RobertW		SR12056: Attempt at Performance Increase
	;| DT	22.02.2000  
	;|
	;\------------------------------------------------------------------/
	;
	NEW YKUNDEX,YADRESX
	IF YSEITE'=1 IF $PIECE(YBELEG1,Y,11)'=1 QUIT   ;ANSCHRIFT AUCH AUF FOLGESEITEN? ;too upon 
	SET YKUNDEX=YKUNDE  ;ZWISCHENSPEICHERN
	SET YADRESX=YADRES
	IF $PIECE($GET(YVERBAND1),Y,71)=1 DO  ;VERBAND ERHÃ„LT RECHNUNG ;ligature tab 
	. SET YKUNDE=YVERBAND
	. SET YADRES=YVERBAND1
	. QUIT
	;
	IF $GET(YTEST)=1 DO   ;WEM;25073;16.02.2004;ANDERE ADRESSDATEI WENN BELEGDRUCKTEST
	. IF SPRACHE="DE" DO  QUIT
	. . SET YADRES=Y_Y_Y_"Muster Firma"_Y_Y_Y_Y_"Muster Firma"_Y_Y_"Musterstrasse 10"_Y_Y_"12345"_Y_Y_Y_0_Y_"Musterstadt"
	. . SET $PIECE(YADRES,Y,92)="Max Mustermann"   ; ANSPRECHPARTNER
	. . QUIT
	. SET YADRES=Y_Y_Y_"Sample Company"_Y_Y_Y_Y_"Sample Company"_Y_Y_"Sample Street 10"_Y_Y_"12345"_Y_Y_Y_0_Y_"Sample City" 
	. SET $PIECE(YADRES,Y,54)=1                  ; STEUERKENNZEICHEN INLAND
	. SET $PIECE(YADRES,Y,92)="John Doe"         ; ANSPRECHPARTNER
	. QUIT
	;
	IF YSEND=0 IF $PIECE(YADRES,Y,15)=1 IF $PIECE(YADRES,Y,24)'="" DO  ;VIA EMAIL
	. NEW YI,YPRINT,YKEY,YBACK
	. SET LFN=8
	. IF +$PIECE(YBELEG1,Y,9)'="" SET LFN=+$PIECE(YBELEG1,Y,9)-2        ;BEC;26820;15.12.04;VARABLE ADRESSZEILE
	. IF YBELEG'=1 IF YBELEG'=2 IF YBELEG'=5 IF YBELEG'=7 IF YBELEG'=3 QUIT
	. IF YBELEG=3!(YBELEG=13) IF $GET(YLIEFER)="" QUIT
	. IF YBELEG=1 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=D|MAIL^INANGEBOT1&YKEY="_YAUFTRAG
	. IF YBELEG=2 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=D|MAIL^INAB1&YKEY="_YAUFTRAG
	. IF YBELEG=3 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=D|MAIL^INAUFBES1&YKEY="_YAUFTRAG_","_$GET(YLIEFER)  ;BESTELLUNG ;sales order 
	. IF YBELEG=13 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=D|MAIL^INAUFBESTORNO&YKEY="_YAUFTRAG_","_$GET(YLIEFER)  ;BESTELLUNG ;sales order 
	. IF YBELEG=7 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=D|MAIL^INRECH1&YKEY="_YAUFTRAG
	. IF YBELEG=5 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=D|MAIL^INAUFAV1&YKEY="_YAUFTRAG
	. ;IF YBELEG=10 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=D|MAIL^INANGANF1&YKEY="_YAUFTRAG  ;ANFRAGE
	. DO VAR^WWWCGI
	. SET A=A_YI
	. SET A=A_""""
	. SET A=A_" TITLE="_""""_$$^WWWTEXT(34035,,1)_": "_$PIECE(YADRES,Y,24)_""""      ;BEC;26820;22.11.04
	. SET A=A_">"
	. SET A=A_$$^WWWTEXT(34035)     ;"via E-Mail";BEC;26820;22.11.04
	. SET A=A_"</A>"
	. DO SPE^INDRUCK
	. QUIT
	;
	;
	;IF YSEND=0 IF $PIECE(YADRES,Y,15)=2 IF $PIECE(YADRES,Y,22)'="" DO  ;VIA FAX
	IF YSEND=0 IF $PIECE(YADRES,Y,15)=2!($PIECE(YBELEG1,Y,210)=1) IF $PIECE(YADRES,Y,22)'="" DO  ;VIA FAX;BEC;27161;14.01.05
	. NEW YI,YPRINT,YKEY,YBACK
	. SET LFN=8
	. IF +$PIECE(YBELEG1,Y,9)'="" SET LFN=+$PIECE(YBELEG1,Y,9)-2        ;BEC;26820;15.12.04;VARABLE ADRESSZEILE
	. IF +$PIECE(YBELEG1,Y,9)'="" SET LFN=+$PIECE(YBELEG1,Y,9)-2        ;BEC;26820;15.12.04;VARABLE ADRESSZEILE
	. IF YBELEG'=1 IF YBELEG'=2 IF YBELEG'=5 IF YBELEG'=7 IF YBELEG'=3 QUIT 
	. IF YBELEG=3!(YBELEG=13) IF $GET(YLIEFER)="" QUIT
	. IF YBELEG=1 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=D|FAX^INANGEBOT1&YKEY="_YAUFTRAG
	. IF YBELEG=2 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=D|FAX^INAB1&YKEY="_YAUFTRAG
	. IF YBELEG=3 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=D|FAX^INAUFBES1&YKEY="_YAUFTRAG_","_$GET(YLIEFER)  ;BESTELLUNG ;sales order 
	. IF YBELEG=13 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=D|FAX^INAUFBESTORNO&YKEY="_YAUFTRAG_","_$GET(YLIEFER) 
	. IF YBELEG=7 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=D|FAX^INRECH1&YKEY="_YAUFTRAG
	. IF YBELEG=5 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=D|FAX^INAUFAV1&YKEY="_YAUFTRAG
	. DO VAR^WWWCGI
	. SET A=A_YI
	. SET A=A_""""
	. SET A=A_" TITLE="_""""_$$^WWWTEXT(34036,,1)_": "_$PIECE(YADRES,Y,22)_""""    ;;BEC;26820;22.11.04
	. SET A=A_">"
	. ;SET A=A_"via FAX"
	. SET A=A_$$^WWWTEXT(34036)    ;VIA FAX;BEC;26820;22.11.04
	. IF $GET(YFAX)'="" SET A=A_" "_YFAX
	. SET A=A_"</A>"
	. DO SPE^INDRUCK
	. QUIT
	;
	IF YSEND=0 IF $PIECE(YADRES,Y,15)=3 DO  ;IF $PIECE(YADRES,Y,24)'="" DO  ;VIA XML
	. NEW YI,YPRINT,YKEY,YBACK
	. SET LFN=8
	. IF +$PIECE(YBELEG1,Y,9)'="" SET LFN=+$PIECE(YBELEG1,Y,9)-2        ;BEC;26820;15.12.04;VARABLE ADRESSZEILE
	. IF YBELEG'=1 IF YBELEG'=2 IF YBELEG'=5 IF YBELEG'=7 IF YBELEG'=3 QUIT
	. IF YBELEG=3!(YBELEG=13) IF $GET(YLIEFER)="" QUIT
	. IF YBELEG=1 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=*D|XML^INANGEBOT1&YKEY="_YAUFTRAG
	. IF YBELEG=2 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=*D|XML^INAB1&YKEY="_YAUFTRAG
	. IF YBELEG=3 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=*D|XML^INAUFBES1&YKEY="_YAUFTRAG_","_$GET(YLIEFER)  ;BESTELLUNG ;sales order 
	. IF YBELEG=13 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=*D|XML^INAUFBESTORNO&YKEY="_YAUFTRAG_","_$GET(YLIEFER)
	. IF YBELEG=7 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=*D|XML^INRECH1&YKEY="_YAUFTRAG
	. IF YBELEG=5 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=*D|XML^INAUFAV1&YKEY="_YAUFTRAG
	. DO VAR^WWWCGI
	. SET A=A_YI
	. SET A=A_""""
	. SET A=A_">"
	. ;SET A=A_"via XML"
	. SET A=A_$$^WWWTEXT(33150)    ;VIA XML;BEC;26820;22.11.04
	. SET A=A_"</A>"
	. DO SPE^INDRUCK
	. QUIT
	;
	IF YSEND=0 IF $PIECE(YADRES,Y,15)=4 DO  ;IF $PIECE(YADRES,Y,24)'="" DO  ;VIA EDI
	. NEW YI,YPRINT,YKEY,YBACK
	. SET LFN=8
	. IF +$PIECE(YBELEG1,Y,9)'="" SET LFN=+$PIECE(YBELEG1,Y,9)-2        ;BEC;26820;15.12.04;VARABLE ADRESSZEILE
	. IF YBELEG'=1 IF YBELEG'=2 IF YBELEG'=5 IF YBELEG'=7 IF YBELEG'=3 QUIT
	. IF YBELEG=3!(YBELEG=13) IF $GET(YLIEFER)="" QUIT
	. IF YBELEG=1 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=*D|EDI^INANGEBOT1&YKEY="_YAUFTRAG
	. IF YBELEG=2 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=*D|EDI^INAB1&YKEY="_YAUFTRAG
	. IF YBELEG=3 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=*D|EDI^INAUFBES1&YKEY="_YAUFTRAG_","_$GET(YLIEFER)  ;BESTELLUNG ;sales order
	. IF YBELEG=13 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=*D|EDI^INAUFBESTORNO&YKEY="_YAUFTRAG_","_$GET(YLIEFER) 
	. IF YBELEG=7 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=*D|EDI^INRECH1&YKEY="_YAUFTRAG
	. IF YBELEG=5 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=*D|EDI^INAUFAV1&YKEY="_YAUFTRAG
	. DO VAR^WWWCGI
	. SET A=A_YI
	. SET A=A_""""
	. SET A=A_">"
	. ;SET A=A_"via EDI"
	. SET A=A_$$^WWWTEXT(34046)    ;VIA EDIFACT;BEC;26820;22.11.04
	. SET A=A_"</A>"
	. DO SPE^INDRUCK
	. QUIT
	;
	IF YSEND=0 IF $PIECE(YADRES,Y,15)=5 DO  ;VIA FTP
	. NEW YI,YPRINT,YKEY,YBACK
	. SET LFN=8
	. IF +$PIECE(YBELEG1,Y,9)'="" SET LFN=+$PIECE(YBELEG1,Y,9)-2        ;BEC;26820;15.12.04;VARABLE ADRESSZEILE
	. IF YBELEG'=1 IF YBELEG'=2 IF YBELEG'=5 IF YBELEG'=7 IF YBELEG'=3 QUIT
	. IF YBELEG=3!(YBELEG=13) IF $GET(YLIEFER)="" QUIT
	. IF YBELEG=1 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=*D|FTP^INANGEBOT1&YKEY="_YAUFTRAG
	. IF YBELEG=2 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=*D|FTP^INAB1&YKEY="_YAUFTRAG
	. IF YBELEG=3 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=*D|FTP^INAUFBES1&YKEY="_YAUFTRAG_","_$GET(YLIEFER)  ;BESTELLUNG ;sales order
	. IF YBELEG=13 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=*D|FTP^INAUFBESTORNO&YKEY="_YAUFTRAG_","_$GET(YLIEFER)  
	. IF YBELEG=7 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=*D|FTP^INRECH1&YKEY="_YAUFTRAG
	. IF YBELEG=5 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=*D|FTP^INAUFAV1&YKEY="_YAUFTRAG
	. DO VAR^WWWCGI
	. SET A=A_YI
	. SET A=A_""""
	. SET A=A_">"
	. ;SET A=A_"via FTP"
	. SET A=A_$$^WWWTEXT(33152)    ;VIA FTP;BEC;26820;22.11.04
	. SET A=A_"</A>"
	. DO SPE^INDRUCK
	. QUIT
	;
	IF YSEND=0 IF $PIECE(YADRES,Y,15)=6 DO   ;IF $PIECE(YADRES,Y,24)'="" DO  ;VIA EDIPRO
	. NEW YI,YPRINT,YKEY,YBACK
	. SET LFN=8
	. IF +$PIECE(YBELEG1,Y,9)'="" SET LFN=+$PIECE(YBELEG1,Y,9)-2        ;BEC;26820;15.12.04;VARABLE ADRESSZEILE
	. IF YBELEG'=1 IF YBELEG'=2 IF YBELEG'=5 IF YBELEG'=7 IF YBELEG'=3 QUIT
	. IF YBELEG=3!(YBELEG=13) IF $GET(YLIEFER)="" QUIT
	. IF YBELEG=1 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=*D|EDIP^INANGEBOT1&YKEY="_YAUFTRAG
	. IF YBELEG=2 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=*D|EDIP^INAB1&YKEY="_YAUFTRAG
	. IF YBELEG=3 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=*D|EDIP^INAUFBES1&YKEY="_YAUFTRAG_","_$GET(YLIEFER)  ;BESTELLUNG ;sales order 
	. IF YBELEG=13 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=*D|EDIP^INAUFBESTORNO&YKEY="_YAUFTRAG_","_$GET(YLIEFER) 
	. IF YBELEG=7 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=*D|EDIP^INRECH1&YKEY="_YAUFTRAG
	. IF YBELEG=5 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=*D|EDIP^INAUFAV1&YKEY="_YAUFTRAG
	. DO VAR^WWWCGI
	. SET A=A_YI
	. SET A=A_""""
	. SET A=A_">"
	. ;SET A=A_"via EDIPro"
	. SET A=A_$$^WWWTEXT(34043)    ;VIA EDIPro;BEC;26820;22.11.04
	. SET A=A_"</A>"
	. DO SPE^INDRUCK
	. QUIT
	;
	IF YSEND=0 IF $PIECE(YADRES,Y,15)=7 DO  ;VIA PDF
	. NEW YI,YPRINT,YKEY,YBACK
	. SET LFN=8
	. IF +$PIECE(YBELEG1,Y,9)'="" SET LFN=+$PIECE(YBELEG1,Y,9)-2        ;BEC;26820;15.12.04;VARABLE ADRESSZEILE
	. IF YBELEG'=1 IF YBELEG'=2 IF YBELEG'=5 IF YBELEG'=7 IF YBELEG'=3 QUIT
	. IF YBELEG=3!(YBELEG=13) IF $GET(YLIEFER)="" QUIT
	. IF YBELEG=1 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=D|PDF^INANGEBOT1&YKEY="_YAUFTRAG
	. IF YBELEG=2 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=D|PDF^INAB1&YKEY="_YAUFTRAG
	. IF YBELEG=3 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=D|PDF^INAUFBES1&YKEY="_YAUFTRAG_","_$GET(YLIEFER)  ;BESTELLUNG ;sales order 
	. IF YBELEG=13 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=D|PDF^INAUFBESTORNO&YKEY="_YAUFTRAG_","_$GET(YLIEFER) 
	. IF YBELEG=7 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=D|PDF^INRECH1&YKEY="_YAUFTRAG
	. IF YBELEG=5 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=D|PDF^INAUFAV1&YKEY="_YAUFTRAG
	. DO VAR^WWWCGI
	. SET A=A_YI
	. SET A=A_""""
	. SET A=A_">"
	. SET A=A_"via PDF"
	. SET A=A_$$^WWWTEXT(34044)    ;VIA PDF;BEC;26820;22.11.04
	. SET A=A_"</A>"
	. DO SPE^INDRUCK
	. QUIT
	;
	IF YSEND=0 IF $PIECE(YADRES,Y,15)=9 DO   ;IF $PIECE(YADRES,Y,24)'="" DO  ;VIA STANDARDSCHNITTSTELLE;FIS;20.02.04
	. NEW YI,YPRINT,YKEY,YBACK
	. SET LFN=8
	. IF +$PIECE(YBELEG1,Y,9)'="" SET LFN=+$PIECE(YBELEG1,Y,9)-2        ;BEC;26820;15.12.04;VARABLE ADRESSZEILE
	. IF YBELEG'=1 IF YBELEG'=2 IF YBELEG'=5 IF YBELEG'=7 IF YBELEG'=3 QUIT
	. IF YBELEG=3!(YBELEG=13) IF $GET(YLIEFER)="" QUIT
	. IF YBELEG=1 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=*D|STDIF^INANGEBOT1&YKEY="_YAUFTRAG
	. IF YBELEG=2 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=*D|STDIF^INAB1&YKEY="_YAUFTRAG
	. IF YBELEG=3 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=*D|STDIF^INAUFBES1&YKEY="_YAUFTRAG_","_$GET(YLIEFER)  ;BESTELLUNG ;sales order
	. IF YBELEG=13 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=*D|STDIF^INAUFBESTORNO&YKEY="_YAUFTRAG_","_$GET(YLIEFER)  
	. IF YBELEG=7 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=*D|STDIF^INRECH1&YKEY="_YAUFTRAG
	. IF YBELEG=5 SET A="<A HREF="_""""_YAKTION_"EP=WWWMANU&YEXEC=*D|STDIF^INAUFAV1&YKEY="_YAUFTRAG
	. DO VAR^WWWCGI
	. SET A=A_YI
	. SET A=A_""""
	. SET A=A_">"
	. ;SET A=A_"via "_$PIECE($GET(^WWW101(0,"MEDIUM1",SPRACHE,9,1)),Y,1)
	. ;SET A=A_"via "_$PIECE($GET(^WWW101(0,"MEDIUM1",SPRACHE,9,1)),Y,1)     ;BEC;25866;07.06.04;DA ZENTRALE DATEI
	. SET A=A_$$^WWWTEXT(34045)_" "_$PIECE($GET(^WWW101(0,"MEDIUM1",SPRACHE,9,1)),Y,1)     ;BEC;26820;22.11.04
	. SET A=A_"</A>"
	. DO SPE^INDRUCK
	. QUIT
	;
	SET YTAB=$EXTRACT("                                                                           ",1,+$PIECE(YBELEG1,Y,10))  ;IN SPALTE ;within rift 
	DO SENDVIA
	IF +$PIECE(YBELEG1,Y,9)'=0 SET LFN=$PIECE(YBELEG1,Y,9)  ;AB ZEILE ;Confirm. 
	IF LFN="" SET LFN=9
	SET YTAB=$EXTRACT("                                                                           ",1,+$PIECE(YBELEG1,Y,10))  ;IN SPALTE ;within rift 
	DO
	. IF YBELEG=5!(YBELEG=6) DO LIEFER QUIT  ;,SENDVIA QUIT  ;AN LIEFERANSCHRIFT (KEIN POSTFACH)
	. DO POST QUIT  ;,SENDVIA   ;AN POSTANSCHRIFT
	. QUIT
	;
	SET YKUNDE=YKUNDEX   ;ZURUECK   
	SET YADRES=YADRESX
	QUIT
	;
	
POST ;POSTFACHANSCHRIFT
	;
	IF SPRACHE'="EN" IF +$PIECE(YADRES,Y,3)'=0 SET A=YTAB_$PIECE($GET(^INPARA(YM,"ANREDE",SPRACHE,$PIECE(YADRES,Y,3),1)),Y,1) DO SPE^INDRUCK   ;ANREDE ;salutation 
	IF $PIECE(YADRES,Y,11)'="" DO 
	. IF SPRACHE="DE" IF '$FIND($PIECE(YADRES,Y,11),"Post") SET $PIECE(YADRES,Y,11)="Postfach "_$PIECE(YADRES,Y,11) 
	. SET $PIECE(YADRES,Y,10)=$PIECE(YADRES,Y,11)  ;POSTFACH IN STRASSE ;within 
	. QUIT
	IF $PIECE(YADRES,Y,11)'="" IF $PIECE(YADRES,Y,13)'="" SET $PIECE(YADRES,Y,12)=$PIECE(YADRES,Y,13)  ;POSTFACHPLZ IN PLZ ;within ZIP 
	IF $PIECE(YADRES,Y,4)'="" SET A=YTAB_$PIECE(YADRES,Y,4) DO SPE^INDRUCK   ;ANSCHRIFT ZEILE 1
	IF $PIECE(YADRES,Y,6)'="" SET A=YTAB_$PIECE(YADRES,Y,6) DO SPE^INDRUCK   ;ANSCHRIFT ZEILE 2
	IF $PIECE(YADRES,Y,7)'="" SET A=YTAB_$PIECE(YADRES,Y,7) DO SPE^INDRUCK   ;ANSCHRIFT ZEILE 3
	IF $PIECE(YBELEG1,Y,27)=1 DO  ;Z.h. ANSPRECHPARTNER;FAN;2.5.2003;23059;FITCOM
	. IF $PIECE($GET(^INUSER(YM,YBED,1)),Y,25)="" IF $PIECE(YADRES,Y,92)'="" SET A=YTAB_$$^WWWTEXT(32226)_" "_$PIECE(YADRES,Y,92) DO SPE^INDRUCK QUIT  ;ANSCHRIFT ZEILE 3
	. IF $PIECE($GET(^INUSER(YM,YBED,1)),Y,25)'="" SET A=YTAB_$$^WWWTEXT(32226)_" "_$PIECE($GET(^INUSER(YM,YBED,1)),Y,25) DO SPE^INDRUCK QUIT  ;ANSCHRIFT ZEILE 3
	. IF YBELEG'=3 IF YBELEG'=10 IF $PIECE(YAUFTRAG1,Y,10)'="" SET A=YTAB_$$^WWWTEXT(32226)_" "_$PIECE(YAUFTRAG1,Y,10) DO SPE^INDRUCK   ;ANSCHRIFT ZEILE 3
	. QUIT
	IF $PIECE(YBELEG1,Y,27)'=1 DO  ;Z.h. ANSPRECHPARTNER;FAN;MAY 2003 ;buff 
	. ;IF $P($G(^INUSER(YM,YBED,1)),Y,25)="" IF $PIECE(YADRES,Y,92)'="" SET A=YTAB_$$^WWWTEXT(32226)_" "_$PIECE(YADRES,Y,92) DO SPE^INDRUCK QUIT  ;ANSCHRIFT ZEILE 3
	. IF $PIECE($GET(^INUSER(YM,YBED,1)),Y,25)'="" SET A=YTAB_$$^WWWTEXT(32226)_" "_$PIECE($GET(^INUSER(YM,YBED,1)),Y,25) DO SPE^INDRUCK QUIT  ;ANSCHRIFT ZEILE 3
	. ;IF YBELEG'=3 IF YBELEG'=10 IF $PIECE(YAUFTRAG1,Y,10)'="" SET A=YTAB_$$^WWWTEXT(32226)_" "_$PIECE(YAUFTRAG1,Y,10) DO SPE^INDRUCK   ;ANSCHRIFT ZEILE 3
	. QUIT
	IF $PIECE(YADRES,Y,10)'="" SET A=YTAB_$PIECE(YADRES,Y,10) DO SPE^INDRUCK   ;STRASSE
	SET LFN=LFN+1  ;EINE ZEILE LEER ;one void 
	;
	SET A=YTAB
	IF $PIECE($GET(^INVORG(YM,YM,1)),Y,50)'=1 DO  ;PLZ VOR ANSCHRIFT ;ZIP pre- 
	. NEW YSPRACHE
	. SET YSPRACHE=SPRACHE
	. IF $PIECE(YADRES,Y,17)="DE" SET YSPRACHE="DE"
	. IF $PIECE($GET(^INVORG(YM,YM,1)),Y,95)=1 DO  ;BUNDESLAND DRUCKEN;23531;ULM;29.04.2003
	. . NEW COUNTRY,STATE
	. . SET COUNTRY=$PIECE(YADRES,Y,17)  ;BUNDESLAND LÃ„NDERABHÃ„NGIG;FIS;12.02.04;24962
	. . IF +COUNTRY=0 SET COUNTRY=$GET(YCOUNTRY)
	. . SET STATE=$PIECE(YADRES,Y,14)
	. . ;IF YSPRACHE="DE" IF $PIECE(YADRES,Y,14)'="" SET $PIECE(YADRES,Y,14)=$PIECE($GET(^WWW101(0,"BUNDESLAND",YSPRACHE,$PIECE(YADRES,Y,14),1)),Y,1)
	. . IF YSPRACHE="DE" IF STATE'="" SET STATE=$PIECE($GET(^WWW102(0,"BUNDESLAND",COUNTRY,STATE,1)),Y,1)
	. . IF STATE'="" SET A=A_STATE_" "
	. . QUIT
	. IF $PIECE(YADRES,Y,12)'="" SET A=A_$PIECE(YADRES,Y,12)_" "  
	. IF $PIECE(YADRES,Y,16)'="" SET A=A_$PIECE(YADRES,Y,16)  ;PLZ VOR ORT ;ZIP pre- village 
	. QUIT
	;
	IF $PIECE($GET(^INVORG(YM,YM,1)),Y,50)=1 DO  ;PLZ NACH ANSCHRIFT ;ZIP within 
	. NEW YSPRACHE
	. SET YSPRACHE=SPRACHE
	. IF $PIECE(YADRES,Y,17)="DE" SET YSPRACHE="DE"
	. IF $PIECE($GET(^INVORG(YM,YM,1)),Y,95)=1 DO  ;BUNDESLAND DRUCKEN;23531;ULM;29.04.2003
	. . NEW COUNTRY,STATE
	. . SET COUNTRY=$PIECE(YADRES,Y,17)  ;BUNDESLAND LÃ„NDERABHÃ„NGIG;FIS;12.02.04;24962
	. . IF +COUNTRY=0 SET COUNTRY=$GET(YCOUNTRY) 
	. . SET STATE=$PIECE(YADRES,Y,14)
	. . ;IF YSPRACHE="DE" IF $PIECE(YADRES,Y,14)'="" SET $PIECE(YADRES,Y,14)=$PIECE($GET(^WWW101(0,"BUNDESLAND",YSPRACHE,$PIECE(YADRES,Y,14),1)),Y,1)
	. . IF YSPRACHE="DE" IF STATE'="" SET STATE=$PIECE($GET(^WWW102(0,"BUNDESLAND",COUNTRY,STATE,1)),Y,1)
	. . IF STATE'="" SET A=A_", "_STATE
	. . QUIT
	. IF $PIECE(YADRES,Y,16)'="" SET A=A_$PIECE(YADRES,Y,16)
	. IF $PIECE(YADRES,Y,12)'="" SET A=A_" "_$PIECE(YADRES,Y,12)_" "  ;PLZ NACH ORT ;ZIP within village 
	. QUIT
	DO SPE^INDRUCK
	IF $PIECE(YADRES,Y,17)'="" IF $PIECE(YADRES,Y,17)'=$GET(YCOUNTRY) SET A=YTAB_$PIECE($GET(^WWW100(0,"LAND",SPRACHE,$PIECE(YADRES,Y,17),1)),Y,1) DO SPE^INDRUCK   ;LANDESKENNZEICHEN
	QUIT
	;
	
LIEFER ;LIEFERANSCHRIFT
	;
	IF SPRACHE'="EN" IF +$PIECE(YADRES,Y,3)'=0 SET A=YTAB_$PIECE($GET(^INPARA(YM,"ANREDE",SPRACHE,$PIECE(YADRES,Y,3),1)),Y,1) DO SPE^INDRUCK   ;ANREDE ;salutation 
	IF $PIECE(YADRES,Y,4)'="" SET A=YTAB_$PIECE(YADRES,Y,4) DO SPE^INDRUCK   ;ANSCHRIFT ZEILE 1
	IF $PIECE(YADRES,Y,6)'="" SET A=YTAB_$PIECE(YADRES,Y,6) DO SPE^INDRUCK   ;ANSCHRIFT ZEILE 2
	IF $PIECE(YADRES,Y,7)'="" SET A=YTAB_$PIECE(YADRES,Y,7) DO SPE^INDRUCK   ;ANSCHRIFT ZEILE 3
	IF $PIECE(YBELEG1,Y,27)=1 DO  ;Z.h. ANSPRECHPARTNER
	. IF $PIECE($GET(^INUSER(YM,YBED,1)),Y,25)="" IF $PIECE(YADRES,Y,92)'="" SET A=YTAB_$$^WWWTEXT(32226)_" "_$PIECE(YADRES,Y,92) DO SPE^INDRUCK QUIT  ;ANSCHRIFT ZEILE 3
	. IF $PIECE($GET(^INUSER(YM,YBED,1)),Y,25)'="" SET A=YTAB_$$^WWWTEXT(32226)_" "_$PIECE($GET(^INUSER(YM,YBED,1)),Y,25) DO SPE^INDRUCK QUIT  ;ANSCHRIFT ZEILE 3
	. IF YBELEG'=3 IF YBELEG'=10 IF $PIECE(YAUFTRAG1,Y,10)'="" SET A=YTAB_$$^WWWTEXT(32226)_" "_$PIECE(YAUFTRAG1,Y,10) DO SPE^INDRUCK   ;ANSCHRIFT ZEILE 3
	. QUIT
	IF $PIECE(YADRES,Y,10)'="" SET A=YTAB_$PIECE(YADRES,Y,10) DO SPE^INDRUCK   ;STRASSE
	SET LFN=LFN+1  ;EINE ZEILE LEER ;one void 
	;
	SET A=YTAB
	IF $PIECE($GET(^INVORG(YM,YM,1)),Y,50)'=1 DO  ;PLZ VOR ANSCHRIFT ;ZIP pre- 
	. NEW YSPRACHE
	. SET YSPRACHE=SPRACHE
	. IF $PIECE(YADRES,Y,17)="DE" SET YSPRACHE="DE"
	. IF $PIECE($GET(^INVORG(YM,YM,1)),Y,95)=1 DO  ;BUNDESLAND DRUCKEN;23531;ULM;29.04.2003
	. . NEW COUNTRY,STATE
	. . SET COUNTRY=$PIECE(YADRES,Y,17)  ;BUNDESLAND LÃ„NDERABHÃ„NGIG;FIS;12.02.04;24962
	. . IF +COUNTRY=0 SET COUNTRY=$GET(YCOUNTRY)
	. . SET STATE=$PIECE(YADRES,Y,14)
	. . ;IF YSPRACHE="DE" IF $PIECE(YADRES,Y,14)'="" SET $PIECE(YADRES,Y,14)=$PIECE($GET(^WWW101(0,"BUNDESLAND",YSPRACHE,$PIECE(YADRES,Y,14),1)),Y,1)
	. . IF YSPRACHE="DE" IF STATE'="" SET STATE=$PIECE($GET(^WWW102(0,"BUNDESLAND",COUNTRY,STATE,1)),Y,1)
	. . IF STATE'="" SET A=A_STATE_" "
	. . QUIT
	. IF $PIECE(YADRES,Y,12)'="" SET A=A_$PIECE(YADRES,Y,12)_" "             ;PLZ  ;ZIP 
	. IF $PIECE(YADRES,Y,16)'="" SET A=A_$PIECE(YADRES,Y,16)                         ;ORT ;village 
	. QUIT
	;
	IF $PIECE($GET(^INVORG(YM,YM,1)),Y,50)=1 DO  ;PLZ NACH ANSCHRIFT ;ZIP within 
	. NEW YSPRACHE
	. SET YSPRACHE=SPRACHE
	. IF $PIECE(YADRES,Y,17)="DE" SET YSPRACHE="DE"
	. IF $PIECE(YADRES,Y,16)'="" SET A=A_$PIECE(YADRES,Y,16)_", "            ;ORT ;village 
	. IF $PIECE($GET(^INVORG(YM,YM,1)),Y,95)=1 DO    ;23531;ULM;29.04.2003
	. . NEW COUNTRY,STATE
	. . SET COUNTRY=$PIECE(YADRES,Y,17)  ;BUNDESLAND LÃ„NDERABHÃ„NGIG;FIS;12.02.04;24962
	. . IF +COUNTRY=0 SET COUNTRY=$GET(YCOUNTRY)
	. . SET STATE=$PIECE(YADRES,Y,14)
	. . ;IF YSPRACHE="DE" IF $PIECE(YADRES,Y,14)'="" SET $PIECE(YADRES,Y,14)=$PIECE($GET(^WWW101(0,"BUNDESLAND",YSPRACHE,$PIECE(YADRES,Y,14),1)),Y,1)
	. . IF YSPRACHE="DE" IF STATE'="" SET STATE=$PIECE($GET(^WWW102(0,"BUNDESLAND",COUNTRY,STATE,1)),Y,1)
	. . IF STATE'="" SET A=A_", "_STATE_" "
	. . QUIT
	. IF $PIECE(YADRES,Y,12)'="" SET A=A_" "_$PIECE(YADRES,Y,12)             ;PLZ  NACH ;ZIP within 
	. QUIT
	DO SPE^INDRUCK
	;IF $PIECE(YADRES,Y,17)'="" IF $PIECE(YADRES,Y,17)'=$GET(YCOUNTRY) SET A=YTAB_$$^WWWUPER($PIECE($GET(^WWW100(0,"LAND",SPRACHE,$PIECE(YADRES,Y,17),1)),Y,1)) DO SPE^INDRUCK   ;LANDESKENNZEICHEN
	IF $PIECE(YADRES,Y,17)'="" IF $PIECE(YADRES,Y,17)'=$GET(YCOUNTRY) SET A=YTAB_$zconvert($PIECE($GET(^WWW100(0,"LAND",SPRACHE,$PIECE(YADRES,Y,17),1)),Y,1),"U") DO SPE^INDRUCK   ;LANDESKENNZEICHEN
	QUIT
	;
	
SENDVIA ;
	;
	QUIT:+YSEND=0  ;NUR BILDSCHIRM ;only monitor 
	IF YSEND=2 DO
	. QUIT:$GET(YFAX)=""
	. ;SET A=YTAB_$$^WWWTEXT(366)_" via Fax "_YFAX
	. SET A=YTAB_$$^WWWTEXT(366)_" via fax: "_YFAX    ;BEC;26921;07.12.04;LINUX FAX
	. DO SPE^INDRUCK
	. QUIT
	IF YSEND=1 DO
	. QUIT:$GET(YMAIL)=""
	. ;SET A=YTAB_$$^WWWTEXT(366)_" via E-mail "_$G(YMAIL)   ;_YMAIL
	. SET A=YTAB_$$^WWWTEXT(366)_" via E-mail "_$GET(YMAIL)   ;BEC;30.11.04
	. DO SPE^INDRUCK
	. QUIT
	IF YSEND=5 DO
	. SET A=YTAB_$$^WWWTEXT(33075)    ;zum ftp-download bereitgestellt
	. DO SPE^INDRUCK
	. QUIT
	QUIT
	;
]]></Routine>
</Export>