<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="22" zv="CACHE" ts="2001-01-01 00:00:00">
<Routine name="WWWVBIN" type="MAC" languagemode="0" timestamp="58440,0"><![CDATA[
WWWVBIN ;WWWVBIN;DT;IMPORT VB FOR WWW...;15.01.2002  ; Compiled February 9, 2005 13:38:33
	;
	;/------------------------------------------------------------------\
	;| Description of Function :
	;|		IMPORT VB FOR WWW...
	;|
	;| Inputs : 
	;|
	;|
	;| ByRef :
	;|
	;|
	;| Returns :
	;|
	;|
	;| History :
	;| 30-May-2005		RobertW		SR12056: Attempt at Performance Increase
	;| DT	15.01.2002  
	;|
	;\------------------------------------------------------------------/
	;
	NEW LFN,SUCH,SATZ
	WRITE "<PRE>",YCR
	QUIT:VORG(1)=""  ;Filename ;File Name  ;File Name File Name 
	S TEMP="TEMP"
	DO IMPORT
	DO READ
	WRITE "</PRE>"
	QUIT
	
IMPORT ;
	;VORG(1)=IMPORTFILE
	;VORG(2)=GLOBAL
	;VORG(3)=LÖSCHEN DATEI 0/1 ;data file 
	;VORG(4)=1.ZEILE = KLASSENDEF 0/1
	;VORG(5)=FELDNUMMER = PRIMÄRSCHL.  XX,XX,
	;VORG(6)=IMPORTTRENNER $C(XX)
	;VORG(7)=DATEITRENNER  $C(XX)
	;VORG(999)=1 = KEINE AUSGABE AUF BILDSCHIRM ;no expenses upon monitor 
	SET VORG(2)="TEMP"
	SET VORG(3)=1
	SET VORG(4)=0
	SET VORG(5)=""
	SET VORG(6)="255"
	SET VORG(7)="255"
	SET VORG(999)=0
	DO ^WWWIMPO
	H 1
	QUIT    
	
READ ;
	NEW FORM
	SET TEMP="TEMP"
	SET SUCH="Begin VB.UserControl"
	SET LFN=$$SUCH(SUCH,"")
	IF LFN'="" DO 
	. SET SATZ=$GET(@("^"_TEMP_"(0,LFN,1)"))
	. SET FORM=$TRANSLATE($PIECE(SATZ,SUCH,2)," ") WRITE FORM,YCR
	. QUIT
	QUIT:$GET(FORM)=""
	SET ^WWW120(0,FORM,1)=FORM_Y_4
	SET $PIECE(^WWW120(0,FORM,1),Y,31)=1
	SET $PIECE(^WWW120(0,FORM,1),Y,21)=0
	SET $PIECE(^WWW120(0,FORM,1),Y,10)=0
	SET $PIECE(^WWW120(0,FORM,1),Y,44)=2
	SET $PIECE(^WWW120(0,FORM,1),Y,16)="W "_""""_"No Action"_""""
	SET $PIECE(^WWW120(0,FORM,1),Y,13)=1
	SET $PIECE(^WWW120(0,FORM,1),Y,45)=1
	SET $PIECE(^WWW120(0,FORM,1),Y,66)=2  ;button links ;on the left 
	SET $PIECE(^WWW120(0,FORM,1),Y,82)=1
	DO ^WWWSSORT("^WWW120(0,"_FORM_",1)")
	SET SUCH="Begin dsc"
	SET LFN=""
	NEW strText
	FOR  SET LFN=$$SUCH(SUCH,LFN) QUIT:LFN=""  DO
	. SET SATZ=$GET(@("^"_TEMP_"(0,LFN,1)"))
	. SET FELD=$PIECE(SATZ," ",3)
	. SET ART=$PIECE($PIECE(SATZ,"Begin dsc",2),".",1)
	. W ART,YCR
	. SET SUCH1="TabIndex "
	. SET LFN1=LFN
	. SET LFN1=$$SUCH(SUCH1,LFN1)
	. SET SATZ="" IF LFN1'="" SET SATZ=$GET(@("^"_TEMP_"(0,LFN1,1)")) WRITE LFN1,"  ",SATZ,YCR  ;Tabindex
	. SET FFIELD=$TRANSLATE($PIECE(SATZ,"=",2)," "_$CHAR(9))
	. QUIT:+FFIELD=0
	. ;QUIT:$DATA(^WWW122(0,FORM,FFIELD,1))
	. W "FIELD: ",FFIELD,YCR
	. SET YFELD=""
	. SET $PIECE(YFELD,Y,21)="VORG("_FFIELD_")"   ;VARIABLE
	. SET $PIECE(YFELD,Y,2)=0   ;erfassungsart
	. SET $PIECE(YFELD,Y,60)=1   ;seite
	. SET $PIECE(YFELD,Y,3)=1   ;position
	. SET $PIECE(YFELD,Y,4)=1   ;tab
	. SET SUCH1="Caption "
	. SET LFN1=LFN
	. SET LFN1=$$SUCH(SUCH1,LFN1)
	. IF LFN1'="" SET SATZ=$GET(@("^"_TEMP_"(0,LFN1,1)")) WRITE LFN1,"  ",SATZ,YCR  ;CAPTION
	. SET TEXT=$TR($PIECE(SATZ,"=   ",2),"&")
	. QUIT:TEXT=""
	. ;
	. SET $PIECE(YFELD,Y,12)=TEXT
	. IF ART="Toolbar"!(ART="Command") DO  QUIT
	. . SET ^WWW124(0,FORM,SPRACHE,FFIELD,1)=TEXT
	. . SET $PIECE(^WWW124(0,FORM,SPRACHE,FFIELD,1),Y,6)="SUBMIT"
	. . QUIT
	. QUIT:ART="CustomFind"
	. QUIT:ART="ScrollContainer"
	. QUIT:ART="Container"
	. IF ART'="TextBox" IF ART'="ComboBox" IF '$FIND(ART,"Memo") IF '$FIND(ART,"SingleColGrid") IF '$FIND(ART,"Check") QUIT
	. SET $PIECE(YFELD,Y,5)=6
	. SET $PIECE(YFELD,Y,6)=30
	. IF $FIND(ART,"Combo") SET $PIECE(YFELD,Y,2)=4  ;select
	. IF $FIND(ART,"Memo") SET $PIECE(YFELD,Y,5)=3  ;memo
	. IF $FIND(ART,"Check") SET $PIECE(YFELD,Y,5)=2  ;ja/nein
	. ;IF $FIND($$^WWWUPER(TEXT),"DATE") SET $PIECE(YFELD,Y,5)=1 SET $PIECE(YFELD,Y,6)=10  ;DATE
	. ;IF $FIND($$^WWWUPER(TEXT),"TOTAL") SET $PIECE(YFELD,Y,5)=8 SET $PIECE(YFELD,Y,6)=12  ;WÄHRUNG ;money standard 
	. ;IF $FIND($$^WWWUPER(TEXT),"NUMBER") SET $PIECE(YFELD,Y,5)=4 SET $PIECE(YFELD,Y,6)=10  ;ZAHL ;numeral 
	. ;IF $FIND($$^WWWUPER(TEXT),"PASSWORD") SET $PIECE(YFELD,Y,5)=5 SET $PIECE(YFELD,Y,6)=10  ;PW
	. ;IF $FIND($$^WWWUPER(TEXT),"TIME") SET $PIECE(YFELD,Y,5)=7 SET $PIECE(YFELD,Y,6)=8  ;TIME
	. ;IF $FIND($$^WWWUPER(TEXT),"AMOUNT") SET $PIECE(YFELD,Y,5)=8 SET $PIECE(YFELD,Y,6)=12 ;BETRAG ;Sum 
	. ;IF $FIND($$^WWWUPER(TEXT),"DISCOUNT") SET $PIECE(YFELD,Y,5)=12 SET $PIECE(YFELD,Y,6)=12 ;ZAHL ;numeral 
	. ;IF $FIND($$^WWWUPER(TEXT),"PERCENT") SET $PIECE(YFELD,Y,5)=12 SET $PIECE(YFELD,Y,6)=12 ;ZAHL ;numeral 
	. ;IF $FIND($$^WWWUPER(TEXT),"%") SET $PIECE(YFELD,Y,5)=12 SET $PIECE(YFELD,Y,6)=12 ;ZAHL ;numeral 
	. ;IF $FIND($$^WWWUPER(TEXT),"FILE") SET $PIECE(YFELD,Y,5)=10  ;FILE
	. set strText=$zconvert(TEXT,"U")
	. IF $FIND(strText,"DATE") SET $PIECE(YFELD,Y,5)=1 SET $PIECE(YFELD,Y,6)=10  ;DATE
	. IF $FIND(strText,"TOTAL") SET $PIECE(YFELD,Y,5)=8 SET $PIECE(YFELD,Y,6)=12  ;WÄHRUNG ;money standard 
	. IF $FIND(strText,"NUMBER") SET $PIECE(YFELD,Y,5)=4 SET $PIECE(YFELD,Y,6)=10  ;ZAHL ;numeral 
	. IF $FIND(strText,"PASSWORD") SET $PIECE(YFELD,Y,5)=5 SET $PIECE(YFELD,Y,6)=10  ;PW
	. IF $FIND(strText,"TIME") SET $PIECE(YFELD,Y,5)=7 SET $PIECE(YFELD,Y,6)=8  ;TIME
	. IF $FIND(strText,"AMOUNT") SET $PIECE(YFELD,Y,5)=8 SET $PIECE(YFELD,Y,6)=12 ;BETRAG ;Sum 
	. IF $FIND(strText,"DISCOUNT") SET $PIECE(YFELD,Y,5)=12 SET $PIECE(YFELD,Y,6)=12 ;ZAHL ;numeral 
	. IF $FIND(strText,"PERCENT") SET $PIECE(YFELD,Y,5)=12 SET $PIECE(YFELD,Y,6)=12 ;ZAHL ;numeral 
	. IF $FIND(strText,"%") SET $PIECE(YFELD,Y,5)=12 SET $PIECE(YFELD,Y,6)=12 ;ZAHL ;numeral 
	. IF $FIND(strText,"FILE") SET $PIECE(YFELD,Y,5)=10  ;FILE
	. SET ^WWW122(0,FORM,FFIELD,1)=YFELD
	. w "SAVED",YCR,YCR
	. ;DO
	. . SET SUCH1="Bind cdsMain,"
	. . SET LFN1=""
	. . FOR  SET LFN1=$$SUCH(SUCH1,LFN1) QUIT:LFN1=""  DO
	. . . SET SATZ=$GET(@("^"_TEMP_"(0,LFN1,1)"))
	. . . QUIT:'$FIND(SATZ,FELD)
	. . . ;WRITE LFN1,"  ",SATZ,YCR
	. . . QUIT
	. . QUIT
	. QUIT
	DO ^WWWSSORT("WWW124",FORM)
	D ^WWWSSORT("WWW122",FORM)
	;KILL @("^"_TEMP)
	QUIT
	
SUCH(SUCH,OFFSET) ;SUCHEN STRING ;seek 
	NEW Q,LFN
	SET Q=""
	SET LFN=$GET(OFFSET) 
	;FOR  SET LFN=$ORDER(@("^"_TEMP_"(0,LFN)")) QUIT:LFN=""  DO  QUIT:Q=1
	FOR  SET LFN=$ORDER(^TEMP(0,LFN)) QUIT:LFN=""  DO  QUIT:Q=1
	. SET SATZ=$GET(^TEMP(0,LFN,1))
	. ;SET SATZ=$GET(@("^"_TEMP_"(0,LFN,1)"))
	. IF $FIND(SATZ,SUCH) SET Q=1
	. QUIT
	QUIT LFN
]]></Routine>
</Export>