<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="22" zv="CACHE" ts="2001-01-01 00:00:00">
<Routine name="WWWDRAGDROP8" type="MAC" languagemode="0" timestamp="58440,0"><![CDATA[
WWWDRAGDROP8(START,STOP,TERMIN,INOUT)	;WWWDRAGDROP8;FIS;KORRIGIEREN FEIERTAGE UND WOCHENENDE;12.09.2003
	;
	;/------------------------------------------------------------------\
	;| Description of Function :
	;|		KORRIGIEREN FEIERTAGE UND WOCHENENDE
	;|
	;| Inputs : 
	;|
	;|
	;| ByRef :
	;|
	;|
	;| Returns :
	;|
	;|
	;| History :
	;|
	;| FIS	12.09.2003
	;|
	;\------------------------------------------------------------------/
	;
	NEW YI,YQ,YTAGE,TERMINX
	SET TERMIN=$GET(TERMIN)
	QUIT:TERMIN="" ""
	SET START=$GET(START)
	QUIT:START="" TERMIN
	SET STOP=$GET(STOP)
	IF +STOP=0 IF $GET(COLUMNS)'="" SET STOP=(START+(COLUMNS-$GET(HEADLAENG)))
	IF +STOP=0!(STOP=START) QUIT TERMIN
	SET INOUT=+$GET(INOUT)  ;0 TERMIN=KOORDINATENTERMIN  1=TATSÄCHLICHER TERMIN
	;;;IF TERMIN=START QUIT TERMIN
	IF INOUT=0 DO
	. SET YQ=0 FOR YI=START:1:STOP DO  QUIT:YQ=1  ;SUCHEN FEIERTAGE ZWISCHEN START UND FERTIGUNGSTERMIN ;seek inter- take-off And 
	. . IF $DATA(^WWWDATEN(YM,+$HOROLOG,YUSER,YFORM,"V","FEIERTAG",YI)) SET TERMIN=TERMIN+1  ;ÜBERSPRINGEN FEIERTAG ;holiday 
	. . IF YI'<TERMIN SET YQ=1  ;TERMIN ERREICHT
	. . QUIT
	. QUIT
	IF INOUT=1 DO 
	. IF TERMIN>STOP SET TERMIN=STOP+1 QUIT
	. SET YTAGE=0
	. FOR YI=START:1:TERMIN DO
	. . IF $DATA(^WWWDATEN(YM,+$HOROLOG,YUSER,YFORM,"V","FEIERTAG",YI)) SET YTAGE=YTAGE+1
	. . QUIT
	. SET TERMIN=TERMIN-YTAGE  ;ANZEIGETERMIN AUS RICHTIGEM TERMIN HOLEN ;out of send for 
	. QUIT
	. ;
	QUIT TERMIN
]]></Routine>
</Export>