<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="9" zv="CACHE" ts="2001-01-01 00:00:00">
<Routine name="INWEINVLIST" type="MAC" languagemode="0" timestamp="58440,0"><![CDATA[
INWEINVLIST ;INWEINVLIST;FAN;INVENTUR AUFBEREITUNGSLISTE ;31.01.2002
#include COMSYS
	;/------------------------------------------------------------------\
	;| Description of Function :
	;|		INVENTUR AUFBEREITUNGSLISTE 
	;|
	;| Inputs : 
	;|
	;|
	;| ByRef :
	;|
	;|
	;| Returns :
	;|
	;|
	;| History :
	;|  8-May-2006	JW		SR14508: Better header
	;| FAN	31.01.2002
	;|
	;\------------------------------------------------------------------/
	;
	NEW DATUM
	
	set YKOPF = $$$Text("IN00458") ;Stocktake History Report	//SR14508
	
	DO ^WWWBACK
	;BEARBEITEN ÜBERSCHRIFT ;superscription 
	SET UES(1)=""
	DO
	. IF $DATA(^WWW1221(0,"INWEINV",1,SPRACHE,1)) SET $PIECE(UES(1),Y,1)=$PIECE(^(1),Y,1) QUIT    ;INVETURDATUM
	. SET $PIECE(UES(1),Y,1)=$PIECE($GET(^WWW122(0,"INWEINV",1,1)),Y,12)
	. QUIT
	DO
	. IF $DATA(^WWW1221(0,"INWEINV",3,SPRACHE,1)) SET $PIECE(UES(1),Y,2)=$PIECE(^(1),Y,1) QUIT    ;JE WARENEINGANG ;once receiving 
	. SET $PIECE(UES(1),Y,2)=$PIECE($GET(^WWW122(0,"INWEINV",3,1)),Y,12)
	. QUIT
	DO
	. IF $DATA(^WWW1221(0,"INWEINV",4,SPRACHE,1)) SET $PIECE(UES(1),Y,3)=$PIECE(^(1),Y,1) QUIT    ;SORTIERUNG ;sorting 
	. SET $PIECE(UES(1),Y,3)=$PIECE($GET(^WWW122(0,"INWEINV",4,1)),Y,12)
	. QUIT
	DO
	. IF $DATA(^WWW1221(0,"INWEINV",5,SPRACHE,1)) SET $PIECE(UES(1),Y,4)=$PIECE(^(1),Y,1) QUIT    ;LIST ;wile 
	. SET $PIECE(UES(1),Y,4)=$PIECE($GET(^WWW122(0,"INWEINV",5,1)),Y,12)
	. QUIT
	DO
	. IF $DATA(^WWW1221(0,"INWEINV",2,SPRACHE,1)) SET $PIECE(UES(1),Y,5)=$PIECE(^(1),Y,1) QUIT    ;BEMERKUNG ;remark 
	. SET $PIECE(UES(1),Y,5)=$PIECE($GET(^WWW122(0,"INWEINV",2,1)),Y,12)
	. QUIT
	SET $PIECE(UES(1),Y,6)=$$^WWWTEXT(159)     ;MITARBEITER
	SET $PIECE(UES(1),Y,7)=$$^WWWTEXT(124)     ;DATUM ;Date  ;Date Date 
	DO DRUCK   ;WERTE DRUCKEN ;print 
	DO STOP^WWWTAB  ;ENDE TABELLE ;termination tabulation 
	QUIT
	
DRUCK ;
	SET YDDSATZ=0
	DO UPUEB  ;DRUCKEN ÜBERSCHRIFT ;print superscription 
	SET DATUM="" FOR  SET DATUM=$ORDER(^INWEINVP(YM,DATUM),-1) QUIT:DATUM=""  DO
	. SET YFELD=$GET(^INWEINVP(YM,DATUM,1))
	. DO
	. . WRITE !
	. . WRITE YCR
	. . DO NL^WWWTAB
	. . DO NFZ^WWWTAB
	. . WRITE $$^WWWDATE(DATUM)
	. . WRITE "&nbsp;"
	. . DO ZWZ^WWWTAB
	. . IF $PIECE(YFELD,Y,5)=1 WRITE $PIECE($GET(^WWW100(0,"JA/NEIN",SPRACHE,1,1)),Y,1)
	. . IF $PIECE(YFELD,Y,5)'=1 WRITE $PIECE($GET(^WWW100(0,"JA/NEIN",SPRACHE,0,1)),Y,1)
	. . WRITE "&nbsp;"
	. . DO ZW^WWWTAB
	. . IF $PIECE(YFELD,Y,6)'="" WRITE $PIECE($GET(^WWW101(0,"SORINWEIND",SPRACHE,$PIECE(YFELD,Y,6),1)),Y,1)
	. . WRITE "&nbsp;"
	. . DO ZW^WWWTAB
	. . IF $PIECE(YFELD,Y,7)'="" WRITE $PIECE($GET(^WWW101(0,"ZAEHLLISTE",SPRACHE,$PIECE(YFELD,Y,7),1)),Y,1)
	. . WRITE "&nbsp;"
	. . DO ZW^WWWTAB
	. . WRITE $PIECE(YFELD,Y,4)
	. . WRITE "&nbsp;"
	. . DO ZW^WWWTAB
	. . IF $PIECE(YFELD,Y,1)'="" WRITE "("_$PIECE(YFELD,Y,1)_") "_$PIECE($GET(^WWW013(0,$PIECE(YFELD,Y,1),1)),Y,1)
	. . WRITE "&nbsp;"
	. . DO ZWZ^WWWTAB
	. . IF $PIECE(YFELD,Y,3)'="" WRITE $$^WWWDATE($PIECE(YFELD,Y,3))
	. . WRITE "&nbsp;"
	. . DO EF^WWWTAB
	. . DO EL^WWWTAB
	. . QUIT
	. QUIT
	QUIT
	
UPUEB ;ÜBERSCHRIFT ;superscription 
	WRITE "<CENTER>"
	DO START00^WWWTAB
	DO NL^WWWTAB
	DO NHWO^WWWTAB
	WRITE "<FONT SIZE=3>"
	WRITE "<B>"
	WRITE "<NOBR>"
	WRITE YKOPF
	WRITE "</FONT>"
	WRITE "</NOBR>"
	WRITE "</B>"
	DO EH^WWWTAB
	DO EL^WWWTAB
	DO STOP^WWWTAB
	WRITE "<BR>"
	WRITE "</CENTER>"
	DO START100^WWWTAB  ;STARTEN DER ÜBERSCHRIFT ;launching the superscription 
	WRITE "<THEAD>" 
	DO NL^WWWTAB
	FOR I=1:1 QUIT:$PIECE(UES(1),Y,I,99)=""  DO NHW^WWWTAB WRITE $PIECE(UES(1),Y,I),"&nbsp;" DO EH^WWWTAB
	DO EL^WWWTAB
	WRITE "</THEAD>"
	QUIT
]]></Routine>
</Export>