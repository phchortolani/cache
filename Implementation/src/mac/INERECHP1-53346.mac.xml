<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="22" zv="CACHE" ts="2001-01-01 00:00:00">
<Routine name="INERECHP1" type="MAC" languagemode="0" timestamp="58440,0"><![CDATA[
#include COMSYS
 
INERECHP1 ;YINERECHP1;DT;PRUEFEN DES LIEFERANTEN;32.01.2001  ; Compiled January 14, 2005 11:44:48
	;
	;------------------------------------------------------------------\
	; Description of Function :
	;		PRUEFEN DES LIEFERANTEN
	;
	; Inputs : 
	;
	;
	; ByRef :
	;
	;
	; Returns :
	;
	;
	; History :
	; 11-Jan-2005	SC			SR14113: Use EscapeHyperEventData() wrapper to guard from javaScript errors.
	; 28-Oct-2005	JW			SR13074: Change type from 12 to 18
	; DT	32.01.2001  
	;
	;------------------------------------------------------------------/
	;
	SET KOND=""
	SET DUMMY=""
	SET WEG=""
	SET BANK=""
	SET BLZ=""
	SET KONTO=""
	QUIT:YINHALT=""
	;SUCHEN LIEFERANTEN ;seek 
	;IF +YINHALT=0 DO ^INLIEFSEL QUIT
	;I SPRACHE="DE" IF +YINHALT'=YINHALT I '$DATA(^INLIEF(YM,YINHALT,1)) Q   ;BEC;27156;14.01.05;AUSGESCHALTET UND PRÜFUNG IN EXEC VOR SAVE
	;IF YINHALT'="" I '$DATA(^INLIEF(YM,YINHALT,1)) D ^INLIEFSEL QUIT    ;BEC;26474;29.09.04;TYBD;7,12,2004;AUSGESCHALTET DA NEUE SUCHE; NEW SEARCH
	;IF '$DATA(^INLIEF(YM,YINHALT,1)) SET %TXT(1)="§"_$$^WWWTEXT(32224) QUIT  ;Lieferant nicht angelegt"     ;BEC;27156;14.01.05;AUSGESCHALTET
	IF YINHALT'="" IF $DATA(^INLIEF(YM,YINHALT,1)) DO
	. NEW LIEF1
	. SET LIEF1=$GET(^INLIEF(YM,YINHALT,1))    ;BEC;25897;14.06.04;AKTIVES KONTO 1 OD 2
	. ;SET KOND=$PIECE(^(1),Y,56)          ;KONDITION LIEFERANT
	. ;SET DUMMY=$PIECE(^(1),Y,8)          ;TEXTFELD
	. ;SET WEG=$PIECE(^(1),Y,102)          ;ZAHLUNGSWEG
	. ;SET BANK=$PIECE(^(1),Y,108)         ;BANK
	. ;SET BLZ=$PIECE(^(1),Y,106)          ;BLZ
	. ;SET KONTO=$PIECE(^(1),Y,104)        ;KONTO
	. ;
	. SET KOND=$PIECE(LIEF1,Y,56)          ;KONDITION LIEFERANT ;supplier 
	. SET DUMMY=$PIECE(LIEF1,Y,8)          ;TEXTFELD; Supplier address Name1.(first line of address).
	. SET WEG=$PIECE(LIEF1,Y,102)          ;ZAHLUNGSWEG
	. ;
	. IF $PIECE(LIEF1,Y,230)'=1 DO          ;ERSTES KONTO   ;premier acct. 
	. . SET BANK=$PIECE(LIEF1,Y,108)         ;BANK ;bench 
	. . SET BLZ=$PIECE(LIEF1,Y,106)          ;BLZ ;Bank-code Number  ;Bank-code Number Number 
	. . SET KONTO=$PIECE(LIEF1,Y,104)        ;KONTO ;acct. 
	. . QUIT
	. ;
	. IF $PIECE(LIEF1,Y,230)=1 DO           ;ZWEITES KONTO   ;acct. 
	. . SET BANK=$PIECE(LIEF1,Y,118)         ;BANK ;bench 
	. . SET BLZ=$PIECE(LIEF1,Y,116)          ;BLZ ;Bank-code Number  ;Bank-code Number Number 
	. . SET KONTO=$PIECE(LIEF1,Y,114)        ;KONTO ;acct. 
	. QUIT
	IF KOND'="" SET %TXT(1)=%TXT(1)_"#YINERECHD12~"_KOND   ;KONDITION SETZEN ;typeset 
	IF WEG'="" SET %TXT(1)=%TXT(1)_"#YINERECHD56~"_WEG   ;ZAHLUNGSWEG
	IF BANK'="" SET %TXT(1)=%TXT(1)_"#YINERECHD100~"_BANK   ;BANK ;bench 
	IF BLZ'="" SET %TXT(1)=%TXT(1)_"#YINERECHD102~"_BLZ   ;BLZ ;Bank-code Number  ;Bank-code Number Number 
	IF KONTO'="" SET %TXT(1)=%TXT(1)_"#YINERECHD104~"_KONTO   ;KONTO ;acct. 
	;IF DUMMY'="" SET %TXT(1)=%TXT(1)_"#DUMMYP1~"_DUMMY  ;TEXT; SR14113
	IF DUMMY'="" SET %TXT(1)=%TXT(1)_$$$Perform_$$$EscapeHyperEventData("DUMMYP1~"_DUMMY)  ;TEXT; SR14113
	;FÄLLIGKEIT ;maturity 
	SET REDAT=$PIECE($GET(^WWWDATEN(YM,+$HOROLOG,YUSER,YFORM,"P",1)),",",3)  ;RECHNUNGSDATUM ;date of invoice 
	SET RETAGE=+$PIECE($GET(^INKOND(YM,YINHALT,1)),Y,4)  ;NETTO-TAGE
	IF +RETAGE'=0 IF +REDAT'=0 SET %TXT(1)=%TXT(1)_"#YINERECHD54~"_$$^WWWDATE(REDAT+RETAGE)  ;FÄLLIGKEITSDATUM
	;FREMDWÄHRUNG;FIS;26316;27.08.04
	DO
	. NEW YWHR1,XRATE
	. SET YWHR1=$PIECE($GET(^INLIEF(YM,YINHALT,1)),Y,51)
	. IF YWHR1'="" IF YWHR1'=YWHR DO  QUIT
	. . SET XRATE=$PIECE($GET(^WWWWAE(0,YWHR1,1)),Y,5)
	. . SET %TXT(1)=%TXT(1)_"#YINERECHD129~WRITE"  ;FREMDWÄHRUNGSBETRAG
	. . SET %TXT(1)=%TXT(1)_"#YINERECHD130~WRITE"  ;UMRECHNUNGSFAKTOR
	. . ;SET %TXT(1)=%TXT(1)_"#YINERECHD131~READ"  ;FREMDWÄHRUNG
	. . ;SET %TXT(1)=%TXT(1)_"#YINERECHD131~"_YWHR1  ;FREMDWÄHRUNG
	. . SET %TXT(1)=%TXT(1)_"#YINERECHD131~REMOVE"  ;FREMDWÄHRUNG
	. . SET %TXT(1)=%TXT(1)_"#YINERECHD131~"_YWHR1_"~"_YWHR1_" - "_$PIECE($GET(^WWW100(0,"WAEHRUNG",SPRACHE,YWHR1,1)),Y,1)_"~"_1
	. . SET %TXT(1)=%TXT(1)_"#YINERECHD131~"_YWHR1  ;FREMDWÄHRUNG
	. . SET %TXT(1)=%TXT(1)_"#YINERECHD130~"_$$^WWWTR(0,18,XRATE)  ;UMRECHNUNGSFAKTOR	//SR13074
	. . QUIT
	. SET %TXT(1)=%TXT(1)_"#YINERECHD129~"  ;FREMDWÄHRUNGSBETRAG
	. SET %TXT(1)=%TXT(1)_"#YINERECHD129~READ"  ;FREMDWÄHRUNGSBETRAG
	. SET %TXT(1)=%TXT(1)_"#YINERECHD130~"  ;UMRECHNUNGSFAKTOR
	. SET %TXT(1)=%TXT(1)_"#YINERECHD130~READ"  ;UMRECHNUNGSFAKTOR
	. ;SET %TXT(1)=%TXT(1)_"#YINERECHD131~WRITE"  ;FREMDWÄHRUNG
	. SET %TXT(1)=%TXT(1)_"#YINERECHD131~"_YWHR  ;WÄHRUNG ;money standard 
	. QUIT
	;DO ^INLIEFSEL 
	QUIT 
]]></Routine>
</Export>