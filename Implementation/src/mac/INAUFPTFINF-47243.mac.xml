<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="22" zv="CACHE" ts="2001-01-01 00:00:00">
<Routine name="INAUFPTFINF" type="MAC" languagemode="0" timestamp="58440,0"><![CDATA[
INAUFPTFINF(YKEY) ;INAUFPTFINF;FIS;FERTIGUNGSKONTROLLE DER ARTIKELTEILE;26.03.2001
	;
	;-------------------------------------------------------------------------------
	; Description of Function :
	;		FERTIGUNGSKONTROLLE DER ARTIKELTEILE
	;
	; Inputs : 
	;	YKEY	
	;	YTARGET
	;	
	; ByRef :
	;
	;
	; Returns :
	;
	;
	; History :
	; 27-Sep-2006	GRF		Naked references; doco; quits; YCR
	; 17-Aug-2005	GRF		SR13215 : ServiceOverhead; explicit type for INMASCHKOST
	; 26.03.2001	FIS
	;-------------------------------------------------------------------------------
	NEW ME,YAUF,YPOS,ANZM,ANZINF,ANZPOS,YTEIL,YDDSATZ,BESTAND,LIEF,AUFTRAG,YPOS1,FERTENDE,KEY,SUM,MENGE,BACK,HAUPTBDE
	
	SET KEY=$GET(YKEY)
	SET YAUF=$PIECE($GET(KEY),",",1)
	SET YPOS=$PIECE($GET(KEY),",",2)
	
	SET BACK="INAUF"
	IF YPOS'="" SET BACK=BACK_",INAUFP"
	SET YTARGET=$GET(YTARGET)
	;SET YTARGET=$PIECE(YTARGET,"/",1)
	IF YTARGET="" SET YTARGET="FRAME2"
	SET $PIECE(YVOR,Y,24)=1
	if '$data(%("%KEY","YLOCKBACK")) DO ^WWWBACK ;SR12082
	
	;AUFBAU DER LISTE ;the list 
	WRITE "<CENTER>"
	WRITE "<B>",$$^WWWTEXT(32575)  ;FERTIGUNGSKONTROLLE
	WRITE " ("_$$^WWWTEXT(32047)_": "
	WRITE YAUF
	IF YPOS'="" WRITE "-"
	WRITE YPOS
	WRITE ")</B>"
	WRITE "</CENTER>"
	DO ^WWWFRAME(2)  ;TABLE AN ;upon 
	DO KOPF
	SET ANZM	 = 0   ;ANZAHL TEILE ;Number 
	SET ANZINF   = ""  ;(1=HAUPT/2=UNTERTEIL)
	SET ANZPOS   = 0   ;ANZAHL HAUPTPOSITIONEN ;Number 
	SET HAUPTBDE = 0   ;0=JEDE FERTIGUNGSNUMMER WIRD GESTEMPELT
	;                   1=NUR HAUPTTEIL WIRD GESTEMPELT  -> WERT VON UNTERTEILEN WIRD NICHT BERECHNET ;worthy Not 
	
	;+++++++++++++++++++++++++++++++++++++++
	;  YPOS1		objINAUFP
	;        and	objINAUFPXL
	;  YFELD		objINAUFPXL
	;+++++++++++++++++++++++++++++++++++++++
	
	; FIXME : remove unnecessary DO level  <GRF>
	DO
	. ;SUCHEN HAUPTTEILE DES AUFTRAGS ;seek 
	. IF YAUF'="" DO:YPOS'=""  IF YPOS="" FOR  SET YPOS=$ORDER(^INAUFP(YM,YAUF,YPOS)) QUIT:YPOS=""  DO
	. . IF ANZM'=0 DO KOPF  ;ZEILE
	. . SET SUM(1)=0  ;GESAMTZEIT SOLL
	. . SET SUM(2)=0  ;GESAMTZEIT IST
	. .;SET SUM(3)=0  ;GESAMTGEWICHT ;table-mat gross load weight 
	. . SET SUM(4)=0  ;GESAMTWERT ;total value  ;total value whole 
	. . SET SUM(5)=0  ;EINZELWERTSUMME MATERIAL
	. . SET SUM(6)=0  ;EINZELWERTSUMME LEISTUNGEN
	. . SET SUM(7)=0  ;EINZELWERTSUMME ZUSATZKOSTEN ;additional costs 
	. . SET MENGE=""
	. . SET ANZPOS=ANZPOS+1
	. . SET YTEIL="" DO  ;HAUPTPOSITION
	. . . SET YPOS1=$GET(^INAUFP(YM,YAUF,YPOS,1))
	. . . QUIT:$PIECE(YPOS1,Y,7)'=3
	. . . SET ANZINF = 2
	. . . SET MENGE  = $PIECE(YPOS1,Y,5)
	. . . SET YAART  = $PIECE(YPOS1,Y,26)
	. . . SET ME     = $PIECE(YPOS1,Y,40)
	. . . IF YAART'=2 IF (ME=2)!(ME=10)!(ME=11) SET YAART=2       ; Deemed to be a service
	. . . SET SUM(1) = ($PIECE(YPOS1,Y,45)+$PIECE(YPOS1,Y,70))    ;FIS;AUS POSITION ÜBERNEHMEN;17.08.04 ;out of assume 
	. . . DO ANZ  ;POSITION
	. . ;
	. . ;SUCHEN TEILE UND UNTERTEILE ;seek And 
	. . SET SUCH="^INAUFPXL("_""""_YM_""""_","_""""_YAUF_""""_","_YPOS_")"
	. . FOR  DO  QUIT:SUCH=""
	. . . SET SUCH=$QUERY(@SUCH)
	. . . IF $TRANSLATE($PIECE(SUCH,",",2),"""")'=YAUF SET SUCH="" QUIT  ;07.06.04;FAN;25794; WENN alphanumerischen Auftragsnummern SOLL DATEN AUCH AUFBAUEN.
	. . . ;IF $PIECE(SUCH,",",2)'=YAUF SET SUCH="" QUIT  ;07.06.04;FAN;25794; WENN alphanumerischen Auftragsnummern SOLL DATEN AUCH AUFBAUEN.
	. . . IF $PIECE(SUCH,",",3)=YPOS DO
	. . . . SET YTEIL  = $PIECE(SUCH,",",4,99)
	. . . . SET YTEIL  = $TRANSLATE(YTEIL,",)","..")
	. . . . SET YPOS1  = @SUCH
	. . . . SET ANZINF = 1
	. . . . IF $DATA(@SUCH)=11 SET ANZINF=2
	. . . . IF $PIECE(YPOS1,Y,26)="" IF $PIECE(YPOS1,Y,4)'="" SET $PIECE(YPOS1,Y,26)=$PIECE($GET(^INART(YM,$PIECE(YPOS1,Y,4),1)),Y,26)  ;HOEL ARTIKELART;FIS;24360;28.10.03
	. . . . SET YAART = $PIECE(YPOS1,Y,26)  ;ARTIKEL-ART (2=Service)
	. . . . SET ME    = $PIECE(YPOS1,Y,40)
	. . . . IF YAART'=2 IF (ME=2)!(ME=10)!(ME=11) SET YAART=2       ; Deemed to be a service
	. . . . DO ANZ  ;TEILE
	. . ;
	. . IF ANZM'=0 DO FUSS
	
	IF ANZM=0 DO ZEILE
	DO ^WWWFRAME(1)   ;TABLE AUS ;out of 
	WRITE YCR
	WRITE "<BR>"
	QUIT
	
ANZ ;ANZEIGEN DER POSITIONEN ;display the 
	NEW YBACK,YKEY,START,START1,STARTSUM,START0,ENDE,ENDE1,ENDE0,ENDESUM,COLOR,LINKTXT,YLINK,YFORM,BDEDAUER,KALK1,KALK2
	
	;ZEITEN NEU RECHNEN UND KALKULATION  ! ÄNDERUNGEN GGF. AUCH IN INNACHKALK ! ;recent have faith in And cost estimating too within 
	;==================================
	SET BDEDAUER=0
	IF $PIECE(YPOS1,Y,165)'="" DO  ;NEUAUFBAU DER FERTIGUNG UND NEURECHNEN DER ZEITEN UND PREISE ;the And the And 
	. NEW TOTAL,YART,WG,KALK,BETR,MASCH,ZEITEN,EZEIT,UTEIL,TWERT,YDATEI
	. QUIT:$DATA(^WWWSOR(YUSER,$PIECE(YPOS1,Y,165)))  ;SCHON AUFGEBAUT ;yet 
	. SET ZEITEN=$$^INPROSTEMP0($PIECE(YPOS1,Y,165),1)  ;NEUAUFBAU DER STEMPELNUMMER ;the 
	. SET TOTAL=0  ;GESAMTZEIT
	. SET TWERT=0  ;GESAMTWERT ;total value  ;total value whole 
	. ;
	. FOR YI=1:1  QUIT:$PIECE(ZEITEN,Y,YI,999)=""  DO
	. . SET UTEIL=$PIECE($PIECE(ZEITEN,Y,YI),"#",1)  ;ARBEITSGANG / UNTERNUMMER
	. . SET EZEIT=$PIECE($PIECE(ZEITEN,Y,YI),"#",2)  ;EINZELZEIT  ; Time
	. . QUIT:+EZEIT=0
	. . SET TOTAL=TOTAL+EZEIT
	. . ;
	. . IF +UTEIL'=0 DO  ;LEISTUNGEN, DIE AUF UNTERNUMMER GESTEMPELT WURDEN
	. . . NEW YFELD,KALKVORG
	. . . SET YDATEI="^INAUFPXL("_""""_YM_""""_","_""""_YAUF_""""_","_YPOS_","_$TRANSLATE(YTEIL,".",",")_UTEIL_")"
	. . . IF '$DATA(@YDATEI) SET UTEIL=0 QUIT
	. . . SET YFELD=@YDATEI
	. . . IF $PIECE(YFELD,Y,26)="" IF $PIECE(YFELD,Y,4)'="" SET $PIECE(YFELD,Y,26)=$PIECE($GET(^INART(YM,$PIECE(YFELD,Y,4),1)),Y,26)  ;HOLEN ARTIKELART;FIS;24360;28.10.03
	. . . IF $PIECE(YFELD,Y,26)'=2 SET UTEIL=0 QUIT
	. . . SET KALKVORG = $$^INMASCHKOST(2)
	. . . SET KALK1    = $PIECE(KALKVORG,Y,1)  ;MASCHINENSTUNDENSATZ ;machine hour rate 
	. . . SET KALK2    = $PIECE(KALKVORG,Y,2)  ;BEDIENERSTUNDENSATZ
	. . . set ServiceOverhead = $piece(KALK,Y,3)				;SR13215
	. . . QUIT:(KALK1+KALK2)=0
	. . . ;
	. . . SET TWERT=TWERT+$JUSTIFY(EZEIT*(KALK1+KALK2)/3600,0,2)      ; no PERSONEN or MENGE? <GRF>
	. . .;   PROPOSED - not adapted yet <GRF> 
	. . .;set MachineCost = ($justify((MachineRate+ServiceOverhead+(WorkerRate*PERSONEN))*EZEIT/3600,0,2)*MENGE)
	. . .;set TWERT = TWERT+MachineCost
	. . ;
	. . IF +UTEIL=0 DO  ;LEISTUNGEN, DIE OHNE UNTERNUMMER GESTEMPELT WURDEN
	. . . SET KALK2=""
	. . . SET WG=$PIECE($GET(^INVORG(YM,YM,1)),Y,13)  ;STANDARD-WARENGRUPPE
	. . . IF WG="" SET WG=$ORDER(^INKALK(YM,BETR,""))
	. . . IF WG'="" IF '$DATA(^INKALK(YM,YLOCATION,WG)) SET WG=$PIECE($GET(^INVORG(YM,YM,1)),Y,13)   ;DFLT WARENGRUPPE = 1.
	. . . IF YLOCATION'="" IF WG'="" SET KALK2=$PIECE($GET(^INKALK(YM,YLOCATION,WG,1)),Y,1)  ;DFLT. STUNDENSATZ
	. . . QUIT:KALK2=""
	. . . SET TWERT=TWERT+(EZEIT*(KALK2/3600))
	. ;
	. SET ^WWWSOR(YUSER,$PIECE(YPOS1,Y,165))=TOTAL_Y_$JUSTIFY(TWERT,0,2)  ;AUFGEBAUT
	. SET BDEDAUER=TOTAL   ;NEUE GESAMTZEIT
	
	;FERTIGUNGSSTATUS
	;=================
	;SUCHEN FERTIGUNGSSTART ;find Production Start
	SET START0=""
	SET START1=""
	SET STARTSUM=0
	IF $PIECE(YPOS1,Y,165)'="" DO
	. QUIT:'$DATA(^INPROSTEMP0(YM,$PIECE(YPOS1,Y,165)))
	. SET START=""
	. FOR  SET START=$ORDER(^INPROSTEMP0(YM,$PIECE(YPOS1,Y,165),START),1)  QUIT:START=""  DO  QUIT:START1'=""
	. . SET START0=$GET(^INPROSTEMP0(YM,$PIECE(YPOS1,Y,165),START,1))
	. . IF $PIECE(START0,Y,14)="" SET START0="" QUIT  ;KEIN START ;no take-off 
	. . IF START1="" SET START1=START0
	. . SET STARTSUM=STARTSUM+1
	
	;SUCHEN FERTIGUNGSENDE  ;find Production End
	SET ENDE0=""
	SET ENDE1=""
	SET ENDESUM=0
	IF $PIECE(YPOS1,Y,165)'="" DO
	. QUIT:'$DATA(^INPROSTEMP0(YM,$PIECE(YPOS1,Y,165)))
	. SET ENDE=""
	. FOR  SET ENDE=$ORDER(^INPROSTEMP0(YM,$PIECE(YPOS1,Y,165),ENDE),-1) QUIT:ENDE=""  DO  QUIT:ENDE1'=""
	. . SET ENDE0=$GET(^INPROSTEMP0(YM,$PIECE(YPOS1,Y,165),ENDE,1))
	. . IF $PIECE(ENDE0,Y,16)="" SET ENDE0="" QUIT  ;KEIN STOP ;no 
	. . IF ENDE1="" SET ENDE1=ENDE0
	. . SET ENDESUM=ENDESUM+1
	
	;---------------------
	;STATUS UND FARBCODE FÜR LEISTUNGEN ERMITTELN ;Status And to LEISTUNGEN find 
	SET COLOR=""
	SET LINKTXT=YAUF_","_YPOS_","_YTEIL
	
	IF YAART=2 DO  ; Service    ; LEISTUNGEN
	. QUIT:ANZINF=2
	. ;
	. ;NEU;FIS;16.12.03 ;recent 
	. ;IF $PIECE(YPOS1,Y,90)=1             SET COLOR="LIGHTGREEN" QUIT  ;FERTIGUNG BEENDET
	. IF $PIECE(YPOS1,Y,165)'="" IF $PIECE($GET(^INPROSTEMP1(YM,$PIECE(YPOS1,Y,165),1)),Y,22)'=""     SET COLOR="LIGHTGREEN" QUIT  ;FERTIGUNG BEENDET
	. IF +$PIECE(YPOS1,Y,168)'=0 IF ($PIECE(YPOS1,Y,168)+$$^INDAUERTAGE($PIECE(YPOS1,Y,45)))<$HOROLOG SET COLOR="RED"        QUIT  ;FERTIGUNGSDAUER_ÜBERSCHRITTEN
	. IF $PIECE(YPOS1,Y,165)'="" IF $$^INPROSTEMP0($PIECE(YPOS1,Y,165))'=0                            SET COLOR="LIGHTBLUE"  QUIT  ;IN FERTIGUNG ;within 
	. IF +$PIECE(YPOS1,Y,168)=0            SET COLOR="YELLOW" QUIT  ;FERTIGUNGSTERMIN_FEHLT
	. IF $PIECE(YPOS1,Y,168)<$HOROLOG      SET COLOR="ORANGE" QUIT  ;FERTIGUNGSSTART ÜBERFÄLLIG ;past due 
	;. 
	;. IF $PIECE(ENDE1,Y,16)'="" IF STARTSUM=ENDESUM SET COLOR="LIGHTGREEN" SET LINKTXT=$$^WWWTEXT(32132)_" "_$$^WWWTEXT(151) QUIT  ;FERTIGUNG BEENDET
	;. IF $PIECE(YPOS1,Y,168)="" IF $PIECE(START1,Y,14)="" SET COLOR="YELLOW" SET LINKTXT=$$^WWWTEXT(32128)_" "_$$^WWWTEXT(32314) QUIT  ;FERTIGUNGSTERMIN_FEHLT
	;. IF $PIECE(YPOS1,Y,168)'="" IF $PIECE(YPOS1,Y,168)<$HOROLOG IF $PIECE(START1,Y,14)="" SET COLOR="ORANGE" SET LINKTXT=$$^WWWTEXT(32128)_" "_$$^WWWUML($$^WWWTEXT(32313)) QUIT  ;FERTIGUNGSTERMIN_ÜBERSCHRITTEN
	;. IF $PIECE(START1,Y,14)'="" SET COLOR="LIGHTBLUE" SET LINKTXT=$$^WWWTEXT(32091)_" "_$$^WWWTEXT(32132)  ;IN FERTIGUNG
	;. IF $PIECE(START1,Y,14)'="" IF $PIECE(YPOS1,Y,45)'="" DO
	;. . SET FERTENDE=""
	;. . SET FERTENDE=($PIECE(START1,Y,14)+$$^INDAUERTAGE($PIECE(YPOS1,Y,45)))
	;. . IF FERTENDE<$HOROLOG SET COLOR="RED" SET LINKTXT=$$^WWWTEXT(32311)_" "_$$^WWWUML($$^WWWTEXT(32313))  ;FERTIGUNGSDAUER_ÜBERSCHRITTEN
	
	IF COLOR="LIGHTGREEN" SET LINKTXT=LINKTXT_YCR_$$^WWWTEXT(32132)_" "_$$^WWWTEXT(151)               ;FERTIGUNG BEENDET
	IF COLOR="RED"        SET LINKTXT=LINKTXT_YCR_$$^WWWTEXT(32311)_" "_$$^WWWUML($$^WWWTEXT(32313))  ;FERTIGUNGSDAUER_ÜBERSCHRITTEN
	IF COLOR="LIGHTBLUE"  SET LINKTXT=LINKTXT_YCR_$$^WWWTEXT(32091)_" "_$$^WWWTEXT(32132)             ;IN FERTIGUNG ;within 
	IF COLOR="YELLOW"     SET LINKTXT=LINKTXT_YCR_$$^WWWTEXT(32128)_" "_$$^WWWTEXT(32314)             ;FERTIGUNGSTERMIN_FEHLT
	IF COLOR="ORANGE"     SET LINKTXT=LINKTXT_YCR_$$^WWWTEXT(32128)_" "_$$^WWWUML($$^WWWTEXT(32313))  ;FERTIGUNGSSTART ÜBERFÄLLIG ;past due 
	
	;LINK SETZEN ;typeset 
	DO
	. NEW YKEY
	. SET YLINK="<A"
	. SET YLINK=YLINK_" TITLE="_YAUF_","_YPOS_","_YTEIL
	. SET YLINK=YLINK_" HREF="_""""_YAKTION_"EP=WWWFORM"
	. IF YTEIL=""              SET YLINK=YLINK_"&YFORM="_"INAUFPT1"_"&YKEY="_YAUF_","_YPOS_"&YBACK="_BACK_","           QUIT  ;HAUPTTEIL
	. IF YTEIL'="" IF YAART=2  SET YLINK=YLINK_"&YFORM="_"INAUFPT"_"&YKEY="_YAUF_","_YPOS_","_YTEIL_"&YBACK="_BACK_","  QUIT
	. IF YTEIL'="" IF YAART'=2 SET YLINK=YLINK_"&YFORM="_"INAUFPT0"_"&YKEY="_YAUF_","_YPOS_","_YTEIL_"&YBACK="_BACK_"," QUIT
	
	;DATEN SCHREIBEN ;write 
	;============================================
	SET ANZM=ANZM+1
	WRITE YCR,"<TR>"
	SET YDDSATZ=YDDSATZ+1
	
	;FERTIGUNGSAUFTRAG
	;--------------------------------------------
	WRITE "<TD NOWRAP ALIGN=RIGHT VALIGN=TOP"
	IF COLOR="" IF YDDSATZ#2=1 WRITE " BGCOLOR="_YWHITE
	IF COLOR'="" WRITE " BGCOLOR="_COLOR  
	WRITE ">"
	WRITE "<FONT SIZE=1>"
	WRITE "<A TITLE="_""""_LINKTXT_""""_" HREF="_""""_YAKTION_"EP=WWWFORM"
	IF $PIECE(YPOS1,Y,165)'="" IF $DATA(^INPROSTEMP1(YM,$PIECE(YPOS1,Y,165))) WRITE "&YFORM="_"INPROSTEMP1"_"&YKEY="_$PIECE(YPOS1,Y,165)_"&YBACK="_BACK_","
	IF $PIECE(YPOS1,Y,165)'="" IF '$DATA(^INPROSTEMP1(YM,$PIECE(YPOS1,Y,165))) IF $DATA(^INPROSTEMP(YM,$PIECE(YPOS1,Y,165))) WRITE "&YFORM="_"INPROSTEMP"_"&YKEY="_$PIECE(YPOS1,Y,165)_"&YBACK="_BACK_","
	IF $PIECE(YPOS1,Y,165)="" WRITE "&YFORM="_"INAUFPT"_"&YKEY="_YAUF_","_YPOS_","_YTEIL_"&YBACK="_BACK_","
	DO ^WWWCGI
	WRITE """"
	IF YTARGET'="" WRITE " TARGET="_YTARGET
	WRITE ">"
	IF $PIECE(YPOS1,Y,165)'="" DO
	. IF ANZINF=2 WRITE "<B>"  ;HAUPTTEIL
	. WRITE $PIECE(YPOS1,Y,165)
	. IF ANZINF=2 WRITE "</B>"  
	WRITE "&nbsp;"
	WRITE "</A>"
	WRITE "</TD>",YCR
	
	;ARTIKEL NUMMER ;item numeral 
	;--------------------------------------------
	WRITE "<TD NOWRAP ALIGN=RIGHT VALIGN=TOP"
	IF YDDSATZ#2=1 WRITE " BGCOLOR="_YWHITE 
	WRITE ">"
	WRITE "<FONT SIZE=1>"
	IF ANZINF=2 WRITE "<B>"
	WRITE YLINK
	DO ^WWWCGI
	WRITE """"
	IF YTARGET'="" WRITE " TARGET="_YTARGET
	WRITE ">"
	WRITE $PIECE(YPOS1,Y,4)
	WRITE "</A>"
	WRITE "&nbsp;"
	IF ANZINF=2 WRITE "</B>"
	WRITE "</TD>",YCR
	
	;BEZEICHNUNG ;notation 
	;--------------------------------------------
	WRITE "<TD NOWRAP VALIGN=TOP"
	IF YDDSATZ#2=1 WRITE " BGCOLOR="_YWHITE
	WRITE ">"
	WRITE "<FONT SIZE=1>"
	IF ANZINF=2 WRITE "<B>"
	WRITE YLINK
	DO ^WWWCGI
	WRITE """"
	IF YTARGET'="" WRITE " TARGET="_YTARGET
	WRITE ">"
	WRITE $EXTRACT($PIECE(YPOS1,Y,1),1,30)
	WRITE "</A>"
	WRITE "&nbsp;"
	IF ANZINF=2 WRITE "</B>"
	WRITE "</TD>",YCR
	
	;FERTIGUNGSTERMIN
	;--------------------------------------------
	WRITE "<TD NOWRAP ALIGN=LEFT VALIGN=TOP"
	IF YDDSATZ#2=1 WRITE " BGCOLOR="_YWHITE
	WRITE ">"
	WRITE "<FONT SIZE=1>"
	WRITE YLINK
	DO ^WWWCGI
	WRITE """"
	IF YTARGET'="" WRITE " TARGET="_YTARGET
	WRITE ">"
	IF YAART=2 WRITE $$^WWWDATE($PIECE(YPOS1,Y,168))
	WRITE "&nbsp;"
	WRITE "</A>"
	WRITE "</TD>",YCR
	
	;FERTIGUNGSDAUER
	;--------------------------------------------
	WRITE "<TD NOWRAP VALIGN=TOP ALIGN=RIGHT"
	IF YDDSATZ#2=1 WRITE " BGCOLOR="_YWHITE
	WRITE ">"
	WRITE "<FONT SIZE=1>"
	WRITE YLINK
	DO ^WWWCGI
	WRITE """"
	IF YTARGET'="" WRITE " TARGET="_YTARGET
	WRITE ">"
	IF ANZINF=2 WRITE "<B>"  ;HAUPTTEIL
	IF YAART=2 IF +$PIECE(YPOS1,Y,45)'=0 WRITE $$^WWWTIME($PIECE(YPOS1,Y,45)*$PIECE(YPOS1,Y,39))  ;NUR LEISTUNGEN ;only LEISTUNGEN 
	IF ANZINF=2 WRITE "</B>"  ;HAUPTTEIL
	WRITE "&nbsp;"
	WRITE "</A>"
	WRITE "</TD>",YCR
	
	;GESAMTZEIT (PLANDAUER) !! WIRD AUS AUFTRAGSPOSITION GEHOLT !! ;out of 
	;--------------------------------------------
	WRITE "<TD NOWRAP VALIGN=TOP ALIGN=RIGHT"
	IF YDDSATZ#2=1 WRITE " BGCOLOR="_YWHITE
	WRITE ">"
	WRITE "<FONT SIZE=1>"
	IF ANZINF=2 DO
	. QUIT:$PIECE(YPOS1,Y,165)=""  ;NOCH KEINE FERTIGUNGSANWEISUNG ;yet no 
	. WRITE YLINK
	. DO ^WWWCGI
	. WRITE """"
	. IF YTARGET'="" WRITE " TARGET="_YTARGET
	. WRITE ">"
	. WRITE "<B>"  ;HAUPTTEIL
	. WRITE $$^WWWTIME($PIECE(YPOS1,Y,166))
	. ;SET SUM(1)=SUM(1)+$PIECE(YPOS1,Y,166)  ;FIS;AUS POSITION ÜBERNEHMEN;17.08.04
	. WRITE "</B>"  ;HAUPTTEIL
	. WRITE "</A>"
	WRITE "&nbsp;"
	WRITE "</TD>",YCR
	
	;FERTIGUNGSPLATZ
	;--------------------------------------------
	WRITE "<TD NOWRAP ALIGN=LEFT VALIGN=TOP"
	IF YDDSATZ#2=1 WRITE " BGCOLOR="_YWHITE
	WRITE ">"
	WRITE "<FONT SIZE=1>"
	IF ($PIECE(YPOS1,Y,61)'="") && $DATA(^INPRONEST(YM,$PIECE(YPOS1,Y,61),1)) {
		WRITE $EXTRACT($PIECE($GET(^INPRONEST(YM,$PIECE(YPOS1,Y,61),1)),Y,1),1,15)  ; 27-Sep-2006
	}
	WRITE "&nbsp;"
	WRITE "</TD>",YCR
	
	;KOSTENSTELLE ;cost centre 
	;--------------------------------------------
	WRITE "<TD NOWRAP ALIGN=LEFT VALIGN=TOP"
	IF YDDSATZ#2=1 WRITE " BGCOLOR="_YWHITE
	WRITE ">"
	WRITE "<FONT SIZE=1>"
	IF $PIECE(YPOS1,Y,61)'="" DO
	. NEW KOSTSTELL
	. SET KOSTSTELL=$PIECE($GET(^INPRONEST(YM,$PIECE(YPOS1,Y,61),1)),Y,37)
	. WRITE KOSTSTELL
	. IF KOSTSTELL'="" WRITE " "_$EXTRACT($PIECE($GET(^INKOSTL(YM,KOSTSTELL,1)),Y,1),1,12)
	WRITE "&nbsp;"
	WRITE "</TD>",YCR
	
	;FERTIGUNGSSTART
	;-------------------------------------------
	;DO
	;. WRITE "<TD NOWRAP VALIGN=TOP ALIGN=RIGHT"
	;. IF YDDSATZ#2=1 WRITE " BGCOLOR="_YWHITE
	;. WRITE ">"
	;. WRITE "<FONT SIZE=1>"
	;. IF ANZINF=2 IF START1'="" IF $PIECE(YPOS1,Y,165)'="" DO
	;. . QUIT:+$PIECE(START1,Y,14)=0
	;. . WRITE $$^WWWDATE(+$PIECE(START1,Y,14))
	;. . WRITE " / "
	;. . WRITE $$^WWWTIME($PIECE(START1,Y,15))
	;. . WRITE " ("
	;. . WRITE STARTSUM
	;. . WRITE ")"
	;. WRITE "&nbsp;"
	;. WRITE "</TD>"
	;. ;
	;. ;FERTIGUNGSENDE
	;. ;--------------------------------------------
	;. WRITE "<TD NOWRAP VALIGN=TOP ALIGN=RIGHT"
	;. IF YDDSATZ#2=1 WRITE " BGCOLOR="_YWHITE
	;. WRITE ">"
	;. WRITE "<FONT SIZE=1>"
	;. IF ANZINF=2 IF ENDE1'="" IF $PIECE(YPOS1,Y,165)'="" DO
	;. . QUIT:+$PIECE(ENDE1,Y,16)=0
	;. . WRITE $$^WWWDATE(+$PIECE(ENDE1,Y,16))
	;. . WRITE " / "
	;. . WRITE $$^WWWTIME($PIECE(ENDE1,Y,17))
	;. . WRITE " ("
	;. . WRITE ENDESUM
	;. . WRITE ")"
	;. WRITE "&nbsp;"
	;. WRITE "</TD>"
	
	;DAUER LT BDE ;permanence factory data capture 
	;-------------------------------------------
	WRITE "<TD NOWRAP VALIGN=TOP ALIGN=RIGHT"
	IF YDDSATZ#2=1 WRITE " BGCOLOR="_YWHITE
	WRITE ">"
	WRITE "<FONT SIZE=1>"
	WRITE YCR
	IF ANZINF=2 DO
	. QUIT:$PIECE(YPOS1,Y,165)=""  ;KEINE FERTIGUNGSNUMMER ;no 
	. WRITE "<A TITLE="_""""_LINKTXT_""""_" HREF="_""""_YAKTION_"EP=WWWFORM"
	. IF $PIECE(YPOS1,Y,165)'="" IF $DATA(^INPROSTEMP1(YM,$PIECE(YPOS1,Y,165))) WRITE "&YFORM="_"INPROSTEMP1"_"&YKEY="_$PIECE(YPOS1,Y,165)_"&YBACK="_BACK_","
	. IF $PIECE(YPOS1,Y,165)'="" IF '$DATA(^INPROSTEMP1(YM,$PIECE(YPOS1,Y,165))) IF $DATA(^INPROSTEMP(YM,$PIECE(YPOS1,Y,165))) WRITE "&YFORM="_"INPROSTEMP"_"&YKEY="_$PIECE(YPOS1,Y,165)_"&YBACK="_BACK_","
	. DO ^WWWCGI
	. WRITE """"
	. IF YTARGET'="" WRITE " TARGET="_YTARGET
	. WRITE ">"
	. DO
	. . IF START1="" IF $PIECE($GET(^INVORG(YM,YM,1)),Y,65)=1 QUIT  ;NUR HAUPTPOSITION STEMPELN ;only postmark 
	. . IF START1=""!(STARTSUM'=ENDESUM) WRITE "<FONT COLOR="_YRED_">"
	. . WRITE $$^WWWTIME(BDEDAUER)
	. . SET SUM(2)=SUM(2)+BDEDAUER
	. . IF (START1="")!(STARTSUM'=ENDESUM) WRITE "</FONT>"
	. . WRITE "</A>"
	WRITE "&nbsp;"
	WRITE "</TD>",YCR
	
	;MENGE ;quantity 
	;-------------------------------------------
	WRITE "<TD NOWRAP VALIGN=TOP ALIGN=RIGHT"
	IF YDDSATZ#2=1 WRITE " BGCOLOR="_YWHITE
	WRITE ">"
	WRITE "<FONT SIZE=1>"
	IF +$PIECE(YPOS1,Y,39)'=0 IF YAART'=2 WRITE $$^WWWZAHL($PIECE(YPOS1,Y,39),0,$LENGTH($PIECE($PIECE(YPOS1,Y,39),".",2)))
	IF ($PIECE(YPOS1,Y,40)'="") && $DATA(^WWW101(0,"EINHEIT",SPRACHE,$PIECE(YPOS1,Y,40),1)) {
		WRITE "&nbsp;"_$EXTRACT($PIECE($GET(^WWW101(0,"EINHEIT",SPRACHE,$PIECE(YPOS1,Y,40),1)),Y,1),1,13)                ; 27-Sep-2006
	}
	WRITE "&nbsp;"
	WRITE "</TD>",YCR
	
	;GEWICHT ;wt. 
	;-------------------------------------------
	WRITE "<TD NOWRAP VALIGN=TOP ALIGN=RIGHT"
	IF YDDSATZ#2=1 WRITE " BGCOLOR="_YWHITE
	WRITE ">"
	WRITE "<FONT SIZE=1>"
	IF YAART'=2 DO             ; not a Service
	. IF (+$PIECE(YPOS1,Y,39)=0)!(+$PIECE(YPOS1,Y,5)=0) QUIT  ;KEIN GEWICIHT ODER MENGE ;no Or quantity 
	. WRITE $TRANSLATE($JUSTIFY($PIECE(YPOS1,Y,43)/$PIECE(YPOS1,Y,5)*$PIECE(YPOS1,Y,39),0,2),".",",")
	;IF YTEIL="" SET SUM(3)=$PIECE(YPOS1,Y,43)/$PIECE(YPOS1,Y,5)*$PIECE(YPOS1,Y,39)
	WRITE "&nbsp;"
	WRITE "</TD>",YCR
	
	;WERT ;value
	;-------------------------------------------
	WRITE "<TD NOWRAP VALIGN=TOP ALIGN=RIGHT"
	IF YDDSATZ#2=1 WRITE " BGCOLOR="_YWHITE
	WRITE ">"
	WRITE "<FONT SIZE=1>"
	
	;PRÜFEN OB WERTANZEIGE ;check whether 
	;	D65		$$$INVORGFinishOnlyForMainParts()
	IF YTEIL="" IF $PIECE($GET(^INVORG(YM,YM,1)),Y,65)=1 DO  ;NUR HAUPTPOSITION STEMPELN ;only postmark 
	. IF START1'="" SET HAUPTBDE=1  ;FERTIGUNG GESTARTET
	
	SET BDEZEIT=0
	IF $PIECE(YPOS1,Y,165)'="" IF +$PIECE($GET(^WWWSOR(YUSER,$PIECE(YPOS1,Y,165))),Y,1)'=0 SET BDEZEIT=1
	IF ANZINF=1 IF YAART=2 IF HAUPTBDE=1 SET BDEZEIT=1  ;LEISTUNGEN IN HAUPTPOSITION BERÜCKSICHTIGT ;LEISTUNGEN within 
	IF +$PIECE(YPOS1,Y,39)=0 SET $PIECE(YPOS1,Y,39)=$PIECE(YPOS1,Y,5)
	IF +$PIECE(YPOS1,Y,39)=0 SET $PIECE(YPOS1,Y,39)=1
	SET YLOS=""
	SET LOSMENGE=0
	IF $PIECE(YPOS1,Y,4)'="" SET YLOS=$PIECE($GET(^INART(YM,$PIECE(YPOS1,Y,4),1)),Y,72)  ;LOSGRÖSSE
	IF +YLOS=0 SET YLOS=999999999
	SET LOSMENGE=$PIECE(YPOS1,Y,39)\YLOS
	IF +LOSMENGE=0 SET LOSMENGE=1
	
	; A Service           ;LEISTUNG
	;++++++++++++++
	IF YAART=2 DO
	. ;
	. IF ANZINF=1 DO  ;UNTERTEIL
	. . IF BDEZEIT=0 DO  ;BDE NICHT VORHANDEN  ;factory data capture Not on hand 
	. . . WRITE $$^WWWZAHL($PIECE(YPOS1,Y,47)*$PIECE(YPOS1,Y,39),,2,YWHR)
	. . . SET SUM(4)=SUM(4)+($PIECE(YPOS1,Y,47)*$PIECE(YPOS1,Y,39))
	. . . SET SUM(6)=SUM(6)+($PIECE(YPOS1,Y,47)*$PIECE(YPOS1,Y,39))  ;LEISTUNGSANTEIL (OHNE BDE)
	. . ;
	. . IF BDEZEIT=1 DO  ;BDE VORHANDEN  ;factory data capture on hand 
	. . . ;W "X"
	. . . ;KEINE VERÄNDERUNG ;no mutation 
	. ;
	. IF ANZINF=2 DO  ;HAUPTTEIL
	. . IF BDEZEIT=0 DO  ;BDE NICHT VORHANDEN  ;factory data capture Not on hand 
	. . . WRITE $$^WWWZAHL((($PIECE(YPOS1,Y,74)+$PIECE(YPOS1,Y,75))*LOSMENGE),,2,YWHR)
	. . . SET SUM(4)=SUM(4)+(($PIECE(YPOS1,Y,74)+$PIECE(YPOS1,Y,75))*LOSMENGE)
	. . . SET SUM(7)=SUM(7)+(($PIECE(YPOS1,Y,74)+$PIECE(YPOS1,Y,75))*LOSMENGE)  ;ZUSATZKOSTENANTEIL
	. . ;
	. . IF BDEZEIT=1 DO  ;BDE VORHANDEN ;factory data capture on hand 
	. . . WRITE $$^WWWZAHL($PIECE(YPOS1,Y,74)+$PIECE(YPOS1,Y,75)+$PIECE($GET(^WWWSOR(YUSER,$PIECE(YPOS1,Y,165))),Y,2),,2,YWHR)
	. . . SET SUM(4)=SUM(4)+$PIECE(YPOS1,Y,74)+$PIECE(YPOS1,Y,75)+$PIECE($GET(^WWWSOR(YUSER,$PIECE(YPOS1,Y,165))),Y,2)
	. . . SET SUM(6)=SUM(6)+$PIECE($GET(^WWWSOR(YUSER,$PIECE(YPOS1,Y,165))),Y,2)  ;LEISTUNGSANTEIL
	. . . SET SUM(7)=SUM(7)+$PIECE(YPOS1,Y,74)+$PIECE(YPOS1,Y,75)  ;ZUSATZKOSTENANTEIL
	
	; Not a Service       ;KEINE LEISTUNG
	;++++++++++++++
	IF YAART'=2 DO
	. IF ANZINF=1 DO  ;UNTERTEIL
	. . IF BDEZEIT=0 DO  ;BDE NICHT VORHANDEN  ;factory data capture Not on hand 
	. . . IF +$PIECE(YPOS1,Y,5)'=0 WRITE $$^WWWZAHL($PIECE(YPOS1,Y,47)/$PIECE(YPOS1,Y,5)*$PIECE(YPOS1,Y,39),,2,YWHR)
	. . . IF +$PIECE(YPOS1,Y,5)'=0 SET SUM(4)=SUM(4)+($PIECE(YPOS1,Y,47)/$PIECE(YPOS1,Y,5)*$PIECE(YPOS1,Y,39))
	. . . IF +$PIECE(YPOS1,Y,5)'=0 SET SUM(5)=SUM(5)+($PIECE(YPOS1,Y,47)/$PIECE(YPOS1,Y,5)*$PIECE(YPOS1,Y,39))  ;MATERIALANTEIL
	. . ;
	. . IF BDEZEIT=1 DO  ;BDE VORHANDEN  ;factory data capture on hand 
	. . . IF +$PIECE(YPOS1,Y,5)'=0 WRITE $$^WWWZAHL($PIECE(YPOS1,Y,47)/$PIECE(YPOS1,Y,5)*$PIECE(YPOS1,Y,39),,2,YWHR)
	. . . IF +$PIECE(YPOS1,Y,5)'=0 SET SUM(4)=SUM(4)+($PIECE(YPOS1,Y,47)/$PIECE(YPOS1,Y,5)*$PIECE(YPOS1,Y,39))
	. . . IF +$PIECE(YPOS1,Y,5)'=0 SET SUM(5)=SUM(5)+($PIECE(YPOS1,Y,47)/$PIECE(YPOS1,Y,5)*$PIECE(YPOS1,Y,39))  ;MATERIALANTEIL
	. ;
	. IF ANZINF=2 DO  ;HAUPTTEIL
	. . IF BDEZEIT=0 DO  ;BDE NICHT VORHANDEN  ;factory data capture Not on hand 
	. . . WRITE $$^WWWZAHL(($PIECE(YPOS1,Y,74)+$PIECE(YPOS1,Y,75))*LOSMENGE,,2,YWHR)
	. . . SET SUM(4)=SUM(4)+(($PIECE(YPOS1,Y,74)+$PIECE(YPOS1,Y,75))*LOSMENGE)
	. . . SET SUM(7)=SUM(7)+(($PIECE(YPOS1,Y,74)+$PIECE(YPOS1,Y,75))*LOSMENGE) ;ZUSATZKOSTENANTEIL
	. . ;
	. . IF BDEZEIT=1 DO  ;BDE VORHANDEN  ;factory data capture on hand 
	. . . WRITE $$^WWWZAHL((($PIECE(YPOS1,Y,74)+$PIECE(YPOS1,Y,75))*LOSMENGE)+$PIECE($GET(^WWWSOR(YUSER,$PIECE(YPOS1,Y,165))),Y,2),,2,YWHR)
	. . . SET SUM(4)=SUM(4)+(($PIECE(YPOS1,Y,74)+$PIECE(YPOS1,Y,75))*LOSMENGE)+$PIECE($GET(^WWWSOR(YUSER,$PIECE(YPOS1,Y,165))),Y,2)
	. . . SET SUM(7)=SUM(7)+(($PIECE(YPOS1,Y,74)+$PIECE(YPOS1,Y,75))*LOSMENGE)    ;ZUSATZKOSTENANTEIL
	. . . SET SUM(6)=SUM(6)+$PIECE($GET(^WWWSOR(YUSER,$PIECE(YPOS1,Y,165))),Y,2)  ;LEISTUNGSANTEIL
	
	WRITE "&nbsp;"
	WRITE "</TD>"
	;---------------------------------------
	WRITE "</TR>",YCR
	QUIT
	
KOPF ;
	;KOPF ZEILE ;pate 
	WRITE "<TH VALIGN=TOP NOWRAP align=CENTER"
	WRITE " BGCOLOR="_YDARKGRAY
	WRITE ">"
	WRITE "<FONT SIZE=1>"
	WRITE $$^WWWTEXT(32132)  ;FERTIGUNG
	WRITE " "
	WRITE "</TH>"
	
	WRITE "<TH VALIGN=TOP NOWRAP align=CENTER"
	WRITE " BGCOLOR="_YDARKGRAY
	WRITE ">"
	WRITE "<FONT SIZE=1>"
	WRITE $$^WWWTEXT(32024)  ;ARTIKEL ;item 
	WRITE "</TH>"
	
	WRITE "<TH VALIGN=TOP NOWRAP align=CENTER WIDTH=15%"
	WRITE " BGCOLOR="_YDARKGRAY
	WRITE ">"
	WRITE "<FONT SIZE=1>"
	WRITE $$^WWWTEXT(32026)  ;BEZEICHNUNG ;notation 
	WRITE "</TH>"
	
	WRITE "<TH VALIGN=TOP NOWRAP align=CENTER"
	WRITE " BGCOLOR="_YDARKGRAY
	WRITE ">"
	WRITE "<FONT SIZE=1>"
	WRITE $$^WWWTEXT(32383)  ;FERTIGUNGTERMIN
	WRITE " "
	WRITE "</TH>"
	
	WRITE "<TH VALIGN=TOP NOWRAP align=CENTER"
	WRITE " BGCOLOR="_YDARKGRAY
	WRITE ">"
	WRITE "<FONT SIZE=1>"
	WRITE $$^WWWTEXT(32857)  ;AUSFÜHRUNGSZEIT ;execution time 
	WRITE "</TH>"
	
	WRITE "<TH VALIGN=TOP NOWRAP align=CENTER"
	WRITE " BGCOLOR="_YDARKGRAY
	WRITE ">"
	WRITE "<FONT SIZE=1>"
	WRITE $$^WWWTEXT(32672)  ;GEPLANTE DAUER  ;permanence 
	WRITE "</TH>"
	
	WRITE "<TH VALIGN=TOP NOWRAP align=CENTER"
	WRITE " BGCOLOR="_YDARKGRAY
	WRITE ">"
	WRITE "<FONT SIZE=1>"
	WRITE $$^WWWTEXT(32129)  ;FERTIGUNSPLATZ
	WRITE "</TH>"
	
	WRITE "<TH VALIGN=TOP NOWRAP align=CENTER"
	WRITE " BGCOLOR="_YDARKGRAY
	WRITE ">"
	WRITE "<FONT SIZE=1>"
	WRITE $$^WWWFELDNAME("INPRONEST","D",37)  ;KOSTENSTELLE ;cost centre 
	WRITE "</TH>"
	
	;WRITE "<TH VALIGN=TOP NOWRAP align=CENTER"
	;WRITE " BGCOLOR="_YDARKGRAY
	;WRITE ">"
	;WRITE "<FONT SIZE=1>"
	;WRITE $$^WWWTEXT(32542)  ;ERSTER FERTIGUNGSSTART
	;WRITE "</TH>"
	
	;WRITE "<TH VALIGN=TOP NOWRAP align=CENTER"
	;WRITE " BGCOLOR="_YDARKGRAY
	;WRITE ">"
	;WRITE "<FONT SIZE=1>"
	;WRITE $$^WWWTEXT(32543)  ;LETZTER FERTIGUNGSSTOP
	;WRITE "</TH>"
	
	WRITE "<TH VALIGN=TOP NOWRAP align=CENTER"
	WRITE " BGCOLOR="_YDARKGRAY
	WRITE ">"
	WRITE "<FONT SIZE=1>"
	WRITE $$^WWWTEXT(32323)  ;IST BDE-DAUER
	WRITE "</TH>"
	
	WRITE "<TH VALIGN=TOP NOWRAP align=CENTER"
	WRITE " BGCOLOR="_YDARKGRAY
	WRITE ">"
	WRITE "<FONT SIZE=1>"
	WRITE $$^WWWTEXT(31407)  ;MENGE ;quantum  ;quantity 
	WRITE "</TH>"
	
	WRITE "<TH VALIGN=TOP NOWRAP align=CENTER"
	WRITE " BGCOLOR="_YDARKGRAY
	WRITE ">"
	WRITE "<FONT SIZE=1>"
	WRITE $$^WWWTEXT(32324)  ;GEWICHT ;wt. 
	WRITE "</TH>"
	
	WRITE "<TH VALIGN=TOP NOWRAP align=CENTER"
	WRITE " BGCOLOR="_YDARKGRAY
	WRITE ">"
	WRITE "<FONT SIZE=1>"
	WRITE $$^WWWTEXT(32325)  ;WERT ;worthy 
	WRITE "</TH>"
	
	WRITE "</TR>",YCR
	SET YDDSATZ=0
	QUIT
	
FUSS ;
	;SUMMEN
	WRITE "<TR>"
	FOR YI(3)=1:1:12 DO
	. WRITE "<TD NOWRAP VALIGN=TOP ALIGN=RIGHT"
	. WRITE " BGCOLOR="_YDARKGRAY
	. WRITE " STYLE="_""""_"border-bottom:2px solid black;"_""""
	. WRITE ">"
	. WRITE "<FONT SIZE=1>"
	. IF YI(3)=6 WRITE "<B>"_$$^WWWTIME(SUM(1))_"</B>"
	. IF YI(3)=9 WRITE "<B>"_$$^WWWTIME(SUM(2))_"</B>"
	. ;YI(3)=10 WRITE "<B>"_$TRANSLATE($JUSTIFY(SUM(3),0,2),".",",")_"</B>"
	. IF YI(3)=12 WRITE "<B>"_$$^WWWZAHL(SUM(4),,2,YWHR)_"</B>"
	. WRITE "&nbsp;"
	. WRITE "</TD>"
	WRITE "</TR>",YCR
	
	;SUMMEN MATERIAL/LEISTUNG ;purr 
	FOR YIII=5,6,7 DO
	. WRITE "<TR>"
	. FOR YI(3)=1:1:9 DO
	. . WRITE "<TD NOWRAP VALIGN=TOP"
	. . WRITE " BGCOLOR="_YDARKGRAY
	. . WRITE ">"
	. . WRITE "<FONT SIZE=1>"
	. . WRITE "&nbsp;"
	. . WRITE "</TD>"
	. ;
	. WRITE "<TD NOWRAP VALIGN=TOP COLSPAN=2 ALIGN=RIGHT"
	. WRITE " BGCOLOR="_YDARKGRAY
	. WRITE ">"
	. WRITE "<FONT SIZE=1>"
	. IF YIII=5 WRITE $$^WWWTEXT(350)_" "_$$^WWWTEXT(32034)  ;SUMME TEILE ;sum 
	. IF YIII=6 DO
	. . IF +SUM(2)=0 WRITE "* "
	. . WRITE $$^WWWTEXT(350)_" "_$$^WWWTEXT(32858)          ;SUMME LEISTUNGEN ;sum LEISTUNGEN 
	. ;
	. IF YIII=7 WRITE $$^WWWTEXT(350)_" "_$$^WWWTEXT(32351)  ;SUMME ZUSATZKOSTEN ;sum additional costs 
	. WRITE "&nbsp;"
	. WRITE "</TD>"
	. ;
	. WRITE "<TD NOWRAP VALIGN=TOP ALIGN=RIGHT"
	. WRITE " BGCOLOR="_YDARKGRAY
	. WRITE ">"
	. WRITE "<FONT SIZE=1>"
	. WRITE $$^WWWZAHL(SUM(YIII),,2,YWHR)
	. WRITE "&nbsp;"
	. WRITE "</TD>"
	WRITE "</TR>",YCR
	
	;WENN OHNE BDE-ZEIT ;when without 
	WRITE "<TR>"
	WRITE "<TD NOWRAP VALIGN=TOP COLSPAN=12 ALIGN=RIGHT"
	;WRITE " BGCOLOR="_YWHITE
	WRITE ">"
	WRITE "<FONT SIZE=1>"
	WRITE "<B>"
	IF +SUM(2)=0 WRITE "* "_$$^WWWTEXT(32619)  ;OHNE RÜSTKOSTEN ;without 
	WRITE "&nbsp;"
	WRITE "</B>"
	WRITE "</FONT>"
	WRITE "</TD></TR>",YCR
	
	QUIT
	
ZEILE ;
	WRITE "<TR>"
	SET YDDSATZ=YDDSATZ+1
	FOR YI(3)=1:1:12 DO
	. WRITE "<TD NOWRAP VALIGN=TOP ALIGN=RIGHT"
	. IF YDDSATZ#2=1 WRITE " BGCOLOR="_YWHITE
	. WRITE ">"
	. WRITE "<FONT SIZE=1>"
	. IF YI(3)=11 WRITE "========="
	. WRITE "&nbsp;"
	. WRITE "</TD>"
	
	WRITE "</TR>",YCR
	QUIT
	
]]></Routine>
</Export>