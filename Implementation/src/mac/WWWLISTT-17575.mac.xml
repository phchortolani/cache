<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="22" zv="CACHE" ts="2001-01-01 00:00:00">
<Routine name="WWWLISTT" type="MAC" languagemode="0" timestamp="58440,0"><![CDATA[
WWWLISTT
	;-------------------------------------------------------------------------------
	; Description of Function :
	;		AUSDRUCK DER LISTE
	;
	; Inputs : 
	;
	;
	; ByRef :
	;
	;
	; Returns :
	;
	;
	; History :
	; 06.10.97	DT
	;-------------------------------------------------------------------------------
	DO DRUCK
	QUIT
	
DRUCK ;
	;WRITE YCR,YCR,"<!-- ************************* DRUCKEN AUS LISTGENERATOR (WWWLISTT)************************** -->",YCR,YCR
	
	SET YHTML=1  ;HTML FORMATIERT
	DO ^WWWFRAME(0)
	SET $Y=0,$X=0
	
	;ZWISCHEN DATEI FORMATIERUNG ;inter- data file formatting 
	SET YDDSATZ=1
	SET YURL=$PIECE($GET(^WWW012(0,YM,1)),Y,44)
	KILL ^WWWSOR(YUSER,3)
	SET MINZEI=0,MAXZEI=0
	
	;SORTIERUNG DER AUSGABE / DATEIEN SUCHEN ;sorting the expenses seek 
	SET YLFN="" FOR  SET YLFN=$ORDER(^WWW131(0,YFORM,YLFN)) QUIT:YLFN=""  DO
	. SET YLF(YLFN)=$GET(^WWW131(0,YFORM,YLFN,1))
	. SET YDATEI(YLFN)=$PIECE(YLF(YLFN),Y,1)
	. SET YLFORM(YLFN)=$PIECE(YLF(YLFN),Y,3)
	. SET YSATZNUM(YLFN)=0
	. ;PRIMÄRSCHL
	. SET BEA="" FOR  SET BEA=$ORDER(^WWW132(0,YFORM,YLFN,BEA)) QUIT:BEA=""  DO
	. . SET PRUEF=^WWW132(0,YFORM,YLFN,BEA,1)
	. . SET ZEIL=+$PIECE(PRUEF,Y,4)
	. . IF ZEIL=0 SET ZEIL=1
	. . SET POS=+$PIECE(PRUEF,Y,5)
	. . IF MINZEI<ZEIL SET MINZEI=ZEIL
	. . SET ^WWWSOR(YUSER,3,YLFN,"1",ZEIL,POS,BEA)=PRUEF
	
	;FELDER SUCHEN ;seek 
	SET YLFN="" FOR  SET YLFN=$ORDER(^WWW133(0,YFORM,YLFN)) QUIT:YLFN=""  DO
	. SET BEA="" FOR  SET BEA=$ORDER(^WWW133(0,YFORM,YLFN,BEA)) QUIT:BEA=""  DO
	. . SET PRUEF=^WWW133(0,YFORM,YLFN,BEA,1)
	. . SET ZEIL=+$PIECE(PRUEF,Y,4)
	. . IF ZEIL=0 SET ZEIL=1
	. . SET POS=+$PIECE(PRUEF,Y,5)
	. . IF MINZEI<ZEIL SET MINZEI=ZEIL
	. . SET ^WWWSOR(YUSER,3,YLFN,"2",ZEIL,POS,BEA)=PRUEF
	
	IF '$DATA(^WWWSOR(YUSER,1)) DO  ;WENN KEINE Daten;30,06,2003;TYBD;23860
	. SET ^WWWSOR(YUSER,1," "," ")="" 
	. SET ^WWWSOR(YUSER,2," ")=1
	
	;LESEN DATEN AUS VORSORTIERUNG ;read out of 
	SET XYLFN=""
	SET YA(2)="" FOR  SET YA(2)=$ORDER(^WWWSOR(YUSER,1,YA(2))) QUIT:YA(2)=""  DO
	. SET YKEY="" FOR  SET YKEY=$ORDER(^WWWSOR(YUSER,1,YA(2),YKEY)) QUIT:YKEY=""  DO
	. . ;
	. . SET YFELD=$$^WWWSETL($GET(^WWWSOR(YUSER,1,YA(2),YKEY)))
	. . SET YLFN=$GET(^WWWSOR(YUSER,2,YA(2)))
	. . QUIT:YLFN=""
	. . IF XYLFN=""!(XYLFN'=YLFN) DO  ;UEBERSCHRIFT  / FORMATIERUNG DER UEBERSCHRIFT;TYBD;WENN OHNE KOPF;23860;30,06,2003
	. . . IF YHTML=1 DO   ;WENN HTMLFORMATIERT DANN TABELLE ;when tabulation 
	. . . . WRITE "<THEAD>"
	. . . . WRITE "<TR><TD NOWRAP>"
	. . . . QUIT
	. . . IF $PIECE(YVOR,Y,7)'="" WRITE "<FONT SIZE="_""""_$PIECE(YVOR,Y,7)_""""_">"
	. . . IF XYLFN="" IF $PIECE(YLF(YLFN),Y,6)'="" WRITE $PIECE(YLF(YLFN),Y,6) DO LF
	. . . ;IF $PIECE(YLF(YLFN),Y,13)="1" WRITE $$^WWWTEXT(207)," "
	. . . IF $PIECE(YLF(YLFN),Y,13)="1" WRITE "<B>"_$$^WWWTEXT(207),"</B> "
	. . . IF $PIECE(YLF(YLFN),Y,20)'="" XECUTE $PIECE(YLF(YLFN),Y,20)
	. . . IF $FIND($PIECE(YLF(YLFN),Y,16),1) WRITE "<STRONG><B>"
	. . . IF $FIND($PIECE(YLF(YLFN),Y,16),2) WRITE "<U>"
	. . . IF $FIND($PIECE(YLF(YLFN),Y,16),3) WRITE "<I>"
	. . . IF $FIND($PIECE(YLF(YLFN),Y,16),4) WRITE "<STRIKE>"
	. . . SET YKOPF=1 DO DRU1
	. . . IF $FIND($PIECE(YLF(YLFN),Y,16),1) WRITE "</STRONG></B>"
	. . . IF $FIND($PIECE(YLF(YLFN),Y,16),2) WRITE "</U>"
	. . . IF $FIND($PIECE(YLF(YLFN),Y,16),3) WRITE "</I>"
	. . . IF $FIND($PIECE(YLF(YLFN),Y,16),4) WRITE "</STRIKE>"
	. . . QUIT
	. . SET XYLFN=YLFN
	. . SET YKOPF=0
	. . ;I $P(YLF(YLFN),Y,15)'="" W "<U>"
	. . DO DRU1
	. . ;I $P(YLF(YLFN),Y,15)'="" W "</U>"
	
	IF YSATZNUM(1)<7 DO    
	. Q:$PIECE($GET(^WWW012(0,YM,1)),Y,144)=1  ;NICHT ANZEIGEN;TYBD;8,09,2003;24248
	. NEW YI
	. FOR YI=YSATZNUM(1):1:7 DO
	. . QUIT:YI=0
	. . SET ^WWWSOR(YUSER,1," ",$EXTRACT("              ",1,YI))="" 
	. . SET ^WWWSOR(YUSER,2," ")=1
	. . QUIT
	. SET XYLFN=YLFN
	. SET YKOPF=0
	. SET YKEY=" " FOR  SET YKEY=$ORDER(^WWWSOR(YUSER,1," ",YKEY)) QUIT:YKEY=""  DO
	. . SET YFELD=$$^WWWSETL($GET(^WWWSOR(YUSER,1," ",YKEY)))
	. . SET YLFN=$GET(^WWWSOR(YUSER,2," "))
	. . QUIT:YLFN=""
	. . DO DRU1
	
	;D LF
	SET YLFN="" FOR  SET YLFN=$ORDER(^WWW131(0,YFORM,YLFN)) QUIT:YLFN=""  DO
	. SET YKOPF=2 DO DRU1
	. IF $PIECE(YLF(YLFN),Y,14)="1" DO LF WRITE $$^WWWTEXT(153)," ("_YLFN_")"_": " WRITE $JUSTIFY(YSATZNUM(YLFN),5,0)
	
	WRITE "</TR>"
	
	;ENDE ;termination 
	KILL ^WWWSOR(YUSER)
	DO ^WWWFRAME(1)
	SET YCR=$CHAR(13,10)
	QUIT
	
DRU1 ;
	;WENN YKOPF=0 DANN NORMALER INHALT AUS DATEI ;when purport out of data file 
	;WENN YKOPF=1 DANN UEBERSCHRIFT ;when 
	;WENN YKOPF=2 DANN FUSSZEILE ;when 
	NEW I,YA
	SET YDDSATZ=YDDSATZ+1
	IF XYLFN'="" DO LF
	SET XZEIL=1
	IF YKOPF=0 DO   ;LFDNUMMER
	. QUIT:$TRANSLATE($GET(YKEY)," ")=""   ;KEIN KEY  ;no KEY 
	. SET YSATZNUM(YLFN)=YSATZNUM(YLFN)+1
	. IF $PIECE(YLF(YLFN),Y,13)="1" WRITE $JUSTIFY(YSATZNUM(YLFN),3,0)," "
	
	IF YKOPF=2 IF $PIECE(YLF(YLFN),Y,13)="1" WRITE "    "
	
	;DRUCKEN DER EINZELFELDER , AUS VORSORTIERUNG WWWSOR
	FOR FART=1,2 SET ZEIL="" FOR  SET ZEIL=$ORDER(^WWWSOR(YUSER,3,YLFN,FART,ZEIL)) QUIT:ZEIL=""  DO
	. SET POS="" FOR  SET POS=$ORDER(^WWWSOR(YUSER,3,YLFN,FART,ZEIL,POS)) QUIT:POS=""  DO
	. . SET BEA="" FOR  SET BEA=$ORDER(^WWWSOR(YUSER,3,YLFN,FART,ZEIL,POS,BEA)) QUIT:BEA=""  DO
	. . . SET PRUEF=$GET(^WWWSOR(YUSER,3,YLFN,FART,ZEIL,POS,BEA))
	. . . QUIT:PRUEF=""
	. . . FOR I=XZEIL:1:+ZEIL-1 DO LF
	. . . SET YZEIL=+ZEIL
	. . . IF YKOPF=2 WRITE "<B>"
	. . . IF YHTML=1 IF YKOPF=1 DO  ;FORMATE
	. . . . IF $FIND($PIECE(YLF(YLFN),Y,16),1) WRITE "<STRONG><B>"
	. . . . IF $FIND($PIECE(YLF(YLFN),Y,16),2) WRITE "<U>"
	. . . . IF $FIND($PIECE(YLF(YLFN),Y,16),3) WRITE "<I>"
	. . . . IF $FIND($PIECE(YLF(YLFN),Y,16),4) WRITE "<STRIKE>"
	. . . . QUIT
	. . . IF $FIND($PIECE(PRUEF,Y,11),1) WRITE "<STRONG><B>"
	. . . IF $FIND($PIECE(PRUEF,Y,11),2) WRITE "<U>"
	. . . IF $FIND($PIECE(PRUEF,Y,11),3) WRITE "<I>"
	. . . IF $FIND($PIECE(PRUEF,Y,11),4) WRITE "<STRIKE>"
	. . . IF YHTML=0 WRITE ?POS    ;WENN PRE-FORMATED  ;when 
	. . . IF FART=1 DO  ;WENN DATEIVORGABE ;when 
	. . . . SET XLFN=BEA
	. . . . IF YKOPF=0 IF $PIECE(PRUEF,Y,8)'="" SET @$PIECE(PRUEF,Y,8)=YINHALT
	. . . . SET YINHALT=$PIECE(YKEY,",",BEA)
	. . . . IF YKOPF=2 SET YINHALT="" DO
	. . . . . IF $PIECE(PRUEF,Y,17)=1 SET YINHALT=$GET(^WWWSOR(YUSER,5,YLFN,"1",BEA))
	. . . . . IF $PIECE(PRUEF,Y,18)=1 IF +YSATZNUM(YLFN)'=0 SET YINHALT=$JUSTIFY($GET(^WWWSOR(YUSER,5,YLFN,"1",BEA))/YSATZNUM(YLFN),0,2)
	. . . . . QUIT
	. . . . IF YKOPF=0 IF $PIECE(PRUEF,Y,17)=1!($PIECE(PRUEF,Y,18)=1) SET ^WWWSOR(YUSER,5,YLFN,FART,BEA)=$GET(^WWWSOR(YUSER,5,YLFN,FART,BEA))+YINHALT
	. . . . QUIT:$PIECE(PRUEF,Y,9)=1
	. . . . DO KEY^WWWLISTF
	. . . . IF YKOPF=1 IF +$PIECE(PRUEF,Y,7)=0 SET YINHALT=""  ;KEIN KOPF ;no pate 
	. . . . IF $PIECE(PRUEF,Y,22)'="" DO  ;EXTRA RELATION AUS LISTGENERATOR DEFINITION ;extra out of 
	. . . . . NEW YDAT,YKE,YFE,YSAT,YDATA
	. . . . . IF $PIECE(PRUEF,Y,24)'=1 QUIT   ;KEIN AUSDRUCK ;no term 
	. . . . . QUIT:YINHALT=""
	. . . . . SET YDAT=$PIECE(PRUEF,Y,22)
	. . . . . SET YKE=$PIECE(PRUEF,Y,23)
	. . . . . IF YKE'="" IF $EXTRACT(YKE)'="""" QUIT
	. . . . . SET YFE=$PIECE(PRUEF,Y,24)
	. . . . . IF +YFE=0 SET YFE=1
	. . . . . SET YSAT="^"_YDAT_"("_$$^WWWYM(YDAT,1)
	. . . . . SET YDATA=$GET(^WWW001(0,YDAT,1))
	. . . . . IF YKE'="" IF $EXTRACT(YKE)'="," SET YSAT=YSAT_YKE_","
	. . . . . IF $PIECE(YDATA,Y,8)'=4 SET YSAT=YSAT_""""_$TRANSLATE(YINHALT,"""")_""""_",1)"
	. . . . . IF $PIECE(YDATA,Y,8)=4 SET YSAT=YSAT_""""_$TRANSLATE(YINHALT,"""")_""""_")"
	. . . . . SET YINHALT=YINHALT_" "_$PIECE($$^WWWSETL(YSAT),Y,YFE)_" "
	. . . . . QUIT
	. . . . QUIT
	. . . IF FART=2 DO
	. . . . SET XLFN=+$PIECE(PRUEF,Y,1)
	. . . . SET YINHALT=$PIECE(YFELD,Y,+$PIECE(PRUEF,Y,1))
	. . . . IF YKOPF=0 IF $PIECE(PRUEF,Y,8)'="" SET @$PIECE(PRUEF,Y,8)=YINHALT
	. . . . IF YKOPF=2 SET YINHALT="" DO
	. . . . . IF $PIECE(PRUEF,Y,17)=1 SET YINHALT=$GET(^WWWSOR(YUSER,5,YLFN,"2",BEA))
	. . . . . IF $PIECE(PRUEF,Y,18)=1 IF +YSATZNUM(YLFN)'=0 SET YINHALT=$JUSTIFY($GET(^WWWSOR(YUSER,5,YLFN,"2",BEA))/YSATZNUM(YLFN),0,2)
	. . . . . QUIT
	. . . . IF YKOPF=0 IF $PIECE(PRUEF,Y,17)=1!($PIECE(PRUEF,Y,18)=1) SET ^WWWSOR(YUSER,5,YLFN,FART,BEA)=$GET(^WWWSOR(YUSER,5,YLFN,FART,BEA))+YINHALT
	. . . . QUIT:$PIECE(PRUEF,Y,9)=1    
	. . . . DO DATEN^WWWLISTF
	. . . . IF YKOPF=1 IF +$PIECE(PRUEF,Y,7)=0 SET YINHALT=""  ;KEIN KOPF ;no pate 
	. . . . IF $PIECE(PRUEF,Y,22)'="" DO  ;EXTRA RELATION AUS LISTGENERATOR DEFINITION ;extra out of 
	. . . . . NEW YDAT,YKE,YFE,YSAT,YDATA
	. . . . . IF $PIECE(PRUEF,Y,24)'=1 QUIT   ;KEIN AUSDRUCK ;no term 
	. . . . . QUIT:YINHALT=""
	. . . . . SET YDAT=$PIECE(PRUEF,Y,22)
	. . . . . SET YKE=$PIECE(PRUEF,Y,23)
	. . . . . IF YKE'="" IF $EXTRACT(YKE)'="""" QUIT
	. . . . . SET YFE=$PIECE(PRUEF,Y,24)
	. . . . . IF +YFE=0 SET YFE=1
	. . . . . SET YSAT="^"_YDAT_"("_$$^WWWYM(YDAT,1)
	. . . . . SET YDATA=$GET(^WWW001(0,YDAT,1))
	. . . . . IF YKE'="" IF $EXTRACT(YKE)'="," SET YSAT=YSAT_YKE_","
	. . . . . IF $PIECE(YDATA,Y,8)'=4 SET YSAT=YSAT_""""_$TRANSLATE(YINHALT,"""")_""""_",1)"
	. . . . . IF $PIECE(YDATA,Y,8)=4 SET YSAT=YSAT_""""_$TRANSLATE(YINHALT,"""")_""""_")"
	. . . . . SET YINHALT=YINHALT_" "_$PIECE($$^WWWSETL(YSAT),Y,YFE)_" "
	. . . . . QUIT
	. . . . QUIT
	. . . ;I YINHALT'="" I $F(YINHALT,".GIF")!($F(YINHALT,".gif")) D  Q
	. . . . WRITE "<IMG SRC="_""""_YGIF1_$TRANSLATE(YINHALT,"| ")_""""_" BORDER=2 WIDTH="_""""_100_""""_" HEIGHT=100 ALIGN=LEFT TITLE="_""""_$PIECE(YINHALT,".",1)_""""_">"
	. . . . DO LF
	. . . . QUIT
	. . . IF YKOPF=0 IF $PIECE(PRUEF,Y,6)'="" SET YINHALT=$PIECE(PRUEF,Y,6)_" "_YINHALT
	. . . IF YKOPF=1 DO
	. . . . IF YHTML=0 IF +$PIECE(PRUEF,Y,7)=0 SET YINHALT=$EXTRACT("                                                                 ",1,$LENGTH(YINHALT))     ;NICHT NUR BEI <PRE> SONDERN IMMER;TYBD;23,6,2004;25972
	. . . . ;IF +$PIECE(PRUEF,Y,16)=0 SET $PIECE(PRUEF,Y,16)=$LENGTH(YINHALT) SET ^WWWSOR(YUSER,3,YLFN,FART,ZEIL,POS,BEA)=PRUEF
	. . . . IF YHTML=0 IF +$PIECE(PRUEF,Y,16)=0 SET $PIECE(PRUEF,Y,16)=$LENGTH(YINHALT) SET ^WWWSOR(YUSER,3,YLFN,FART,ZEIL,POS,BEA)=PRUEF
	. . . . IF YHTML'=0 SET ^WWWSOR(YUSER,3,YLFN,FART,ZEIL,POS,BEA)=PRUEF                                           ;BEC;
	. . . . QUIT
	. . . ;IF YHTML=0 IF +$PIECE(PRUEF,Y,16)'=0 SET YINHALT=$EXTRACT(YINHALT_"                                                                 ",1,$PIECE(PRUEF,Y,16))  ;NICHT NUR BEI <PRE> SONDERN IMMER;TYBD;23,6,2004;25972
	. . . IF +$PIECE(PRUEF,Y,16)'=0 SET YINHALT=$EXTRACT(YINHALT_"                                                                 ",1,$PIECE(PRUEF,Y,16))
	. . . IF FART=1 IF YLFORM(YLFN)'="" DO
	. . . . WRITE "<A HREF="_""""_YAKTION_"EP=WWWFORM&amp;YFORM="_YLFORM(YLFN)
	. . . . ;-------- RÜCKSPRUNG INS ÜBERFORMULAR -------- FIS, 20.03.02
	. . . . ;IF $FIND(YKEY,",") DO  ;UNTERFORMULAR  ->FUNKTIONIERT NOCH NICHT
	. . . . . NEW YDATEI,YFKEY,YSUCH
	. . . . . SET (YFKEY,YSUCH)=""
	. . . . . FOR  SET YSUCH=$ORDER(^WWW121(0,YLFORM(YLFN),YSUCH)) QUIT:YSUCH=""  DO  QUIT:YFKEY'=""  ;SUCHEN FIXKEY AUS VORDATEI ;seek out of 
	. . . . . . IF $PIECE($GET(^WWW121(0,YLFORM(YLFN),YSUCH,1)),Y,16)=1 SET YFKEY=$PIECE(YKEY,",",YSUCH)
	. . . . . . QUIT
	. . . . . QUIT:YFKEY=""!(YSUCH="")
	. . . . . SET YDATEI=$PIECE($GET(^WWW002(0,YLFORM(YLFN),YSUCH,1)),Y,8)  ;VORDATEI
	. . . . . QUIT:'$DATA(^WWW120(0,YDATEI))  ;OHNE FORMULAR ;without form 
	. . . . . WRITE "&amp;YBACK="_YDATEI_",&amp;YFKEY="_YFKEY
	. . . . . QUIT
	. . . . ;----------------------------------------------
	. . . . DO
	. . . . . NEW YBACK
	. . . . . SET YBACK=YFORM_","
	. . . . . DO ^WWWCGI
	. . . . . QUIT
	. . . . WRITE """"_">"
	. . . . QUIT
	. . . IF YKOPF=2 IF $PIECE(PRUEF,Y,18)=1 IF $GET(^WWWSOR(YUSER,5,YLFN,"2",BEA))'="" WRITE "&Oslash;"
	. . . IF $PIECE(PRUEF,Y,9)'=1 WRITE $$^WWWUML(YINHALT)
	. . . IF YHTML=0 WRITE " "
	. . . IF FART=1 IF YLFORM(YLFN)'="" WRITE "</A>"
	. . . IF YKOPF=2 WRITE "</B>"
	. . . IF YHTML=1 IF YKOPF=1 DO
	. . . . IF $FIND($PIECE(YLF(YLFN),Y,16),1) WRITE "</STRONG></B>"
	. . . . IF $FIND($PIECE(YLF(YLFN),Y,16),2) WRITE "</U>"
	. . . . IF $FIND($PIECE(YLF(YLFN),Y,16),3) WRITE "</I>"
	. . . . IF $FIND($PIECE(YLF(YLFN),Y,16),4) WRITE "</STRIKE>"
	. . . . QUIT
	. . . IF $FIND($PIECE(PRUEF,Y,11),1) WRITE "</STRONG></B>"
	. . . IF $FIND($PIECE(PRUEF,Y,11),2) WRITE "</U>"
	. . . IF $FIND($PIECE(PRUEF,Y,11),3) WRITE "</I>"
	. . . IF $FIND($PIECE(PRUEF,Y,11),4) WRITE "</STRIKE>"
	. . . IF YHTML=1 DO
	. . . . QUIT:$PIECE(PRUEF,Y,9)=1  ;NUR RECHENFELD ;only 
	. . . . IF $TRANSLATE(YINHALT," ")="" WRITE "&nbsp;"
	. . . . WRITE YCR
	. . . . WRITE "</TD>"
	. . . . ;TYBD;30,06,2003;23860;AUSRICHTUNG
	. . . . IF FART=2 DO  ;FELD AUSRICHTUNG NEXT ;field 
	. . . . . NEW POS1,BEA1
	. . . . . SET POS1=POS
	. . . . . SET BEA1=BEA
	. . . . . SET BEANE=$ORDER(^WWWSOR(YUSER,3,YLFN,FART,ZEIL,POS1,BEA1)) 
	. . . . . IF BEANE="" SET POS1=$ORDER(^WWWSOR(YUSER,3,YLFN,FART,ZEIL,POS1)) SET BEA1=""
	. . . . . QUIT:POS1=""
	. . . . . SET BEANE=$ORDER(^WWWSOR(YUSER,3,YLFN,FART,ZEIL,POS1,BEA1)) IF BEANE'="" DO
	. . . . . . ;
	. . . . . . SET BEANP=^WWWSOR(YUSER,3,YLFN,FART,ZEIL,POS1,BEANE) 
	. . . . . . SET XLFN=+$PIECE(BEANP,Y,1)
	. . . . . . QUIT:XLFN=0
	. . . . . . SET YTYP=$PIECE($GET(^WWW003(0,YDATEI(YLFN),XLFN,1)),Y,3)
	. . . . . . WRITE "<TD NOWRAP"
	. . . . . . DO
	. . . . . . . QUIT:$FIND(",2,3,5,6,10,11,",","_YTYP_",")
	. . . . . . . WRITE " ALIGN=RIGHT"
	. . . . . . . QUIT
	. . . . . . IF YKOPF=0 IF YDDSATZ#2=1 WRITE " BGCOLOR="_YWHITE
	. . . . . . IF YKOPF=0 IF YDDSATZ#2=0 WRITE " BGCOLOR="_YGRAY
	. . . . . . IF YKOPF=1 IF YDDSATZ#2=0 WRITE " BGCOLOR="_YSILVER
	. . . . . . WRITE ">"
	. . . . . . IF $PIECE(YVOR,Y,7)'="" WRITE "<FONT SIZE="_""""_$PIECE(YVOR,Y,7)_""""_">"
	. . . . . . QUIT
	. . . . . QUIT
	. . . . IF FART=1 DO  ;FELD AUSRICHTUNG NEXT WENN FELD=KEY ;field when 
	. . . . . QUIT:$ORDER(^WWWSOR(YUSER,3,YLFN,FART,ZEIL,POS,BEA))'=""   ;NOCH KEYS VORHANDEN ;yet on hand 
	. . . . . NEW ZEIL1,POS1,YLFN1
	. . . . . SET YLFN1="" FOR  SET YLFN1=$ORDER(^WWWSOR(YUSER,3,YLFN1)) QUIT:YLFN1=""  IF $DATA(^WWWSOR(YUSER,3,YLFN1,2)) QUIT  ;VORHANDEN ;on hand 
	. . . . . QUIT:YLFN1=""
	. . . . . SET ZEIL1=$ORDER(^WWWSOR(YUSER,3,YLFN,2,""))
	. . . . . QUIT:ZEIL1=""
	. . . . . SET POS1=$ORDER(^WWWSOR(YUSER,3,YLFN,2,ZEIL1,""))
	. . . . . QUIT:POS1=""
	. . . . . SET BEANE=$ORDER(^WWWSOR(YUSER,3,YLFN,2,ZEIL1,POS1,"")) IF BEANE'="" DO   ;ERSTES DATENFELD ;premier data item 
	. . . . . . SET BEANP=^WWWSOR(YUSER,3,YLFN,2,ZEIL1,POS1,BEANE) 
	. . . . . . SET XLFN=+$PIECE(BEANP,Y,1)
	. . . . . . QUIT:XLFN=""
	. . . . . . SET YTYP=$PIECE($GET(^WWW003(0,YDATEI(YLFN),XLFN,1)),Y,3)
	. . . . . . WRITE "<TD NOWRAP"
	. . . . . . DO
	. . . . . . . QUIT:$FIND(",2,3,5,6,10,11,",","_YTYP_",")
	. . . . . . . WRITE " ALIGN=RIGHT"
	. . . . . . . QUIT
	. . . . . . IF YKOPF=0 IF YDDSATZ#2=1 WRITE " BGCOLOR="_YWHITE
	. . . . . . IF YKOPF=0 IF YDDSATZ#2=0 WRITE " BGCOLOR="_YGRAY
	. . . . . . IF YKOPF=1 IF YDDSATZ#2=0 WRITE " BGCOLOR="_YSILVER
	. . . . . . WRITE ">"
	. . . . . . IF $PIECE(YVOR,Y,7)'="" WRITE "<FONT SIZE="_""""_$PIECE(YVOR,Y,7)_""""_">"
	. . . . . . QUIT
	. . . . IF FART=1 DO  ;FELD AUSRICHTUNG NEXT WENN FELD=KEY ;field when 
	. . . . . ;QUIT:$ORDER(^WWWSOR(YUSER,3,YLFN,2,""))=""   ;NOCH KEYS VORHANDEN
	. . . . . QUIT:$ORDER(^WWWSOR(YUSER,3,YLFN,FART,ZEIL,POS,BEA))=""   ;NOCH KEYS VORHANDEN ;yet on hand 
	. . . . . SET BEANE=$ORDER(^WWWSOR(YUSER,3,YLFN,FART,ZEIL,POS,BEA)) IF BEANE'="" DO   ;NAOCH KEY
	. . . . . . SET BEANP=^WWWSOR(YUSER,3,YLFN,FART,ZEIL,POS,BEANE) 
	. . . . . . SET XLFN=+$PIECE(BEANP,Y,1)
	. . . . . . QUIT:XLFN=""
	. . . . . . SET YTYP=$PIECE($GET(^WWW002(0,YDATEI(YLFN),XLFN,1)),Y,3)
	. . . . . . WRITE "<TD NOWRAP"
	. . . . . . DO
	. . . . . . . QUIT:$FIND(",2,3,5,6,10,11,",","_YTYP_",")
	. . . . . . . WRITE " ALIGN=RIGHT"
	. . . . . . . QUIT
	. . . . . . IF YKOPF=0 IF YDDSATZ#2=1 WRITE " BGCOLOR="_YWHITE
	. . . . . . IF YKOPF=0 IF YDDSATZ#2=0 WRITE " BGCOLOR="_YGRAY
	. . . . . . IF YKOPF=1 IF YDDSATZ#2=0 WRITE " BGCOLOR="_YSILVER
	. . . . . . WRITE ">"
	. . . . . . IF $PIECE(YVOR,Y,7)'="" WRITE "<FONT SIZE="_""""_$PIECE(YVOR,Y,7)_""""_">"
	
	QUIT
	
LF ;LINE FEED
	IF YHTML=0 DO LF^WWWW() QUIT
	IF YHTML=1 DO
	. WRITE YCR
	. WRITE "</TD></TR>"
	. IF YKOPF'=1 WRITE "</THEAD>"  ;ÜBERSCHRIFT ;superscription 
	. WRITE $CHAR(10)_$CHAR(13)
	. WRITE "<TR><TD NOWRAP"
	. IF YKOPF=0 DO
	. . IF YDDSATZ#2=1 WRITE " BGCOLOR="_YWHITE
	. . IF YDDSATZ#2=0 WRITE " BGCOLOR="_YGRAY
	. . QUIT
	. IF YKOPF=1 DO
	. . WRITE " BGCOLOR="_YSILVER
	. . QUIT
	. WRITE ">"
	. IF $PIECE(YVOR,Y,7)'="" WRITE "<FONT SIZE="_""""_$PIECE(YVOR,Y,7)_""""_">"
	
	QUIT
	
]]></Routine>
</Export>