<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="22" zv="CACHE" ts="2001-01-01 00:00:00">
<Routine name="INPROPROHTML" type="MAC" languagemode="0" timestamp="58440,0"><![CDATA[
INPROPROHTML(YSTEMPEL)
	;-------------------------------------------------------------------------------
	; Description of Function :
	;		PRODUKTIONSANWEISUNG HTML
	;	INSTRUCTION FOR PRODUCTION HTML
	;
	; Inputs : 
	;
	;
	; ByRef :
	;
	;
	; Returns :
	;
	;
	; History :
	; 26-Jul-2006	GRF		Doco; !=>||; quits
	; 06.11.2002	ULM		Created
	;-------------------------------------------------------------------------------
	;@HELP@
	;Verwendbare Sonder-Tags:
	;<FERTIGUNGSNUMMER></FERTIGUNGSNUMMER>          = NUMMER UND UNTERNUMMER (ARBEITSGANG) DER FERTIGUNGSANWEISUNG ;numeral And the 
	;<FERTIGUNGSBEGINN></FERTIGUNGSBEGINN>          = GEPLANTES DATUM DER FERTIGUNG ;Date the 
	;<AUFTRAG></AUFTRAG>                            = AUFTRAGSNUMMER
	;<POSITION></POSITION>                          = AUFTRAGSPOSITION
	;<ARTIKEL></ARTIKEL>                            = ARTIKELNUMMER UND BEZEICHNUNG DER AUFTRAGSPOSITION ;And notation the 
	;<KOMMISSION></KOMMISSION>                      = KOMMISSION/PROJEKT/VORGANGSNUMMER
	;<TEIL></TEIL>                                  = ARTIKELNUMMER UND BEZEICHNUNG DES ZU PRODUZIERENDEN TEILES ;And notation within 
	;<AUSFUEHRUNG></AUSFUEHRUNG>                    = AUSFÜHRUNGSTEXT
	;<MENGE></MENGE>                                = ZU PRODUZIERENDE MENGE ;within quantity 
	;<FERTIGUNGSPLATZ></FERTIGUNGSPLATZ>            = FERTIGUNGSPLATZ
	;<PRODUKTIONSANWEISUNG></PRODUKTIONSANWEISUNG>  = PRODUKTIONSANWEISUNGEN DER FERTIGUNG ;the 
	;<ABTEILUNG></ABTEILUNG>                        = ZUSTÄNDIGE ABTEILUNG ;speciality 
	;<NEXTFERTIGUNGSPLATZ></NEXTFERTIGUNGSPLATZ>    = NÄCHSTER FERTIGUNGSPLATZ NACH FERTIGUNG ;within 
	;<BESTELLER></BESTELLER>                        = KUNDENINFORMATIONEN BEI BESTELLUNGEN ;next to 
	;<QUALITAETSPRUEFUNG></QUALITAETSPRUEFUNG>      = QUALITÄTS-PRÜFUNGSVORSCHRIFTEN
	;<BARCODE></BARCODE>                            = BARCODE DER FERTIGUNGSNUMMER ;the 
	;<DATUM></DATUM>                                = TAGESDATUM DES AUSDRUCKES
	;<MAXTEILE>40</MAXTEILE>                        = MAXIMALE ANZAHL UNTERTEILE JE BLATT (AUSDRUCK) ;Number once sheet 
	;..<UNTERTEILE>                                     = AB HIER ANGABEN DER UNTERTEILE
	;....<LFN>.)</LFN>                                  = LFD. NUMMER DES UNTERTEILS (AUFZÄHLUNGSSYMBOL OPTIONAL)
	;....<ARTIKEL></ARTIKEL>                            = ARTIKELNUMMER DES UNTERTEILS
	;....<BEZEICHNUNG></BEZEICHNUNG>                    = ARTIKELBEZEICHNUNG DES UNTERTEILS
	;....<PRODUKTIONSANWEISUNG></PRODUKTIONSANWEISUNG>  = PRODUKTIONSANWEISUNGEN DER FERTIGUNG
	;....<WARENHERKUNFT></WARENHERKUNFT>                = WARENHERKUNFT DES UNTERTEILS
	;....<MENGE></MENGE>                                = BENÖTIGTE MENGE FÜR DIE PRODUKTION
	;....<FERTIGUNGSZEIT></FERTIGUNGSZEIT>              = DAUER DES ARBEITSSCHRITTES (AUSFÜHRUNGSZEIT)
	;....<RUESTZEIT></RUESTZEIT>                        = MASCHINENRÜSTZEIT
	;..</UNTERTEILE>                                   
	;<GESDAUER></GESDAUER>                           = GESAMT AUSFÜHRUNGSZEIT DER LEISTUNGEN ;total execution time the LEISTUNGEN 
	;<GESRUESTZEIT></GESRUESTZEIT>                   = GESAMTRÜSTZEIT
	;<GESAMTZEIT><GESAMTZEIT>                        = GESAMT FERTIGUNGSDAUER ;total 
	;<SEITE></SEITE>                                 = SEITENANGABE (UNTER BERÜCKSICHTIGUNG DER <MAXTEILE>) ;the 
	;<ANLAGEn>..HTML-TEXT...</ANLAGEn>               = HTML-CODE FÜR EINE ANLAGE JE ABTEILUNG(n) Z.B. ERFASSUNGSLISTE
	;@END@
	;-------------------------------------------------------------------------------
	
	NEW UNTERPUNKT,YDATEI,YDATEI1,YI,YAUF,YPOS,YTEIL1,GESAMTZEIT,MITZEITEN,ZEITFACT,ANZEIGE,ABANZEIGE,BISANZEIGE,FMASCH,FPLATZ
	NEW FBEGINN,UNTERTX,MITKOM,MITSTRUKTUR,GEB,YGESAMT,HTML,SEITE,MAXTEILE
	
	SET YNOFOOT    = 1  ;KEINFUSS
	SET GESAMTZEIT = 0  ;GESAMTZEIT DER GEPLANTEN FERTIGUNG ;the 
	SET UNTERPUNKT = 0
	
	;YLFN=UNTERTEILESTRUKTUR AB DER GEDRUCKT WIRD (AUS DATEI INAUFPXL,AUF,POS,TEIL1,TEILn)
	SET YSTEMPEL1=""
	SET YSTEMPEL=$GET(YSTEMPEL)
	IF YSTEMPEL'="" SET YSTEMPEL1=$GET(^INPROSTEMP(YM,YSTEMPEL,1))
	IF YSTEMPEL1="" IF YSTEMPEL'="" SET YSTEMPEL1=$GET(^INPROSTEMP1(YM,YSTEMPEL,1))  ;AUS ALTENSTEMPELNUMMERN ;out of 
	
	SET YLFN=$PIECE(YSTEMPEL1,Y,6)
	SET YAUF=$PIECE(YSTEMPEL1,Y,1)			QUIT:$GET(YAUF)=""
	SET YPOS=$PIECE(YSTEMPEL1,Y,3)			QUIT:$GET(YPOS)=""
	
	SET MITKOM      = $PIECE($GET(^INVORG(YM,YM,1)),Y,19)   ;MIT KUNDENNNAME ;by means of 
	SET MITSTRUKTUR = $PIECE($GET(^INVORG(YM,YM,1)),Y,27)   ;MIT TEILESTRUKTUR? 1=JA ;by means of 
	SET MITZEITEN   = $PIECE($GET(^INVORG(YM,YM,1)),Y,42)   ;OHNE EINZELZEITEN?  1=OHNE ;without 
	
	;HOLEN HTML-VORLAGE ;send for 
	SET HTML=$PIECE($GET(^WWWHTML($$^WWWYM("WWWHTML"),"INPROPROHTML",SPRACHE,1)),Y,1)  ;MANDANT-KEY=MANDANTÜBERGREIFEND  
	IF HTML="" DO CREATE
	;SET HTML="" DO CREATE
	SET HTML=$TRANSLATE(HTML,$CHAR(9),"|")
	SET HTML=$PIECE(HTML,"<UNTERTEILE>",1)_"<UNTERTEILE>"_$TRANSLATE($PIECE($PIECE(HTML,"<UNTERTEILE>",2),"</UNTERTEILE>",1),"|")_"</UNTERTEILE>"_$PIECE(HTML,"</UNTERTEILE>",2)
	IF $FIND(HTML,"<ANLAGE") DO
	. NEW ANLAGE
	. SET ANLAGE=$PIECE($PIECE(HTML,"<ANLAGE",2),">",1)
	. SET HTML=$PIECE(HTML,"<ANLAGE"_ANLAGE_">",1)_"<ANLAGE"_ANLAGE_">"_$TRANSLATE($PIECE($PIECE(HTML,"<ANLAGE"_ANLAGE_">",2),"</ANLAGE"_ANLAGE_">",1),"|")_"</ANLAGE"_ANLAGE_">"_$PIECE(HTML,"</ANLAGE"_ANLAGE_">",2)
	
	;ZUSAMMENBAUEN DER DATEI ZUM DURCHSUCHEN DER EBENE ;the data file scour the plain 
	KILL YDATEI
	SET YDATEI="^INAUFPXL("_""""_YM_""""
	FOR YI=1:1 QUIT:$PIECE(YLFN,",",YI)=""  DO  
	. SET YDATEI=YDATEI_","_""""_$PIECE(YLFN,",",YI)_""""
	. SET YDATEI(YI)=YDATEI_")"  ;GGF FÜR UNTERDATEIEN ;to 
	
	SET YDATEI(0)=YDATEI_")"
	SET YXL=$GET(@(YDATEI(0)))   ;POSITIONSDATEN
	SET YZWEITSCHRIFT=""  ;KEIN WIEDERHOLUNGSDRUCK ;no 
	IF $PIECE(YXL,Y,165)=YSTEMPEL SET YZWEITSCHRIFT=$$^WWWTEXT(32296)  ;WIEDERHOLUNGSDRUCK
	IF $DATA(^INPROSTEMP(YM,YSTEMPEL)) DO  ;FIS;SPEICHERN FÜR WWIEDERHOLUNGSDRUCK;25955;02.07.04
	. IF $PIECE($GET(^INPROSTEMP(YM,YSTEMPEL,1)),Y,30)=1 SET YZWEITSCHRIFT=$$^WWWTEXT(32296)  ;WIEDERHOLUNGSDRUCK
	. IF YZWEITSCHRIFT'="" SET $PIECE(^INPROSTEMP(YM,YSTEMPEL,1),Y,30)=1  ;ACHTUNG MEHRFACHDRUCK (UNTERNUMMERN) ;estimation 
	
	IF $DATA(^INPROSTEMP1(YM,YSTEMPEL)) DO  ;FIS;SPEICHERN FÜR WWIEDERHOLUNGSDRUCK;25955;02.07.04
	. IF $PIECE($GET(^INPROSTEMP1(YM,YSTEMPEL,1)),Y,30)=1 SET YZWEITSCHRIFT=$$^WWWTEXT(32296)  ;WIEDERHOLUNGSDRUCK
	. IF YZWEITSCHRIFT'="" SET $PIECE(^INPROSTEMP1(YM,YSTEMPEL,1),Y,30)=1  ;ACHTUNG MEHRFACHDRUCK (UNTERNUMMERN) ;estimation 
	
	SET $PIECE(YXL,Y,165)=YSTEMPEL
	SET $PIECE(@(YDATEI(0)),Y,165)=YSTEMPEL
	IF $PIECE(@(YDATEI(0)),Y,83)="" DO   ;WANN GEDRUCKT ;when 
	. SET $PIECE(@(YDATEI(0)),Y,83)=+$HOROLOG
	. SET $PIECE(@(YDATEI(0)),Y,51)=+$HOROLOG
	. SET $PIECE(@(YDATEI(0)),Y,84)=$PIECE($HOROLOG,",",2)
	. SET $PIECE(@(YDATEI(0)),Y,85)=YBED
	. SET $PIECE(@(YDATEI(0)),Y,52)=YBED
	
	SET YDATEISUCH=YDATEI_","_"ANZEIGE"_")"  ;LAUFVARIABLE FÜR UNTERTEILE DATEN ;to 
	SET YDATEI=YDATEI_","_"YI"_")"  ;LAUFVARIABLE FÜR UNTERTEILE DATEN ;to 
	;FERTIGUNGSPLATZ/BEGINN/MASCHINE
	SET FBEGINN=$PIECE(YXL,Y,168)  ;FERTIGUNGSBEGINN
	SET FPLATZ(0)=$PIECE(YXL,Y,61)
	SET FPLATZ="" 
	IF $PIECE(YXL,Y,61)'="" SET FPLATZ=$EXTRACT($PIECE($GET(^INPRONEST(YM,$PIECE(YXL,Y,61),1)),Y,1),1,12) ;FERTIGUNGSPLATZ
	SET FMASCH="" 
	IF $PIECE(YXL,Y,57)'="" SET FMASCH=$EXTRACT($PIECE($GET(^INMASCH(YM,$PIECE(YXL,Y,57),1)),Y,1),1,12) ;FERTIGUNGSMASCHINE
	SET FIXPLATZ="" 
	DO
	. SET ANZEIGE=""
	. FOR  SET ANZEIGE=$ORDER(@(YDATEISUCH),-1) QUIT:ANZEIGE=""  DO  QUIT:FIXPLATZ'=""  ;SUCHEN IN UNTERTEILEDATEI WENN UNTERSCHIEDLICHE FERTIGUNGSMASCHIENEN ODER PLÄTZE ;seek within when Or 
	. . SET YXL1=$GET(@(YDATEISUCH))
	. . IF ($PIECE(YXL1,Y,40)=2) || ($PIECE(YXL1,Y,40)=10) || ($PIECE(YXL1,Y,40)=11) IF $PIECE(YXL1,Y,61)'="" SET FIXPLATZ=$PIECE(YXL1,Y,61) 
	
	IF FIXPLATZ="" SET FIXPLATZ=FPLATZ(0)
	IF FIXPLATZ'="" DO  ;NACHTRÄGLICH EINTRAGEN VON UNTEN NACH OBEN ;supplementary underneath within upstairs 
	. SET ANZEIGE=""
	. FOR  SET ANZEIGE=$ORDER(@(YDATEISUCH),-1) QUIT:ANZEIGE=""  DO  ;SUCHEN IN UNTERTEILEDATEI WENN UNTERSCHIEDLICHE FERTIGUNGSMASCHIENEN ODER PLÄTZE ;seek within when Or 
	. . SET YXL1=$GET(@(YDATEISUCH))
	. . IF ($PIECE(YXL1,Y,40)=2) || ($PIECE(YXL1,Y,40)=10) || ($PIECE(YXL1,Y,40)=11) IF $PIECE(YXL1,Y,61)'="" SET FIXPLATZ=$PIECE(YXL1,Y,61) QUIT
	. . SET $PIECE(@(YDATEISUCH),Y,61)=FIXPLATZ
	
	IF FIXPLATZ'="" SET FPLATZ=$EXTRACT($PIECE($GET(^INPRONEST(YM,FIXPLATZ,1)),Y,1),1,12) ;FERTIGUNGSPLATZ IN KLARSCHRIFT ;within 
	SET ANZEIGE    = 0    ;SUCHVARIABLE FUER FERTIGUNGSZWISCHENTEILE
	SET ABANZEIGE  = 0    ;AB TEILE POS ;Confirm. 
	SET BISANZEIGE = 0    ;BIS TEILEPOS ;until 
	SET YGESAMT    =0     ;SUMME FÜR AUSFÜHRUNGSZEIT ;sum to execution time 
	KILL ^INPROSTEMPT(YM,YSTEMPEL)           ;Löschen der alten stempeldatei ;Delete who 
	FOR UNTERTX=1:1 SET ANZEIGE=$ORDER(@(YDATEISUCH)) QUIT:ANZEIGE=""  DO  ;SUCHEN IN UNTERTEILEDATEI WENN UNTERSCHIEDLICHE FERTIGUNGSMASCHIENEN ODER PLÄTZE ;seek within when Or 
	. SET YXL1=$GET(@(YDATEISUCH))           ;DATENSATZ ;data record 
	. SET FPLATZ(1)=$PIECE(YXL1,Y,61)        ;FERTIGUNGSPLATZ DES DATENSATZES
	. IF FIXPLATZ="" SET FIXPLATZ=FPLATZ(1)  ;WENN KEINE VORGABE ;when no default 
	. IF $PIECE(YXL1,Y,40)'=2 IF $PIECE(YXL1,Y,40)'=10 IF $PIECE(YXL1,Y,40)'=11 QUIT  ;NUR WENN LEISTUNG;FIS;23889;07.07.03
	. QUIT:UNTERTX=1           ;NICHT BEIM ERSTEN TEIL ;Not part 
	. QUIT:FIXPLATZ=FPLATZ(1)  ;GLEICHER PLATZ   ;same square 
	. SET BISANZEIGE=ANZEIGE   ;NICHT DRUCKEN  (BISANZEIGE SOLL AUF NEXT  ;Not print upon 
	. IF $PIECE(YXL1,Y,168)'="" SET FBEGINN=$PIECE(YXL1,Y,168)  ;FERTIGUNGSBEGINN
	. IF FIXPLATZ'="" SET FPLATZ=$EXTRACT($PIECE($GET(^INPRONEST(YM,FIXPLATZ,1)),Y,1),1,12) ;FERTIGUNGSPLATZ IN KLARSCHRIFT ;within 
	. DO ANWEIS                ;DRUCKEN ZWISCHENANWEISUNG ;print 
	. IF $ORDER(@(YDATEISUCH))'="" DO FF^WWWW()  ;FORMFEED
	. SET FIXPLATZ=FPLATZ(1)   ;NEUER VORGABE PLATZ ;default square 
	. SET ABANZEIGE=ANZEIGE    ;NÄCHSTE ANZEIGE AB ;next Show Confirm. 
	
	IF FIXPLATZ'="" SET FPLATZ=$EXTRACT($PIECE($GET(^INPRONEST(YM,FIXPLATZ,1)),Y,1),1,12) ;FERTIGUNGSPLATZ IN KLARSCHRIFT ;within 
	SET ANZEIGE=BISANZEIGE,ABANZEIGE=ANZEIGE
	IF ANZEIGE'="" IF ($ORDER(@(YDATEISUCH))'="") || ($GET(@(YDATEISUCH))'="") SET BISANZEIGE=999999 DO ANWEIS   ;REST DRUCKEN ;residue print 
	SET ANZEIGE="" IF $ORDER(@(YDATEISUCH))="" DO ANWEIS  ;KEINE TEILE NUR HAUPTTEIL ;no only 
	IF $DATA(^INPROSTEMP(YM,YSTEMPEL))  SET $PIECE(^INPROSTEMP(YM,YSTEMPEL,1),Y,19)=GESAMTZEIT
	IF $DATA(^INPROSTEMP1(YM,YSTEMPEL)) SET $PIECE(^INPROSTEMP1(YM,YSTEMPEL,1),Y,19)=GESAMTZEIT
	DO  ;NEUAUFBAU DER TEILE ;the 
	. NEW YAUFTRAG,SATZ
	. QUIT:YAUF=""
	. SET YAUFTRAG=YAUF
	. QUIT:YPOS=""
	. SET SATZ=$GET(^INAUFP(YM,YAUFTRAG,YPOS,1))
	. DO ^INAUFTEILE(YAUFTRAG,YPOS)
	
	QUIT
	
ANWEIS ;BEGINN DER ANWEISUNG ;inauguration the 
	NEW YI,YI1,PROSEITE,UNTER,UNTERPUNKT,YDAUER,YRZEIT
	
	SET YPROSEITE=$GET(YPROSEITE)+1  ;SEITE (BLATT FERTIGUNGSANWEISUNG) ;side 
	SET SEITE  = 1  ;SEITEN GESAMT DIESER FERTIGUNGSANWEISUNG ;sidelong total this 
	SET UNTER  = 0  ;UNTERTEILE GEDRUCKT ?
	SET YDAUER = 0  ;GESAMT-PRODUKTIONSDAUER
	SET YRZEIT = 0  ;GESAMT-RÜSTZEIT
	
	;SUCHEN/FESTLEGEN UNTERPUNKT (ARBEITSGANG)
	SET UNTERPUNKT=0
	SET YI=""
	FOR  SET YI=$ORDER(@(YDATEI)) QUIT:YI=""  DO  QUIT:+UNTERPUNKT'=0  ;SUCHEN IN UNTERTEILEDATEI ;seek within 
	. QUIT:YI<$GET(ABANZEIGE)  ;ERST AB DIESEM TEIL ;only Confirm. part 
	. QUIT:YI=$GET(BISANZEIGE)  ;NUR BIS ZU DIESEM TEIL ;only until within part 
	. QUIT:YI>$GET(BISANZEIGE)  ;NUR BIS ZU DIESEM TEIL ;only until within part 
	. SET YXL1=$GET(@(YDATEI))
	. ;IF ($PIECE(YXL1,Y,40)=2) || ($PIECE(YXL1,Y,40)=10) || ($PIECE(YXL1,Y,40)=11) DO   ;MINUTEN STUNDEN INDUSTRIEMINUT
	. ;.SET UNTERPUNKT=YI
	. IF $PIECE(YXL1,Y,26)="" IF $PIECE(YXL1,Y,4)'="" SET $PIECE(YXL1,Y,26)=$PIECE($GET(^INART(YM,$PIECE(YXL1,Y,4),1)),Y,26)  ;FIS;31.10.03;24360
	. DO  ;FIS;08.07.03;23889
	. . IF ($PIECE(YXL1,Y,40)=2) || ($PIECE(YXL1,Y,40)=10) || ($PIECE(YXL1,Y,40)=11) IF $PIECE(YXL1,Y,26)'=1 DO  QUIT  ;NUR WENN LEISTUNG (AUSSER FREMDLEISTUNG) ;only when performance 
	. . . SET UNTERPUNKT=YI
	. . ;
	. . IF +UNTERPUNKT=0 SET UNTERPUNKT="X"_YI
	
	FOR YI1=1:1:1200 SET YI(1)=$PIECE(HTML,"|",YI1) DO  QUIT:$FIND(YI(1),"</HTML>")  ;LESEN HTML-CODE ;read 
	. DO TRANSLATE  ;UMWANDELN SONDER-TAGS ;transmute 
	. DO
	. . NEW I,YZWS,YII
	. . FOR YII=1:1 SET YZWS=$PIECE(YI(1),"|",YII) QUIT:$PIECE(YI(1),"|",YII,999)=""  DO
	. . . WRITE YZWS   ;$$^WWWUML(YZWS,1)
	. . . WRITE $CHAR(13)_$CHAR(10)
	
	DO FF^WWWW()
	QUIT
	
TRANSLATE   ;UMWANDELN ALLGEMEINE SONDER-TAGS ;transmute 
	;NEW MASCH
	;FESTLEGEN MAXIMALE ANZAHL UNTERTEILE PRO SEITE ;Number within side 
	;----------------------------------------------
	SET MAXTEILE=48
	IF $FIND(YI(1),"<MAXTEILE>") DO
	. SET MAXTEILE=$PIECE($PIECE(YI(1),"<MAXTEILE>",2),"</MAXTEILE>",1)
	. SET YI(1)=$PIECE(YI(1),"<MAXTEILE>",1)_$PIECE(YI(1),"</MAXTEILE>",2)
	. SET MAXTEILE=+MAXTEILE
	
	IF $FIND(YI(1),"<UNTERTEILE>") DO
	. NEW ZEILE
	. IF UNTER'=0 SET YI(1)=$PIECE(YI(1),"<UNTERTEILE>",1)_$PIECE(YI(1),"</UNTERTEILE>",2) QUIT  ;BEREITS GEDRUCKT ;yet 
	. SET ZEILE=$PIECE($PIECE(YI(1),"<UNTERTEILE>",2),"</UNTERTEILE>",1)
	. DO UNTERTEILE
	. SET YI(1)=$PIECE(YI(1),"<UNTERTEILE>",1)_ZEILE_$PIECE(YI(1),"</UNTERTEILE>",2)
	. SET UNTER=1
	
	;SUMME DAUER ;sum permanence 
	IF $FIND(YI(1),"<GESDAUER>") DO
	. IF (MITZEITEN=1) || (+YDAUER=0) SET YI(1)=$PIECE(YI(1),"<GESDAUER>",1)_"&nbsp;"_$PIECE(YI(1),"</GESDAUER>",2) QUIT
	. SET YI(1)=$PIECE(YI(1),"<GESDAUER>",1)_$$^WWWTIME(YDAUER)_$PIECE(YI(1),"</GESDAUER>",2)
	 
	;MASCHINE ;machine 
	IF $FIND(YI(1),"<MASCHINE>") DO
	. SET YI(1)=$PIECE(YI(1),"<MASCHINE>",1)_FPLATZ_FMASCH_$PIECE(YI(1),"</MASCHINE>",2)
	
	;SUMME RÜSTZEIT ;sum setup time 
	IF $FIND(YI(1),"<GESRUESTZEIT>") DO
	. IF (MITZEITEN=1) || (+YRZEIT=0) SET YI(1)=$PIECE(YI(1),"<GESRUESTZEIT>",1)_"&nbsp;"_$PIECE(YI(1),"</GESRUESTZEIT>",2) QUIT
	. SET YI(1)=$PIECE(YI(1),"<GESRUESTZEIT>",1)_$$^WWWTIME(YRZEIT)_$PIECE(YI(1),"</GESRUESTZEIT>",2)
	
	;SUMME TOTAL ;sum whole 
	IF $FIND(YI(1),"<GESAMTZEIT>") DO
	. IF MITZEITEN=1 SET YI(1)=$PIECE(YI(1),"<GESAMTZEIT>",1)_"&nbsp;"_$PIECE(YI(1),"</GESAMTZEIT>",2) QUIT
	. IF (+YDAUER=0) || (ZEITFACT=0) SET YI(1)=$PIECE(YI(1),"<GESAMTZEIT>",1)_"&nbsp;"_$PIECE(YI(1),"</GESAMTZEIT>",2) QUIT
	. SET YI(1)=$PIECE(YI(1),"<GESAMTZEIT>",1)_$$^WWWTIME(YDAUER*ZEITFACT+YRZEIT)_$PIECE(YI(1),"</GESAMTZEIT>",2)
	
	IF $FIND(YI(1),"<FERTIGUNGSNUMMER>") DO
	. IF YSTEMPEL="" SET YI(1)=$PIECE(YI(1),"<FERTIGUNGSNUMMER>",1)_$PIECE(YI(1),"</FERTIGUNGSNUMMER>",2) QUIT
	. ;N UNTERPUNKT1 ;substitute product 
	. ;SET UNTERPUNKT1=UNTERPUNKT ;table-mat 
	. ;IF $E(UNTERPUNKT1)="X" SET UNTERPUNKT1=$E(UNTERPUNKT,2,99)
	. IF YZWEITSCHRIFT="" SET YI(1)=$PIECE(YI(1),"<FERTIGUNGSNUMMER>",1)_YSTEMPEL_" "_$EXTRACT(100+(+UNTERPUNKT),2,3)_$PIECE(YI(1),"</FERTIGUNGSNUMMER>",2) QUIT
	. SET YI(1)=$PIECE(YI(1),"<FERTIGUNGSNUMMER>",1)_YSTEMPEL_" "_$EXTRACT(100+UNTERPUNKT,2,3)_" "_YZWEITSCHRIFT_$PIECE(YI(1),"</FERTIGUNGSNUMMER>",2)
	
	IF $FIND(YI(1),"<FERTIGUNGSBEGINN>") DO
	. IF FBEGINN="" SET YI(1)=$PIECE(YI(1),"<FERTIGUNGSBEGINN>",1)_"&nbsp;"_$PIECE(YI(1),"</FERTIGUNGSBEGINN>",2) QUIT
	. SET YI(1)=$PIECE(YI(1),"<FERTIGUNGSBEGINN>",1)_$$^WWWDATE(FBEGINN)_$PIECE(YI(1),"</FERTIGUNGSBEGINN>",2)
	
	IF $FIND(YI(1),"<DATUM>") DO  
	. SET YI(1)=$PIECE(YI(1),"<DATUM>",1)_$$^WWWDATE(+$HOROLOG,SPRACHE)_$PIECE(YI(1),"</DATUM>",2)
	
	IF $FIND(YI(1),"<LIEFERUNG>") DO  ;z.B. 36 SATZ/KARTON - AUS UMVERPACKUNGSAUFKLEBER  ;e.g. out of 
	. IF $PIECE(YXL,Y,4)'="" IF $PIECE($GET(^INART(YM,$PIECE(YXL,Y,4),1)),Y,40)'="" IF $PIECE($GET(^INART(YM,$PIECE(YXL,Y,4),1)),Y,186)'="" DO
	. . SET YI(1)=$PIECE(YI(1),"<LIEFERUNG>",1)_$PIECE($GET(^INART(YM,$PIECE(YXL,Y,4),1)),Y,187)_" "_$PIECE($GET(^WWW101(0,"EINHEIT",SPRACHE,$PIECE($GET(^INART(YM,$PIECE(YXL,Y,4),1)),Y,40),1)),Y,1)_"/"_$PIECE($GET(^INTRANSPACK(YM,$PIECE($GET(^INART(YM,$PIECE(YXL,Y,4),1)),Y,186),1)),Y,1)_$PIECE(YI(1),"</LIEFERUNG>",2)
	
	IF $FIND(YI(1),"<ABTEILUNG>") DO
	. NEW ABTEILUNG
	. SET ABTEILUNG=""
	. IF $PIECE(YXL,Y,57)'="" IF $PIECE($GET(^INMASCH(YM,$PIECE(YXL,Y,57),1)),Y,36)'="" SET ABTEILUNG=$PIECE($GET(^WWW0124(YM,$PIECE($GET(^INMASCH(YM,$PIECE(YXL,Y,57),1)),Y,36),1)),Y,1)
	. SET YI(1)=$PIECE(YI(1),"<ABTEILUNG>",1)_ABTEILUNG_$PIECE(YI(1),"</ABTEILUNG>",2)
	
	IF $FIND(YI(1),"<FERTIGUNGSPLATZ>") DO
	. IF FPLATZ="" SET YI(1)=$PIECE(YI(1),"<FERTIGUNGSPLATZ>",1)_$PIECE(YI(1),"</FERTIGUNGSPLATZ>",2) QUIT
	. SET YI(1)=$PIECE(YI(1),"<FERTIGUNGSPLATZ>",1)_FPLATZ_$PIECE(YI(1),"</FERTIGUNGSPLATZ>",2)
	
	IF $FIND(YI(1),"<NEXTFERTIGUNGSPLATZ>") DO  ;ANZEIGEN NÄCHSTER FERTIGUNGSPLATZ ;display 
	. NEW FPL
	. IF $PIECE($GET(^INVORG(YM,YM,1)),Y,102)'=1 SET YI(1)=$PIECE(YI(1),"<NEXTFERTIGUNGSPLATZ>",1)_$PIECE(YI(1),"</NEXTFERTIGUNGSPLATZ>",2) QUIT   ;KEIN DRUCK ;no printing 
	. SET FPL=$$^INPROFERTPL(YLFN)
	. IF FPL'="" SET FPL=$EXTRACT($PIECE($GET(^INPRONEST(YM,FPL,1)),Y,1),1,12) ;FERTIGUNGSPLATZ IN KLARSCHRIFT ;within 
	. SET YI(1)=$PIECE(YI(1),"<NEXTFERTIGUNGSPLATZ>",1)_FPL_$PIECE(YI(1),"</NEXTFERTIGUNGSPLATZ>",2)
	
	IF $FIND(YI(1),"<BESTELLER>") DO  ;BESTELLUNG DURCH KUNDE ;sales order trans- customer 
	. NEW BEST
	. SET BEST=""
	. IF YAUF'="" IF $PIECE($GET(^INAUF(YM,YAUF,1)),Y,1)'="" SET BEST=$PIECE($GET(^INKUNDE(YM,$PIECE($GET(^INAUF(YM,YAUF,1)),Y,1),1)),Y,8)
	. SET YI(1)=$PIECE(YI(1),"<BESTELLER>",1)_BEST_$PIECE(YI(1),"</BESTELLER>",2)
	
	IF $FIND(YI(1),"<AUFTRAG>") DO  ;AUFTRAG ;mandate  ;order 
	. SET YI(1)=$PIECE(YI(1),"<AUFTRAG>",1)_YAUF_$PIECE(YI(1),"</AUFTRAG>",2)
	
	IF $FIND(YI(1),"<POSITION>") DO  ;POSITION
	. SET YI(1)=$PIECE(YI(1),"<POSITION>",1)_YPOS_$PIECE(YI(1),"</POSITION>",2)
	
	IF $FIND(YI(1),"<ARTIKEL>") DO  ;ARTIKEL (NUMMER) BEZEICHNUNG ;item notation 
	. SET YI(1)=$PIECE(YI(1),"<ARTIKEL>",1)_" ("_$PIECE($GET(^INAUFP(YM,YAUF,YPOS,1)),Y,4)_") "_$TRANSLATE($$^WWWUML($PIECE($GET(^INAUFP(YM,YAUF,YPOS,1)),Y,1)),"|")_$PIECE(YI(1),"</ARTIKEL>",2)
	
	IF $FIND(YI(1),"<KOMMISSION>") DO  QUIT  ;KOMMISSION ;errand 
	. IF (MITKOM'=1) || (YAUF="") SET YI(1)=$PIECE(YI(1),"<KOMMISSION>",1)_"&nbsp;"_$PIECE(YI(1),"</KOMMISSION>",2) QUIT   ;KEIN DRUCK
	. SET YI(1)=$PIECE(YI(1),"<KOMMISSION>",1)_$TRANSLATE($$^WWWUML($PIECE($GET(^INAUF(YM,YAUF,1)),Y,13)),"|")_" "_$$^WWWUML($PIECE($GET(^INAUF(YM,YAUF,1)),Y,8))_$PIECE(YI(1),"</KOMMISSION>",2)  ;FIS;25964;05.07.04
	. ;SET YI(1)=$PIECE(YI(1),"<KOMMISSION>",1)_$PIECE($GET(^INART(YM,$PIECE(YXL,Y,4),1)),Y,301)_$PIECE(YI(1),"</KOMMISSION>",2)  ;VORGANGSNUMMER
	. ;IF $PIECE(YXL,Y,4)'=""  SET YI(1)=$PIECE(YI(1),"<KOMMISSION>",1)_$PIECE($GET(^INART(YM,$PIECE(YXL,Y,4),1)),Y,301)_$PIECE(YI(1),"</KOMMISSION>",2)  ;BEC;22.06.04  ;AUSGESCHALTET -> KOMMISSION '= VORGANGSNUMMER;FIS;25964;05.07.04
	
	IF $FIND(YI(1),"<VORGANGSNUMMER>") DO  ;VORGANGSNUMMER;FIS;25964;05.07.04
	. IF $PIECE(YXL,Y,4)="" SET YI(1)=$PIECE(YI(1),"<VORGANGSNUMMER>",1)_"&nbsp;"_$PIECE(YI(1),"</VORGANGSNUMMER>",2) QUIT   ;KEIN DRUCK
	. IF $PIECE(YXL,Y,4)'="" SET YI(1)=$PIECE(YI(1),"<VORGANGSNUMMER>",1)_$PIECE($GET(^INART(YM,$PIECE(YXL,Y,4),1)),Y,301)_$PIECE(YI(1),"</VORGANGSNUMMER>",2)
	
	IF $FIND(YI(1),"<TEIL>") DO  ;PRODUKTIONSTEIL
	. IF MITSTRUKTUR'=1 DO  ;OHNE TEILESTRUKTUR ;without 
	. . NEW YI,TEIL
	. . SET YTEIL=$PIECE(YXL,Y,4)   ;ARTIKELNUMMER
	. . SET TEIL="("_YTEIL_")"   ;ARTIKELNUMMER
	. . SET TEIL=TEIL_" "_$EXTRACT($TRANSLATE($$^WWWUML($PIECE(YXL,Y,1)),"|"),1,25)  ;ARTIKELINFORMATION TEIL ;part 
	. . SET YI(1)=$PIECE(YI(1),"<TEIL>",1)_TEIL_$PIECE(YI(1),"</TEIL>",2)
	. ;
	. IF MITSTRUKTUR=1 DO  ;MIT TEILESTRUKTUR ;by means of 
	. . NEW YII,TEIL
	. . SET TEIL=""
	. . FOR YII=2:1 QUIT:$PIECE(YLFN,",",YII)=""  DO 
	. . . IF TEIL'="" SET TEIL=TEIL_"<br>"
	. . . SET YXLT=$GET(@(YDATEI(YII)))   ;POSITIONSDATEN
	. . . FOR YII(1)=2:1:(YII-1) SET TEIL=TEIL_"-"
	. . . SET YTEIL=$PIECE(YXLT,Y,4)   ;ARTIKELNUMMER
	. . . SET TEIL=TEIL_"("_YTEIL_")"   ;ARTIKELNUMMER
	. . . SET TEIL=TEIL_" "_$EXTRACT($TRANSLATE($$^WWWUML($PIECE(YXLT,Y,1)),"|"),1,25)  ;ARTIKELINFORMATION TEIL ;part 
	. . . ;SET MASCH="" IF $PIECE(YXLT,Y,57)'="" SET MASCH=$PIECE($GET(^INMASCH(YM,$PIECE(YXLT,Y,57),1)),Y,1)
	. . ;
	. . SET YI(1)=$PIECE(YI(1),"<TEIL>",1)_TEIL_$PIECE(YI(1),"</TEIL>",2)
	
	IF $FIND(YI(1),"<AUSFUEHRUNG>") DO  ;AUSFÜHRUNGSTEXT
	. SET YI(1)=$PIECE(YI(1),"<AUSFUEHRUNG>",1)_$EXTRACT($TRANSLATE($$^WWWUML($PIECE(YXL,Y,14)),"|"),1,25)_$PIECE(YI(1),"</AUSFUEHRUNG>",2)
	
	IF $FIND(YI(1),"<MENGE>") DO  ;MENGE ;quantum  ;quantity 
	. NEW MENGE
	. SET MENGE=$$^WWWZAHL($PIECE(YXL,Y,39),0,$LENGTH($PIECE($PIECE(YXL,Y,39),".",2)))   ;AUFBEREITETE MENGE ;quantity 
	. IF $PIECE(YXL,Y,40)'="" SET MENGE=MENGE_" "_$PIECE($GET(^WWW101(0,"EINHEIT",SPRACHE,$PIECE(YXL,Y,40),1)),Y,1)
	. SET ZEITFACT=$PIECE(YXL,Y,39)  ;GESAMTMENGE
	. IF $PIECE(YXL,Y,5)>0 DO
	. . SET MENGE=MENGE_" ("_$PIECE(YXL,Y,5)
	. . IF $PIECE(YXL,Y,39)>0 SET MENGE=MENGE_" X "_($PIECE(YXL,Y,39)/$PIECE(YXL,Y,5))  ;MEHRFACHE FERTIGUNGSMENGE
	. . SET MENGE=MENGE_")"
	. ;
	. SET YI(1)=$PIECE(YI(1),"<MENGE>",1)_MENGE_$PIECE(YI(1),"</MENGE>",2)
	
	IF $FIND(YI(1),"<PRODUKTIONSANWEISUNG>") DO  ;
	. SET YI(1)=$PIECE(YI(1),"<PRODUKTIONSANWEISUNG>",1)_$TRANSLATE($$^WWWUML($PIECE(YXL,Y,53),1),"|")_$PIECE(YI(1),"</PRODUKTIONSANWEISUNG>",2)
	
	IF $FIND(YI(1),"<ARBEITSGANG>") DO  ;
	. SET YI(1)=$PIECE(YI(1),"<ARBEITSGANG>",1)_"ARBEITSGANG"_$PIECE(YI(1),"</ARBEITSGANG>",2)
	
	;PRODUKTIONSMENGE
	IF $FIND(YI(1),"<PRODUKTIONSMENGE>") DO
	. SET YI(1)=$PIECE(YI(1),"<PRODUKTIONSMENGE>",1)_$PIECE(YXL,Y,5)_$PIECE(YI(1),"</PRODUKTIONSMENGE>",2)
	
	;OFFENE PRODUKTIONSMENGE
	IF $FIND(YI(1),"<MENGEOFFEN>") DO
	. NEW VERT,SUM,SATZ
	. SET SUM=0
	. SET VERT=""
	. FOR  SET VERT=$ORDER(^INAUFPREL(YM,YAUF,YPOS,VERT)) QUIT:VERT=""  DO
	. . SET SATZ=$GET(^INAUFPREL(YM,YAUF,YPOS,VERT,1))
	. . QUIT:+$HOROLOG<$PIECE(SATZ,2)  ;LIEFERTERMIN DER ABRUFPOSITION LIEGT NACH TAGESDATUM DES DRUCKES ;time of delivery the within 
	. . SET SUM=SUM+(+$PIECE(SATZ,Y,1))
	. ;
	. IF '$DATA(^INAUFPREL(YM,YAUF,YPOS)) SET SUM=$PIECE(YXL,Y,5)
	. SET YI(1)=$PIECE(YI(1),"<MENGEOFFEN>",1)_SUM_$PIECE(YI(1),"</MENGEOFFEN>",2)
	
	IF $FIND(YI(1),"<QUALITAETSPRUEFUNG>") DO  ;
	. NEW QPRUEF
	. SET QPRUEF=""
	. SET QPRUEF(2)=""
	. IF $GET(YTEIL)'="" SET QPRUEF=$PIECE($GET(^INART(YM,YTEIL,1)),Y,174)       ;ARTIKEL MIT QUALITÄTSPRUEFUNG ;item by means of 
	. IF $GET(YTEIL)=""  SET QPRUEF=$PIECE($GET(^INAUFP(YM,YAUF,YPOS,1)),Y,174)  ;ARTIKEL MIT QUALITÄTSPRUEFUNG ;item by means of 
	. IF QPRUEF'=""   SET QPRUEF(1)=$PIECE($GET(^INQPRUEF(YM,YLOCATION,QPRUEF,1)),Y,3) IF QPRUEF(1)'="" DO  ;ACHTUNG ARTIKEL MIT QUA ;estimation item by means of 
	. . SET QPRUEF(2)=$PIECE($GET(^INPARA(YM,"QMPARA",SPRACHE,QPRUEF,1)),Y,1)_": "_$TRANSLATE($$^WWWUML(QPRUEF(1)),"|")  ;PRUEF-INFORMATION
	. ;
	. SET YI(1)=$PIECE(YI(1),"<QUALITAETSPRUEFUNG>",1)_QPRUEF(2)_$PIECE(YI(1),"</QUALITAETSPRUEFUNG>",2)
	
	IF $FIND(YI(1),"<BARCODE>") DO
	. NEW BARCODE,GIF
	. ;SET UNTERPUNKT1=UNTERPUNKT ;table-mat 
	. ;IF $E(UNTERPUNKT1)="X" SET UNTERPUNKT1=$E(UNTERPUNKT,2,99)
	. SET GIF="gif"_YSTEMPEL_$EXTRACT(100+(+UNTERPUNKT),2,3)_".gif"
	. ;DO ^WWWBARC(FILE,BARCODETYPE[B25,B25A,B25I,B25M,B25D,BCB,C39,EAN13],BARCODE,PRUEFSUMMEBILDEN[0,1],LÄNGEDESBARCODES[20],DEHNUNGSFAKTOR[1],KLARSCHRIFTTEXT,HORIZONTALODERVERTIKAL[H,V])
	. ;DO ^WWWBARC($PIECE($GET(^WWW012(0,YM,1)),Y,49)_GIF,"B25",YSTEMPEL_$EXTRACT(100+UNTERPUNKT,2,3),1,40,1,YSTEMPEL_$EXTRACT(100+UNTERPUNKT,2,3),"H")
	. DO ^WWWBAR(YSTEMPEL_$EXTRACT(100+(+UNTERPUNKT),2,3),,,1)     ;BEC;12.10.03;24816; DURCK DURCH DIE WWWBAR
	. SET BARCODE=YGIF_GIF
	. SET YI(1)=$PIECE(YI(1),"<BARCODE>",1)_"<img src="_""""_BARCODE_""""_">"_$PIECE(YI(1),"</BARCODE>",2)
	
	IF $FIND(YI(1),"<SEITE>") DO
	. IF (SEITE=1) || (UNTER=0) SET YI(1)=$PIECE(YI(1),"<SEITE>",1)_YPROSEITE_$PIECE(YI(1),"</SEITE>",2) QUIT  ;SEITE ;side 
	. SET YI(1)=$PIECE(YI(1),"<SEITE>",1)_YPROSEITE_"-"_(YPROSEITE+SEITE-1)_$PIECE(YI(1),"</SEITE>",2)  ;SEITE VON-BIS ;side 
	. SET YPROSEITE=YPROSEITE+SEITE-1
	
	;ANHANG JE ABTEILUNG ;supporters once speciality 
	IF $FIND(YI(1),"<ANLAGE") DO
	. NEW ANLAGE,ABTEILUNG
	. SET ANLAGE=$PIECE($PIECE(YI(1),"<ANLAGE",2),">",1)
	. SET ABTEILUNG=""
	. IF $PIECE(YXL,Y,57)'="" SET ABTEILUNG=$PIECE($GET(^INMASCH(YM,$PIECE(YXL,Y,57),1)),Y,36)
	. IF ABTEILUNG=""      SET YI(1)=$PIECE(YI(1),"<ANLAGE"_ANLAGE_">",1)_$PIECE(YI(1),"</ANLAGE"_ANLAGE_">",2) QUIT
	. IF ABTEILUNG'=ANLAGE SET YI(1)=$PIECE(YI(1),"<ANLAGE"_ANLAGE_">",1)_$PIECE(YI(1),"</ANLAGE"_ANLAGE_">",2) QUIT
	. SET YI(1)=$PIECE(YI(1),"<ANLAGE"_ANLAGE_">",1)_$PIECE($PIECE(YI(1),"<ANLAGE"_ANLAGE_">",2),"</ANLAGE"_ANLAGE_">",1)_$PIECE(YI(1),"</ANLAGE"_ANLAGE_">",2)
	
	DO  ;ALLGEMEINE DATENFELDER AUFTRAGSPOSITION
	. NEW ZEILE,YDATEI,YFELD
	. SET ZEILE=YI(1)
	. SET YDATEI="INAUFP"
	. SET YFELD=$GET(^INAUFP(YM,YAUF,YPOS,1))
	. DO ^INRELNAME  ;DURCHSUCHEN ZEILE NACH DATENFELDERN ;scour within 
	. SET YI(1)=ZEILE
	
	QUIT
	
UNTERTEILE ;DRUCKEN DER UNTERTEILE ;print the 
	NEW YI,YII,WHANZ,ZPOS,LFN,ARTIKEL,BEZEICHNUNG,PRODUKTIONSANWEISUNG,WARENHERKUNFT,MENGE,FERTIGUNGSZEIT,RUESTZEIT,YXL1KEY
	
	SET YI="" IF $ORDER(@(YDATEI))="" QUIT  ;KEINE TEILE VORHANDEN=KEIN DRUCK ;no printing 
	SET ZEITFACT=$GET(ZEITFACT)
	SET YII   = 0  ;LAUFENDE NUMMER ;numeral 
	SET WHANZ = +$PIECE($GET(^INVORG(YM,YM,1)),Y,92)  ;WARENHERKUNFT ANZEIGEN ;display 
	SET ZPOS  = +$PIECE($GET(^INVORG(YM,YM,1)),Y,93)  ;ZEICHNUNGSPOSITIONEN ANZEIGEN ;display 
	
	;UNTERTEILEBESCHREIBUNG
	SET YI=""
	FOR  SET YI=$ORDER(@(YDATEI)) QUIT:YI=""  DO  ;SUCHEN IN UNTERTEILEDATEI ;seek within 
	. QUIT:YI<ABANZEIGE  ;ERST AB DIESEM TEIL ;only Confirm. part 
	. QUIT:YI=BISANZEIGE  ;NUR BIS ZU DIESEM TEIL ;only until within part 
	. QUIT:YI>BISANZEIGE  ;NUR BIS ZU DIESEM TEIL ;only until within part 
	. SET YXL1=$GET(@(YDATEI))
	. QUIT:YXL1=""  ;KEIN DATENSATZ VORHANDEN ;no data record on hand 
	. IF $DATA(@(YDATEI))=1 SET $PIECE(@(YDATEI),Y,165)=YSTEMPEL   ;WENN UNTERSTES TEIL ;when part 
	. ;
	. SET YXL1KEY=$PIECE($PIECE(YDATEI,",",2,99),")",1)  ;RÜCKHOLEN TEILEKEY ZUR SPEICHERUNG;FIS;09.09.03;24243
	. SET YXL1KEY=$REVERSE($PIECE($REVERSE(YXL1KEY),",",2,99))
	. SET YXL1KEY=$TRANSLATE(YXL1KEY,"""")_","_YI
	. ;
	. ;--------------------------------------------------------------------
	. ;SPEICHERN HERSTELLKOSTEN UND MASCHINENSTUNDENSATZ FÜR VORKALKULATION ;Save And machine hour rate to preliminary costing 
	. IF $GET(@(YDATEI))'="" DO
	. . IF +$PIECE(@(YDATEI),Y,250)=0 SET $PIECE(@(YDATEI),Y,250)=$PIECE(@(YDATEI),Y,47)  ;HERSTELLKOSTEN VORKALKULATION ;preliminary costing 
	. . IF $PIECE(@(YDATEI),Y,26)=2 DO  ;MASCHINEN+BEDIENERSTUNDENSATZ SETZEN ;typeset 
	. . . NEW KALK,YFELD
	. . . SET YFELD=@(YDATEI)
	. . . IF +($PIECE(YFELD,Y,251)+$PIECE(YFELD,Y,252))'=0 QUIT  ;BEREITS GESETZT ;yet staid 
	. . . SET KALK=$$^INMASCHKOST(2)
	. . . SET $PIECE(@(YDATEI),Y,251)=$PIECE(KALK,Y,1)
	. . . SET $PIECE(@(YDATEI),Y,252)=$PIECE(KALK,Y,2)
	. ;--------------------------------------------------------------------
	. ;  FIXME : Remove extra DO level? <GRF>
	. ;
	. NEW YTEILSUM
	. SET YTEILSUM=""
	. DO
	. . DO    ;AUSWERTEN DER MENGEN, WENN TEILE GLEICH
	. . . NEW YARTTX,Q,YARTTC,TEILE1
	. . . SET TEILE1=YXL1
	. . . SET YTEILSUM=1
	. . . SET Q=0
	. . . SET YARTTX=YI
	. . . FOR  SET YI=$ORDER(@YDATEI) QUIT:YI=""  DO  QUIT:Q=1
	. . . . IF YI<ABANZEIGE  SET Q=1 SET YI=YARTTX QUIT   ;ERST AB DIESEM TEIL ;only Confirm. part 
	. . . . IF YI=BISANZEIGE SET Q=1 SET YI=YARTTX QUIT   ;NUR BIS ZU DIESEM TEIL ;only until within part 
	. . . . IF YI>BISANZEIGE SET Q=1 SET YI=YARTTX QUIT   ;NUR BIS ZU DIESEM TEIL ;only until within part 
	. . . . SET YARTTC=$GET(@(YDATEI))  ;TEILE INFO
	. . . . IF $PIECE(YARTTC,Y,1,40)'=$PIECE(TEILE1,Y,1,40) SET Q=1 SET YI=YARTTX QUIT  ;NICHT GLEICH ;Not without delay 
	. . . . SET YARTTX=YI
	. . . . ;
	. . . . SET YTEILSUM=YTEILSUM+1
	. . . . IF $DATA(@(YDATEI))=1 SET $PIECE(@(YDATEI),Y,165)=YSTEMPEL   ;WENN UNTERSTES TEIL ;when part 
	. . . . ;--------------------------------------------------------------------
	. . . . ;SPEICHERN HERSTELLKOSTEN UND MASCHINENSTUNDENSATZ FÜR VORKALKULATION ;Save And machine hour rate to preliminary costing 
	. . . . IF $GET(@(YDATEI))'="" DO
	. . . . . IF +$PIECE(@(YDATEI),Y,250)=0 SET $PIECE(@(YDATEI),Y,250)=$PIECE(@(YDATEI),Y,47)  ;HERSTELLKOSTEN VORKALKULATION ;preliminary costing 
	. . . . . IF $PIECE(@(YDATEI),Y,26)=2 DO  ;MASCHINEN+BEDIENERSTUNDENSATZ SETZEN ;typeset 
	. . . . . . NEW KALK,YFELD
	. . . . . . SET YFELD=@(YDATEI)
	. . . . . . IF +($PIECE(YFELD,Y,251)+$PIECE(YFELD,Y,252))'=0 QUIT  ;BEREITS GESETZT ;yet staid 
	. . . . . . SET KALK=$$^INMASCHKOST(2)
	. . . . . . SET $PIECE(@(YDATEI),Y,251)=$PIECE(KALK,Y,1)
	. . . . . . SET $PIECE(@(YDATEI),Y,252)=$PIECE(KALK,Y,2)
	. . . . ;
	. . . . ;SET $PIECE(YXL1,Y,5)=$PIECE(YXL1,Y,5)+$PIECE(YARTTC,Y,5)  ;MEHRERE STUECKE ALLES GLEICH  MENGE
	. . . . ;SET $PIECE(YXL1,Y,43)=$PIECE(YXL1,Y,43)+$PIECE(YARTTC,Y,43)  ;MEHRERE STUECKE ALLES GLEICH  GEWICHT
	. . . . ;SET $PIECE(YXL1,Y,45)=$PIECE(YXL1,Y,45)+$PIECE(YARTTC,Y,45)  ;MEHRERE STUECKE ALLES GLEICH  ZEIT
	. . . . ;SET $PIECE(YXL1,Y,70)=$PIECE(YXL1,Y,70)+$PIECE(YARTTC,Y,70)  ;MEHRERE STUECKE ALLES GLEICH  RUESTZEIT
	. . . . ;SET $PIECE(YXL1,Y,47)=$PIECE(YXL1,Y,47)+$PIECE(YARTTC,Y,47)  ;MEHRERE STUECKE ALLES GLEICH  WERT
	. . . ;
	. . . IF YI="" SET YI=$ORDER(@YDATEI,-1)
	. ;
	. SET YII=YII+1   ;LAUFENDE NUMMER ;numeral 
	. SET ZEILE(YII)=ZEILE
	. ;
	. ;PRODUKTIONSDAUER
	. IF +$PIECE(YXL1,Y,45)'=0 DO
	. . IF $PIECE(YXL1,Y,40)'=2 IF $PIECE(YXL1,Y,40)'=10 IF $PIECE(YXL1,Y,40)'=11 QUIT
	. . SET YDAUER=YDAUER+$PIECE(YXL1,Y,45)  ;ADDITION PRODUKTIONSDAUER
	. ;
	. ;RÜSTZEIT ;setup time 
	. IF +$PIECE(YXL1,Y,70)'=0 DO
	. . IF $PIECE(YXL1,Y,40)'=2 IF $PIECE(YXL1,Y,40)'=10 IF $PIECE(YXL1,Y,40)'=11 QUIT
	. . SET YRZEIT=YRZEIT+$PIECE(YXL1,Y,70)  ;ADDITION RÜSTZEIT ;addition setup time 
	. ;
	. ;PRODUKTIONSMENGE
	. IF +$PIECE(YXL1,Y,5)'=0 DO
	. . QUIT:$PIECE(YXL1,Y,40)=2   ;MINUTEN
	. . QUIT:$PIECE(YXL1,Y,40)=10  ;STUNDEN ;procrastinate 
	. . QUIT:$PIECE(YXL1,Y,40)=11  ;INDUSTRIEMINUTEN
	. . ;
	. . SET GEB=""
	. . IF $PIECE(YXL1,Y,244)'="" SET GEB=1  ;BESTAND BEREITS BERICHTIGT ;yet 
	. . ;TEILENUMMER = (100+ARBEITSGANG)_$E(1000+LFN,2,4) Z.B.: ARBEITSGANG 05, TEIL 3 = 105003
	. . IF $EXTRACT(UNTERPUNKT)="X" DO           ;FIS;08.07.03;23889
	. . . IF $DATA(^INPROSTEMPT(YM,YSTEMPEL,"100"_$EXTRACT(1000+YII,2,4),1)) SET UNTERPUNKT=0 QUIT
	. . . SET UNTERPUNKT=$EXTRACT(UNTERPUNKT,2,9)
	. . ;
	. . IF '$DATA(^INPROSTEMPT(YM,YSTEMPEL,YII,1)) IF '$DATA(^INPROSTEMPT(YM,YSTEMPEL,(100+UNTERPUNKT)_$EXTRACT(1000+YII,2,4),1)) DO  ;SPEICHERN BESTANDSVERÄNDERUNGSDATEI  ;Save 
	. . . IF $GET(YTEILSUM)>1 SET ^INPROSTEMPT(YM,YSTEMPEL,(100+UNTERPUNKT)_$EXTRACT(1000+YII,2,4),1)=Y_Y_Y_$PIECE(YXL1,Y,4)_Y_($PIECE(YXL1,Y,39)*YTEILSUM)_Y_GEB_Y_Y_$PIECE(YXL1,Y,1)_Y_YXL1KEY QUIT  ;FIS, 05.08.02
	. . . SET ^INPROSTEMPT(YM,YSTEMPEL,(100+UNTERPUNKT)_$EXTRACT(1000+YII,2,4),1)=Y_Y_Y_$PIECE(YXL1,Y,4)_Y_$PIECE(YXL1,Y,39)_Y_GEB_Y_Y_$PIECE(YXL1,Y,1)_Y_YXL1KEY
	. ;
	. ;DRUCKEN UNTERTEILE ;print 
	. ;==================
	. DO
	. . ;LAUFENDE NUMMER ;numeral 
	. . ;---------------
	. . IF $FIND(ZEILE(YII),"<LFN>") DO
	. . . SET LFN(YII)=YII_$PIECE($PIECE(ZEILE(YII),"<LFN>",2),"</LFN>",1)
	. . ;
	. . ;ARTIKELNUMMER
	. . ;-------------
	. . IF $FIND(ZEILE(YII),"<ARTIKEL>") DO
	. . . SET ARTIKEL(YII)=$PIECE(YXL1,Y,4)
	. . ;
	. . ;SUCHBEZEICHNUNG MIT TEXT ;by means of Text 
	. . ;------------------------
	. . IF $FIND(ZEILE(YII),"<BEZEICHNUNG>") DO  ;Z-POS_ARTIKELBEZEICHNUNG
	. . . NEW BEZEICHNUNG1
	. . . SET BEZEICHNUNG1=""
	. . . IF +$PIECE(YXL1,Y,18)'=0 IF $PIECE(YXL1,Y,1)'="" SET BEZEICHNUNG1=$$^WWWUML($PIECE(YXL1,Y,1))   ;Z-POS_ARTIKELBEZEICHNUNG
	. . . IF +$PIECE(YXL1,Y,18)=0  IF $PIECE(YXL1,Y,1)'="" IF $PIECE(YXL1,Y,4)'="" IF $PIECE($GET(^INART(YM,$PIECE(YXL1,Y,4),1)),Y,26)=2 SET BEZEICHNUNG1=$$^WWWUML($PIECE(YXL1,Y,1))   ;WENN LEISTUNG ;when performance 
	. . . SET BEZEICHNUNG(YII)=BEZEICHNUNG1
	. . ;
	. . ;PRODUKTIONSANWEISUNG_PRODUKTIONSANWEISUNGSNR
	. . ;--------------------------------------------
	. . IF $FIND(ZEILE(YII),"<PRODUKTIONSANWEISUNG>") DO
	. . . NEW BEZEICHNUNG2
	. . . SET BEZEICHNUNG2="&nbsp;"
	. . . IF $PIECE(YXL1,Y,53)'="" SET BEZEICHNUNG2=$TRANSLATE($$^WWWUML($PIECE(YXL1,Y,53)),"|")  ;PRODUKTIONSANWEISUNG
	. . . SET ANWEISUNG(YII)=BEZEICHNUNG2
	. . ;
	. . ;WARENHERKUNFT
	. . ;-------------
	. . IF $FIND(ZEILE(YII),"<WARENHERKUNFT>") DO
	. . . IF (WHANZ'=1) || ($PIECE(YXL1,Y,7)="") SET WARENHERKUNFT(YII)="&nbsp;" QUIT
	. . . SET WARENHERKUNFT(YII)=$PIECE($GET(^WWW101(0,"WARENHERKUNFT1",SPRACHE,$PIECE(YXL1,Y,7),1)),Y,1)
	. . ;
	. . ;MENGE+EINHEIT
	. . ;-------------
	. . IF $FIND(ZEILE(YII),"<MENGE>") DO
	. . . SET MENGE=""
	. . . IF $GET(YTEILSUM)>1      SET MENGE=MENGE_YTEILSUM_" X "   ;ANZAHL DER SUMME]]><![CDATA[N ;Number the purr 
	. . . IF +$PIECE(YXL1,Y,5)=0   SET MENGE(YII)="&nbsp;" QUIT
	. . . IF $PIECE(YXL1,Y,40)=2   SET MENGE(YII)="&nbsp;" QUIT   ;MINUTEN
	. . . IF $PIECE(YXL1,Y,40)=10  SET MENGE(YII)="&nbsp;" QUIT   ;STUNDEN
	. . . IF $PIECE(YXL1,Y,40)=11  SET MENGE(YII)="&nbsp;" QUIT   ;INDUSTRIEMINUTEN
	. . . SET MENGE=MENGE_$$^WWWZAHL($PIECE(YXL1,Y,5),0,$LENGTH($PIECE($PIECE(YXL1,Y,5),".",2)))  ;MENGE ;quantum  ;quantity 
	. . . IF $PIECE(YXL1,Y,40)'="" SET MENGE=MENGE_"&nbsp;"_$PIECE($GET(^WWW101(0,"EINHEIT",SPRACHE,$PIECE(YXL1,Y,40),1)),Y,1)   ;MENGE_MENGENEINHEIT
	. . . SET MENGE(YII)=MENGE
	. . ;
	. . ;FERTIGUNGSZEIT
	. . ;--------------
	. . IF $FIND(ZEILE(YII),"<FERTIGUNGSZEIT>") DO
	. . . IF +$PIECE(YXL1,Y,45)=0 SET FERTIGUNGSZEIT(YII)="&nbsp;" QUIT
	. . . IF $PIECE(YXL1,Y,40)'=2 IF $PIECE(YXL1,Y,40)'=10 IF $PIECE(YXL1,Y,40)'=11 SET FERTIGUNGSZEIT(YII)="&nbsp;" QUIT  ;NUR BEI LEISTUNG
	. . . IF MITZEITEN=1 SET FERTIGUNGSZEIT(YII)="&nbsp;" QUIT  ;KEINE ZEITEN DRUCKEN
	. . . SET FERTIGUNGSZEIT(YII)=$$^WWWTIME($PIECE(YXL1,Y,45))
	. . ;
	. . ;RÜSTZEIT ;setup time 
	. . ;--------
	. . IF $FIND(ZEILE(YII),"<RUESTZEIT>") DO
	. . . IF +$PIECE(YXL1,Y,70)=0 SET RUESTZEIT(YII)="&nbsp;" QUIT
	. . . IF $PIECE(YXL1,Y,40)'=2 IF $PIECE(YXL1,Y,40)'=10 IF $PIECE(YXL1,Y,40)'=11 SET RUESTZEIT(YII)="&nbsp;" QUIT  ;NUR BEI LEISTUNG
	. . . SET RUESTZEIT(YII)=$$^WWWTIME($PIECE(YXL1,Y,70))
	
	;=======================
	;EINSETZEN WERTE IN TEXT ;stow within Text 
	FOR VAR="LFN","ARTIKEL","BEZEICHNUNG","PRODUKTIONSANWEISUNG","WARENHERKUNFT","MENGE","FERTIGUNGSZEIT","RUESTZEIT" DO
	. SET YI(3)=""
	. IF $FIND(ZEILE,"<"_VAR_">") DO
	. . SET YI(2)=VAR_"("_""""_""""_")"
	. . FOR I=1:1:100  DO  QUIT:YI(2)=""
	. . . SET YI(2)=$QUERY(@YI(2))
	. . . IF '$DATA(YI(2)) SET YI(2)="" QUIT  ;NICHT VORHANDEN ;Not on hand 
	. . . IF $PIECE(YI(2),"(",1)'=VAR SET YI(2)="" QUIT
	. . . IF YI(3)'="" SET YI(3)=YI(3)_"<br>"
	. . . ;SET YI(3)=YI(3)_"<table border=1 cellspacing=0 cellpadding=0><tr><td align=left>"
	. . . SET YI(3)=YI(3)_@YI(2)
	. . . ;SET YI(3)=YI(3)_"</td></tr></table>"
	. . ;
	. . SET ZEILE=$PIECE(ZEILE,"<"_VAR_">",1)_YI(3)_$PIECE(ZEILE,"</"_VAR_">",2)
	
	IF +$GET(YII)>MAXTEILE SET SEITE=SEITE+1  ;ÜBER 2 SEITEN ;via sidelong 
	;SUMME FÜR GESAMT-AUSFÜHRUNGSZEIT ;sum to 
	IF +YDAUER'=0 DO
	. IF +ZEITFACT'=0 SET YGESAMT=YGESAMT+(YDAUER*ZEITFACT)+YRZEIT QUIT
	. SET YGESAMT=YGESAMT+YDAUER+YRZEIT
	
	;SUMME ;sum 
	IF +YDAUER'=0 DO
	. SET $PIECE(@(YDATEI(0)),Y,166)=YGESAMT  ;FERTIGUNGSZEIT DER ANWEISUNG ;the 
	. QUIT
	IF +YDAUER'=0 IF +ZEITFACT'=0 DO
	. SET $PIECE(@(YDATEI(0)),Y,166)=YGESAMT  ;FERTIGUNGSZEIT DER ANWEISUNG ;the 
	. IF $QLENGTH(YDATEI(0))=3 DO
	. . NEW DATEIX,POSX
	. . SET DATEIX=$TRANSLATE($PIECE(YDATEI(0),"(",2),")"_"""")
	. . ;SET POSX="^INAUFP("_DATEIX_",1)"
	. . SET POSX="^INAUFP("_$$^WWWKEYBUILD(DATEIX)_",1)"  ;FIS;25.08.04
	. . IF $GET(@POSX)'="" SET $PIECE(@POSX,Y,166)=YGESAMT  ;FERTIGUNGSZEIT DER ANWEISUNG ;the 
	. ;
	. SET GESAMTZEIT=GESAMTZEIT+(YDAUER*ZEITFACT)+YRZEIT
	
	QUIT
	
CREATE ;HTML-VORLAGE BILDEN / CREATE DEFAULT IF THERE IS NONE (JUST IN CASE) ;shape within 
	;SET HTML="<html>"
	;SET HTML=HTML_"|"_"<head>"
	;SET HTML=HTML_"|"_"<meta http-equiv=expires content=0>"
	;SET HTML=HTML_"|"_"<meta http-equiv="_""""_"Content-Type"_""""_" content="_""""_"text/html; charset=iso-8859-1"_""""_">"  ;EUROPEAN FONT-TYPE
	;SET HTML=HTML_"|"_"<title>Fertigungsanweisung</title>"
	;SET HTML=HTML_"|"_"</head>"
	
	SET HTML=HTML_"|"_"<style>"
	SET HTML=HTML_"|"_" <!--"
	SET HTML=HTML_"|"_" body {background-color:white;}"
	SET HTML=HTML_"|"_" table.border {border:1px solid black;}"
	SET HTML=HTML_"|"_" td.border {border:1px solid black;}"
	SET HTML=HTML_"|"_" //-->"
	SET HTML=HTML_"|"_"</style>"
	
	;SET HTML=HTML_"|"_"<body>"
	;SET HTML=HTML_"|"_"<table border=0 cellspacing=0 cellpadding=0>"
	;SET HTML=HTML_"|"_"<tr><td>"
	;SET HTML=HTML_"|"_"<fieldset>"
	;SET HTML=HTML_"|"_"<legend><font face=arial size=3><b><mandant></mandant></b></font></legend>"
	;SET HTML=HTML_"|"_"<table BORDER=0 CELLSPACING=4 CELLPADDING=0 WIDTH="_""""_"400"_""""_" >"
	;SET HTML=HTML_"|"_"<tr>"
	;SET HTML=HTML_"|"_"<td>"
	;SET HTML=HTML_"|"_"<center>"
	;SET HTML=HTML_"|"_"<table BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH="_""""_"100%"_""""_">"
	;SET HTML=HTML_"|"_"<tr>"
	;SET HTML=HTML_"|"_"<td VALIGN=BOTTOM>"
	
	SET HTML=HTML_"|"_"<table BORDER=0 CELLSPACING=4 CELLPADDING=4 WIDTH="_""""_"650"_""""_">"
	SET HTML=HTML_"|"_"<tr>"
	SET HTML=HTML_"|"_"<td colspan=4 align=left valign=top nowrap>"
	SET HTML=HTML_"|"_"<font face=arial size=3><b><FERTIGUNGSPLATZ></FERTIGUNGSPLATZ></b></font>"
	SET HTML=HTML_"|"_"</td>"
	SET HTML=HTML_"|"_"</tr>"
	SET HTML=HTML_"|"_"<tr>"
	SET HTML=HTML_"|"_"<td align=left valign=top nowrap>"
	SET HTML=HTML_"|"_"<font face=arial size=2><b>Produktionsauftrag: <FERTIGUNGSNUMMER></FERTIGUNGSNUMMER></font></b>"
	SET HTML=HTML_"|"_"</td>"
	SET HTML=HTML_"|"_"<td align=left valign=top nowrap>"
	SET HTML=HTML_"|"_"<font face=arial size=2> für Auftrag:  <AUFTRAG></AUFTRAG>-<POSITION></POSITION></font>"
	SET HTML=HTML_"|"_"</td>"
	SET HTML=HTML_"|"_"<td align=left valign=top nowrap>"
	SET HTML=HTML_"|"_"<font face=arial size=2> vom: <DATUM></DATUM></font>"
	SET HTML=HTML_"|"_"</td>"
	SET HTML=HTML_"|"_"</tr>"
	SET HTML=HTML_"|"_"<tr>"
	SET HTML=HTML_"|"_"<td colspan=1 align=left valign=top nowrap>"
	SET HTML=HTML_"|"_"<font face=arial size=2> Artikel: <ARTIKEL></ARTIKEL><br> Zch.Nr.: <D273></D273><br> Auf.Dat.: <D193></D193></font>"
	SET HTML=HTML_"|"_"</td>"
	SET HTML=HTML_"|"_"<td colspan=2  align=left valign=top nowrap>"
	SET HTML=HTML_"|"_"<font face=arial size=2> Firma: <BESTELLER></BESTELLER><br> Index: <D274></D274><br> Lieferung: <LIEFERUNG></LIEFERUNG>  <br>Zu prod. Menge: <B><MENGE></MENGE></B></font>"
	SET HTML=HTML_"|"_"</td>"
	SET HTML=HTML_"|"_"<td colspan=3 align=left valign=top nowrap>"
	SET HTML=HTML_"|"_"<font face=arial size=2>VG.Nr.: <br><KOMMISSION></KOMMISSION></font>"
	SET HTML=HTML_"|"_"</td>"
	SET HTML=HTML_"|"_"</tr>"
	SET HTML=HTML_"|"_"<tr>"
	SET HTML=HTML_"|"_"<td colspan=2 align=left valign=top nowrap>"
	SET HTML=HTML_"|"_"<font face=arial size=2> Zu produzieren:<b> <TEIL></TEIL> <AUSFUEHRUNG></AUSFUEHRUNG></b><br>Summe&nbsp;Offen/Bestellt:&nbsp;<MENGEOFFEN></MENGEOFFEN>/<PRODUKTIONSMENGE></PRODUKTIONSMENGE>"
	SET HTML=HTML_"|"_"</td>"
	SET HTML=HTML_"|"_"<td colspan=2 align=left valign=top nowrap>"
	SET HTML=HTML_"|"_"<font face=arial size=2><BARCODE></BARCODE>"
	SET HTML=HTML_"|"_"</td>"
	SET HTML=HTML_"|"_"</tr>"
	SET HTML=HTML_"|"_"<tr>"
	SET HTML=HTML_"|"_"<td colspan=2 align=left valign=top nowrap>"
	SET HTML=HTML_"|"_"<font face=arial size=2> "
	SET HTML=HTML_"|"_"</td>"
	SET HTML=HTML_"|"_"<td colspan=2 align=left valign=top nowrap>"
	SET HTML=HTML_"|"_"<font face=arial size=2> Arbeitsplatz: <MASCHINE></MASCHINE>"
	SET HTML=HTML_"|"_"</td>"
	SET HTML=HTML_"|"_"</tr>"
	SET HTML=HTML_"|"_"<tr>"
	SET HTML=HTML_"|"_"<td colspan=2 align=left valign=top>"
	SET HTML=HTML_"|"_"<font face=arial size=2> <b>QM-Prüfung: </b><QUALITAETSPRUEFUNG></QUALITAETSPRUEFUNG>"
	SET HTML=HTML_"|"_"</td>"
	SET HTML=HTML_"|"_"<td colspan=2 align=left valign=top nowrap>"
	SET HTML=HTML_"|"_"<font face=arial size=2> nächster Arbeitsplatz: <NEXTFERTIGUNGSPLATZ></NEXTFERTIGUNGSPLATZ>"
	SET HTML=HTML_"|"_"</td>"
	SET HTML=HTML_"|"_"</tr>"
	SET HTML=HTML_"|"_"</table>"
	
	;AB HIER UNTERTEILE ;Confirm. here is 
	SET HTML=HTML_"|"_"<MAXTEILE>48</MAXTEILE><UNTERTEILE>"
	SET HTML=HTML_" "_"<table BORDER=0 CELLSPACING=1 CELLPADDING=1 WIDTH="_""""_"100%"_""""_">"
	SET HTML=HTML_" "_"<tr>"
	SET HTML=HTML_" "_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	SET HTML=HTML_" "_"<font face=arial size=2><b>lfd.Nr.</font>"
	SET HTML=HTML_" "_"</td>"
	SET HTML=HTML_" "_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	SET HTML=HTML_" "_"<font face=arial size=2><b>Artikel</font>"
	SET HTML=HTML_" "_"</td>"
	SET HTML=HTML_" "_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	SET HTML=HTML_" "_"<font face=arial size=2><b>Bezeichnung</font>"
	SET HTML=HTML_" "_"</td>"
	SET HTML=HTML_" "_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	SET HTML=HTML_" "_"<font face=arial size=2><b>Warenherkunft</font>"
	SET HTML=HTML_" "_"</td>"
	SET HTML=HTML_" "_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	SET HTML=HTML_" "_"<font face=arial size=2><b>Menge</font>"
	SET HTML=HTML_" "_"</td>"
	SET HTML=HTML_" "_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	SET HTML=HTML_" "_"<font face=arial size=2><b>Rüstzeit</font>"
	SET HTML=HTML_" "_"</td>"
	SET HTML=HTML_" "_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	SET HTML=HTML_" "_"<font face=arial size=2><b>Dauer</font>"
	SET HTML=HTML_" "_"</td>"
	SET HTML=HTML_" "_"</tr>"
	SET HTML=HTML_" "_"<tr>"
	SET HTML=HTML_" "_"<td class="_""""_"border"_""""_" align=right valign=top nowrap>"
	SET HTML=HTML_" "_"<font face=arial size=2><LFN> .)</LFN></font>"
	SET HTML=HTML_" "_"</td>"
	SET HTML=HTML_" "_"<td class="_""""_"border"_""""_" align=right valign=top nowrap>"
	SET HTML=HTML_" "_"<font face=arial size=2><ARTIKEL></ARTIKEL></font>"
	SET HTML=HTML_" "_"</td>"
	SET HTML=HTML_" "_"<td class="_""""_"border"_""""_" align=left valign=top nowrap>"
	SET HTML=HTML_" "_"<font face=arial size=2><BEZEICHNUNG></BEZEICHNUNG></font>"
	SET HTML=HTML_" "_"</td>"
	SET HTML=HTML_" "_"<td class="_""""_"border"_""""_" align=left valign=top nowrap>"
	SET HTML=HTML_" "_"<font face=arial size=2><WARENHERKUNFT></WARENHERKUNFT></font>"
	SET HTML=HTML_" "_"</td>"
	SET HTML=HTML_" "_"<td class="_""""_"border"_""""_" align=right valign=top nowrap>"
	SET HTML=HTML_" "_"<font face=arial size=2><MENGE></MENGE></font>"
	SET HTML=HTML_" "_"</td>"
	SET HTML=HTML_" "_"<td class="_""""_"border"_""""_" align=right valign=top nowrap>"
	SET HTML=HTML_" "_"<font face=arial size=2><RUESTZEIT></RUESTZEIT></font>"
	SET HTML=HTML_" "_"</td>"
	SET HTML=HTML_" "_"<td class="_""""_"border"_""""_" align=right valign=top nowrap>"
	SET HTML=HTML_" "_"<font face=arial size=2><FERTIGUNGSZEIT></FERTIGUNGSZEIT></font>"
	SET HTML=HTML_" "_"</td>"
	SET HTML=HTML_" "_"</tr>"
	SET HTML=HTML_" "_"<tr>"
	SET HTML=HTML_" "_"<td COLSPAN=5 class="_""""_"border"_""""_" align=RIGHT valign=top nowrap>"
	SET HTML=HTML_" "_"<font face=arial size=2>&nbsp;</font>"
	SET HTML=HTML_" "_"</td>"
	SET HTML=HTML_" "_"<td class="_""""_"border"_""""_" class="_""""_"border"_""""_" align=RIGHT valign=top nowrap>"
	SET HTML=HTML_" "_"<font face=arial size=2><B><GESRUESTZEIT></GESRUESTZEIT></B></font>"
	SET HTML=HTML_" "_"</td>"
	SET HTML=HTML_" "_"<td class="_""""_"border"_""""_" class="_""""_"border"_""""_" align=RIGHT valign=top nowrap>"
	SET HTML=HTML_" "_"<font face=arial size=2><B><GESDAUER></GESDAUER></B></font>"
	SET HTML=HTML_" "_"</td>"
	SET HTML=HTML_" "_"</tr>"
	SET HTML=HTML_" "_"<tr>"
	SET HTML=HTML_" "_"<td COLSPAN=7 class="_""""_"border"_""""_" align=RIGHT valign=top nowrap>"
	SET HTML=HTML_" "_"<font face=arial size=2><B><GESAMTZEIT></GESAMTZEIT></B></font>"
	SET HTML=HTML_" "_"</td>"
	SET HTML=HTML_" "_"</tr>"
	SET HTML=HTML_" "_"</table>"
	SET HTML=HTML_" "_"</UNTERTEILE>"
	SET HTML=HTML_"|"_"<br>"
	
	;AB HIER LISTE STUNDENLEISTUNG ;Confirm. here is list 
	SET HTML=HTML_"|"_"<ANLAGE4>"
	SET HTML=HTML_"|"_"<table border=0 CELLSPACING=1 CELLPADDING=1 WIDTH="_""""_"100%"_""""_" >"
	SET HTML=HTML_"|"_"<tr>"
	SET HTML=HTML_"|"_"<td colspan=6 align=left valign=top nowrap>"
	SET HTML=HTML_"|"_"<font face=arial size=2> Stundenleistung: </font>"
	SET HTML=HTML_"|"_"</td>"
	SET HTML=HTML_"|"_"<td colspan=3 align=left valign=top nowrap>"
	SET HTML=HTML_"|"_"<font face=arial size=2> Form: </font>"
	SET HTML=HTML_"|"_"</td>"
	SET HTML=HTML_"|"_"</tr>"
	SET HTML=HTML_"|"_"<tr>"
	SET HTML=HTML_"|"_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	SET HTML=HTML_"|"_"<font face=arial size=2> Datum </font>"
	SET HTML=HTML_"|"_"</td>"
	SET HTML=HTML_"|"_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	SET HTML=HTML_"|"_"<font face=arial size=2> PersonalNr.<br>und Name </font>"
	SET HTML=HTML_"|"_"</td>"
	SET HTML=HTML_"|"_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	SET HTML=HTML_"|"_"<font face=arial size=2> Std </font>"
	SET HTML=HTML_"|"_"</td>"
	SET HTML=HTML_"|"_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	SET HTML=HTML_"|"_"<font face=arial size=2> Gut <br> Stück </font>"
	SET HTML=HTML_"|"_"</td>"
	SET HTML=HTML_"|"_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	SET HTML=HTML_"|"_"<font face=arial size=2> Gesamt- <br> Gutstück </font>"
	SET HTML=HTML_"|"_"</td>"
	SET HTML=HTML_"|"_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	SET HTML=HTML_"|"_"<font face=arial size=2> Zyklen/ <br>Schicht </font>"
	SET HTML=HTML_"|"_"</td>"
	SET HTML=HTML_"|"_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	SET HTML=HTML_"|"_"<font face=arial size=2> Zyklen/<br> Gesamt </font>"
	SET HTML=HTML_"|"_"</td>"
	SET HTML=HTML_"|"_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	SET HTML=HTML_"|"_"<font face=arial size=2> QS/ <br> frei </font>"
	SET HTML=HTML_"|"_"</td>"
	SET HTML=HTML_"|"_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	SET HTML=HTML_"|"_"<font face=arial size=2> Mat.verlust beim <br> Abspritzen in gr </font>"
	SET HTML=HTML_"|"_"</td>"
	SET HTML=HTML_"|"_"</tr>"
	FOR YI=1:1:10 DO
	. SET HTML=HTML_"|"_"<tr>"
	. SET HTML=HTML_"|"_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	. SET HTML=HTML_"|"_"<font face=arial size=2>&nbsp;</font>"
	. SET HTML=HTML_"|"_"</td>"
	. SET HTML=HTML_"|"_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	. SET HTML=HTML_"|"_"<font face=arial size=2>&nbsp;</font>"
	. SET HTML=HTML_"|"_"</td>"
	. SET HTML=HTML_"|"_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	. SET HTML=HTML_"|"_"<font face=arial size=2>&nbsp;</font>"
	. SET HTML=HTML_"|"_"</td>"
	. SET HTML=HTML_"|"_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	. SET HTML=HTML_"|"_"<font face=arial size=2>&nbsp;</font>"
	. SET HTML=HTML_"|"_"</td>"
	. SET HTML=HTML_"|"_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	. SET HTML=HTML_"|"_"<font face=arial size=2>&nbsp;</font>"
	. SET HTML=HTML_"|"_"</td>"
	. SET HTML=HTML_"|"_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	. SET HTML=HTML_"|"_"<font face=arial size=2>&nbsp;</font>"
	. SET HTML=HTML_"|"_"</td>"
	. SET HTML=HTML_"|"_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	. SET HTML=HTML_"|"_"<font face=arial size=2>&nbsp;</font>"
	. SET HTML=HTML_"|"_"</td>"
	. SET HTML=HTML_"|"_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	. SET HTML=HTML_"|"_"<font face=arial size=2>&nbsp;</font>"
	. SET HTML=HTML_"|"_"</td>"
	. SET HTML=HTML_"|"_"<td class="_""""_"border"_""""_" align=center valign=top nowrap>"
	. SET HTML=HTML_"|"_"<font face=arial size=2>&nbsp;</font>"
	. SET HTML=HTML_"|"_"</td>"
	. SET HTML=HTML_"|"_"</tr>"
	. QUIT
	SET HTML=HTML_"|"_"</table>"
	SET HTML=HTML_"|"_"</ANLAGE4>"
	SET HTML=HTML_"|"_"Seite: <SEITE></SEITE>"
	;SET HTML=HTML_"|"_"</body>"
	;SET HTML=HTML_"|"_"</html>"
	SET $PIECE(^WWWHTML($$^WWWYM("WWWHTML"),"INPROPROHTML","DE",1),Y,1)=HTML
	SET $PIECE(^WWWHTML($$^WWWYM("WWWHTML"),"INPROPROHTML","DE",1),Y,2)="Fertigungsanweisung"
	QUIT           
]]></Routine>
</Export>