<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="22" zv="Cache" ts="2001-01-01 00:00:00">
<Class name="VAR.CSP.VARValidadorEstadiamento">
<ClassType/>
<IncludeCode>MEDConst,VARConst,INConst,WWWConst</IncludeCode>
<ProcedureBlock>0</ProcedureBlock>
<Super>%CSP.Page</Super>

<Method name="OnPage">
<ClassMethod>1</ClassMethod>
<ReturnType>%Status</ReturnType>
<Implementation><![CDATA[	$$$VAR
	Set method = $get(%request.Data("method",1))
	Xecute "do .."_method_"()"
	Return $$$OK]]></Implementation>
</Method>

<Method name="GetColunas">
<ClassMethod>1</ClassMethod>
<FormalSpec>pYBED="",pCodCID=""</FormalSpec>
<Implementation><![CDATA[	$$$VAR
	Set YM 		= 0
	Set Y 		= "~"
	If (pYBED = "") {
		Set YBED 	= $Get(%request.Data("YBED",1))
		Set pCodCID = $Get(%request.Data("pCodCID",1))
	}Else{
		Set YBED 	= pYBED
	}
	;
	If (pCodCID = "C90.0") {
		Do ..GetColunasC900(pYBED, pCodCID)
		Return $Replace($Replace(retorno.%ToJSON(),"""'",""),"'""","")
	}
	
	Set retorno = []
	Set retornoCol = []
	;
	Set list = {}
	Set list.dataField 	= "Sequencia"
	Set list.visible 	= 0
	Set list.width		= 200
	Do retorno.%Push(list)
	;
	If (YBED = "JULIODEV1") {
		Set list = {}
		Set list.dataField 	= "preparar"
		Set list.alignment 	= "center"
		Set list.visible 	= 1
		Set list.width		= 80
		Do list.%Set("cellTemplate", "'preparar'")
		Do retorno.%Push(list)
	}
	;
	Set nSeq = ""
	For {
		Set nSeq = $Order(^WWW003(0,"VARValidadorEstadiamento",nSeq))
		Quit:nSeq=""
		;
		Set descr = $Piece(^WWW003(0,"VARValidadorEstadiamento",nSeq,1),Y,1)
		Set campo = $Piece(^WWW003(0,"VARValidadorEstadiamento",nSeq,1),Y,25)
		;
		Set list = {}
		Set list.dataField 	= campo
		Set list.caption	= descr
		Set list.width		= 120
		If ($Extract(campo,1,5)["Campo") {
			Set list.allowSearch = 0
		}
		If (campo = "Campo455" || (campo = "Campo102") || (campo = "Campo101")) {
			Do list.%Set("cellTemplate", "'mudarCor'")
			Set list.corColuna = "#FFFF88"
		}
		Do retornoCol.%Push(list)
		;
		If (nSeq = 109) {
			Set list = {}
			Set list.dataField 	= "AreasLinfadenopatia"
			Set list.caption	= "Áreas de Linfadenopatia"
			Set list.width		= 120
			Set list.allowSorting = 0
			Set list.allowSearch = 0
			Set list.allowFiltering = 0
			Do retornoCol.%Push(list)
		}
		;
	}
	;
	Set list = {}
	Set list.dataField 	= "Consultar"
	Set list.caption	= "Consultar"
	Set list.alignment 	= "center"
	Set list.width		= 120
	Set list.allowSorting = 0
	Set list.allowSearch = 0
	Set list.allowFiltering = 0
	Do list.%Set("cellTemplate", "'colunaConsultar'")
	Do retornoCol.%Push(list)
	;
	Set list = {}
	Set list.caption 	= "MAPPA"
	Set list.alignment 	= "center"
	Set list.columns 	= retornoCol
	Do retorno.%Push(list)
	;
	;RAI
	Set retornoCol = []
	Set list = {}
	Set list.dataField 	= "RAILinfonodosAumentados"
	Set list.caption	= "Linfonodos Aumentados"
	Set list.allowSorting = 0
	Set list.allowSearch = 0
	Set list.allowFiltering = 0
	Set list.width		= 120
	Do list.%Set("cellTemplate", "'mudarCor'")
	Set list.corColuna 	= "#D5FFC6"
	Do retornoCol.%Push(list)
	Set list = {}
	Set list.dataField 	= "RAIBacoDilatado"
	Set list.caption	= "Baço Dilatado"
	Set list.allowSorting = 0
	Set list.allowSearch = 0
	Set list.allowFiltering = 0
	Set list.width		= 120
	Do list.%Set("cellTemplate", "'mudarCor'")
	Set list.corColuna 	= "#D5FFC6"
	Do retornoCol.%Push(list)
	Set list = {}
	Set list.dataField 	= "RAIFigadoDilatado"
	Set list.caption	= "Fígado Dilatado"
	Set list.width		= 120
	Set list.allowSorting = 0
	Set list.allowSearch = 0 
	Set list.allowFiltering = 0
	Do list.%Set("cellTemplate", "'mudarCor'")
	Set list.corColuna 	= "#D5FFC6"
	Do retornoCol.%Push(list)
	Set list = {}
	Set list.dataField 	= "RAIAnemia"
	Set list.caption	= "Anemia (Hgb ≤11 g / dL)"
	Set list.width		= 120
	Set list.allowSorting = 0
	Set list.allowSearch = 0
	Set list.allowFiltering = 0
	Do list.%Set("cellTemplate", "'mudarCor'")
	Set list.corColuna 	= "#D5FFC6"
	Do retornoCol.%Push(list)
	Set list = {}
	Set list.dataField 	= "RAITrombocitopenia"
	Set list.caption	= "Trombocitopenia (Plaquetas ≤100.000 / mm³)"
	Set list.width		= 120
	Set list.allowSorting = 0
	Set list.allowSearch = 0
	Set list.allowFiltering = 0
	Do list.%Set("cellTemplate", "'mudarCor'")
	Set list.corColuna 	= "#D5FFC6"
	Do retornoCol.%Push(list)
	Set list = {}
	Set list.dataField 	= "RAIResultado"
	Set list.caption	= "Resultado"
	Set list.width		= 180
	Set list.allowSorting = 0
	Set list.allowSearch = 0
	;Set list.allowFiltering = 0
	Set list.corColuna 	= "#D5FFC6"
	Do list.%Set("cellTemplate", "'colunaResultado'")
	Do retornoCol.%Push(list)
	Set list = {}
	Set list.dataField 	= "RAIResultadoCheck"
	Set list.caption	= "Checagem"
	Set list.alignment 	= "center"
	Set list.width		= 120
	Set list.allowSorting = 0
	Set list.allowSearch = 0
	;Set list.allowFiltering = 0
	Set list.corColuna 	= "#D5FFC6"
	Do list.%Set("cellTemplate", "'colunaChec'")
	Do retornoCol.%Push(list)
	Set list = {}
	Set list.caption 	= "MDCALC | RAI"
	Set list.alignment 	= "center"
	Set list.columns 	= retornoCol
	Do retorno.%Push(list)
	;
	;BINET
	Set retornoCol = []
	Set list = {}
	Set list.dataField 	= "BINETAreasLinfadenopatia"
	Set list.caption 	= "Áreas de linfadenopatia (Cervical, axilar, inguinal, baço e fígado)"
	Set list.width		= 120
	Set list.allowSorting = 0
	Set list.allowSearch = 0
	Set list.allowFiltering = 0
	Do retornoCol.%Push(list)
	Set list = {}
	Set list.dataField 	= "BINETAnemia"
	Set list.caption 	= "Anemia (Hgb <10 g / dL)"
	Set list.width		= 120
	Set list.allowSorting = 0
	Set list.allowSearch = 0
	Set list.allowFiltering = 0
	Do retornoCol.%Push(list)
	Set list = {}
	Set list.dataField 	= "BINETTrombocitopenia"
	Set list.caption 	= "Trombocitopenia (Plaquetas <100.000 / mm³)"
	Set list.width		= 120
	Set list.allowSorting = 0
	Set list.allowSearch = 0
	Set list.allowFiltering = 0
	Do retornoCol.%Push(list)
	Set list = {}
	Set list.dataField 	= "BINETResultado"
	Set list.caption	= "Resultado"
	Set list.width		= 180
	Set list.allowSorting = 0
	Set list.allowSearch = 0
	;Set list.allowFiltering = 0
	Do list.%Set("cellTemplate", "'colunaResultado'")
	Do retornoCol.%Push(list)
	Set list = {}
	Set list.dataField 	= "BINETResultadoCheck"
	Set list.caption	= "Checagem"
	Set list.width		= 120
	Set list.allowSorting = 0
	Set list.alignment 	= "center"
	Set list.allowSearch = 0
	;Set list.allowFiltering = 0
	Do list.%Set("cellTemplate", "'colunaChec'")
	Do retornoCol.%Push(list)
	Set list = {}
	Set list.caption 	= "MDCALC | BINET"
	Set list.alignment 	= "center"
	Set list.columns 	= retornoCol
	Do retorno.%Push(list)
	;	
	;CLL-IPI
	Set retornoCol = []
	Set list = {}
	Set list.dataField 	= "CLLIPIIdade"
	Set list.caption 	= "Idade"
	Set list.width		= 120
	Set list.allowSorting = 0
	Set list.allowSearch = 0
	Set list.allowFiltering = 0
	Do list.%Set("cellTemplate", "'mudarCor'")
	Set list.corColuna 	= "#DFEFFF"
	Do retornoCol.%Push(list)
	Set list = {}
	Set list.dataField 	= "CLLIPIEstagioClinico"
	Set list.caption 	= "Estágio clínico"
	Set list.width		= 120
	Set list.allowSorting = 0
	Set list.allowSearch = 0
	Set list.allowFiltering = 0
	Do list.%Set("cellTemplate", "'mudarCor'")
	Set list.corColuna 	= "#DFEFFF"
	Do retornoCol.%Push(list)
	Set list = {}
	Set list.dataField 	= "CLLIPIMicroglobulina"
	Set list.caption 	= "Microglobulina β2 sérica, mg/L (ou µg/mL)"
	Set list.width		= 120
	Set list.allowSorting = 0
	Set list.allowSearch = 0
	Set list.allowFiltering = 0
	Do list.%Set("cellTemplate", "'mudarCor'")
	Set list.corColuna 	= "#DFEFFF"
	Do retornoCol.%Push(list)
	Set list = {}
	Set list.dataField 	= "CLLIPIIGHV"
	Set list.caption 	= "Status mutacional IGHV"
	Set list.width		= 120
	Set list.allowSorting = 0
	Set list.allowSearch = 0
	Set list.allowFiltering = 0
	Do list.%Set("cellTemplate", "'mudarCor'")
	Set list.corColuna 	= "#DFEFFF"
	Do retornoCol.%Push(list)
	Set list = {}
	Set list.dataField 	= "CLLIPITP53"
	Set list.caption 	= "Deleção 17p (FISH) e / ou mutação TP53 (sequenciamento)"
	Set list.width		= 120
	Set list.allowSorting = 0
	Set list.allowSearch = 0
	Set list.allowFiltering = 0
	Do list.%Set("cellTemplate", "'mudarCor'")
	Set list.corColuna 	= "#DFEFFF"
	Do retornoCol.%Push(list)
	Set list = {}
	Set list.dataField 	= "CLLIPIResultado"
	Set list.caption	= "Resultado"
	Set list.width		= 180
	Set list.allowSorting = 0
	Set list.allowSearch = 0
	Set list.allowFiltering = 0
	Set list.corColuna 	= "#DFEFFF"
	Do list.%Set("cellTemplate", "'colunaResultado'")
	Do retornoCol.%Push(list)
	Set list = {}
	Set list.dataField 	= "CLLIPIResultadoCheck"
	Set list.caption	= "Checagem"
	Set list.alignment 	= "center"
	Set list.width		= 120
	Set list.allowSorting = 0
	Set list.allowSearch = 0
	;Set list.allowFiltering = 0
	Set list.corColuna 	= "#DFEFFF"
	Do list.%Set("cellTemplate", "'colunaChec'")
	Do retornoCol.%Push(list)
	Set list = {}
	Set list.caption 	= "MDCALC | CLL-IPI"
	Set list.alignment 	= "center"
	Set list.columns 	= retornoCol
	Do retorno.%Push(list)
	;
	Return $Replace($Replace(retorno.%ToJSON(),"""'",""),"'""","")]]></Implementation>
</Method>

<Method name="GetColunasC900">
<ClassMethod>1</ClassMethod>
<FormalSpec>pYBED="",pCodCID=""</FormalSpec>
<Implementation><![CDATA[	$$$VAR
	Set YM 		= 0
	Set Y 		= "~"
	;
	Set retorno = []
	Set retornoCol = []
	;
	Set list = {}
	Set list.dataField 	= "Sequencia"
	Set list.visible 	= 0
	Set list.width		= 200
	Do retorno.%Push(list)
	;
	If (YBED = "JULIODEV1") {
		Set list = {}
		Set list.dataField 	= "preparar"
		Set list.alignment 	= "center"
		Set list.visible 	= 1
		Set list.width		= 80
		Do list.%Set("cellTemplate", "'preparar'")
		Do retorno.%Push(list)
	}
	;
	Set nSeq = ""
	For {
		Set nSeq = $Order(^WWW003(0,"VARValidadorEstadiamentoC900",nSeq))
		Quit:nSeq=""
		;
		Set descr = $Piece(^WWW003(0,"VARValidadorEstadiamentoC900",nSeq,1),Y,1)
		Set campo = $Piece(^WWW003(0,"VARValidadorEstadiamentoC900",nSeq,1),Y,25)
		;
		Set list = {}
		Set list.dataField 	= campo
		Set list.caption	= descr
		Set list.width		= 120
		;Set list.visible    = 0
		If ($Extract(campo,1,5)["Campo") {
			Set list.allowSearch = 0
		}
		;If (campo = "Campo455" || (campo = "Campo102") || (campo = "Campo101")) {
		;	Do list.%Set("cellTemplate", "'mudarCor'")
		;	Set list.corColuna = "#FFFF88"
		;}
		Do retornoCol.%Push(list)
		;
	}
	;
	Set list = {}
	Set list.dataField 	= "Consultar"
	Set list.caption	= "Consultar"
	Set list.alignment 	= "center"
	Set list.width		= 120
	Set list.allowSorting = 0
	Set list.allowSearch = 0
	Set list.allowFiltering = 0
	Do list.%Set("cellTemplate", "'colunaConsultar'")
	Do retornoCol.%Push(list)
	;
	Set list = {}
	Set list.caption 	= "MAPPA"
	Set list.alignment 	= "center"
	Set list.columns 	= retornoCol
	Do retorno.%Push(list)
	;
	;Diagnóstico
	Set retornoCol = []
	Set retornoCol1 = []
	Set retornoCol2 = []

	Set list = {}
	Set list.dataField 	= "DiagQuad1A"
	Set list.caption	= "A. Células plasmáticas clonais da medula óssea ≥10%"
	Set list.allowSorting = 0
	Set list.allowSearch = 0
	Set list.allowFiltering = 0
	Set list.width		= 120
	Set list.corColuna 	= "#D5FFC6"
	Do list.%Set("cellTemplate", "'mudarCor'")
	Do retornoCol.%Push(list)	
	Set list = {}
	Set list.dataField 	= "DiagQuad1B"
	Set list.caption	= "B. Plasmacitoma ósseo ou extramedular comprovado por biópsia"
	Set list.allowSorting = 0
	Set list.allowSearch = 0
	Set list.allowFiltering = 0
	Set list.width		= 120
	Set list.corColuna 	= "#D5FFC6"
	Do list.%Set("cellTemplate", "'mudarCor'")
	Do retornoCol.%Push(list)
	;
	Set list = {}
	Set list.caption 	= "≥1 dos seguintes (A ou B)"
	Set list.alignment 	= "center"
	Set list.columns 	= retornoCol
	Do retornoCol1.%Push(list)
	;
	Set retornoCol = []
	Set list = {}
	Set list.dataField 	= "DiagQuad2A"
	Set list.caption	= "Hipercalcemia - Cálcio sérico> 1 mg / dL (> 0,25 mmol / L) superior ao limite superior do normal ou> 11 mg / dL (> 2,75 mmol / L)"
	Set list.allowSorting = 0
	Set list.allowSearch = 0
	Set list.allowFiltering = 0
	Set list.width		= 120
	Set list.corColuna 	= "#D5FFC6"
	Do list.%Set("cellTemplate", "'mudarCor'")
	Do retornoCol.%Push(list)	
	Set list = {}
	Set list.dataField 	= "DiagQuad2B"
	Set list.caption	= "Insuficiência renal - Depuração de creatinina <40 mL por min ou creatinina sérica> 2 mg / dL (177 μmol / L)"
	Set list.allowSorting = 0
	Set list.allowSearch = 0
	Set list.allowFiltering = 0
	Set list.width		= 120
	Set list.corColuna 	= "#D5FFC6"
	Do list.%Set("cellTemplate", "'mudarCor'")
	Do retornoCol.%Push(list)
	Set list = {}
	Set list.dataField 	= "DiagQuad2C"
	Set list.caption	= "Anemia - Hemoglobina> 2 g / dL (20 g / L) abaixo do limite inferior do normal ou <10 g / dL (100 g / L)"
	Set list.allowSorting = 0
	Set list.allowSearch = 0
	Set list.allowFiltering = 0
	Set list.width		= 120
	Set list.corColuna 	= "#D5FFC6"
	Do list.%Set("cellTemplate", "'mudarCor'")
	Do retornoCol.%Push(list)	
	Set list = {}
	Set list.dataField 	= "DiagQuad2D"
	Set list.caption	= "Lesões ósseas - ≥1 lesão osteolítica na radiografia esquelética, TC ou PET-TC"
	Set list.allowSorting = 0
	Set list.allowSearch = 0
	Set list.allowFiltering = 0
	Set list.width		= 120
	Set list.corColuna 	= "#D5FFC6"
	Do list.%Set("cellTemplate", "'mudarCor'")
	Do retornoCol.%Push(list)
	;
	Set list = {}
	Set list.caption 	= "C1. Lesão de órgão final atribuível ao distúrbio de células plasmáticas subjacente (≥1 dos seguintes):"
	Set list.alignment 	= "center"
	Set list.columns 	= retornoCol
	Do retornoCol2.%Push(list)	
	;
	Set retornoCol = []
	Set list = {}
	Set list.dataField 	= "DiagQuad3A"
	Set list.caption	= "Células plasmáticas clonais da medula óssea ≥60%"
	Set list.allowSorting = 0
	Set list.allowSearch = 0
	Set list.allowFiltering = 0
	Set list.width		= 120
	Set list.corColuna 	= "#D5FFC6"
	Do list.%Set("cellTemplate", "'mudarCor'")
	Do retornoCol.%Push(list)	
	Set list = {}
	Set list.dataField 	= "DiagQuad3B"
	Set list.caption	= "Envolvido: Uninvolved sflc proporção ≥100"
	Set list.allowSorting = 0
	Set list.allowSearch = 0
	Set list.allowFiltering = 0
	Set list.width		= 120
	Set list.corColuna 	= "#D5FFC6"
	Do list.%Set("cellTemplate", "'mudarCor'")
	Do retornoCol.%Push(list)
	Set list = {}
	Set list.dataField 	= "DiagQuad3C"
	Set list.caption	= "> 1 lesão focal na ressonância magnética"
	Set list.allowSorting = 0
	Set list.allowSearch = 0
	Set list.allowFiltering = 0
	Set list.width		= 120
	Set list.corColuna 	= "#D5FFC6"
	Do list.%Set("cellTemplate", "'mudarCor'")
	Do retornoCol.%Push(list)
	;
	Set list = {}
	Set list.caption 	= "C2. ≥1 dos seguintes biomarcadores de malignidade:"
	Set list.alignment 	= "center"
	Set list.columns 	= retornoCol
	Do retornoCol2.%Push(list)	
	;	
	Set list = {}
	Set list.caption 	= "≥1 evento definidor de mieloma (C1 ou C2)"
	Set list.alignment 	= "center"
	Set list.columns 	= retornoCol2
	Do retornoCol1.%Push(list)	
	;	
	Set list = {}
	Set list.dataField 	= "DiagResultado"
	Set list.caption	= "Resultado"
	Set list.width		= 180
	Set list.allowSorting = 0
	Set list.allowSearch = 0
	Do list.%Set("cellTemplate", "'colunaResultado'")
	Set list.corColuna 	= "#D5FFC6"
	Do retornoCol1.%Push(list)
	Set list = {}
	Set list.dataField 	= "DiagResultadoCheck"
	Set list.caption	= "Checagem"
	Set list.alignment 	= "center"
	Set list.width		= 120
	Set list.allowSorting = 0
	Set list.allowSearch = 0
	Do list.%Set("cellTemplate", "'colunaChec'")
	Set list.corColuna 	= "#D5FFC6"
	Do retornoCol1.%Push(list)
	;
	Set list = {}
	Set list.caption 	= "MDCALC | Diagnóstico Mieloma Múltiplo"
	Set list.alignment 	= "center"
	Set list.columns 	= retornoCol1
	Do retorno.%Push(list)
	;ISS
	Set retornoCol = []
	Set list = {}
	Set list.dataField 	= "ISSBeta2Microglobulina"
	Set list.caption	= "Beta 2 Microglobulina"
	Set list.allowSorting = 0
	Set list.allowSearch = 0
	Set list.allowFiltering = 0
	Set list.width		= 120
	Do retornoCol.%Push(list)
	Set list = {}
	Set list.dataField 	= "ISSAlbumina"
	Set list.caption	= "Albumina"
	Set list.allowSorting = 0
	Set list.allowSearch = 0
	Set list.allowFiltering = 0
	Set list.width		= 120
	Do retornoCol.%Push(list)
	Set list = {}
	Set list.dataField 	= "ISSResultado"
	Set list.caption	= "Resultado"
	Set list.width		= 180
	Set list.allowSorting = 0
	Set list.allowSearch = 0
	Do list.%Set("cellTemplate", "'colunaResultado'")
	Do retornoCol.%Push(list)
	Set list = {}
	Set list.dataField 	= "ISSResultadoCheck"
	Set list.caption	= "Checagem"
	Set list.alignment 	= "center"
	Set list.width		= 120
	Set list.allowSorting = 0
	Set list.allowSearch = 0
	Do list.%Set("cellTemplate", "'colunaChec'")
	Do retornoCol.%Push(list)
	Set list = {}
	Set list.caption 	= "MDCALC | ISS"
	Set list.alignment 	= "center"
	Set list.columns 	= retornoCol
	Do retorno.%Push(list)
	;
	;R-ISS
	Set retornoCol = []
	Set list = {}
	Set list.dataField 	= "RISSBeta2Microglobulina"
	Set list.caption	= "Beta 2 Microglobulina"
	Set list.allowSorting = 0
	Set list.allowSearch = 0
	Set list.allowFiltering = 0
	Set list.width		= 120
	Set list.corColuna 	= "#D5FFC6"
	Do list.%Set("cellTemplate", "'mudarCor'")
	Do retornoCol.%Push(list)
	Set list = {}
	Set list.dataField 	= "RISSAlbumina"
	Set list.caption	= "Albumina"
	Set list.allowSorting = 0
	Set list.allowSearch = 0
	Set list.allowFiltering = 0
	Set list.width		= 120
	Set list.corColuna 	= "#D5FFC6"
	Do list.%Set("cellTemplate", "'mudarCor'")
	Do retornoCol.%Push(list)
	Set list = {}
	Set list.dataField 	= "RISSCAporiFISH"
	Set list.caption	= "CA by iFISH - High risk defined as: presence of del(17p) and/or translocation t(4;14) and/or translocation t(14;16)"
	Set list.allowSorting = 0
	Set list.allowSearch = 0
	Set list.allowFiltering = 0
	Set list.width		= 120
	Set list.corColuna 	= "#D5FFC6"
	Do list.%Set("cellTemplate", "'mudarCor'")
	Do retornoCol.%Push(list)
	Set list = {}
	Set list.dataField 	= "RISSLDH"
	Set list.caption	= "LDH"
	Set list.allowSorting = 0
	Set list.allowSearch = 0
	Set list.allowFiltering = 0
	Set list.width		= 120
	Set list.corColuna 	= "#D5FFC6"
	Do list.%Set("cellTemplate", "'mudarCor'")
	Do retornoCol.%Push(list)
	Set list = {}
	Set list.dataField 	= "RISSResultado"
	Set list.caption	= "Resultado"
	Set list.width		= 180
	Set list.allowSorting = 0
	Set list.allowSearch = 0
	Do list.%Set("cellTemplate", "'colunaResultado'")
	Set list.corColuna 	= "#D5FFC6"
	Do retornoCol.%Push(list)
	Set list = {}
	Set list.dataField 	= "RISSResultadoCheck"
	Set list.caption	= "Checagem"
	Set list.alignment 	= "center"
	Set list.width		= 120
	Set list.allowSorting = 0
	Set list.allowSearch = 0
	Do list.%Set("cellTemplate", "'colunaChec'")
	Set list.corColuna 	= "#D5FFC6"
	Do retornoCol.%Push(list)
	Set list = {}
	Set list.caption 	= "MDCALC | R-ISS"
	Set list.alignment 	= "center"
	Set list.columns 	= retornoCol
	Do retorno.%Push(list)	
	;
	Return $Replace($Replace(retorno.%ToJSON(),"""'",""),"'""","")]]></Implementation>
</Method>

<Method name="GetLinhas">
<ClassMethod>1</ClassMethod>
<Implementation><![CDATA[	#Dim pObjFiltros As %Library.DynamicObject 	= ""
	
	$$$VAR
	Set YM 		= 0
	Set Y 		= "~"
	Set YBED 	= $Get(%request.Data("YBED",1))
	Set pCodCID = $Get(%request.Data("pCodCID",1))
	Set pFilter	= $Get(%request.Data("pFilter",1))
	;
	If (pCodCID = "C90.0") {
		Do ..GetLinhasC900()

		Return $$$OK
	}
	/*Kill ^zzJULIO
	Set pObjFiltros = [].%FromJSON(pFilter)
	Set pSkip		= pObjFiltros.skip
	Set pTake		= (pSkip + pObjFiltros.take) - 1
	;
	Set filtro = ""
	If ($IsObject(pObjFiltros.filter)) {
		If ($IsObject(pObjFiltros.filter.%Get(0))) {
			For i = 0 : 1 : (pObjFiltros.filter.%Size()-1) {
				Set objeto = pObjFiltros.filter.%Get(i)
				If ($IsObject(objeto)) {
					Set campo 		= objeto.%Get(0) 
					Set condicao 	= objeto.%Get(1) 
					Set cmparacao = objeto.%Get(2) 
					If (condicao="contains") { Set filtro	= filtro _ campo_" Like '%"_cmparacao_"%' "
					}ElseIf (condicao="notcontains") { Set filtro	= filtro _ campo_" Not Like '%"_cmparacao_"%' "
					}ElseIf (condicao="startswith") { Set filtro= filtro _ campo_" Like '"_cmparacao_"%' "
					}ElseIf (condicao="endswith") { Set filtro = filtro _ campo_" Like '%"_cmparacao_"' "
					}Else{ Set filtro	= filtro _ campo_" "_condicao_" '"_cmparacao_"' " 
					}
				}Else{
					Set filtro		= filtro _ objeto _ " "
				}
			}
		}Else{
			Set campo 		= pObjFiltros.filter.%Get(0) 
			Set condicao 	= pObjFiltros.filter.%Get(1) 
			Set cmparacao = pObjFiltros.filter.%Get(2) 
			If (condicao="contains") { Set filtro		= campo_" Like '%"_cmparacao_"%' "
			}ElseIf (condicao="notcontains") { Set filtro		= campo_" Not Like '%"_cmparacao_"%' "
			}ElseIf (condicao="startswith") { Set filtro		= campo_" Like '"_cmparacao_"%' "
			}ElseIf (condicao="endswith") { Set filtro		= campo_" Like '%"_cmparacao_"' "
			}Else{ Set filtro		= campo_" "_condicao_" '"_cmparacao_"' " 
			}
		}	
	}
	;S ^zzJULIO($now()) = filtro

	Set orderBy = ""
	If ($IsObject(pObjFiltros.sort)) {
		For i = 0 : 1 : (pObjFiltros.sort.%Size()-1) {
			Set objeto = pObjFiltros.sort.%Get(i)
			Set orderBy = orderBy _ $Select(orderBy="":"",1:", ")_ objeto.selector_" "_$Select(objeto.desc=0:"",1:"desc")
		}
	}
	;
	;S ^zzJULIO($now()) = pSkip_"|"_pTake_"|"_orderBy_"|"_filtro
	;*/
	Set retorno = []
	;
	/*Set meuSQL = "Select * From ( " _ 
				 					"Select *, Count(*) As qtdeLinha From SQLUser.VARValidadorEstadiamento Where Company = 0 " _
				 					$Select(filtro="":"",1:"And "_filtro) _
				 					;" And Sequencia = 66017330653 "_
				 			 ") Where %VID Between "_pSkip_" and "_pTake _
				 			 $Select(orderBy="":"",1:"Order By "_ orderBy_" ")*/
	Set meuSQL = "Select *, Count(*) As qtdeLinha From SQLUser.VARValidadorEstadiamento Where Company = 0 " ;And Sequencia = '6601833008518'"
	;S ^zzJULIO("SQL") = meuSQL
	Set rSet 		= ##class(%SQL.Statement).%ExecDirect("",meuSQL)
	While(rSet.%Next()){
		Set list = {}
		Set list.CIDImagem = "C91_1"
		Set list.Sequencia = rSet.%Get("Sequencia")
		Set list.preparar = 1
		Set list.qtdeLinha = rSet.%Get("qtdeLinha")
		Set qtdeArea = 0
		Set nSeq = ""
		For {
			Set nSeq = $Order(^WWW003(0,"VARValidadorEstadiamento",nSeq))
			Quit:nSeq=""
			Set campo = $Piece(^WWW003(0,"VARValidadorEstadiamento",nSeq,1),Y,25)
			If (campo = "Campo243" && (rSet.%Get(campo) = "S")) Set qtdeArea = qtdeArea + 1
			If (campo = "Campo244" && (rSet.%Get(campo) = "S")) Set qtdeArea = qtdeArea + 1
			If (campo = "Campo245" && (rSet.%Get(campo) = "S")) Set qtdeArea = qtdeArea + 1
			If (campo = "Campo1350" && (rSet.%Get(campo) = "S")) Set qtdeArea = qtdeArea + 1
			If (campo = "Campo1351" && (rSet.%Get(campo) = "S")) Set qtdeArea = qtdeArea + 1
			Do list.%Set(campo, rSet.%Get(campo))
		}
		Do list.%Set("AreasLinfadenopatia", qtdeArea)
		;
		;RAI
		Set xRAILinfonodosAumentados = "N"
		Set list.RAILinfonodosAumentados = "Não"
		If (rSet.%Get("Campo243")="S" || (rSet.%Get("Campo244")="S") || (rSet.%Get("Campo245")="S") || 
		   (rSet.%Get("Campo255")="S") || (rSet.%Get("Campo265")="S") || (rSet.%Get("Campo270")="S") || 
		   (rSet.%Get("Campo275")="S") || (rSet.%Get("Campo285")="S")) {
			Set list.RAILinfonodosAumentados = "Sim"	   
			Set xRAILinfonodosAumentados = "S"
	    }
		Set xRAIBacoDilatado = "N"
		Set list.RAIBacoDilatado = "Não"
		If (rSet.%Get("Campo1351")="S") {
			Set list.RAIBacoDilatado = "Sim"	   
			Set xRAIBacoDilatado = "S"
	    }
		Set xRAIFigadoDilatado = "N"
		Set list.RAIFigadoDilatado = "Não"
		If (rSet.%Get("Campo1350")="S") {
			Set list.RAIFigadoDilatado = "Sim"	   
			Set xRAIFigadoDilatado = "S"
	    }
		Set xRAIAnemia = "N"
		Set list.RAIAnemia = "Não"
		If (rSet.%Get("Campo13")<=11) {
			Set list.RAIAnemia = "Sim"	   
			Set xRAIAnemia = "S"
	    }
		Set xRAITrombocitopenia = "N"
		Set list.RAITrombocitopenia = "Não"
		If (rSet.%Get("Campo32")<=100000) {
			Set list.RAITrombocitopenia = "Sim"	   
			Set xRAITrombocitopenia = "S"
	    }
	    Set result = xRAILinfonodosAumentados_xRAIBacoDilatado_xRAIFigadoDilatado_xRAIAnemia_xRAITrombocitopenia
		Set eResult = "", checagem = 0
		If ($Data(^VALIDADOSMAPPA(0,"RAI",result))) {
			Set eResult = $Piece(^VALIDADOSMAPPA(0,"RAI",result,1),"~",1)_" | "_$Piece(^VALIDADOSMAPPA(0,"RAI",result,1),"~",2)
			If ($Piece(list.ResultadoRAI," | ",1) [ "Impossível") {
				Set checagem = 2
			}Else{
				If ($Piece(^VALIDADOSMAPPA(0,"RAI",result,1),"~",1) = $Piece(list.ResultadoRAI," | ",1) && 
				   ($Piece(^VALIDADOSMAPPA(0,"RAI",result,1),"~",2) = $Piece($Piece(list.ResultadoRAI," | ",2)," ",2))) { 
				   	Set checagem = 1
				}
			}
		}
		Set list.RAIResultado = eResult
		Set list.RAIResultadoImg = result
		Set list.RAIResultadoCheck = $Select(+checagem=2:$Piece(list.ResultadoRAI," | ",1),+checagem=1:"OK",1:"Não OK")
		Set list.RAIResultadoCheckIcone = +checagem
		;
		;BINET
		Set xBINETAreasLinfadenopatia = "ME3"
		Set list.BINETAreasLinfadenopatia = "<3"
		If (qtdeArea>=3) {
			Set list.BINETAreasLinfadenopatia = "≥3"	   
			Set xBINETAreasLinfadenopatia = "MA3"
	    }
		Set xBINETAnemia = "N"
		Set list.BINETAnemia = "Não"
		If (rSet.%Get("Campo13")<10) {
			Set list.BINETAnemia = "Sim"	   
			Set xBINETAnemia = "S"
	    }
		Set xBINETTrombocitopenia = "N"
		Set list.BINETTrombocitopenia = "Não"
		If (rSet.%Get("Campo32")<100000) {
			Set list.BINETTrombocitopenia = "Sim"	   
			Set xBINETTrombocitopenia = "S"
    }
    Set result = xBINETAreasLinfadenopatia_xBINETAnemia_xBINETTrombocitopenia
		Set eResult = "", checagem = 0
		If ($Data(^VALIDADOSMAPPA(0,"BINET",result))) {
			Set eResult = $Piece(^VALIDADOSMAPPA(0,"BINET",result,1),"~",1)_" | "_$Piece(^VALIDADOSMAPPA(0,"BINET",result,1),"~",2)
			If ($Piece(list.ResultadoBINET," | ",1) [ "Impossível") {
				Set checagem = 2
			}Else{
				If ($Piece(^VALIDADOSMAPPA(0,"BINET",result,1),"~",1) = $Piece(list.ResultadoBINET," | ",1)) Set checagem = 1
			}
		}
		Set list.BINETResultado = eResult
		Set list.BINETResultadoImg = result
		Set list.BINETResultadoCheck = $Select(+checagem=2:$Piece(list.ResultadoBINET," | ",1),+checagem=1:"OK",1:"Não OK")
		Set list.BINETResultadoCheckIcone = +checagem
		;
		;CLL-IPI
		Set xPontos 	= 0
		Set qtdeAnos 	= 0
		Set nasc		 	= 0
		Set:rSet.%Get("DatadeNascimento")'="" nasc = $ZDate($ZDateH(rSet.%Get("DatadeNascimento"),4),8)
		Set hoje 		= $ZDate($Horolog,8)
		Set qtdeAnos 	= $Extract(hoje,1,4)-$Extract(nasc,1,4)-1
		If $Extract(hoje,5,8)>=$Extract(nasc,5,8) Set qtdeAnos = qtdeAnos +1
		;		
		Set xCLLIPIIdade = "A0"
		Set list.CLLIPIIdade = "≤65 | +0 Ponto"
		If (qtdeAnos>65) {
			Set list.CLLIPIIdade = ">65 | +1 Ponto"
			Set xCLLIPIIdade = "A1"
    	Set xPontos = xPontos + 1
    }
		;
		Set stagioRAI = $Piece(rSet.%Get("ResultadoRAI")," ",2)
		Set stagioBINET = $Piece(rSet.%Get("ResultadoBINET")," ",2)
		Set xCLLIPIEstagioClinico = "C0"
		Set list.CLLIPIEstagioClinico = "Binet A or Rai 0 | +0 Ponto"
		If (stagioRAI="I"||(stagioRAI="II")||(stagioRAI="III")||(stagioRAI="IV")||(stagioBINET="B")||(stagioBINET="C")) {
			Set list.CLLIPIEstagioClinico = "Binet B-C or Rai I-IV | +1 Ponto"
	    	Set xPontos = xPontos + 1
			Set xCLLIPIEstagioClinico = "C1"
	    }
		;
		Set xCLLIPIMicroglobulina = "S0"
		Set list.CLLIPIMicroglobulina = "≤3,5 | +0 Ponto"
		If (rSet.%Get("Campo155")>3.5) {
			Set list.CLLIPIMicroglobulina = ">3,5 | +2 Pontos"
	    Set xPontos = xPontos + 2
			Set xCLLIPIMicroglobulina = "S2"
	  }
		;
		Set xCLLIPIIGHV = "I0"
		Set list.CLLIPIIGHV = "Mutado | +0 Ponto"
		If (rSet.%Get("Campo141") = 1) {
			Set list.CLLIPIIGHV = "Não Mutado | +2 Pontos"
	    Set xPontos = xPontos + 2
			Set xCLLIPIIGHV = "I2"
	  }
		;
		Set xCLLIPITP53 = "T0"
		Set list.CLLIPITP53 = "Sem anormalidades | +0 Ponto"
		If (rSet.%Get("Campo142")=0 || (rSet.%Get("Campo1941")=1) || (rSet.%Get("Campo1926")=1)) {
			Set list.CLLIPITP53 = "Deleção 17p (FISH) e/ou mutação TP53 (sequenciamento) | +4 Pontos"
	    Set xPontos = xPontos + 4
			Set xCLLIPITP53 = "T4"
	  }
		;
		Set result = xCLLIPIIdade_xCLLIPIEstagioClinico_xCLLIPIMicroglobulina_xCLLIPIIGHV_xCLLIPITP53
		Set eResult = "", checagem = 0
		If ($Data(^VALIDADOSMAPPA(0,"CLLIPI",result))) {
			Set eResult = xPontos_" Ponto(s) | "_$Piece(^VALIDADOSMAPPA(0,"CLLIPI",result,1),"~",2)
			If (("Risco "_$Piece(^VALIDADOSMAPPA(0,"CLLIPI",result,1),"~",2)) = rSet.%Get("ResultadoCLL")) Set checagem = 1
		}
		Set list.CLLIPIResultado = eResult
		Set list.CLLIPIResultadoImg = result
		Set list.CLLIPIResultadoCheck = $Select(+checagem=2:$Piece(list.ResultadoBINET," | ",1),+checagem=1:"OK",1:"Não OK")
		Set list.CLLIPIResultadoCheckIcone = +checagem
		;
		Do retorno.%Push(list)		
	}
	;
	Do retorno.%ToJSON()
	Return $$$OK]]></Implementation>
</Method>

<Method name="GetLinhasC900">
<ClassMethod>1</ClassMethod>
<Implementation><![CDATA[	$$$VAR
	Set YM 		= 0
	Set Y 		= "~"

	Set retorno = []

	Set meuSQL = "Select *, Count(*) As qtdeLinha From SQLUser.VARValidadorEstadiamentoC900 Where Company = 0 " ;And Sequencia = '6601833008518'"
	Set rSet 		= ##class(%SQL.Statement).%ExecDirect("",meuSQL)
	While(rSet.%Next()){
		Set list = {}
		Set list.CIDImagem = "C90_0"
		Set list.Sequencia = rSet.%Get("Sequencia")
		Set list.preparar = 1
		Set list.qtdeLinha = rSet.%Get("qtdeLinha")
		Set qtdeArea = 0
		Set nSeq = ""
		For {
			Set nSeq = $Order(^WWW003(0,"VARValidadorEstadiamentoC900",nSeq))
			Quit:nSeq=""
			Set campo = $Piece(^WWW003(0,"VARValidadorEstadiamentoC900",nSeq,1),Y,25)
			Do list.%Set(campo, rSet.%Get(campo))
		}
		;Diagnóstico
		Set xDiagQuad1A = "_"
		If (rSet.%Get("Campo38494")'=""||
		   (rSet.%Get("Campo38495")'="")||
		   (rSet.%Get("Campo38497")'="")||
		   (rSet.%Get("Campo38503")'="")) { 
		   		Set xDiagQuad1A = "N" 
		   		Set list.DiagQuad1A = "Não"
		}
		If (+rSet.%Get("Campo38494")>9||
		   (+rSet.%Get("Campo38495")>9)||
		   (+rSet.%Get("Campo38497")>9)||
		   (rSet.%Get("Campo38503")=1)||
		   (rSet.%Get("Campo38503")="S")) {
			   Set xDiagQuad1A = "S"
		   		Set list.DiagQuad1A = "Sim"
		}
		;
		Set xDiagQuad1B = "_"
		If (rSet.%Get("Campo38520")'="") {
	   		Set xDiagQuad1B = "N" 
	   		Set list.DiagQuad1B = "Não"
		}
		If (rSet.%Get("Campo38520")=1||(rSet.%Get("Campo38520")="S")) {
			Set xDiagQuad1B = "S"
			Set list.DiagQuad1B = "Sim"
		}
		;
		Set xDiagQuad2A = "_"
		If (rSet.%Get("Campo38499")'="") {
	   		Set xDiagQuad2A = "N" 
	   		Set list.DiagQuad2A = "Não"
		}
		If (rSet.%Get("Campo38499")=1||(rSet.%Get("Campo38499")="S")) {
			Set xDiagQuad2A = "S"
			Set list.DiagQuad2A = "Sim"
		}
		;
		Set xDiagQuad2B = "_"
		If (rSet.%Get("Campo38500")'="") {
	   		Set xDiagQuad2B = "N" 
	   		Set list.DiagQuad2B = "Não"
		}
		If (rSet.%Get("Campo38500")=1||(rSet.%Get("Campo38500")="S")) {
			Set xDiagQuad2B = "S"
			Set list.DiagQuad2B = "Sim"
		}
		;
		Set xDiagQuad2C = "_"
		If (rSet.%Get("Campo38501")'="") {
	   		Set xDiagQuad2C = "N" 
	   		Set list.DiagQuad2C = "Não"
		}
		If (rSet.%Get("Campo38501")=1||(rSet.%Get("Campo38501")="S")) {
			Set xDiagQuad2C = "S"
			Set list.DiagQuad2C = "Sim"
		}
		;
		Set xDiagQuad2D = "_"
		If (rSet.%Get("Campo38502")'="") {
	   		Set xDiagQuad2D = "N" 
	   		Set list.DiagQuad2D = "Não"
		}
		If (rSet.%Get("Campo38502")=1||(rSet.%Get("Campo38502")="S")) {
			Set xDiagQuad2D = "S"
			Set list.DiagQuad2D = "Sim"
		}
		;
		Set xDiagQuad3A = "_"
		If (rSet.%Get("Campo38494")'=""||
		   (rSet.%Get("Campo38495")'="")||
		   (rSet.%Get("Campo38497")'="")||
		   (rSet.%Get("Campo38503")'="")) { 
		   		Set xDiagQuad3A = "N" 
		   		Set list.DiagQuad3A = "Não"
		}
		If (+rSet.%Get("Campo38494")>60||
		   (+rSet.%Get("Campo38495")>60)||
		   (+rSet.%Get("Campo38497")>60)||
		   (rSet.%Get("Campo38503")=1)||
		   (rSet.%Get("Campo38503")="S")) {
			   Set xDiagQuad3A = "S"
		   		Set list.DiagQuad3A = "Sim"
		}
		;
		Set xDiagQuad3B = "_"
		If (rSet.%Get("Campo38504")'="") {
	   		Set xDiagQuad3B = "N" 
	   		Set list.DiagQuad3B = "Não"
		}
		If (rSet.%Get("Campo38504")=1||(rSet.%Get("Campo38504")="S")) {
			Set xDiagQuad3B = "S"
			Set list.DiagQuad3B = "Sim"
		}
		;		
		Set xDiagQuad3C = "_"
		If (rSet.%Get("Campo38505")'="") {
	   		Set xDiagQuad3C = "N" 
	   		Set list.DiagQuad3C = "Não"
		}
		If (rSet.%Get("Campo38505")=1||(rSet.%Get("Campo38505")="S")) {
			Set xDiagQuad3C = "S"
			Set list.DiagQuad3C = "Sim"
		}
		;
	    Set result = xDiagQuad1A_xDiagQuad1B_xDiagQuad2A_xDiagQuad2B_xDiagQuad2C_xDiagQuad2D_xDiagQuad3A_xDiagQuad3B_xDiagQuad3C
		Set eResult = "", checagem = 0
		If ($Data(^VALIDADOSMAPPA(0,"DIAGNOSTICO",result))) {
			Set eResult = $Piece(^VALIDADOSMAPPA(0,"DIAGNOSTICO",result,1),"~",1)
			If ($Piece(list.ResultadoDiagnostico," | ",1) [ "Impossível") {
				Set checagem = 2
			}Else{
				If ($Piece(^VALIDADOSMAPPA(0,"DIAGNOSTICO",result,1),"~",1) = "Positivo" &&
				   (list.ResultadoDiagnostico = "Mieloma Múltiplo")) {
					Set checagem = 1   
				}
				If ($Piece(^VALIDADOSMAPPA(0,"DIAGNOSTICO",result,1),"~",1) = "Não positivo" &&
				   (list.ResultadoDiagnostico '= "Mieloma Múltiplo")) {
					Set checagem = 1   
				}
			}
		}
		Set list.DiagResultado = eResult
		Set list.DiagResultadoImg = result
		Set list.DiagResultadoCheck = $Select(+checagem=2:$Piece(list.ResultadoDiagnostico," | ",1),+checagem=1:"OK",1:"Não OK")
		Set list.DiagResultadoCheckIcone = +checagem
		;			
		;ISS
		Set xISSBeta2Microglobulina = ""
		If (rSet.%Get("Campo48533")'="") Set xISSBeta2Microglobulina = "IG35"
		If (rSet.%Get("Campo48533")'=""&&(+rSet.%Get("Campo48533")<3.5))  Set xISSBeta2Microglobulina = "ME35"
		If (rSet.%Get("Campo48533")'=""&&(+rSet.%Get("Campo48533")>5.4))  Set xISSBeta2Microglobulina = "MA54"
		Set list.ISSBeta2Microglobulina = rSet.%Get("Campo48533")	   
		;
		Set xISSAlbumina = ""
		If (rSet.%Get("Campo48532")'="") Set xISSAlbumina = "ME35"
		If (rSet.%Get("Campo48532")'=""&&(+rSet.%Get("Campo48532")>3.4))  Set xISSAlbumina = "MA34"
		Set list.ISSAlbumina = rSet.%Get("Campo48532")	   
	    ;
	    Set result = xISSBeta2Microglobulina_xISSAlbumina
		Set eResult = "", checagem = 0
		If ($Data(^VALIDADOSMAPPA(0,"ISS",result))) {
			Set eResult = $Piece(^VALIDADOSMAPPA(0,"ISS",result,1),"~",1)
			If ($Piece(list.ResultadoISS," | ",1) [ "Impossível") {
				Set checagem = 2
			}Else{
				If ($Piece($Piece(^VALIDADOSMAPPA(0,"ISS",result,1),"~",1)," ",2) = $Piece($Piece(list.ResultadoISS," | ",1)," ",2)) { 
				   	Set checagem = 1
				}
			}
		}
		Set list.ISSResultado = eResult
		Set list.ISSResultadoImg = result
		Set list.ISSResultadoCheck = $Select(+checagem=2:$Piece(list.ResultadoISS," | ",1),+checagem=1:"OK",1:"Não OK")
		Set list.ISSResultadoCheckIcone = +checagem
		;
		;R-ISS
		Set xRISSBeta2Microglobulina = ""
		If (rSet.%Get("Campo48533")'="") Set xRISSBeta2Microglobulina = "IG35"
		If (rSet.%Get("Campo48533")'=""&&(+rSet.%Get("Campo48533")<3.5))  Set xRISSBeta2Microglobulina = "ME35"
		If (rSet.%Get("Campo48533")'=""&&(+rSet.%Get("Campo48533")>5.4))  Set xRISSBeta2Microglobulina = "MA54"
		Set list.RISSBeta2Microglobulina = rSet.%Get("Campo48533")	   
		;
		Set xRISSAlbumina = ""
		If (rSet.%Get("Campo48532")'="") Set xRISSAlbumina = "ME35"
		If (rSet.%Get("Campo48532")'=""&&(+rSet.%Get("Campo48532")>3.4))  Set xRISSAlbumina = "MA34"
		Set list.RISSAlbumina = rSet.%Get("Campo48532")	   
	    ;
		Set xRISSCAporiFISH = ""
		Set list.RISSCAporiFISH = ""	   
		If (rSet.%Get("Campo142")'=""&&(rSet.%Get("Campo149")'="")&&(rSet.%Get("Campo158")'="")) {
			Set list.RISSCAporiFISH = "Não"
			Set xRISSCAporiFISH = "SR"
		}
		If (rSet.%Get("Campo142")=1||(+rSet.%Get("Campo149")=1)||(+rSet.%Get("Campo158")=1)) {
			Set list.RISSCAporiFISH = "Sim"
			Set xRISSCAporiFISH = "HR"
		}
	    ;
		Set xRISSLDH = ""
		Set list.RISSLDH = ""	   
		If (rSet.%Get("Campo38534")'="") {
			Set list.RISSLDH = "Não"
			Set xRISSLDH = "NO"
		}
		If (rSet.%Get("Campo38534")="S") {
			Set list.RISSLDH = "Sim"
			Set xRISSLDH = "HI"
		}
	    Set result = xRISSBeta2Microglobulina_xRISSAlbumina_xRISSCAporiFISH_xRISSLDH
		Set eResult = "", checagem = 0
		If ($Data(^VALIDADOSMAPPA(0,"RISS",result))) {
			Set eResult = $Piece(^VALIDADOSMAPPA(0,"RISS",result,1),"~",1)
			If ($Piece(list.ResultadoRISS," | ",1) [ "Impossível") {
				Set checagem = 2
			}Else{
				If ($Piece($Piece(^VALIDADOSMAPPA(0,"RISS",result,1),"~",1)," ",2) = $Piece($Piece(list.ResultadoRISS," | ",1)," ",2)) { 
					Set checagem = 1
				}
			}
		}
		Set list.RISSResultado = eResult
		Set list.RISSResultadoImg = result
		Set list.RISSResultadoCheck = $Select(+checagem=2:$Piece(list.ResultadoRISS," | ",1),+checagem=1:"OK",1:"Não OK")
		Set list.RISSResultadoCheckIcone = +checagem
		;
		Do retorno.%Push(list)		
	}
	;
	Do retorno.%ToJSON()
	Return]]></Implementation>
</Method>

<Method name="GetArquivos">
<ClassMethod>1</ClassMethod>
<Implementation><![CDATA[	Set retorno = []
	Set grupo = ""
	For {
		Set grupo = $Order(^VALIDADOSMAPPA(0,grupo))
		Quit:grupo=""	
		Set condicao = ""
		For {
			Set condicao = $Order(^VALIDADOSMAPPA(0,grupo,condicao))
			Quit:condicao=""
			
			Set list = {}
			Set list.grupo = grupo
			Set list.condicao = condicao
			Set list.estagio = $Piece(^VALIDADOSMAPPA(0,grupo,condicao,1),"~",1)
			Set list.risco = $Piece(^VALIDADOSMAPPA(0,grupo,condicao,1),"~",2)
			Set list.cid = $Piece(^VALIDADOSMAPPA(0,grupo,condicao,1),"~",4)
			Do retorno.%Push(list)
				
		}	
	}	
	Do retorno.%ToJSON()
	Return $$$OK]]></Implementation>
</Method>

<Method name="GetMAPPA">
<ClassMethod>1</ClassMethod>
<FormalSpec>pSequencia="",pCIDImagem=""</FormalSpec>
<Implementation><![CDATA[	If (pSequencia = "") {
		Set pSequencia = $Get(%request.Data("pSequencia",1))
		Set pCIDImagem = $Get(%request.Data("pCIDImagem",1))
	}
	
	Set listRetorno = {}
	If (pCIDImagem = "C90_0") {
		Set objeto = $Get(^VARValidadorEstadiamentoC900(0, pSequencia, 1))
		Set listRetorno.paciente = "Combinação "_pSequencia
		Set listRetorno.dtNascimento = ""
		Set listRetorno.idade = ""
		Set listRetorno.Campo48532 = $$$VARValidadorEstadiamentoC900Campo48532(objeto)
		Set listRetorno.Campo48533 = $$$VARValidadorEstadiamentoC900Campo48533(objeto)
		Set listRetorno.Campo38571 = $$$VARValidadorEstadiamentoC900Campo38571(objeto)
		Set listRetorno.Campo142 = $$$VARValidadorEstadiamentoC900Campo142(objeto)
		Set listRetorno.Campo149 = $$$VARValidadorEstadiamentoC900Campo149(objeto)
		Set listRetorno.Campo158 = $$$VARValidadorEstadiamentoC900Campo158(objeto)
		Set listRetorno.Campo38494 = $$$VARValidadorEstadiamentoC900Campo38494(objeto)
		Set listRetorno.Campo38495 = $$$VARValidadorEstadiamentoC900Campo38495(objeto)
		Set listRetorno.Campo38497 = $$$VARValidadorEstadiamentoC900Campo38497(objeto)
		Set listRetorno.Campo38499 = $$$VARValidadorEstadiamentoC900Campo38499(objeto)
		Set listRetorno.Campo38500 = $$$VARValidadorEstadiamentoC900Campo38500(objeto)
		Set listRetorno.Campo38501 = $$$VARValidadorEstadiamentoC900Campo38501(objeto)
		Set listRetorno.Campo38502 = $$$VARValidadorEstadiamentoC900Campo38502(objeto)
		Set listRetorno.Campo38503 = $$$VARValidadorEstadiamentoC900Campo38503(objeto)
		Set listRetorno.Campo38504 = $$$VARValidadorEstadiamentoC900Campo38504(objeto)
		Do listRetorno.%Set("Campo38537-1", $Piece($$$VARValidadorEstadiamentoC900Campo38537(objeto),"/",1))
		Do listRetorno.%Set("Campo38537-2", $Piece($$$VARValidadorEstadiamentoC900Campo38537(objeto),"/",2))
		Do listRetorno.%Set("Campo38538-1", $Piece($$$VARValidadorEstadiamentoC900Campo38538(objeto),"/",1))
		Do listRetorno.%Set("Campo38538-2", $Piece($$$VARValidadorEstadiamentoC900Campo38538(objeto),"/",2))
		Set listRetorno.Campo38539 = $$$VARValidadorEstadiamentoC900Campo38539(objeto)
		Set listRetorno.Campo38505 = $$$VARValidadorEstadiamentoC900Campo38505(objeto)
		Set listRetorno.Campo38506 = $$$VARValidadorEstadiamentoC900Campo38506(objeto)
		Set listRetorno.Campo47278 = $$$VARValidadorEstadiamentoC900Campo47278(objeto)
		;
		Set opcao 	= $$$VARWorkFlowPEPOpcoes($Get(^VARWorkFlowPEP(0, "C90.0", 38507, 1)))
		Set xOpcao 	= ""
		Set xInfor	= $$$VARValidadorEstadiamentoC900Campo38507(objeto)
		For i = 1 : 1 : $Length(xInfor,"/") {
			If (+$Piece(xInfor,"/",i)=1) {
				Set xOpcao = xOpcao _$Select(xOpcao="":"",1:" | ")_ $Piece(opcao,"|",i)				
			}			
		}
		Set listRetorno.Campo38507 = xOpcao
		Set listRetorno.Campo38540 = $$$VARValidadorEstadiamentoC900Campo38540(objeto)
		Set listRetorno.Campo47281 = $$$VARValidadorEstadiamentoC900Campo47281(objeto)
		;
		Set opcao 	= $$$VARWorkFlowPEPOpcoes($Get(^VARWorkFlowPEP(0, "C90.0", 38541, 1)))
		Set xOpcao 	= ""
		Set xInfor	= $$$VARValidadorEstadiamentoC900Campo38541(objeto)
		For i = 1 : 1 : $Length(xInfor,"/") {
			If (+$Piece(xInfor,"/",i)=1) {
				Set xOpcao = xOpcao _$Select(xOpcao="":"",1:" | ")_ $Piece(opcao,"|",i)				
			}			
		}
		Set listRetorno.Campo38541 = xOpcao
		Set listRetorno.Campo38520 = $$$VARValidadorEstadiamentoC900Campo38520(objeto)
		Set listRetorno.Campo38536 = $$$VARValidadorEstadiamentoC900Campo38536(objeto)
		Set listRetorno.Campo38524 = $$$VARValidadorEstadiamentoC900Campo38524(objeto)
		Set listRetorno.Campo38535 = $$$VARValidadorEstadiamentoC900Campo38535(objeto)
		Set listRetorno.Campo38534 = $$$VARValidadorEstadiamentoC900Campo38534(objeto)
		Set listRetorno.Campo48182 = $$$VARValidadorEstadiamentoC900Campo48182(objeto)
		Set listRetorno.Campo48183 = $$$VARValidadorEstadiamentoC900Campo48183(objeto)
		Set listRetorno.Campo48185 = $$$VARValidadorEstadiamentoC900Campo48185(objeto)
		Set listRetorno.Campo48186 = $$$VARValidadorEstadiamentoC900Campo48186(objeto)
		Set listRetorno.resultadoDiagnostico = $$$VARValidadorEstadiamentoC900ResultadoDiagnostico(objeto)
		Set listRetorno.resultadoISS = $$$VARValidadorEstadiamentoC900ResultadoISS(objeto)
		Set listRetorno.resultadoRISS = $$$VARValidadorEstadiamentoC900ResultadoRISS(objeto)
		
	}Else{
		Set objeto = $Get(^VARValidadorEstadiamento(0, pSequencia, 1))
		Set listRetorno.paciente = "Combinação "_pSequencia
		Set listRetorno.dtNascimento = ""
		Set listRetorno.idade = ""
		Set listRetorno.Campo13 = $$$VARValidadorEstadiamentoCampo13(objeto)
		Set listRetorno.Campo32 = $$$VARValidadorEstadiamentoCampo32(objeto)
		Set listRetorno.Campo101 = $$$VARValidadorEstadiamentoCampo101(objeto)
		Set listRetorno.Campo102 = $$$VARValidadorEstadiamentoCampo102(objeto)
		Set listRetorno.Campo455 = $$$VARValidadorEstadiamentoCampo455(objeto)
		Set listRetorno.Campo155 = $$$VARValidadorEstadiamentoCampo155(objeto)
		Set listRetorno.Campo1941 = $$$VARValidadorEstadiamentoCampo1941(objeto)
		Set listRetorno.Campo1926 = $$$VARValidadorEstadiamentoCampo1926(objeto)
		Set listRetorno.Campo141 = $$$VARValidadorEstadiamentoCampo141(objeto)
		Set listRetorno.Campo142 = $$$VARValidadorEstadiamentoCampo142(objeto)
		Set listRetorno.Campo1351 = $$$VARValidadorEstadiamentoCampo1351(objeto)
		Set listRetorno.Campo1350 = $$$VARValidadorEstadiamentoCampo1350(objeto)
		Set listRetorno.Campo285 = $$$VARValidadorEstadiamentoCampo285(objeto)
		Set listRetorno.Campo245 = $$$VARValidadorEstadiamentoCampo245(objeto)
		Set listRetorno.Campo275 = $$$VARValidadorEstadiamentoCampo275(objeto)
		Set listRetorno.Campo243 = $$$VARValidadorEstadiamentoCampo243(objeto)
		Set listRetorno.Campo255 = $$$VARValidadorEstadiamentoCampo255(objeto)
		Set listRetorno.Campo265 = $$$VARValidadorEstadiamentoCampo265(objeto)
		Set listRetorno.Campo244 = $$$VARValidadorEstadiamentoCampo244(objeto)
		Set listRetorno.Campo270 = $$$VARValidadorEstadiamentoCampo270(objeto)
		Set listRetorno.Campo69 = "N"
		If (listRetorno.Campo285 = "S" || (listRetorno.Campo245 = "S") || (listRetorno.Campo275 = "S") ||
		   (listRetorno.Campo243 = "S") || (listRetorno.Campo255 = "S") || (listRetorno.Campo265 = "S")  || 
		   (listRetorno.Campo244 = "S") || (listRetorno.Campo270 = "S")) {
			Set listRetorno.Campo69 = "S"
		}
		Set listRetorno.resultadoRAI = $$$VARValidadorEstadiamentoResultadoRAI(objeto)
		Set listRetorno.resultadoBINET = $$$VARValidadorEstadiamentoResultadoBINET(objeto)
		Set listRetorno.resultadoCLLIPI = $$$VARValidadorEstadiamentoResultadoCLL(objeto)
	}
	Do listRetorno.%ToJSON()
	Return $$$OK]]></Implementation>
</Method>

<Method name="PrapararMAPPA">
<ClassMethod>1</ClassMethod>
<Implementation><![CDATA[	$$$VAR
	Set pSequencia = $Get(%request.Data("pSequencia",1))

	Do PrepararUnico^VARValidadorEstadiamento(pSequencia)]]></Implementation>
</Method>
</Class>
</Export>