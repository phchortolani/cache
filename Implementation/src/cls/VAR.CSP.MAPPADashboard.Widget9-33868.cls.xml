<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="22" zv="Cache" ts="2001-01-01 00:00:00">
<Class name="VAR.CSP.MAPPADashboard.Widget9">
<ClassType/>
<IncludeCode>VARConst,WWWConst,INConst</IncludeCode>
<ProcedureBlock>0</ProcedureBlock>
<Super>%CSP.Page</Super>

<Method name="OnPage">
<ClassMethod>1</ClassMethod>
<ReturnType>%Status</ReturnType>
<Implementation><![CDATA[	$$$VAR
	Set job = %session.SessionId 
	Quit:$$$ISERR(..validaSessao()) $$$OK
	Set method = $Get(%request.Data("method",1))
	Xecute "do .."_method_"()"
	Quit $$$OK]]></Implementation>
</Method>

<Method name="validaSessao">
<ClassMethod>1</ClassMethod>
<Implementation><![CDATA[	Set status = $$VerifySession^VARCSPUtils(YBED, YUSER)
	If status=0||(YBED="UNKNOWN"){
		Set status=0
		Set resp={}
		Set resp.erro=1
		Set resp.mensagem="SessÃ£o Expirou"
		Write resp.%ToJSON()
	}
	Quit status]]></Implementation>
</Method>

<Method name="getDados">
<ClassMethod>1</ClassMethod>
<Implementation><![CDATA[	;
	$$$VAR
	Set YM 	= 0
	Set Y 	= "~"
	;
	Set codCID 			= $Get(%request.Data("codCID",1))
	Set codPaciente = $Get(%request.Data("codPaciente",1))
	;
	Set ficha = $Order(^VARPEPPremiumConsulta(YM, codPaciente, ""),-1)
	If (ficha = "") {
		Write "&nbsp;"
		Return $$$OK
	}
	Write ##Class(VAR.CSP.MAPPA).getResumoPaciente(codPaciente,codCID,ficha)_"&nbsp;"
	;
	Return $$$OK]]></Implementation>
</Method>
</Class>
</Export>