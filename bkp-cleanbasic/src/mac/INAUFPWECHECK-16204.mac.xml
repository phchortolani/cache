<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="22" zv="CACHE" ts="2001-01-01 00:00:00">
<Routine name="INAUFPWECHECK" type="MAC" languagemode="0" timestamp="58440,0"><![CDATA[
INAUFPWECHECK   ;INAUFPWECKECK;WEM;PRÜFEN, OB WARENEINGANG ERFASST WERDEN DARF;16.12.2003
	;
	;/------------------------------------------------------------------\
	;| Description of Function :
	;|		PRÜFEN, OB WARENEINGANG ERFASST WERDEN DARF
	;|
	;| Inputs : 
	;|
	;|
	;| ByRef :
	;|
	;|
	;| Returns :
	;|
	;|
	;| History :
	;|
	;| WEM	16.12.2003
	;|
	;\------------------------------------------------------------------/
	; DO ^INAUFPWECHECK
	NEW AUF,POS
	
	SET AUF = $GET(AUFTRAG)
	SET POS = $GET(POSITION)
	QUIT:AUF=""
	QUIT:POS=""
	
	IF $PIECE($GET(^INAUFP(YM,AUF,POS,1)),Y,7)=1 DO   ; WARENHERKUNFT = BESTELLUNG ;sales order 
	. ; FIXME : DISABLED BLOCK
	. ;IF $PIECE($GET(^INAUFP(YM,AUF,POS,1)),Y,83)="" DO  ; BESTELLUNG NOCH NICHT GEDRUCKT  ;AUSGESCHALTETE;TYBD;7,10,2004;WEIL AUCH TELEFONISCH BESTELLT WERDEN KANN;DANN PROBLEM
	. . DO ^WWWINFO($$^WWWTEXT(185,,1)_"! "_$$^WWWTEXT(33697,,1))   ; ACHTUNG! ES WURDE NOCH KEINE BESTELLUNG GEDRUCKT. ;it were yet no sales order 
	. ;
	. DO  ;IF $PIECE($GET(^INAUFP(YM,AUF,POS,1)),Y,83)'="" DO  ; BESTELLUNG SCHON GEDRUCKT
	. . IF YFORM="INAUFP" DO   ; AUFRUF AUS AUFTRAGSPOSITION ;out of 
	. . . SET YFORM = "INWEAUF"
	. . . SET %("VAR","YKEY")  = AUF_","_POS
	. . . SET %("VAR","YBACK") = "INAUFBANZ,INAUF,INAUFP,"
	. . . SET %("VAR","YFORM") = "INWEAUF"
	. . . DO ^WWWFORM
	
	IF $PIECE($GET(^INAUFP(YM,AUF,POS,1)),Y,7)'=1 DO   ; WARENHERKUNFT NICHT GLEICH BESTELLUNG ;Not without delay sales order 
	. SET YFORM = "INWEAUF"
	. SET %("VAR","YKEY")  = AUF_","_POS
	. SET %("VAR","YBACK") = "INAUFBANZ,INAUF,INAUFP,"
	. SET %("VAR","YFORM") = "INWEAUF"
	. DO ^WWWFORM
	
	QUIT
	
INAUFBANZ(AUFTRAG,POSITION)  ; AUFRUF DURCH INAUFBANZ1 ;trans- 
	NEW AUF,POS,RET
	
	SET AUF =$GET(AUFTRAG)
	SET POS =$GET(POSITION)
	IF (AUF="") || (POS="") QUIT RET
	
	SET RET=1
	IF $PIECE($GET(^INAUFP(YM,AUF,POS,1)),Y,7)'=1 QUIT RET  ; WARENHERKUNFT IST NICHT BESTELLUNG ;Not sales order 
	IF $PIECE($GET(^INAUFP(YM,AUF,POS,1)),Y,83)="" SET RET=0   ; KEINE ERFASSUNG DES WEs MÖGLICH ;no logging potential 
	IF $PIECE($GET(^INAUFP(YM,AUF,POS,1)),Y,83)'="" SET RET=1	 ; WE ERFASSUNG MÖGLICH, DA BESTELLUNG GEDRUCKT BZW. WH IST KEINE BESTELLUNG
	IF $DATA(^INWEAUF(YM,AUF,POS)) SET RET=1  ;SCHON VORHANDEN;TYBD;7,10,2004
	QUIT RET
]]></Routine>
</Export>