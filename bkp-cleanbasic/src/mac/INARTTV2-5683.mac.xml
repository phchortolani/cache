<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="22" zv="CACHE" ts="2001-01-01 00:00:00">
<Routine name="INARTTV2" type="MAC" languagemode="0" timestamp="58440,0"><![CDATA[
INARTTV2
#include COMSYS
	;-------------------------------------------------------------------------------
	; Description of Function :
	;		ANZEIGE ARTIKEL AUSWAHL FÜR TEILE/ SPEICHERN NEUE TEILE/EDIT TEILE
	;
	;	ANZEIGE DER ARTIKEL ZUR AUSWAHL ;Show the item Selection 
	;	DIE AUSWAHL DES ARTIKELS ERFOLGT, WENN EINE MENGE EINGETRAGEN WIRD
	;	WENN EINE MENGE AUSGEWÄHLT WURDE SPEICHERN DER ARTIKEL IN EINER TEILEPOSITION
	;	 ;when one quantum select were Save the item within unit 
	;
	; Inputs : 
	;
	;
	; ByRef :
	;
	;
	; Returns :
	;
	;
	; History :
	; 05-Feb-2008	GRF		SR15627: Use $$$Save; quits
	; 21-Sep-2006	FAN		SR14746: Sales statistics incorrect
	; 08.02.2000	DT		Created
	;-------------------------------------------------------------------------------
	NEW MULTIPLE,YDATUM,YARTIKEL,NAME,ART,ANZM,SUCH,ART1,YVOR,YFKEY,AUF,AUFMG,YMNG
	new YTEIL,YTEIL1,Q,YTEILP,ARTIKEL,MENGE,YSTD,YARTIKEL1
	
	SET %("VAR","YKEY")=YKEY
	SET YARTIKEL=$PIECE(YKEY,",",1)
	SET YDATUM=$PIECE(YKEY,",",2)
	IF YDATUM="" DO  QUIT
	. SET YKEY=YARTIKEL_","_YDATUM
	. DO ^INARTTV  ;TABELLE DER TEILE ANZEIGEN ;tabulation the display 
	. DO VERSIONEN
	
	QUIT:YDATUM=""
	QUIT:YARTIKEL=""  ;KEIN ARTIKEL ;no item 
	
	NEW YKEY
	SET YARTIKEL1=$GET(^INART(YM,YARTIKEL,1))
	IF $PIECE(YARTIKEL1,Y,26)=6 DO  QUIT   ;KEINE TEILE ;no 
	. WRITE "<A onClick='return doLink(this)' HREF=""JavaScript:window.history.back();"_""""_">"_$$^WWWTEXT(99)_"</A>"
	. WRITE YCR,"<BR><BR>"_$PIECE($GET(^WWW101(0,"ARTIKEL-ART",SPRACHE,$PIECE(YARTIKEL1,Y,26),1)),Y,1)_" "_$$^WWWTEXT(32112,,1)  ;ARTIKELART NICHT MÖGLICH ;Not potential 
	. WRITE YCR,"<BR>"
	
	;IF $PIECE(YARTIKEL1,Y,40)=2!($PIECE(YARTIKEL1,Y,40)=3)!($PIECE(YARTIKEL1,Y,40)=4)!($PIECE(YARTIKEL1,Y,40)=5)!($PIECE(YARTIKEL1,Y,40)=10)!($PIECE(YARTIKEL1,Y,40)=11) DO  QUIT   ;KEINE TEILE
	;IF $PIECE(YARTIKEL1,Y,40)=3!($PIECE(YARTIKEL1,Y,40)=4)!($PIECE(YARTIKEL1,Y,40)=5)!($PIECE(YARTIKEL1,Y,40)=10)!($PIECE(YARTIKEL1,Y,40)=11) DO  QUIT   ;KEINE TEILE
	;. W "<A HREF="_""""_"JavaScript:window.history.back();"_""""_">"_$$^WWWTEXT(99)_"</A>"
	;. WRITE YCR,"<BR><BR>"_$PIECE($GET(^WWW101(0,"EINHEIT",SPRACHE,$PIECE(YARTIKEL1,Y,40),1)),Y,1)_" "_$$^WWWTEXT(32119,,1)  ;ARTIKELART NICHT MÖGLICH
	;. WRITE YCR,"<BR>"
	;
	;KILL ^INARTTV1(YM)  ;LOSCHEN MÖGLICHER WERTE
	KILL ^WWWDATEN(YM,+$HOROLOG,YUSER,YFORM,"LOCK",1)
	DO NEU
	DO SUCH
	SET YKEY=YARTIKEL_","_YDATUM
	DO ^INARTTV  ;TABELLE DER TEILE ANZEIGEN ;tabulation the display 
	DO   ;ANZEIGE DER BYPRODUCTS ;Show the 
	. QUIT:'$DATA(^INARTNEBEN(YM,YARTIKEL))  ;KEIN BYPRODUKT ;no 
	. NEW ART
	. SET ART=""
	. FOR  SET ART=$ORDER(^INARTNEBEN(YM,YARTIKEL,ART)) QUIT:ART=""  DO
	. . WRITE "<FONT SIZE=2>"
	. . WRITE "By Product: " ;$$^WWWTEXT()   ;BYPRODUCT
	. . WRITE $PIECE($GET(^INARTNEBEN(YM,YARTIKEL,ART,1)),Y,1)_" "
	. . DO
	. . . IF $PIECE($GET(^INART(YM,ART,1)),Y,40)'="" DO
	. . . . WRITE $PIECE($get(^WWW101(0,"EINHEIT",SPRACHE,$PIECE($GET(^INART(YM,ART,1)),Y,40),1)),Y,1)
	. . . . WRITE " "
	. . ;
	. . WRITE " ("_ART_") "_$PIECE($GET(^INART(YM,ART,1)),Y,1)_" "
	. . WRITE " per "
	. . WRITE $PIECE($GET(^INARTNEBEN(YM,YARTIKEL,ART,1)),Y,2)_" "
	. . DO
	. . . IF $PIECE($GET(^INART(YM,YARTIKEL,1)),Y,40)'="" DO
	. . . . WRITE $PIECE($get(^WWW101(0,"EINHEIT",SPRACHE,$PIECE($GET(^INART(YM,YARTIKEL,1)),Y,40),1)),Y,1)
	. . . . WRITE " "
	. . ;
	. . WRITE "<BR>"
	. . WRITE YCR
	. ;
	. WRITE YCR
	
	QUIT
	
NEU ;NEUE POSITION  
	;ARTIKELAUSWAHL / ANLEGEN DER POSITIONEN ;put onto the 
	IF $GET(%(YQUERY,"ITEMS"))'="" DO  ;SONDERFELDER AUS WWW2 ;out of 
	. SET %(YQUERY,"YMNG"_$GET(%(YQUERY,"ITEMS")))=$GET(%(YQUERY,"ITEMSQ"))
	. SET %(YQUERY,"YMUL"_$GET(%(YQUERY,"ITEMS")))=$GET(%(YQUERY,"ITEMMULN"))
	. SET %(YQUERY,"YBEN"_$GET(%(YQUERY,"ITEMS")))=$GET(%(YQUERY,"ITEMBENN"))
	. SET %(YQUERY,"YBRT"_$GET(%(YQUERY,"ITEMS")))=$GET(%(YQUERY,"ITEMBRTN"))
	. SET %(YQUERY,"YLNG"_$GET(%(YQUERY,"ITEMS")))=$GET(%(YQUERY,"ITEMLNGN"))
	. SET %(YQUERY,"YHOE"_$GET(%(YQUERY,"ITEMS")))=$GET(%(YQUERY,"ITEMHOEN"))
	
	
	SET YMNG="YMNG" FOR  SET YMNG=$ORDER(%(YQUERY,YMNG)) QUIT:$EXTRACT(YMNG,1,4)'="YMNG"  DO    ;ALLE MENGENFELDER LESEN ;read 
	. NEW YFORM,YEINHEIT,YTEILP
	. SET YFORM="INARTTV"  ;POSITIONEN
	. QUIT:$GET(%(YQUERY,YMNG))=""   ;KEINE MENGE EINGETRAGEN ;no quantum regd. 
	. ;
	. SET YTEIL=$ORDER(^INARTTV(YM,YARTIKEL,YDATUM,""),-1)+1   ;NÄCHSTE POSITIONSNUMMER  ;next 
	. ;
	. ;
	. SET ART=$EXTRACT(YMNG,5,99)  ;ARTIKELNUMMER BESTANDTEIL DER YMNG VARIABEL ;ingredient the 
	. ;PRUEFEN FALSCHE POSITION (DOPPEL SAVE)
	. SET YTEILP=$ORDER(^INARTTV(YM,YARTIKEL,YDATUM,YTEIL),-1)
	. SET Q=0
	. IF YTEILP'="" DO
	. . NEW TIME,YTEILPP
	. . SET TIME=$PIECE($GET(^INARTTV(YM,YARTIKEL,YDATUM,YTEILP,1)),Y,22)  ;ERFASSUNGSDATUM
	. . SET YTEILPP=$PIECE($GET(^INARTTV(YM,YARTIKEL,YDATUM,YTEILP,1)),Y,1)  ;ARTIKEL ;item 
	. . IF YTEILPP'=ART QUIT  ;NICHT GLEICHER ARTIKEL ;Not same item 
	. . IF +TIME=+$HOROLOG DO
	. . . IF ($PIECE(TIME,",",2)+5)>$PIECE($HOROLOG,",",2) SET Q=1  ;DOPPELSAVE FALSCH ;wrong 
	. ;
	. QUIT:Q=1
	. ;ZUSAMMENSTELLEN NEUES TEIL ;something new whack 
	. SET MENGE=$TRANSLATE($GET(%(YQUERY,YMNG)),",",".")
	. QUIT:+MENGE=0
	. QUIT:ART=""
	. QUIT:'$DATA(^INART(YM,ART,1))  ;ARTIKEL NICHT VORHANDEN ;item Not on hand 
	. SET YARTIKEL1=$GET(^INART(YM,ART,1))  ;ARTIKELDATEN
	. ;
	. ;
	. SET YTEIL1=""   ;ZUSAMMENSTELLEN DATENTEIL1
	. SET $PIECE(YTEIL1,Y,4)=+MENGE
	. SET $PIECE(YTEIL1,Y,1)=ART  ;NEUE TEILEARTIKELNUMMER
	. SET $PIECE(YTEIL1,Y,3)=$PIECE(YARTIKEL1,Y,1)  ;BESCHREIBUNG ;description 
	. SET $PIECE(YTEIL1,Y,5)=+$PIECE(YARTIKEL1,Y,40)  ;EINHEIT ;unity 
	. IF +$PIECE(YTEIL1,Y,5)=0 SET $PIECE(YTEIL1,Y,5)=1
	. SET YEINHEIT=$PIECE(YTEIL1,Y,5)
	. IF YEINHEIT'=11 IF YEINHEIT'=2 IF YEINHEIT'=10 SET $PIECE(YTEIL1,Y,7)=($$^INARTDAUER(ART)*MENGE)  ;RUEST +(MENGE * DAUER)
	. SET $PIECE(YTEIL1,Y,15)=+$TRANSLATE($GET(%(YQUERY,"YLNG"_ART)),",",".")  ;LÄNGE ;longitude 
	. SET $PIECE(YTEIL1,Y,16)=+$TRANSLATE($GET(%(YQUERY,"YBRT"_ART)),",",".")  ;BREITE ;width 
	. SET $PIECE(YTEIL1,Y,17)=+$TRANSLATE($GET(%(YQUERY,"YHOE"_ART)),",",".")  ;HOEHE
	. SET $PIECE(YTEIL1,Y,30)=$GET(%(YQUERY,"YBEN"_ART))  ;BENENNUNG
	. SET MULTIPLE=+$GET(%(YQUERY,"YMUL"_ART))  ;ANZAHL DER TEILE ;Number the 
	. SET $PIECE(YTEIL1,Y,6)=$$^INGEWICHTT(ART,MENGE,$PIECE(YTEIL1,Y,15),$PIECE(YTEIL1,Y,16),$PIECE(YTEIL1,Y,17))  ;MENGE*GEWICHT
	. SET $PIECE(YTEIL1,Y,251)=$PIECE(YARTIKEL1,Y,251)  ;MASCHINENSTUNDENSATZ KOPIEREN ;machine hour rate 
	. SET $PIECE(YTEIL1,Y,252)=$PIECE(YARTIKEL1,Y,252)  ;BEDIENERSTUNDENSATZ KOPIEREN
	. ;
	. ;ZEICHNUNGSNUMMER WENN KEINE DAUER ;when no permanence 
	. SET YTEILP=YTEIL
	. IF YTEILP'="" DO
	. . NEW YTEILP1,YBIG
	. . ;QUIT:$ORDER(^INARTTV(YM,YARTIKEL,YDATUM,""),-1)=""
	. . SET YBIG=""
	. . SET YTEILP1=""
	. . FOR  SET YTEILP1=$ORDER(^INARTTV(YM,YARTIKEL,YDATUM,YTEILP1),-1) QUIT:YTEILP1=""  DO 
	. . . IF $PIECE($GET(^INARTTV(YM,YARTIKEL,YDATUM,YTEILP1,1)),Y,18)>YBIG SET YBIG=$PIECE($GET(^INARTTV(YM,YARTIKEL,YDATUM,YTEILP1,1)),Y,18)
	. . ;
	. . SET YTEILP=YBIG+1
	. ;
	. IF YEINHEIT=2!(YEINHEIT=10)!(YEINHEIT=11) SET YTEILP=""
	. SET $PIECE(YTEIL1,Y,18)=YTEILP
	. ;
	. IF YEINHEIT=2 DO  ;STUNDEN = DAUER ;procrastinate permanence 
	. . NEW YSTD
	. . SET YSTD=$GET(%(YQUERY,YMNG))
	. . SET $PIECE(YTEIL1,Y,4)=""  ;LÖSCHEN MENGE ;Delete quantum 
	. . IF $FIND(YSTD,":") SET $PIECE(YTEIL1,Y,7)=($PIECE(YSTD,":",1)*60*60)+($PIECE(YSTD,":",2)*60)+$PIECE(YSTD,":",3) SET YSTD=""  ;STUNDEN MINUTEN SEKUNDEN ;procrastinate 
	. . IF $FIND(YSTD,",") SET $PIECE(YTEIL1,Y,7)=($PIECE(YSTD,",",1)*60*60)+(60*60*("."_$PIECE(YSTD,",",2))) SET YSTD=""  ;STUNDEN MIT KOMMA ;procrastinate by means of comma 
	. . IF $FIND(YSTD,".") SET $PIECE(YTEIL1,Y,7)=($PIECE(YSTD,".",1)*60*60)+(60*60*("."_$PIECE(YSTD,".",2))) SET YSTD=""  ;STUNDEN MIT PUNKT ;procrastinate by means of point 
	. . IF +YSTD'=0 SET $PIECE(YTEIL1,Y,7)=(YSTD*60*60)  ;VOLLE STUNDEN  ;procrastinate 
	. ;
	. IF YEINHEIT=10 DO  ;MINUTEN = DAUER ;permanence 
	. . NEW YSTD
	. . SET YSTD=$GET(%(YQUERY,YMNG))
	. . SET $PIECE(YTEIL1,Y,4)=""  ;LÖSCHEN MENGE ;Delete quantum 
	. . IF $FIND(YSTD,":") SET $PIECE(YTEIL1,Y,7)=($PIECE(YSTD,":",1)*60*60)+($PIECE(YSTD,":",2)*60)+$PIECE(YSTD,":",3) SET YSTD="" ;STUNDEN MINUTEN SEKUNDEN ;procrastinate 
	. . IF $FIND(YSTD,",") SET $PIECE(YTEIL1,Y,7)=($PIECE(YSTD,",",1)*60)+(60*("."_$PIECE(YSTD,",",2))) SET YSTD=""  ;MINUTEN MIT KOMMA ;by means of comma 
	. . IF $FIND(YSTD,".") SET $PIECE(YTEIL1,Y,7)=($PIECE(YSTD,".",1)*60)+(60*("."_$PIECE(YSTD,".",2))) SET YSTD=""  ;MINUTEN MIT PUNKT ;by means of point 
	. . IF +YSTD'=0 SET $PIECE(YTEIL1,Y,7)=(YSTD*60)  ;VOLLE MINUTEN 
	. ;
	. IF YEINHEIT=11 DO  ;INDUSTRIE MINUTEN = DAUER ;industry permanence 
	. . NEW YSTD
	. . SET YSTD=$GET(%(YQUERY,YMNG))
	. . SET $PIECE(YTEIL1,Y,4)=""  ;LÖSCHEN MENGE ;Delete quantum 
	. . IF +YSTD'=0 SET $PIECE(YTEIL1,Y,7)=(YSTD*60/100*60)  ;VOLLE INDUSTIEMINUTEN 
	. ;
	. ;SAVE DAUER OHNE RUEST   FÜR NACHRECHNUNGEN ;permanence without to 
	. IF +$PIECE(YTEIL1,Y,7)'=0 SET $PIECE(YTEIL1,Y,9)=$PIECE(YTEIL1,Y,7)   ;-$$^INARTRUEST(ART)
	. SET $PIECE(YTEIL1,Y,70)=$$^INARTRUEST(ART)*$$^INPROLOS(ART,MENGE)
	. ;
	. IF $DATA(^INARTTV(YM,ART,YDATUM)) SET $PIECE(YTEIL1,Y,7)=$$^INARTDAUERT(ART,$PIECE(YTEIL1,Y,4))   ;ERRECHNEN DAUER AUS TEILEN * MENGE ;permanence out of quantum 
	. IF $DATA(^INARTTV(YM,ART,YDATUM)) SET $PIECE(YTEIL1,Y,6)=$$^INGEWICHTT(ART,$PIECE(YTEIL1,Y,4),$PIECE(YTEIL1,Y,15),$PIECE(YTEIL1,Y,16),$PIECE(YTEIL1,Y,17))  ;GEWICHT AUS TEILEN * MENGE ;wt. out of quantum 
	. IF +$PIECE(YTEIL1,Y,6)=0 SET $PIECE(YTEIL1,Y,6)=""  ;GEWICHT ;wt. 
	. SET $PIECE(YTEIL1,Y,8)=$$^INARTKOSTT(ART,$PIECE(YTEIL1,Y,4),$PIECE(YTEIL1,Y,7),$PIECE(YTEIL,Y,6))  ;PREISERRECHNEN INKL VERSCHNITT
	. ;
	. IF $PIECE(YTEIL1,Y,5)'=2 IF $PIECE(YTEIL1,Y,5)'=11 IF $PIECE(YTEIL1,Y,5)'=10 SET $PIECE(YTEIL1,Y,7)="",$PIECE(YTEIL1,Y,9)=""  ;DAUER LÖSCHEN WENN KEINE ZEIT ;permanence Delete when no time 
	. IF +$PIECE(YTEIL1,Y,6)=0 SET $PIECE(YTEIL1,Y,6)=""  ;GEWICHT=""
	. SET $PIECE(YTEIL1,Y,22)=$HOROLOG   ;ERFASST
	. SET $PIECE(YTEIL1,Y,23)=YBED   ;ERFASST
	. IF +$PIECE(YTEIL1,Y,5)=0 SET $PIECE(YTEIL1,Y,5)=1
	. ;
	. DO
	. . NEW YVORG,YVORG1,YFORM 
	. . SET YFORM="INARTTV"
	. . SET YOK=$$^WWWSPEI("INARTTV",YARTIKEL_","_YDATUM_","_YTEIL,YTEIL1,1)   ;SPEICHERN ARTIKELTEIL ;Save 
	. . IF $GET(MULTIPLE)>1 SET:MULTIPLE>300 MULTIPLE=300 FOR YMULTI=2:1:MULTIPLE DO  ;ANLAGE VON MEHREREN MENGEN ;layout shuffle 
	. . . SET YTEIL=$ORDER(^INARTTV(YM,YARTIKEL,""),-1)+1   ;NÄCHSTE POSITIONSNUMMER ;next 
	. . . SET YOK=$$^WWWSPEI("INARTTV",YARTIKEL_","_YDATUM_","_YTEIL,YTEIL1,1)   ;SPEICHERN ARTIKELTEIL  ;Save 
	. ;
	. ;SPEICHERN ÄNDERUNGSMITARBEITER ;Save 
	. ;SET $PIECE(^INART(YM,YARTIKEL,1),Y,24)=$H    ; SR15627 vvv
	. ;SET $PIECE(^INART(YM,YARTIKEL,1),Y,25)=YBED
	. set YOK = $$MasterfileChanged^INARTMaster(YARTIKEL,YBED)
	. ;
	. QUIT:+$GET(YOPTION)=1  ;KEIN NEUAUBAU DER DATEN ;no the 
	. ;DO ^INARTNEU(YARTIKEL)  ;NEUAUFBAU DER TEILE
	. ;SET $PIECE(^INART(YM,YARTIKEL,1),Y,47)=$$^INARTKOST(YARTIKEL,1)  ;NEUER SELBSTKOSTENPREIS
	. ;DO ^INARTXL(YARTIKEL)  ;NEUAUFBAU DER TEILESTRUKTUR
	. ;SET ARTIKEL="" FOR  SET ARTIKEL=$ORDER(^INARTTVs(YM,1,$$^WWWUMLAU(YARTIKEL,1),ARTIKEL)) QUIT:ARTIKEL=""  DO ^INARTXL(ARTIKEL)
	
	QUIT
	
EDIT ;EDITIEREN BESTEHENDER DATENSATZ   AUFRUF AUS FORMAULARSTPEICHERUNG  ;data record out of 
	;MENGENÄNDERUNG DER POSITIONEN ;the 
	;QUIT
	SET YARTIKEL = $PIECE(YKEY,",",1)
	SET YDATUM   = $PIECE(YKEY,",",2)
	SET YTEIL    = $PIECE(YKEY,",",3)
	QUIT:YARTIKEL=""
	QUIT:YDATUM=""
	QUIT:YTEIL=""
	QUIT:$GET(YFELD)=""  ;KEIN DATENSATZ VORHANDEN ;no data record on hand 
	
	DO
	. NEW YFORM
	. SET YFORM="INARTTV"  ;POSITIONEN
	. SET YTEIL1=YFELD   ;ZUSAMMENSTELLEN DATEN TEIL1
	. SET YEINHEIT=$PIECE(YTEIL1,Y,5)
	. SET MENGE=$PIECE(YFELD,Y,4)
	. IF YEINHEIT'=10 QUIT:+MENGE=0  ;0 MENGE SOLL GEHEN ;quantum walk 
	. IF YEINHEIT=10 QUIT:MENGE=""  ;0 MENGE SOLL GEHEN ;quantum walk 
	. SET ART=$PIECE(YFELD,Y,1)
	. QUIT:ART=""
	. QUIT:'$DATA(^INART(YM,ART,1))  ;ARTIKEL NICHT VORHANDEN ;item Not on hand 
	. SET YARTIKEL1=$GET(^INART(YM,ART,1))  ;ARTIKELDATEN
	. ;
	. ;
	. SET $PIECE(YTEIL1,Y,3)=$PIECE(YARTIKEL1,Y,1)  ;BESCHREIBUNG AKTUELL ;description up-to-date 
	. SET $PIECE(YTEIL1,Y,5)=+$PIECE(YARTIKEL1,Y,40)  ;EINHEIT AKTUELL ;unity up-to-date 
	. IF YEINHEIT'=11 IF YEINHEIT'=2 IF YEINHEIT'=10 SET $PIECE(YTEIL1,Y,7)=$$^INARTRUEST(ART)+($$^INARTDAUER(ART)*MENGE)   ;RUEST+(MENGE * DAUER)
	. SET $PIECE(YTEIL1,Y,6)=$$^INGEWICHT(ART)*MENGE  ;MENGE*GEWICHT
	. ;
	. IF YEINHEIT=2 DO  ;STUNDEN = DAUER ;procrastinate permanence 
	. . NEW YSTD
	. . SET YSTD=MENGE
	. . SET $PIECE(YTEIL1,Y,4)=""  ;LÖSCHEN MENGE ;Delete quantum 
	. . IF $FIND(YSTD,":") SET $PIECE(YTEIL1,Y,7)=+($PIECE(YSTD,":",1)*60*60)+($PIECE(YSTD,":",2)*60)+$PIECE(YSTD,":",3) SET YSTD="" ;STUNDEN MINUTEN SEKUNDEN ;procrastinate 
	. . IF $FIND(YSTD,",") SET $PIECE(YTEIL1,Y,7)=+($PIECE(YSTD,",",1)*60*60)+(60*60*("."_$PIECE(YSTD,",",2))) SET YSTD=""  ;STUNDEN MIT KOMMA ;procrastinate by means of comma 
	. . IF $FIND(YSTD,".") SET $PIECE(YTEIL1,Y,7)=+($PIECE(YSTD,".",1)*60*60)+(60*60*("."_$PIECE(YSTD,".",2))) SET YSTD=""  ;STUNDEN MIT PUNKT ;procrastinate by means of point 
	. . IF +YSTD'=0        SET $PIECE(YTEIL1,Y,7)=+(YSTD*60*60)  ;VOLLE STUNDEN  ;procrastinate 
	. ;
	. IF YEINHEIT=10 DO  ;MINUTEN = DAUER ;permanence 
	. . NEW YSTD
	. . SET YSTD=MENGE
	. . SET $PIECE(YTEIL1,Y,4)=""  ;LÖSCHEN MENGE ;Delete quantum 
	. . IF $FIND(YSTD,":") SET $PIECE(YTEIL1,Y,7)=+($PIECE(YSTD,":",1)*60*60)+($PIECE(YSTD,":",2)*60)+$PIECE(YSTD,":",3) SET YSTD="" ;STUNDEN MINUTEN SEKUNDEN ;procrastinate 
	. . IF $FIND(YSTD,",") SET $PIECE(YTEIL1,Y,7)=+($PIECE(YSTD,",",1)*60)+(60*("."_$PIECE(YSTD,",",2))) SET YSTD=""  ;MINUTEN MIT KOMMA ;by means of comma 
	. . IF $FIND(YSTD,".") SET $PIECE(YTEIL1,Y,7)=+($PIECE(YSTD,".",1)*60)+(60*("."_$PIECE(YSTD,".",2))) SET YSTD=""  ;MINUTEN MIT PUNKT ;by means of point 
	. . IF +YSTD'=0 SET $PIECE(YTEIL1,Y,7)=+(YSTD*60)  ;VOLLE MINUTEN 
	. . IF MENGE=0  SET $PIECE(YTEIL1,Y,7)=0,$PIECE(YTEIL1,Y,9)=0   ;0 MENGE ;quantum 
	. ;
	. IF YEINHEIT=11 DO  ;INDUSTRIE MINUTEN = DAUER ;industry permanence 
	. . NEW YSTD
	. . SET YSTD=MENGE
	. . SET $PIECE(YTEIL1,Y,4)=""  ;LÖSCHEN MENGE ;Delete quantum 
	. . IF +YSTD'=0 SET $PIECE(YTEIL1,Y,7)=+(YSTD*60/100*60)  ;VOLLE INDUSTIEMINUTEN 
	. ;
	. ;SAVE DAUER OHNE RUEST   FÜR NACHRECHNUNGEN ;permanence without to 
	. IF +$PIECE(YTEIL1,Y,7)'=0 SET $PIECE(YTEIL1,Y,9)=$PIECE(YTEIL1,Y,7)   ;-$$^INARTRUEST(ART)
	. IF $PIECE(YTEIL1,Y,70)="" SET $PIECE(YTEIL1,Y,70)=$$^INARTRUEST(ART)*$$^INPROLOS(ART,MENGE)
	. IF +MENGE=0 SET $PIECE(YTEIL1,Y,70)="" ;KEINE RUESTZEITEN WENN KEINE MENGE ;no when no quantum 
	. ;
	. IF $DATA(^INARTTV(YM,ART,YDATUM)) SET $PIECE(YTEIL1,Y,7)=$$^INARTDAUERT(ART,$PIECE(YTEIL1,Y,4))   ;ERRECHNEN DAUER AUS TEILEN * MENGE ;permanence out of quantum 
	. SET $PIECE(YTEIL1,Y,6)=$$^INGEWICHTT(ART,$PIECE(YTEIL1,Y,4),$PIECE(YTEIL1,Y,15),$PIECE(YTEIL1,Y,16),$PIECE(YTEIL1,Y,17))  ;GEWICHT AUS TEILEN * MENGE ;wt. out of quantum 
	. IF +$PIECE(YTEIL1,Y,6)=0 SET $PIECE(YTEIL1,Y,6)=""  ;GEWICHT=""
	. SET $PIECE(YTEIL1,Y,8)=$$^INARTKOSTT(ART,$PIECE(YTEIL1,Y,4),$PIECE(YTEIL1,Y,7),$PIECE(YTEIL1,Y,6),YARTIKEL,YTEIL)  ;PREISERRECHNEN INKL VERSCHNITT
	. IF $PIECE(YTEIL1,Y,5)'=2 IF $PIECE(YTEIL1,Y,5)'=11 IF $PIECE(YTEIL1,Y,5)'=10 SET $PIECE(YTEIL1,Y,7)="",$PIECE(YTEIL1,Y,9)=""  ;DAUER LÖSCHEN WENN KEINE ZEIT ;permanence Delete when no time 
	. DO
	. . NEW YVORG,YVORG1,YFORM 
	. . SET YFORM="INARTTV"
	. . SET YOK=$$^WWWSPEI("INARTTV",YARTIKEL_","_YDATUM_","_YTEIL,YTEIL1,1)   ;SPEICHERN ARTIKELTEIL ;Save 
	. . DO ALLEARTIKEL  ; ÄNDERN VON GLEICHEN ARTIKELN ;alter resemble 
	
	;SPEICHERN ÄNDERUNGSMITARBEITER ;Save 
	;SET $PIECE(^INART(YM,YARTIKEL,1),Y,24)=$HOROLOG       ; SR15627
	;SET $PIECE(^INART(YM,YARTIKEL,1),Y,25)=YBED
	set YOK = $$MasterfileChanged^INARTMaster(YARTIKEL,YBED)
	
	;DO
	;. QUIT:+$GET(YOPTION)=1  ;KEIN NEUAUBAU DER DATEN
	;. DO ^INARTNEU(YARTIKEL)  ;NEUAUFBAU DER TEILE
	;. ;
	;. DO ^INARTXL(YARTIKEL,1)   ;NEUAUFBAU STRUKTUR  NUR DIESES
	;. SET $PIECE(^INART(YM,YARTIKEL,1),Y,47)=$$^INARTKOST(YARTIKEL,1)  ;NEUER SELBSTKOSTENPREIS
	
	QUIT
	
ALLEARTIKEL  ;ÄNDERN VON GLEICHEN ARTIKELN, WENN DER FOLGENDE ARTIKEL GLEICH IST SOLL ER AUCH GEÄNDERT WERDEN 
	;YARTIKEL1 ALTER ARTIKEL ;governor item 
	;YARTIKEL KEY DES ARTIKELS
	NEW NLFN,NARTIKEL1,YI,YQ
	
	SET YQ=0
	SET NLFN=$GET(YTEIL)
	FOR  SET NLFN=$ORDER(^INARTTV(YM,YARTIKEL,YDATUM,NLFN)) QUIT:NLFN=""  DO  QUIT:YQ=1
	. SET NARTIKEL1=$GET(^INARTTV(YM,YARTIKEL,YDATUM,NLFN,1))
	. SET YQ=0
	. SET YI=""
	. FOR YI=1,3,18,30 DO  QUIT:YQ=1  
	. . IF $PIECE(NARTIKEL1,Y,YI)'=$PIECE(YTEIL1,Y,YI) SET YQ=1
	. ;
	. IF YQ=0 SET YOK=$$^WWWSPEI("INARTTV",YARTIKEL_","_YDATUM_","_NLFN,YTEIL1,1)   ;SPEICHERN ARTIKELTEIL ;Save 
	
	QUIT
	
SUCH ;ANZEIGEN NACH SUCHVORGABE ;display within 
	SET VORG(1)=$EXTRACT(YAUSWAHL,2,99)   ;SUCHVORGABE VOLLTEXT ODER NUMMER ;full text Or numeral 
	KILL ^WWWSOR(YUSER,"ARTIKEL")
	QUIT:VORG(1)=""   ;KEINE AUSWAHL ;no Selection 
	
	SET YDDSATZ=0   ;VARIABELE ZUR HELL DUNKELSCHALTUNG ;bright 
	WRITE YCR
	IF $FIND(VORG(1),"=") DO  SET VORG(1)="" QUIT  ;SONDERFUNKTION LÖSCHEN UND MOVE ;Delete And 
	. SET VORG(1)=$TRANSLATE(VORG(1),"()"_"""")
	. IF +$PIECE(VORG(1),"=",1)=0!(+$PIECE(VORG(1),"=",2)=0) IF $PIECE(VORG(1),"=",2)'="x" IF $PIECE(VORG(1),"=",2)'="X"  DO  QUIT
	. . WRITE "<script language="_""""_"JavaScript"_""""_">alert('"_$$^WWWTEXT(32292,,1)_"');</script>"  ;BITTE PRÜFEN
	. ;
	. IF $TRANSLATE($PIECE(VORG(1),"=",2),"x","X")="X" DO  ;LOESCHEN
	. . NEW YPARA1,TLFN
	. . SET YSONDERFUNKTION=1
	. . SET TLFN=$PIECE(VORG(1),"=",1) 
	. . SET TLFN(1)=$PIECE(TLFN,"-",1)
	. . SET TLFN(2)=$PIECE(TLFN,"-",2)
	. . IF (TLFN(2)-TLFN(1))>500 DO  QUIT
	. . . WRITE "<script language="_""""_"JavaScript"_""""_">alert('"_$$^WWWTEXT(32292,,1)_"');</script>"  ;BITTE PRÜFEN
	. . ;
	. . IF TLFN(2)="" SET TLFN(2)=TLFN(1)
	. . FOR TLFN(3)=TLFN(1):1:TLFN(2) DO   ;LÖSCHEN EINZELNE FELDER ;Delete 
	. . . SET %(YQUERY,"YFUNCT1")="KILL"  ;FUNKTION (UP DOWN KILL)
	. . . SET %(YQUERY,"YPARA1")=YARTIKEL_","_YDATUM_","_TLFN(1)
	. . . DO PROC^INARTTV   ;LÖSCHEN DATEN ;Delete 
	. ;
	. IF $TRANSLATE($PIECE(VORG(1),"=",2),"x","X")'="X" DO  ;BEWEGEN ;stir 
	. . NEW YPARA1,TLFN
	. . SET YSONDERFUNKTION=1
	. . SET TLFN(1)=+$PIECE(VORG(1),"=",1) 
	. . SET TLFN(2)=+$PIECE(VORG(1),"=",2) 
	. . IF (TLFN(2)-TLFN(1))>500 DO  QUIT
	. . . WRITE "<script language="_""""_"JavaScript"_""""_">alert('"_$$^WWWTEXT(32292,,1)_"');</script>"  ;BITTE PRÜFEN
	. . ;
	. . SET TLFN(3)=TLFN(1)-TLFN(2)
	. . IF TLFN(3)>0 DO  QUIT   ;UP
	. . . FOR TLFN(4)=TLFN(1):-1:TLFN(2)+1 DO   ;SCHIEBEN FELDER ;shove 
	. . . . SET %(YQUERY,"YFUNCT1")="UP"  ;FUNKTION (UP DOWN KILL)
	. . . . ;SET %(YQUERY,"YPARA1")=YARTIKEL_","_TLFN(4)
	. . . . SET %(YQUERY,"YPARA1")=YARTIKEL_","_YDATUM_","_TLFN(4)  ;TYBD;22840;12.06.2003;FEHLENDER PARAMETER
	. . . . DO PROC^INARTTV  ; DATEN SCHIEBEN ;shove 
	. . ;
	. . IF TLFN(3)<0 DO  QUIT   ;DOWN
	. . . FOR TLFN(4)=TLFN(1):1:TLFN(2)-1 DO   ;SCHIEBEN FELDER ;shove 
	. . . . SET %(YQUERY,"YFUNCT1")="DOWN"  ;FUNKTION (UP DOWN KILL)
	. . . . SET %(YQUERY,"YPARA1")=YARTIKEL_","_YDATUM_","_TLFN(4)  ;TYBD;22840;12.06.2003;FEHLENDER PARAMETER
	. . . . DO PROC^INARTTV  ; DATEN SCHIEBEN ;shove 
	. ;
	. SET %(YQUERY,"YFUNCT1")=""  ;FUNKTION (UP DOWN KILL)
	. SET %(YQUERY,"YPARA1")=""
	
	IF VORG(1)'="" WRITE "&nbsp;"_$$^WWWTEXT(148)_": "_VORG(1)   ;SUCHE NACH
	IF $PIECE(YARTIKEL1,Y,26)=2 WRITE " ("_$$^WWWTEXT(32992)_")"
	
	;KOPF ZEILE ;heading 
	DO ^WWWFRAME(0)  ;TABLE AN  ;upon 
	WRITE "<TH VALIGN=TOP NOWRAP VALIGN=TOP align=LEFT ALIGN=LEFT WIDTH=10%"
	WRITE " BGCOLOR="_YDARKGRAY
	WRITE ">"
	WRITE "<FONT SIZE=2>"
	WRITE $$^WWWTEXT(32025)  ;MENGE MENGENEINHEIT ;quantum 
	WRITE "</TH>",YCR
	
	WRITE "<TH VALIGN=TOP NOWRAP VALIGN=TOP align=LEFT ALIGN=LEFT WIDTH=10%"
	WRITE " BGCOLOR="_YDARKGRAY
	WRITE ">"
	WRITE "<FONT SIZE=2>"
	WRITE $$^WWWTEXT(32024)  ;ARTIKEL ;item 
	WRITE "</TH>",YCR
	
	WRITE "<TH VALIGN=TOP NOWRAP VALIGN=TOP align=LEFT ALIGN=LEFT WIDTH=30%"
	WRITE " BGCOLOR="_YDARKGRAY
	WRITE ">"
	WRITE "<FONT SIZE=2>"
	WRITE $$^WWWTEXT(32026)  ;BEZEICHNUNG ;notation 
	WRITE "</TH>",YCR
	
	WRITE "<TH VALIGN=TOP NOWRAP VALIGN=TOP align=LEFT ALIGN=LEFT WIDTH=10%"
	WRITE " BGCOLOR="_YDARKGRAY
	WRITE ">"
	WRITE "<FONT SIZE=2>"
	WRITE $$^WWWTEXT(32020)  ;BESTAND
	WRITE "</TH>",YCR
	
	WRITE "<TH VALIGN=TOP NOWRAP VALIGN=TOP align=LEFT ALIGN=LEFT WIDTH=10%"
	WRITE " BGCOLOR="_YDARKGRAY
	WRITE ">"
	WRITE "<FONT SIZE=2>"
	WRITE $$^WWWTEXT(31409)_" ("_$$^WWWTEXT(32980)_")"  ;EINZEL-PREIS (EK)
	WRITE "</TH>",YCR
	
	WRITE "<TH VALIGN=TOP NOWRAP VALIGN=TOP align=LEFT ALIGN=LEFT WIDTH=30%"
	WRITE " BGCOLOR="_YDARKGRAY
	WRITE ">"
	WRITE "<FONT SIZE=2>"
	WRITE $$^WWWTEXT(32027)  ;AUSFÜHRUNG ;execution 
	WRITE "</TH>",YCR
	
	WRITE "<TH VALIGN=TOP NOWRAP VALIGN=TOP align=LEFT ALIGN=LEFT WIDTH=30%"
	WRITE " BGCOLOR="_YDARKGRAY
	WRITE ">"
	WRITE "<FONT SIZE=2>"
	WRITE $$^WWWTEXT(32022)  ;LIEFERANT ;purveyor 
	WRITE "</TH>",YCR
	
	WRITE "</TR>",YCR
	
	SET ANZM=0
	;STRATEGIE 1 ARTIKELNUMMER ;strategy 
	IF $EXTRACT(VORG(1))'="*" IF VORG(1)'="" IF $DATA(^INART(YM,VORG(1))) SET ART=VORG(1) DO
	. SET ART1=$GET(^INART(YM,ART,1)) DO ANZ
	. QUIT
	;STRATEGIE 2 BEZEICHNUNG GENAU ;strategy notation truly 
	IF VORG(1)'="" IF $EXTRACT(VORG(1))'="*" SET NAME=$$^WWWUMLAU(VORG(1),1) IF $DATA(^INARTs(YM,1,NAME)) DO
	. SET ART=""
	. FOR  SET ART=$ORDER(^INARTs(YM,1,NAME,ART)) QUIT:ART=""  DO  QUIT:ANZM>50
	. . SET ART1=$GET(^INART(YM,ART,1))
	. . DO ANZ
	
	;STRATEGIE 3 BEZEICHNUNG UNGENAU ;strategy notation inexact 
	IF ANZM<10 IF VORG(1)'="" IF $EXTRACT(VORG(1))'="*" SET NAME=$$^WWWUMLAU(VORG(1),1) FOR  SET NAME=$ORDER(^INARTs(YM,1,NAME)) QUIT:NAME=""  QUIT:'$FIND(NAME,$$^WWWUMLAU(VORG(1),1))  DO  QUIT:ANZM>50
	. SET ART=""
	. FOR  SET ART=$ORDER(^INARTs(YM,1,NAME,ART)) QUIT:ART=""  DO  QUIT:ANZM>50
	. . SET ART1=$GET(^INART(YM,ART,1))
	. . DO ANZ
	
	;STRATEGIE 4 SUCHEN ARTIKELNUMMERN ;strategy seek 
	IF ANZM<10 IF +VORG(1)'=0 FOR I=0:1:4 DO  QUIT:ANZM>50
	. SET ART=VORG(1)_$EXTRACT("00000000",1,I)
	. IF ART'=VORG(1) IF $DATA(^INART(YM,ART,1)) SET ART1=$GET(^INART(YM,ART,1)) DO ANZ
	. FOR  SET ART=$ORDER(^INART(YM,ART)) QUIT:ART=""  QUIT:'$FIND(ART,VORG(1))  DO  QUIT:ANZM>50
	. . SET ART1=$GET(^INART(YM,ART,1))
	. . IF VORG(1)'=ART DO ANZ QUIT
	
	;STRATEGIE 4 SUCHEN VOLLTEXT MODELL ;strategy seek full text 
	IF ANZM=0 IF VORG(1)'="" IF $EXTRACT(VORG(1))'="*" SET NAME="" FOR  SET NAME=$ORDER(^INARTs(YM,1,NAME)) QUIT:NAME=""  IF $FIND(NAME,$$^WWWUMLAU(VORG(1),1)) DO  QUIT:ANZM>50
	. SET ART=""
	. FOR  SET ART=$ORDER(^INARTs(YM,1,NAME,ART)) QUIT:ART=""  DO  QUIT:ANZM>50
	. . SET ART1=$GET(^INART(YM,ART,1))
	. . DO ANZ
	.
	;STRATEGIE 4 SUCHEN VOLLTEXT ARTIKEL ;strategy seek full text item 
	IF ANZM=0 IF $EXTRACT(VORG(1))="*" SET VORG(1)=$$^WWWUMLAU($EXTRACT(VORG(1),2,99),1) SET NAME="" FOR  SET NAME=$ORDER(^INARTs(YM,1,NAME)) QUIT:NAME=""  DO  QUIT:ANZM>50
	. SET ART=""
	. FOR  SET ART=$ORDER(^INARTs(YM,1,NAME,ART)) QUIT:ART=""  DO  QUIT:ANZM>50
	. . SET ART1=$GET(^INART(YM,ART,1))
	. . IF VORG(1)'="" IF $FIND($$^WWWUMLAU(ART1_Y_ART,1),VORG(1)) DO ANZ QUIT
	. . IF VORG(1)="" DO ANZ QUIT
	
	;STRATEGIE 7 SUCHEN ALTERNATIVE ARTIKELSUCHE ;strategy seek option 
	IF ANZM=0 DO    ;TYBD;25563;17,4,2004
	. SET ART=""
	. FOR  SET ART=$ORDER(^INARTXCHs(YM,1,$$^WWWUMLAU(VORG(1),1),ART)) QUIT:ART=""  DO  QUIT:ANZM>50    ;SSOK
	. . SET ART1=$GET(^INART(YM,ART,1))
	. . DO ANZ QUIT  
	
	IF ANZM=0 DO   ;KEIN DATENYTEIL1 GEFUNDEN ;no 
	. WRITE "<TR>"
	. SET YDDSATZ=YDDSATZ+1
	. WRITE "<TD NOWRAP VALIGN=TOP"
	. IF YDDSATZ#2=1 WRITE " BGCOLOR="_YWHITE
	. WRITE ">"
	. WRITE "<FONT SIZE=2>"
	. WRITE "&nbsp;"
	. WRITE "</TD>",YCR
	. ;
	. WRITE "<TD NOWRAP VALIGN=TOP"
	. IF YDDSATZ#2=1 WRITE " BGCOLOR="_YWHITE
	. WRITE ">"
	. WRITE "<FONT SIZE=2>"
	. WRITE "&nbsp;"
	. WRITE "</TD>",YCR
	. ;
	. WRITE "<TD NOWRAP VALIGN=TOP"
	. IF YDDSATZ#2=1 WRITE " BGCOLOR="_YWHITE
	. WRITE ">"
	. WRITE "<FONT SIZE=2>"
	. WRITE "&nbsp;"
	. WRITE "</TD>",YCR
	. ;
	. WRITE "<TD NOWRAP VALIGN=TOP"
	. IF YDDSATZ#2=1 WRITE " BGCOLOR="_YWHITE
	. WRITE ">"
	. WRITE "<FONT SIZE=2>"
	. WRITE "&nbsp;"
	. WRITE "</TD>",YCR
	. ;
	. WRITE "<TD NOWRAP VALIGN=TOP"
	. IF YDDSATZ#2=1 WRITE " BGCOLOR="_YWHITE
	. WRITE ">"
	. WRITE "<FONT SIZE=2>"
	. WRITE "&nbsp;"
	. WRITE "</TD>",YCR
	. ;
	. WRITE "<TD NOWRAP VALIGN=TOP"
	. IF YDDSATZ#2=1 WRITE " BGCOLOR="_YWHITE
	. WRITE ">"
	. WRITE "<FONT SIZE=2>"
	. WRITE "&nbsp;"
	. WRITE "</TD>",YCR
	. ;
	. WRITE "<TD NOWRAP VALIGN=TOP"
	. IF YDDSATZ#2=1 WRITE " BGCOLOR="_YWHITE
	. WRITE ">"
	. WRITE "<FONT SIZE=2>"
	. WRITE "&nbsp;"
	. WRITE "</TD>",YCR
	. ;
	. WRITE "</TR>",YCR
	
	DO ^WWWFRAME(1)   ;TABLE AUS ;out of 
	WRITE YCR
	WRITE "<BR>"
	IF ANZM>49 WRITE "<B>",$$^WWWTEXT(32111),"</b>"  ;Weitere Artikel vorhanden.... Suche einschränken!
	KILL ^WWWSOR(YUSER,"ARTIKEL")
	QUIT
	
ANZ ;
	;anzeige suchergebnis auswahl der Menge ;Selection who Quantity 
	NEW DIMENS   ;DIMENSIONEN
	
	SET DIMENS=0
	IF (+$PIECE(ART1,Y,26)=0)!($PIECE(ART1,Y,26)=2)!($PIECE(ART1,Y,26)=3)!($PIECE(ART1,Y,26)=1) DO   ;NUR WENN BESTELL ODER EIGENFERTIGUNG ;only when Or 
	. QUIT:ART'=$TRANSLATE(ART,",.-#;:_'+*´?=!§%&/()=[]{}²³@|><"_"""")
	. IF $PIECE(ART1,Y,40)'=5 IF $PIECE(ART1,Y,40)'=6 IF $PIECE(ART1,Y,40)'=12 IF $PIECE(ART1,Y,40)'=15 IF $PIECE(ART1,Y,40)'=4 QUIT  ;FALSCHE EINHEIT ;unity 
	. SET DIMENS=1  ;DIM VORHANDEN ;on hand 
	
	QUIT:$DATA(^WWWSOR(YUSER,"ARTIKEL",ART))  ;SCHON AUSGEWÄHLT ;yet select 
	SET ^WWWSOR(YUSER,"ARTIKEL",ART)=""
	;EIGENAUFTRAG
	IF $PIECE(YFELD,Y,2)=1 IF +$PIECE(ART1,Y,26)'=0 IF $PIECE(ART1,Y,26)'=2 IF $PIECE(ART1,Y,26)'=3 QUIT  ;NUR LEISTUNGEN UND EIGENFERTIGUNG BEI INNTERNEM AUFTRAG ;only LEISTUNGEN And next to mandate 
	;LIEFERANTEN BESTELLUNG ;sales order 
	IF $PIECE(YFELD,Y,2)=2 IF $PIECE(ART1,Y,26)'=0 IF $PIECE(ART1,Y,26)'=1 IF $PIECE(ART1,Y,26)'=4 QUIT  ;NUR BESTELLUNG UND KLEINTEILE BER BESTELLUNGEN  ;only sales order And 
	IF $PIECE(YARTIKEL1,Y,26)=2 IF $PIECE(ART1,Y,26)'=2 QUIT   ;NUR LEISTUNGEN AN LEISTUNGEN TYBD07.05.2002 ;only LEISTUNGEN upon LEISTUNGEN 
	SET ANZM=ANZM+1
	
	WRITE "<TR>",YCR
 
	SET YDDSATZ=YDDSATZ+1
	
	;MENGE ;quantity 
	WRITE "<TD NOWRAP VALIGN=TOP"
	IF YDDSATZ#2=1 WRITE " BGCOLOR="_YWHITE
	WRITE ">"
	WRITE "<FONT SIZE=2>"
	;MENGENAUSWAHL
	WRITE "<INPUT NAME="_"YMNG"_ART_" SIZE=5 MAXLENGTH=5 TYPE=float VALUE="_""""_""""
	WRITE " TABINDEX=ART style="_""""_"padding-top:0 ;padding-bottom:0"_""""_" style="_""""_"text-align:right"_""""
	WRITE YCR
	WRITE " onFocus='select();'"
	IF $GET(YHTMFORM)="WWW2" DO
	. WRITE YCR," onBlur='"
	. WRITE " retval = EventValue("_""""_YUCI_""""_","_""""_YUSER_""""_","_""""_YFORM_""""_","_""""_"FIX"_$GET(YKEY)_""""_","_""""_""""_",this.value,"_""""_"0"_""""_","_""""_"YMNG"_ART_""""_");"
	. ;WRITE "document.WWW.ITEMS.value="_""""_ART_""""_";document.WWW.ITEMSQ.value=this.value;"
	. ;WRITE "document.WWW.ITEMBENN.value=document."_YHTMFORM_".YBEN"_ART_".value;"
	. ;IF DIMENS=1 DO
	. ;. WRITE "document.WWW.ITEMLNGN.value=document."_YHTMFORM_".YLNG"_ART_".value;"
	. ;. WRITE "document.WWW.ITEMBRTN.value=document."_YHTMFORM_".YBRT"_ART_".value;"
	. ;. WRITE "document.WWW.ITEMHOEN.value=document."_YHTMFORM_".YHOE"_ART_".value;"
	. ;. WRITE "document.WWW.ITEMMULN.value=document."_YHTMFORM_".YMUL"_ART_".value;"
	. ;
	. WRITE "'"
	
	WRITE YCR
	WRITE " onKeyDown='if (event.keyCode == 13) event.keyCode = 9;'"
	WRITE YCR
	WRITE " STYLE="_""""_"background-color: 'beige'"_""""
	WRITE YCR
	;DO  ;NUR WENN KEINE DIM ;only when no 
	. IF $PIECE(ART1,Y,40)'=5 IF $PIECE(ART1,Y,40)'=6 IF $PIECE(ART1,Y,40)'=12 IF $PIECE(ART1,Y,40)'=15 IF $PIECE(ART1,Y,40)'=4 QUIT
	. WRITE " onKeyDown='if (event.keyCode == 13) event.keyCode = 9;'"
	
	WRITE ">"
	IF $PIECE(ART1,Y,66)=1 WRITE "<FONT COLOR=RED>"   ;ARTIKEL ;item 
	IF $PIECE(ART1,Y,66)=2 WRITE "<FONT COLOR=ORANGE>"   ;ACHTUNG ;estimation 
	IF $PIECE(ART1,Y,66)=3 WRITE "<FONT COLOR=GREEN>"   ;
	WRITE "&nbsp;"
	IF $PIECE(ART1,Y,46)="" SET $PIECE(ART1,Y,46)=$PIECE(ART1,Y,40)  ;VERKAUFSEINHEIT=MENGENEINHEIT
	IF $PIECE(ART1,Y,46)="" SET $PIECE(ART1,Y,46)=1
	;MENGENEINHEIT
	IF '$DATA(^WWW101(0,"EINHEIT",SPRACHE,+$PIECE(ART1,Y,46),1)) SET $PIECE(ART1,Y,46)=1  ;STUECK
	IF +$PIECE(ART1,Y,46)'=0 WRITE $PIECE($GET(^WWW101(0,"EINHEIT",SPRACHE,$PIECE(ART1,Y,46),1)),Y,1)  ;EINHEIT ;unity 
	WRITE "&nbsp;"
	;BREITE/LÄNGE/HÖHE
	IF DIMENS=1 DO   ;WENN DIMENSIONEN VORHANDEN ;when on hand 
	. WRITE YCR
	. WRITE "<BR>"
	. WRITE "<INPUT NAME="_"YLNG"_ART_" SIZE=5 MAXLENGTH=10 TYPE=float VALUE="_""""_$PIECE(ART1,Y,15)_""""
	. WRITE YCR
	. WRITE " TABINDEX=ART style="_""""_"padding-top:0 ;padding-bottom:0"_""""_" style="_""""_"text-align:right"_""""
	. WRITE YCR
	. WRITE " onFocus='select();'"
	. WRITE YCR
	. WRITE " onKeyDown='if (event.keyCode == 13) event.keyCode = 9;'"
	. WRITE YCR
	. SET ^WWWDATEN(YM,+$HOROLOG,YUSER,YFORM,"V","YLNG"_ART,1)=$PIECE(ART1,Y,15)  ;DATEN ZUR PRUEFUNG
	. WRITE " onBlur='retval = EventValue("_""""_YUCI_""""_","_""""_YUSER_""""_","_""""_YFORM_""""_","_""""_"FIX"_""""_","_""""_"INMNGART"_""""_",this.value,6,"_""""_ART_""""_" + "_""""_"/"_""""_" + "_"document."_YHTMFORM_".YBRT"_ART_".value"_"+"_""""_"/"_""""_" + "_"document."_YHTMFORM_".YHOE"_ART_".value"_"); if (retval != "_""""_""""_") document."_YHTMFORM_".YMNG"_ART_".value = retval;"
	. IF $GET(YHTMFORM)="WWW2" WRITE " retval = EventValue("_""""_YUCI_""""_","_""""_YUSER_""""_","_""""_YFORM_""""_","_""""_"FIX"_$GET(YKEY)_""""_","_""""_""""_",this.value,"_""""_"0"_""""_","_""""_"YLNG"_ART_""""_");"
	. ;IF $GET(YHTMFORM)="WWW2" DO
	. ;. WRITE "document.WWW.ITEMS.value = "_""""_ART_""""_";"
	. ;. WRITE "document.WWW.ITEMSQ.value = retval;"
	. ;. WRITE "document.WWW.ITEMLNGN.value=document."_YHTMFORM_".YLNG"_ART_".value;"
	. ;. WRITE "document.WWW.ITEMBRTN.value=document."_YHTMFORM_".YBRT"_ART_".value;"
	. ;. WRITE "document.WWW.ITEMHOEN.value=document."_YHTMFORM_".YHOE"_ART_".value;"
	. ;
	. WRITE "'"
	. ;
	. WRITE ">"
	. WRITE " Dim.1"
	. ;
	. WRITE YCR
	. WRITE "<BR>"
	. WRITE "<INPUT NAME="_"YBRT"_ART_" SIZE=5 MAXLENGTH=10 TYPE=float VALUE="_""""_$PIECE(ART1,Y,16)_""""
	. WRITE YCR
	. WRITE " TABINDEX=ART style="_""""_"padding-top:0 ;padding-bottom:0"_""""_" style="_""""_"text-align:right"_""""
	. WRITE YCR
	. WRITE " onFocus='select();'"
	. WRITE YCR
	. WRITE " onKeyDown='if (event.keyCode == 13) event.keyCode = 9;'"
	. WRITE YCR
	. SET ^WWWDATEN(YM,+$HOROLOG,YUSER,YFORM,"V","YBRT"_ART,1)=$PIECE(ART1,Y,16)  ;DATEN ZUR PRUEFUNG
	. WRITE " onBlur='retval = EventValue("_""""_YUCI_""""_","_""""_YUSER_""""_","_""""_YFORM_""""_","_""""_"FIX"_""""_","_""""_"INMNGART"_""""_",this.value,6,"_""""_ART_""""_" + "_""""_"/"_""""_" + "_"document."_YHTMFORM_".YLNG"_ART_".value"_"+"_""""_"/"_""""_" + "_"document."_YHTMFORM_".YHOE"_ART_".value"_"); if (retval != "_""""_""""_") document."_YHTMFORM_".YMNG"_ART_".value = retval;"
	. IF $GET(YHTMFORM)="WWW2" WRITE " retval = EventValue("_""""_YUCI_""""_","_""""_YUSER_""""_","_""""_YFORM_""""_","_""""_"FIX"_$GET(YKEY)_""""_","_""""_""""_",this.value,"_""""_"0"_""""_","_""""_"YBRT"_ART_""""_");"
	. ;IF $GET(YHTMFORM)="WWW2" DO
	. ;. WRITE "document.WWW.ITEMS.value = "_""""_ART_""""_";"
	. ;. WRITE "document.WWW.ITEMSQ.value = retval;"
	. ;. WRITE "document.WWW.ITEMLNGN.value=document."_YHTMFORM_".YLNG"_ART_".value;"
	. ;. WRITE "document.WWW.ITEMBRTN.value=document."_YHTMFORM_".YBRT"_ART_".value;"
	. ;. WRITE "document.WWW.ITEMHOEN.value=document."_YHTMFORM_".YHOE"_ART_".value;"
	. ;
	. WRITE "'"
	. ;
	. WRITE ">"
	. WRITE " Dim.2"
	. ;
	. ;
	. WRITE YCR
	. WRITE "<BR>"
	. WRITE "<INPUT NAME="_"YHOE"_ART_" SIZE=5 MAXLENGTH=10 TYPE=float VALUE="_""""_$PIECE(ART1,Y,17)_""""
	. WRITE YCR
	. WRITE " TABINDEX=ART style="_""""_"padding-top:0 ;padding-bottom:0"_""""_" style="_""""_"text-align:right"_""""
	. WRITE YCR
	. WRITE " onFocus='select();'"
	. WRITE YCR
	. WRITE " onKeyDown='if (event.keyCode == 13) event.keyCode = 9;'"
	. WRITE YCR
	. SET ^WWWDATEN(YM,+$HOROLOG,YUSER,YFORM,"V","YHOE"_ART,1)=$PIECE(ART1,Y,17)  ;DATEN ZUR PRUEFUNG
	. WRITE " onBlur='retval = EventValue("_""""_YUCI_""""_","_""""_YUSER_""""_","_""""_YFORM_""""_","_""""_"FIX"_""""_","_""""_"INMNGART"_""""_",this.value,6,"_""""_ART_""""_" + "_""""_"/"_""""_" + "_"document."_YHTMFORM_".YBRT"_ART_".value"_"+"_""""_"/"_""""_" + "_"document."_YHTMFORM_".YLNG"_ART_".value"_"); if (retval != "_""""_""""_") document."_YHTMFORM_".YMNG"_ART_".value = retval;"
	. IF $GET(YHTMFORM)="WWW2" WRITE " retval = EventValue("_""""_YUCI_""""_","_""""_YUSER_""""_","_""""_YFORM_""""_","_""""_"FIX"_$GET(YKEY)_""""_","_""""_""""_",this.value,"_""""_"0"_""""_","_""""_"YHOE"_ART_""""_");"
	. ;IF $GET(YHTMFORM)="WWW2" DO
	. ;. WRITE "document.WWW.ITEMS.value = "_""""_ART_""""_";"
	. ;. WRITE "docum]]><![CDATA[ent.WWW.ITEMSQ.value = retval;"
	. ;. WRITE "document.WWW.ITEMLNGN.value=document."_YHTMFORM_".YLNG"_ART_".value;"
	. ;. WRITE "document.WWW.ITEMBRTN.value=document."_YHTMFORM_".YBRT"_ART_".value;"
	. ;. WRITE "document.WWW.ITEMHOEN.value=document."_YHTMFORM_".YHOE"_ART_".value;"
	. ;
	. WRITE "'"
	. ;
	. WRITE ">"
	. WRITE " Dim.3"
	. QUIT
	. ;
	. WRITE "<IMG SRC="_""""_YGIF_"total.gif"_""""_" ALIGN=right TITLE="_""""_$$^WWWTEXT(32366)_""""_" border=0>"
	. WRITE "</TD>",YCR
	
	;ARTIKEL NUMMER ;item numeral 
	WRITE "<TD NOWRAP ALIGN=LEFT VALIGN=TOP"
	IF YDDSATZ#2=1 WRITE " BGCOLOR="_YWHITE
	WRITE ">"
	WRITE "<FONT SIZE=2>"
	IF $PIECE(ART1,Y,66)=1 WRITE "<FONT COLOR=RED>"   ;ARTIKEL ;item 
	IF $PIECE(ART1,Y,66)=2 WRITE "<FONT COLOR=ORANGE>"   ;ACHTUNG ;estimation 
	IF $PIECE(ART1,Y,66)=3 WRITE "<FONT COLOR=GREEN>"   ;
	WRITE ART
	WRITE "&nbsp;"
	WRITE "</TD>",YCR
	
	;BEZEICHNUNG ;notation 
	WRITE "<TD NOWRAP VALIGN=TOP"
	IF YDDSATZ#2=1 WRITE " BGCOLOR="_YWHITE
	WRITE ">"
	WRITE "<FONT SIZE=2>"
	IF $PIECE(ART1,Y,66)=1 WRITE "<FONT COLOR=RED>"   ;ARTIKEL ;item 
	IF $PIECE(ART1,Y,66)=2 WRITE "<FONT COLOR=ORANGE>"   ;ACHTUNG ;estimation 
	IF $PIECE(ART1,Y,66)=3 WRITE "<FONT COLOR=GREEN>"   ;
	WRITE $PIECE(ART1,Y,1)
	DO  ;ZUSATZBENENNUNG
	. WRITE "<BR>"
	. WRITE "<INPUT NAME="_"YBEN"_ART_" SIZE=20 MAXLENGTH=60 TYPE=TEXT VALUE="_""""_""""
	. WRITE " TABINDEX=ART style="_""""_"padding-top:0 ;padding-bottom:0"_""""
	. WRITE " onFocus='select();'"
	. IF $GET(YHTMFORM)="WWW2" WRITE " onBlur='retval = EventValue("_""""_YUCI_""""_","_""""_YUSER_""""_","_""""_YFORM_""""_","_""""_"FIX"_$GET(YKEY)_""""_","_""""_""""_",this.value,"_""""_"0"_""""_","_""""_"YBEN"_ART_""""_");'"
	. ;IF $GET(YHTMFORM)="WWW2" WRITE " onBlur='document.WWW.ITEMBENN.value=this.value;'"
	. WRITE YCR
	. WRITE " onKeyDown='if (event.keyCode == 13) event.keyCode = 9;'"
	. WRITE ">"
	. WRITE YCR
	
	;MENGE, WENN VIELE EINHEITEN
	IF DIMENS=1 DO
	. WRITE "<BR>"
	. WRITE "<INPUT NAME="_"YMUL"_ART_" SIZE=4 MAXLENGTH=10 TYPE=TEXT VALUE="_""""_""""
	. WRITE " TABINDEX=ART style="_""""_"padding-top:0 ;padding-bottom:0"_""""
	. WRITE " onFocus='select();'"
	. IF $GET(YHTMFORM)="WWW2" WRITE " onBlur='retval = EventValue("_""""_YUCI_""""_","_""""_YUSER_""""_","_""""_YFORM_""""_","_""""_"FIX"_$GET(YKEY)_""""_","_""""_""""_",this.value,"_""""_"0"_""""_","_""""_"YMUL"_ART_""""_");'"
	. ;IF $GET(YHTMFORM)="WWW2" WRITE YCR," onBlur='document.WWW.ITEMMULN.value=this.value;'"
	. WRITE YCR
	. WRITE " onKeyDown='if (event.keyCode == 13) event.keyCode = 9;'"
	. WRITE ">"
	. WRITE "&nbsp;"_$$^WWWTEXT(32240)  ;MENGE
	. WRITE YCR
	WRITE "</TD>",YCR
	
	;BESTAND
	WRITE "<TD VALIGN=TOP ALIGN=RIGHT NOWRAP"
	IF YDDSATZ#2=1 WRITE " BGCOLOR="_YWHITE
	WRITE ">"
	WRITE "<FONT SIZE=2>"
	IF $PIECE(ART1,Y,66)=1 WRITE "<FONT COLOR=RED>"   ;
	IF $PIECE(ART1,Y,66)=2 WRITE "<FONT COLOR=ORANGE>"   ;
	IF $PIECE(ART1,Y,66)=3 WRITE "<FONT COLOR=GREEN>"   ;
	DO
	. NEW MENGE
	. SET MENGE=$$^INARTMENGE(ART)
	. IF +MENGE>0 WRITE MENGE
	WRITE "&nbsp;"
	WRITE "</TD>",YCR
	
	;EINZEL-PREIS
	WRITE "<TD VALIGN=TOP ALIGN=RIGHT NOWRAP"
	IF YDDSATZ#2=1 WRITE " BGCOLOR="_YWHITE
	WRITE ">"
	WRITE "<FONT SIZE=2>"
	IF $PIECE(ART1,Y,66)=1 WRITE "<FONT COLOR=RED>"   ;
	IF $PIECE(ART1,Y,66)=2 WRITE "<FONT COLOR=ORANGE>"   ;
	IF $PIECE(ART1,Y,66)=3 WRITE "<FONT COLOR=GREEN>"   ;
	WRITE $$^WWWZAHL($$^INARTKOST(ART,1),10,2,YWHR)
	WRITE "&nbsp;"
	WRITE "</TD>",YCR
	
	;AUSFÜHRUNG ;execution 
	WRITE "<TD VALIGN=TOP WIDTH=250"
	IF YDDSATZ#2=1 WRITE " BGCOLOR="_YWHITE
	WRITE ">"
	WRITE "<FONT SIZE=2>"
	IF $PIECE(ART1,Y,66)=1 WRITE "<FONT COLOR=RED>"
	IF $PIECE(ART1,Y,66)=2 WRITE "<FONT COLOR=ORANGE>"
	IF $PIECE(ART1,Y,66)=3 WRITE "<FONT COLOR=GREEN>"
	WRITE $TRANSLATE($PIECE(ART1,Y,14),"|"," ")
	WRITE "&nbsp;"
	WRITE "</TD>",YCR
	
	;LIEFERANT ;supplier
	WRITE "<TD VALIGN=TOP"
	IF YDDSATZ#2=1 WRITE " BGCOLOR="_YWHITE
	WRITE ">"
	WRITE "<FONT SIZE=2>"
	IF $PIECE(ART1,Y,66)=1 WRITE "<FONT COLOR=RED>"
	IF $PIECE(ART1,Y,66)=2 WRITE "<FONT COLOR=ORANGE>"
	IF $PIECE(ART1,Y,66)=3 WRITE "<FONT COLOR=GREEN>"
	WRITE $TRANSLATE($PIECE(ART1,Y,195),"|"," ")
	WRITE "&nbsp;"
	WRITE "</TD>",YCR
	WRITE "</TR>",YCR
	QUIT
	
HIDDEN ;NEU HIDDENFELDER ;recent 
	;YOPTION = DATUM AB WANN DIE VERSION GÜLTIG IST ;Date Confirm. when who valuable 
	IF $PIECE(YKEY,",",2)="" SET YOPTION=""
	;IF +$PIECE($GET(YKEY),",",2)'=0 IF $PIECE(YKEY,",",1)'="" DO
	IF $PIECE($GET(YKEY),",",2)'="" IF $PIECE(YKEY,",",1)'="" DO       ;BEC;22840;19.05.03;GEÄNDERT DASS AUCH VERSIONEN MIT BUCHSTABEN MÖGLICH SIND
	. IF '$DATA(^INARTTV(YM,$PIECE(YKEY,",",1),$PIECE(YKEY,",",2))) DO
	. . MERGE ^INARTTV(YM,$PIECE(YKEY,",",1),$PIECE(YKEY,",",2))=^INARTT(YM,$PIECE(YKEY,",",1))
	
	IF $GET(YOPTION)=0 SET YOPTION=""
	IF $PIECE($GET(YKEY),",",1)'="" DO
	. IF $PIECE($GET(YKEY),",",2)'="" DO
	. . NEW LFN
	. . SET LFN=$ORDER(^INARTTV(YM,$PIECE($GET(YKEY),",",1),$PIECE($GET(YKEY),",",2),"")) IF LFN'="" DO
	. . . IF $PIECE($GET(^INARTTV(YM,$PIECE($GET(YKEY),",",1),$PIECE($GET(YKEY),",",2),LFN,1)),Y,100)'="" SET YOPTION=$PIECE(^(1),Y,100) QUIT
 	. . . ;IF +YOPTION'=0 SET $PIECE(^INARTTV(YM,$PIECE($GET(YKEY),",",1),$PIECE($GET(YKEY),",",2),LFN,1),Y,100)=YOPTION QUIT  // SR14746
 	. . . IF +YOPTION'=0 DO  QUIT
 	. . . . NEW SATZ,KEY
 	. . . . SET KEY=$PIECE($GET(YKEY),",",1)_","_$PIECE($GET(YKEY),",",2)_","_LFN
 	. . . . SET SATZ=$GET(^INARTTV(YM,$PIECE($GET(YKEY),",",1),$PIECE($GET(YKEY),",",2),LFN,1))
 	. . . . SET $PIECE(SATZ,Y,100)=YOPTION 
 	. . . . ;DO SAVE^WWWSPEI("INARTTV",KEY,SATZ,1)        // SR14746
 	. . . . set strStatus=$$$Save("INARTTV",KEY,SATZ,$$$YES) // SR14746
 	. . . ;
	. . . SET YOPTION=$PIECE($GET(^INARTTV(YM,$PIECE($GET(YKEY),",",1),$PIECE($GET(YKEY),",",2),LFN,1)),Y,100)
	
	QUIT:$GET(YHTMFORM)'="WWW2"
	
	WRITE YCR,"<INPUT TYPE=HIDDEN NAME="_""""_"ITEMS"_""""_" VALUE="_""""_""""_">"
	WRITE YCR,"<INPUT TYPE=HIDDEN NAME="_""""_"ITEMSQ"_""""_" VALUE="_""""_""""_">"
	WRITE YCR,"<INPUT TYPE=HIDDEN NAME="_""""_"ITEMBENN"_""""_" VALUE="_""""_""""_">"
	WRITE YCR,"<INPUT TYPE=HIDDEN NAME="_""""_"ITEMMULN"_""""_" VALUE="_""""_""""_">"
	WRITE YCR,"<INPUT TYPE=HIDDEN NAME="_""""_"ITEMLNGN"_""""_" VALUE="_""""_""""_">"
	WRITE YCR,"<INPUT TYPE=HIDDEN NAME="_""""_"ITEMBRTN"_""""_" VALUE="_""""_""""_">"
	WRITE YCR,"<INPUT TYPE=HIDDEN NAME="_""""_"ITEMHOEN"_""""_" VALUE="_""""_""""_">"
	QUIT
	
VERSIONEN ;
	;ANZEIGEN VERSIONEN ;display 
	QUIT:$PIECE($GET(YKEY),",",1)=""
	WRITE "<BR>"
	DO ^WWWFRAME(0)
	NEW UES,YI
	SET UES=$$^WWWFELDNAME("INARTTV1","P",2)_Y_$$^WWWFELDNAME("INARTTV1","D",4)_Y_$$^WWWTEXT(32781)_Y_$$^WWWFELDNAME("INARTTV1","D",3)_Y_$$^WWWFELDNAME("INARTTV1","D",2)
	;              VERSION                        GÜLTIG AB                            STATUS                   ;ERFASSUNGSMITARBEITERV                                 ;ERFASSUNGSDATUM                                 ;valuable Confirm. 
	SET UES=UES_Y_$$^WWWFELDNAME("INARTTV1","D",5)_Y_$$^WWWFELDNAME("INARTTV1","D",6)
	;					ÄNDERUNGSMITARBEITER               ÄNDERUNGSDATUM
	WRITE "<tr nowrap bgcolor="_YDARKGRAY_">"
	FOR YI=1:1 QUIT:$PIECE(UES,Y,YI,99)=""  DO 
	. WRITE "<th>"
	. WRITE "<font size=2>"
	. WRITE $PIECE(UES,Y,YI)
	. WRITE "&nbsp;</font>"
	. WRITE "</th>"    ; SR15627 include in for loop
	WRITE "</tr>"
	
	NEW LFN,DATUM,VERSION,LFN1,ART,YFELD,ART1,LFN3
	
	SET YDDSATZ=0		;BEC;22840;28.07.03;LEERZEILEN EINGEFÜGT
	SET DATUM=""
	FOR LFN=1:1:200 SET DATUM=$ORDER(^INARTTV1s(YM,1,$PIECE($GET(YKEY),",",1),DATUM)) QUIT:DATUM=""  DO
	. SET ART=""
	. FOR LFN2=1:1:50 SET ART=$ORDER(^INARTTV1s(YM,1,$PIECE($GET(YKEY),",",1),DATUM,ART)) QUIT:ART=""  DO
	. . IF ART'="" SET ART1=$GET(^INART(YM,ART,1))
	. . SET VERSION=""
	. . FOR LFN3=1:1:50 SET VERSION=$ORDER(^INARTTV1s(YM,1,$PIECE($GET(YKEY),",",1),DATUM,ART,VERSION)) QUIT:VERSION=""  DO
	. . . SET YFELD=$GET(^INARTTV1(YM,$PIECE($GET(YKEY),",",1),VERSION,1))
	. . . QUIT:YFELD=""
	. . . WRITE YCR
	. . . DO NL^WWWTAB
	. . . DO NF2^WWWTAB
	. . . ;
	. . . DO
	. . . . WRITE "<A"
	. . . . WRITE " TITLE="_""""_$$^WWWTEXT(374)_""""     ;DATENSATZ AUSWÄHLEN ;data record pick out 
	. . . . WRITE "HREF="_""""_YAKTION_"EP=WWWFORM&YFORM=INARTTV1&YKEY="_$PIECE($GET(YKEY),",",1)_","_VERSION_"&YFKEY="_$PIECE($GET(YKEY),",",1)
	. . . . NEW YKEY,YFKEY
	. . . . DO ^WWWCGI
	. . . . WRITE """"
	. . . . WRITE ">"
	. . . . WRITE VERSION
	. . . . WRITE "</A>"
	. . . . WRITE "&nbsp;"
	. . . ;
	. . . DO ZW2^WWWTAB
	. . . DO
	. . . . WRITE "<A"
	. . . . WRITE " TITLE="_""""_$$^WWWTEXT(374)_""""     ;DATENSATZ AUSWÄHLEN ;data record pick out 
	. . . . WRITE "HREF="_""""_YAKTION_"EP=WWWFORM&YFORM=INARTTV1&YKEY="_$PIECE($GET(YKEY),",",1)_","_VERSION_"&YFKEY="_$PIECE($GET(YKEY),",",1)
	. . . . NEW YKEY,YFKEY
	. . . . DO ^WWWCGI
	. . . . WRITE """"
	. . . . WRITE ">"
	. . . . WRITE $$^WWWDATE(DATUM),"&nbsp;"   ;GUELTIG AB
	. . . . WRITE "</A>"
	. . . . WRITE "&nbsp;"
	. . . ;
	. . . DO ZW2^WWWTAB
	. . . DO
	. . . . WRITE "<A"
	. . . . WRITE " TITLE="_""""_$$^WWWTEXT(374)_""""     ;DATENSATZ AUSWÄHLEN ;data record pick out 
	. . . . WRITE "HREF="_""""_YAKTION_"EP=WWWFORM&YFORM=INARTTV1&YKEY="_$PIECE($GET(YKEY),",",1)_","_VERSION_"&YFKEY="_$PIECE($GET(YKEY),",",1)
	. . . . NEW YKEY,YFKEY
	. . . . DO ^WWWCGI
	. . . . WRITE """"
	. . . . WRITE ">"
	. . . . IF VERSION=$PIECE(ART1,Y,203) WRITE $$^WWWTEXT(33414),"&nbsp;"   ;ARTIKEL ENTHÄLT DIESE VERSION 
	. . . . WRITE "</A>"
	. . . . WRITE "&nbsp;"
	. . . ;
	. . . DO ZW2^WWWTAB
	. . . DO
	. . . . WRITE "<A"
	. . . . WRITE " TITLE="_""""_$$^WWWTEXT(374)_""""     ;DATENSATZ AUSWÄHLEN ;data record pick out 
	. . . . WRITE "HREF="_""""_YAKTION_"EP=WWWFORM&YFORM=INARTTV1&YKEY="_$PIECE($GET(YKEY),",",1)_","_VERSION_"&YFKEY="_$PIECE($GET(YKEY),",",1)
	. . . . NEW YKEY,YFKEY
	. . . . DO ^WWWCGI
	. . . . WRITE """"
	. . . . WRITE ">"
	. . . . IF $PIECE(YFELD,Y,3)'="" WRITE $PIECE(YFELD,Y,3)," (",$PIECE($GET(^WWW013(0,$PIECE(YFELD,Y,3),1)),Y,1),")"   ;ERFASSUNGESMITARBEITERR
	. . . . WRITE "</A>"
	. . . . WRITE "&nbsp;"
	. . . ;
	. . . DO ZW2^WWWTAB
	. . . DO
	. . . . WRITE "<A"
	. . . . WRITE " TITLE="_""""_$$^WWWTEXT(374)_""""     ;DATENSATZ AUSWÄHLEN ;data record pick out 
	. . . . WRITE "HREF="_""""_YAKTION_"EP=WWWFORM&YFORM=INARTTV1&YKEY="_$PIECE($GET(YKEY),",",1)_","_VERSION_"&YFKEY="_$PIECE($GET(YKEY),",",1)
	. . . . NEW YKEY,YFKEY
	. . . . DO ^WWWCGI
	. . . . WRITE """"
	. . . . WRITE ">"
	. . . . WRITE $$^WWWDATE($PIECE(YFELD,Y,2)),"&nbsp;"   ;ERFASSUNGSDATUM
	. . . . WRITE "</A>"
	. . . . WRITE "&nbsp;"
	. . . ;
	. . . DO ZW2^WWWTAB
	. . . DO
	. . . . WRITE "<A"
	. . . . WRITE " TITLE="_""""_$$^WWWTEXT(374)_""""     ;DATENSATZ AUSWÄHLEN ;data record pick out 
	. . . . WRITE "HREF="_""""_YAKTION_"EP=WWWFORM&YFORM=INARTTV1&YKEY="_$PIECE($GET(YKEY),",",1)_","_VERSION_"&YFKEY="_$PIECE($GET(YKEY),",",1)
	. . . . NEW YKEY,YFKEY
	. . . . DO ^WWWCGI
	. . . . WRITE """"
	. . . . WRITE ">"
	. . . . IF $PIECE(YFELD,Y,5)'="" WRITE $PIECE(YFELD,Y,5)," (",$PIECE($GET(^WWW013(0,$PIECE(YFELD,Y,5),1)),Y,1),")"   ;ÄNDERUNGSMITARBEITER 
	. . . . WRITE "</A>"
	. . . . WRITE "&nbsp;"
	. . . ;
	. . . DO ZW2^WWWTAB
	. . . DO
	. . . . WRITE "<A"
	. . . . WRITE " TITLE="_""""_$$^WWWTEXT(374)_""""     ;DATENSATZ AUSWÄHLEN ;data record pick out 
	. . . . WRITE "HREF="_""""_YAKTION_"EP=WWWFORM&YFORM=INARTTV1&YKEY="_$PIECE($GET(YKEY),",",1)_","_VERSION_"&YFKEY="_$PIECE($GET(YKEY),",",1)
	. . . . NEW YKEY,YFKEY
	. . . . DO ^WWWCGI
	. . . . WRITE """"
	. . . . WRITE ">"
	. . . . WRITE $$^WWWDATE($PIECE(YFELD,Y,6)),"&nbsp;"   ;ÄNDERUNGSSDATUM
	. . . . WRITE "</A>"
	. . . . WRITE "&nbsp;"
	. . . ;
	. . . DO EF^WWWTAB
	. . . DO EL^WWWTAB
	. . . WRITE "</tr>"
	
	DO LEER^WWWTAB(5,7)    	;BEC;22840;28.07.03;LEERZEILEN EINGEFÜGT
	DO ^WWWFRAME(0)
	WRITE "<BR>"
	QUIT
]]></Routine>
</Export>