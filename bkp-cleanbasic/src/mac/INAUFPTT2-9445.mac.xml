<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="22" zv="CACHE" ts="2001-01-01 00:00:00">
<Routine name="INAUFPTT2" type="MAC" languagemode="0" timestamp="58440,0"><![CDATA[
INAUFPTT2
	;-------------------------------------------------------------------------------
	; Description of Function :
	;		ANZEIGE POSTIONSARTIKEL AUSWAHL FÜR TEILE/ SPEICHERN NEUE TEILE/EDIT TEILE
	;
	;		ANZEIGE DER ARTIKEL ZUR AUSWAHL ;Show the item Selection 
	;		DIE AUSWAHL DES ARTIKELS ERFOLGT, WENN EINE MENGE EINGETRAGEN WIRD
	;		WENN EINE MENGE AUSGEWÄHLT WURDE SPEICHERN DER ARTIKEL IN EINER TEILEPOSITION
	;		when one quantity select were Save the item within unit 
	; 
	; Inputs : 
	;
	;
	; ByRef :
	;
	;
	; Returns :
	;
	;
	; History :
	; 01-Jun-2006	GRF		Doco; dot level
	; 11.08.2004	FIS		26113
	; 23,07,2004	TYBD	26151
	; 07.07.2003	FIS		23867
	; 07.05.2002	TYBD
	; 11.11.2000	DT		Created
	;-------------------------------------------------------------------------------
	NEW YARTIKEL,NAME,ART,ANZM,SUCH,ART1,YVOR,YFKEY,AUF,AUFMG,YMNG,YTEIL,YTEIL1,Q,YTEILP,ARTIKEL,MENGE,YSTD,YARTIKEL1,PROENDE
	
	SET %("VAR","YKEY")=YKEY
	SET YAUFTRAG=$PIECE(YKEY,",",1)    	   QUIT:YAUFTRAG=""            ;KEIN AUFTRAG   ;no order 
	SET YPOSITION=$PIECE(YKEY,",",2)       QUIT:YPOSITION=""           ;KEINE POSITION ;no line no
	
	NEW YKEY
	
	SET YLIST      = $GET(YLIST)                               ;FUR LISTENKOPF
	SET YPOSITION1 = $GET(^INAUFP(YM,YAUFTRAG,YPOSITION,1))
	
	/*vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv DISABLED BLOCK START
	;IF $PIECE(YPOSITION1,Y,26)=2!($PIECE(YPOSITION1,Y,26)=4) DO  QUIT   ;KEINE TEILE
	;IF $PIECE(YPOSITION1,Y,26)=4 DO  QUIT   ;KEINE TEILE
	. WRITE YCR,"<BR>"_$PIECE($GET(^WWW101(0,"ARTIKEL-ART",SPRACHE,$PIECE(YPOSITION1,Y,26),1)),Y,1)_" "_$$^WWWTEXT(32112,,1)  ;ARTIKELART NICHT MÖGLICH ;Not potential 
	
	;IF $PIECE(YPOSITION1,Y,40)=2!($PIECE(YPOSITION1,Y,40)=3)!($PIECE(YPOSITION1,Y,40)=4)!($PIECE(YPOSITION1,Y,40)=5)!($PIECE(YPOSITION1,Y,40)=10)!($PIECE(YPOSITION1,Y,40)=11) DO  QUIT   ;KEINE TEILE
	. WRITE YCR,"<BR>"_$PIECE($GET(^WWW101(0,"EINHEIT",SPRACHE,$PIECE(YPOSITION1,Y,40),1)),Y,1)_" "_$$^WWWTEXT(32119,,1)  ;ARTIKELART NICHT MÖGLICH ;Not potential 
	;^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ DISABLED BLOCK END */
	
	KILL ^INAUFPTT1(YM)                                    ;LOSCHEN MÖGLICHER ALTEN WERTE
	KILL ^WWWDATEN(YM,+$HOROLOG,YUSER,YFORM,"LOCK",1)
	DO NEU
	DO SUCH
	SET YKEY=YAUFTRAG_","_YPOSITION
	DO ^INAUFPTT                                           ;TABELLE DER TEILE ANZEIGEN ;tabulation the display 
	QUIT
	
NEU ;NEUE POSITION  
	;ARTIKELAUSWAHL / ANLEGEN DER POSITIONEN ;put onto the 
	IF $GET(%(YQUERY,"ITEMS"))'="" DO  ;SONDERFELDER AUS WWW2 ;out of 
	. SET %(YQUERY,"YMNG"_$GET(%(YQUERY,"ITEMS")))=$GET(%(YQUERY,"ITEMSQ"))
	. SET %(YQUERY,"YMUL"_$GET(%(YQUERY,"ITEMS")))=$GET(%(YQUERY,"ITEMMULN"))
	. SET %(YQUERY,"YBEN"_$GET(%(YQUERY,"ITEMS")))=$GET(%(YQUERY,"ITEMBENN"))
	. SET %(YQUERY,"YBRT"_$GET(%(YQUERY,"ITEMS")))=$GET(%(YQUERY,"ITEMBRTN"))
	. SET %(YQUERY,"YLNG"_$GET(%(YQUERY,"ITEMS")))=$GET(%(YQUERY,"ITEMLNGN"))
	. SET %(YQUERY,"YHOE"_$GET(%(YQUERY,"ITEMS")))=$GET(%(YQUERY,"ITEMHOEN"))
	
	SET YPARA=$GET(%(YQUERY,"YPARA"))            ;TEILENUMMER
	FOR  QUIT:$EXTRACT(YPARA)'=","  SET YPARA=$EXTRACT(YPARA,2,99)  ;KOMMA HERAUSFILTERN ;comma 
	
	SET YMNG="YMNG"
	FOR  SET YMNG=$ORDER(%(YQUERY,YMNG)) QUIT:$EXTRACT(YMNG,1,4)'="YMNG"  DO   ;ALLE MENGENFELDER LESEN ;read 
	. NEW YFORM,YEINHEIT,YTEILP,YTEIL,DATEI,MENGE,ART,YARTIKEL1
	. SET YFORM="INAUFP"                         ;POSITIONEN
	. QUIT:$GET(%(YQUERY,YMNG))=""               ;KEINE MENGE EINGETRAGEN ;no quantity regd. 
	. ;
	. QUIT:YAUFTRAG=""  QUIT:YPOSITION=""
	. SET YAUF=YAUFTRAG
	. SET YPOS=YPOSITION
	. ;DATEI ORIGINAL ;data file 
	. SET DATEI="^INAUFPXL("_""""_YM_""""_","_""""_YAUFTRAG_""""_","_YPOSITION
	. FOR YI=1:1 QUIT:$PIECE(YPARA,",",YI)=""  SET DATEI=DATEI_","_$PIECE(YPARA,",",YI)  ;ZUSAMMENBAUEN TEILSTRING
	. SET DATEI=DATEI_",YTEIL)"
	. SET YTEIL=""
	. SET YTEIL=$ORDER(@DATEI,-1)+1
	. IF YTEIL="" SET YTEIL=1
	. ;
	. ;ACHTUNG HIER PRÜFUNG AUF DOPPELERFASSUNG DURCH RELOAD EINBAUEN ;estimation here is quiz upon trans- 
	. ;
	. SET MENGE=$$^WWWTR(1,8,$GET(%(YQUERY,YMNG)))  ;26151;TYBD;23,7,2004;MENGE
	. QUIT:+MENGE=0
	. SET ART=$EXTRACT(YMNG,5,99)                ;ARTIKELNUMMER BESTANDTEIL DER YMNG VARIABEL ;ingredient the 
	. QUIT:ART=""
	. QUIT:'$DATA(^INART(YM,ART,1))              ;ARTIKEL NICHT VORHANDEN ;item Not on hand 
	. SET YARTIKEL1=$GET(^INART(YM,ART,1))       ;ARTIKELDATEN
	. ;
	. MERGE @DATEI=^INARTXL(YM,ART)              ;KOPIEREN DES ARTIKELTEILEBAU
	. ;
	. SET YTEIL1=$GET(^INARTXL(YM,ART))          ;HAUPTUNTERTEIL
	. IF YTEIL1="" DO
	. . NEW YI
	. . ;DATEN AUS ARTIKEL ÜBERTRAGEN ;out of item transport
	. . FOR YI=2,3,10,14,15,16,17,26,30,31,32,33,36,37,38,40,41,42,43,44,45,47,48,49,50,53,54,55,57,58,59,62,66,68,70,71,72,73,74,75,126,130,131,132,134,136,158,166,171,172,174,191,192 SET $PIECE(YTEIL1,Y,YI)=$PIECE(YARTIKEL1,Y,YI)
	. ;
	. ;ERRECHNEN TEIL MIT MENGEN ;part by means of shuffle 
	. SET $PIECE(YTEIL1,Y,5)  = +MENGE
	. SET $PIECE(YTEIL1,Y,4)  = ART                       ;NEUE TEILEARTIKELNUMMER
	. SET $PIECE(YTEIL1,Y,1)  =  $PIECE(YARTIKEL1,Y,1)    ;BESCHREIBUNG ;description 
	. SET $PIECE(YTEIL1,Y,40) = +$PIECE(YARTIKEL1,Y,40)   ;EINHEIT ;unit
	. IF $PIECE(YTEIL1,Y,40)=0 SET $PIECE(YTEIL1,Y,40)=1
	. SET YEINHEIT=$PIECE(YTEIL1,Y,40)
	. ;IF YEINHEIT'=11 IF YEINHEIT'=2 IF YEINHEIT'=10 SET $PIECE(YTEIL1,Y,70)=$$^INARTRUEST(ART)+($$^INARTDAUER(ART)*MENGE)  ;RUEST +(MENGE * DAUER)
	. IF YEINHEIT'=11 IF YEINHEIT'=2 IF YEINHEIT'=10 SET $PIECE(YTEIL1,Y,70)=($$^INARTDAUER(ART)*MENGE)  ;RUEST +(MENGE * DAUER)
	. ;SET $PIECE(YTEIL1,Y,15)=+$TR($GET(%(YQUERY,"YLNG"_ART)),",",".")  ;LÄNGE
	. ;SET $PIECE(YTEIL1,Y,16)=+$TR($GET(%(YQUERY,"YBRT"_ART)),",",".")  ;BREITE
	. ;SET $PIECE(YTEIL1,Y,17)=+$TR($GET(%(YQUERY,"YHOE"_ART)),",",".")  ;HOEHE
	. SET $PIECE(YTEIL1,Y,15)=$$^WWWTR(1,8,$GET(%(YQUERY,"YLNG"_ART)))   ;LÄNGE   ;26151;TYBD;23,7,2004
	. SET $PIECE(YTEIL1,Y,16)=$$^WWWTR(1,8,$GET(%(YQUERY,"YBRT"_ART)))   ;BREITE  ;26151;TYBD;23,7,2004
	. SET $PIECE(YTEIL1,Y,17)=$$^WWWTR(1,8,$GET(%(YQUERY,"YHOE"_ART)))   ;HOEHE   ;26151;TYBD;23,7,2004
	. IF $GET(%(YQUERY,"YBEN"_ART))'="" DO
	. . SET $PIECE(YTEIL1,Y,1)=$GET(%(YQUERY,"YBEN"_ART))_" "_$PIECE(YTEIL1,Y,1)  ;BENENNUNG
	. ;
	. SET MULTIPLE=+$GET(%(YQUERY,"YMUL"_ART))                           ;ANZAHL DER TEILE ;Number the 
	. SET $PIECE(YTEIL1,Y,43)=$$^INGEWICHTT(ART,MENGE,$PIECE(YTEIL1,Y,15),$PIECE(YTEIL1,Y,16),$PIECE(YTEIL1,Y,17))  ;MENGE*GEWICHT
	. ;
	. ;ZEICHNUNGSNUMMER WENN KEINE DAUER ;when no time 
	. SET YTEILP=YTEIL
	. IF YTEILP'="" DO
	. . NEW YBIG,YTEIL
	. . SET YBIG=""
	. . SET YTEIL=""
	. . FOR  SET YTEIL=$ORDER(@DATEI) QUIT:YTEIL=""  DO 
	. . . IF $PIECE($GET(@DATEI),Y,18)>YBIG SET YBIG=$PIECE($GET(@DATEI),Y,18)
	. . ;
	. . SET YTEILP=YBIG+1
	. ;
	. IF YEINHEIT=2!(YEINHEIT=10)!(YEINHEIT=11) SET YTEILP=""
	. SET $PIECE(YTEIL1,Y,18)=YTEILP
	. ;
	. ;ZEITEN ERRECHNEN
	. IF YEINHEIT=2 DO  ;STUNDEN = DAUER ;Hours 
	. . NEW YSTD
	. . SET YSTD=$GET(%(YQUERY,YMNG))
	. . SET $PIECE(YTEIL1,Y,5)=""  ;LÖSCHEN MENGE ;Delete quantity 
	. . IF $FIND(YSTD,":") SET $PIECE(YTEIL1,Y,45)=($PIECE(YSTD,":",1)*60*60)+($PIECE(YSTD,":",2)*60)+$PIECE(YSTD,":",3) SET YSTD=""  ;STUNDEN MINUTEN SEKUNDEN ;procrastinate 
	. . IF $FIND(YSTD,",") SET $PIECE(YTEIL1,Y,45)=($PIECE(YSTD,",",1)*60*60)+(60*60*("."_$PIECE(YSTD,",",2))) SET YSTD=""  ;STUNDEN MIT KOMMA ;procrastinate by means of comma 
	. . IF $FIND(YSTD,".") SET $PIECE(YTEIL1,Y,45)=($PIECE(YSTD,".",1)*60*60)+(60*60*("."_$PIECE(YSTD,".",2))) SET YSTD=""  ;STUNDEN MIT PUNKT ;procrastinate by means of point 
	. . IF +YSTD'=0 SET $PIECE(YTEIL1,Y,45)=(YSTD*60*60)  ;VOLLE STUNDEN  ;procrastinate 
	. ;
	. IF YEINHEIT=10 DO  ;MINUTEN = DAUER ;Minutes
	. . NEW YSTD
	. . SET YSTD=$GET(%(YQUERY,YMNG))
	. . SET $PIECE(YTEIL1,Y,5)=""  ;LÖSCHEN MENGE ;Delete quantity 
	. . IF $FIND(YSTD,":") SET $PIECE(YTEIL1,Y,45)=($PIECE(YSTD,":",1)*60*60)+($PIECE(YSTD,":",2)*60)+$PIECE(YSTD,":",3) SET YSTD="" ;STUNDEN MINUTEN SEKUNDEN ;procrastinate 
	. . IF $FIND(YSTD,",") SET $PIECE(YTEIL1,Y,45)=($PIECE(YSTD,",",1)*60)+(60*("."_$PIECE(YSTD,",",2))) SET YSTD=""  ;MINUTEN MIT KOMMA ;by means of comma 
	. . IF $FIND(YSTD,".") SET $PIECE(YTEIL1,Y,45)=($PIECE(YSTD,".",1)*60)+(60*("."_$PIECE(YSTD,".",2))) SET YSTD=""  ;MINUTEN MIT PUNKT ;by means of point 
	. . IF +YSTD'=0 SET $PIECE(YTEIL1,Y,45)=(YSTD*60)  ;VOLLE MINUTEN
	. ;
	. IF YEINHEIT=11 DO  ;INDUSTRIE MINUTEN = DAUER ;industry Minutes
	. . NEW YSTD
	. . SET YSTD=$GET(%(YQUERY,YMNG))
	. . SET $PIECE(YTEIL1,Y,5)=""  ;LÖSCHEN MENGE ;Delete quantity 
	. . IF +YSTD'=0 SET $PIECE(YTEIL1,Y,45)=(YSTD*60/100*60)  ;VOLLE INDUSTIEMINUTEN 
	. ;
	. SET $PIECE(YTEIL1,Y,70)=$$^INARTRUEST(ART)*$$^INPROLOS(ART,MENGE)  ;RUESTZEIT
	. ;
	. IF $DATA(^INARTT(YM,ART)) SET $PIECE(YTEIL1,Y,45)=$$^INARTDAUERT(ART,$PIECE(YTEIL1,Y,5))   ;ERRECHNEN DAUER AUS TEILEN * MENGE ;permanence out of quantity 
	. IF $DATA(^INARTT(YM,ART)) SET $PIECE(YTEIL1,Y,43)=$$^INGEWICHTT(ART,$PIECE(YTEIL1,Y,5),$PIECE(YTEIL1,Y,15),$PIECE(YTEIL1,Y,16),$PIECE(YTEIL1,Y,17))  ;GEWICHT AUS TEILEN * MENGE ;wt. out of quantity 
	. IF +$PIECE(YTEIL1,Y,43)=0 SET $PIECE(YTEIL1,Y,43)=""  ;GEWICHT ;wt. 
	. SET $PIECE(YTEIL1,Y,47)=$$^INARTKOSTT(ART,$PIECE(YTEIL1,Y,5),$PIECE(YTEIL1,Y,45),$PIECE(YTEIL,Y,43))  ;PREISERRECHNEN INKL VERSCHNITT
	. ;
	. IF $PIECE(YTEIL1,Y,40)'=2 IF $PIECE(YTEIL1,Y,40)'=11 IF $PIECE(YTEIL1,Y,40)'=10 SET $PIECE(YTEIL1,Y,9)=""  ;DAUER LÖSCHEN WENN KEINE ZEIT ;permanence Delete when no time 
	. IF +$PIECE(YTEIL1,Y,43)=0 SET $PIECE(YTEIL1,Y,43)=""  ;GEWICHT=""
	. SET $PIECE(YTEIL1,Y,22)=$HOROLOG                      ;ERFASST
	. SET $PIECE(YTEIL1,Y,23)=YBED                          ;ERFASST
	. ;
	. SET @DATEI=YTEIL1                ;SPEICHERN HAUPTUNTERTEIL MIT MENGEN ;Save by means of shuffle 
	. IF $GET(MULTIPLE)>1 SET:MULTIPLE>300 MULTIPLE=300 FOR YMULTI=2:1:MULTIPLE DO  ;ANLAGE VON MEHREREN MENGEN ;layout shuffle 
	. . SET YTEIL=YTEIL+1              ;NÄCHSTE POSITIONSNUMMER ;next 
	. . MERGE @DATEI=^INARTXL(YM,ART)  ;KOPIEREN DES ARTIKELTEILEBAU
	. . SET @DATEI=YTEIL1              ;SPEICHERN NEXT ARTIKELTEIL  ;Save 
	. ;
	. DO ^INAUFPXLDEL  ;LÖSCHEN UNTERTEILE VON BESTELLWARE;FIS;27.03.03;23327
	. ;
	. DO NEU^INAUFPTT  ;TEILESTRUKTUR AUFBAUEN FÜR EDIT ;construct to 
	. ;
	. IF $PIECE($GET(^INVORG(YM,YM,1)),Y,70)=1 DO  ;ERSTELLEN BEDARF FÜR PRODUKTION IM DRP ;to production DRP 
	. . DO START^INDRPPRODU(YAUF,YPOS)
	. ;
	. ;PRODUKTION BEREITS ABGESCHLOSSEN / BESTAND NACHTRÄGLICH KORRIGIEREN / WH AUF LAGER SETZTEN ;FIS, 14.06.02
	. IF $DATA(%(YQUERY,"YBEKOR"_ART))!($DATA(%(YQUERY,"YWHLAG"_ART))) DO
	. . NEW PROMENGE,YEK,TEILEKEY,MENGE,YI,BUCH,REST,HAL,YMULTI,YTEILX
	. . SET YMULTI=0
	. . SET YTEILX=YTEIL
	. . DO:MULTIPLE'>1  IF MULTIPLE>1 FOR YMULTI=0:1:MULTIPLE-1  DO
	. . . SET YTEIL=(YTEILX-YMULTI)
	. . . SET TEILEKEY=YPARA_","_YTEIL
	. . . FOR  QUIT:$EXTRACT(TEILEKEY)'=","  SET TEILEKEY=$EXTRACT(TEILEKEY,2,99)  ;KOMMA HERAUSFILTER ;comma 
	. . . SET PROMENGE=$PIECE(@DATEI,Y,39)  ;PRODUKTIONSMENGE
	. . . ;
	. . . ;BESTANDSKORREKTUR
	. . . IF $GET(%(YQUERY,"YBEKOR"_ART))=1 IF +PROMENGE'=0 DO
	. . . . SET HAL=$PIECE($GET(^INVORGB(YM,YM,YLOCATION,1)),Y,1)  ;PRODUKTIONSLAGER
	. . . . LOCK +^INBUCHLOCK(YM,YAUF,YPOS):20  ;AUFTRAG FÜR BEARBEITUNG ANDERER BESTANDSBUCHUNGEN SPERREN;02.02.04;FIS;24941
	. . . . SET BUCH=$$^INARTMINUS(YAUF,YPOS,ART,PROMENGE,,HAL,2,2,TEILEKEY,1)  ;BESTAND BUCHEN (AUS FERTIGUNG ABER OHNE FERTIGUNGSNUMMER) ;yet without 
	. . . . SET REST=$PIECE(BUCH,"*",1)  ;RESTMENGE
	. . . . IF +REST'=0 SET BUCH=$$^INARTMINUS(YAUF,YPOS,ART,REST,,,2,1,TEILEKEY,1,,1)  ;BESTAND NACHBUCHEN 
	. . . . SET YEK=$PIECE(BUCH,"*",2)  ;EK-PREIS
	. . . . LOCK -^INBUCHLOCK(YM,YAUF,YPOS)  ;SPERRE AUFHEBEN;02.02.04;FIS;24941
	. . . . QUIT:+YEK=0  ;ÜBERTRAGEN EK AUS WE NACH ARTIKELTEIL ;transport Planned Cost out of In within 
	. . . . SET MENGE=+$PIECE(@DATEI,Y,5)
	. . . . IF MENGE=0 SET MENGE=1
	. . . . SET VERSCHNITT=$PIECE($GET(^INVORG(YM,YM,1)),Y,10)  ;VERSCHNITT IN % ;within 
	. . . . IF +VERSCHNITT'=0 SET MENGE=MENGE+(MENGE/100*VERSCHNITT)
	. . . . SET $PIECE(@DATEI,Y,250) = $PIECE(@DATEI,Y,47)  ;SPEICHERN EK AUS VORKALKULATION ;Save Planned Cost out of preliminary costing 
	. . . . SET $PIECE(@DATEI,Y,47)  = YEK*MENGE            ;SPEICHERN TATSÄCHLICHER EK ;Save Planned Cost 
	. . . . SET $PIECE(@DATEI,Y,244) = +$HOROLOG            ;SPEICHERN BUCHUNGSDATUM  (DIENT AUCH ZUR KONTROLLE IN INAUFPTT = KEIN NEURECHNEN DES EK) ;Save too within no 
	. . . . FOR YI=47,250,244  SET $PIECE(^INAUFPT(YM,YAUF,YPOS,$TRANSLATE(TEILEKEY,",",".")_".",1),Y,YI)=$PIECE(@DATEI,Y,YI)  ;ÜBERTRAGEN NACH INAUFPTT ;transport within 
	. . . . IF $PIECE($GET(^INAUFP(YM,YAUF,YPOS,1)),Y,90)=1 SET ^INAUFKALKNEU(YM,YAUF,YPOS,1)=""  ;SPEICHERN FÜR ERNEUTE NACHKALKULATION ;Save to statistical cost accounting 
	. . . ;
	. . . ;FESTLEGEN WH AUF LAGERBESTAND ;upon 
	. . . IF $GET(%(YQUERY,"YWHLAG"_ART))=1 DO
	. . . . NEW YFELD,YKEY
	. . . . SET YKEY=YAUF_","_YPOS_","_$TRANSLATE(TEILEKEY,",",".")_"."
	. . . . SET $PIECE(@DATEI,Y,7)=2
	. . . . SET $PIECE(^INAUFPT(YM,YAUF,YPOS,$PIECE(YKEY,",",3),1),Y,7)=2
	. . . . SET YFELD=$GET(^INAUFPT(YM,YAUF,YPOS,$PIECE(YKEY,",",3),1))
	. . . . DO ^INAUFPT
	. . ;
	. . SET YTEIL=YTEILX
	
	QUIT
	
SUCH ;ANZEIGEN NACH SUCHVORGABE ;display within 
	SET VORG(1)=$EXTRACT(YAUSWAHL,2,99)   ;SUCHVORGABE VOLLTEXT ODER NUMMER ;full text Or numeral 
	QUIT:VORG(1)=""                       ;KEINE AUSWAHL ;no Selection 
	
	SET YDDSATZ=0                         ;VARIABELE ZUR HELL DUNKELSCHALTUNG ;bright 
	
	IF $FIND(VORG(1),"=") DO  SET VORG(1)="" QUIT  ;SONDERFUNKTION LÖSCHEN UND MOVE ;Delete And 
	. SET VORG(1)=$TRANSLATE(VORG(1),"()"_"""")
	. IF +$PIECE(VORG(1),"=",1)=0!(+$PIECE(VORG(1),"=",2)=0) IF $PIECE(VORG(1),"=",2)'="x" IF $PIECE(VORG(1),"=",2)'="X"  DO  QUIT
	. . WRITE "<script language="_""""_"JavaScript"_""""_">alert('"_$$^WWWTEXT(32292,,1)_"');</script>"  ;BITTE PRÜFEN
	. ;
	. NEW PRUEF,YQ,FERT
	. SET PRUEF="^INAUFPXL("_""""_YM_""""_","_""""_YAUFTRAG_""""_","_YPOSITION
	. IF $GET(YPARA)'="" SET PRUEF=PRUEF_","_YPARA
	. SET PRUEF(0)=PRUEF
	. SET PRUEF=PRUEF_")"
	. SET YQ=0
	. IF $DATA(@PRUEF) IF $PIECE(@PRUEF,Y,165)'="" SET FERT=$PIECE(@PRUEF,Y,165) DO  QUIT:YQ=1  ;NICHT WENN BEREITS GEFERTIGT ;Not when yet 
	. . IF +$PIECE($GET(^INAUFP(YM,YAUFTRAG,YPOSITION,1)),Y,90)=1 SET YQ=1 QUIT  ;PRODUKTION-ABGESCHLOSSEN=BESTAND KORRIGIERT
	. . IF $PIECE($GET(^INPROSTEMP1(YM,FERT,1)),Y,22)'="" SET YQ=1 QUIT  ;LAGERBUCHUNG DES OBERTEILS BEREITS ERFOLGT ;yet 
	. . IF $PIECE($GET(^INPROSTEMP(YM,FERT,1)),Y,22)'="" SET YQ=1 QUIT  ;LAGERBUCHUNG DES OBERTEILS BEREITS ERFOLGT ;yet 
	. . IF $PIECE($GET(@PRUEF),Y,244)'="" SET YQ=1 QUIT  ;LAGERBUCHUNG DES OBERTEILS BEREITS ERFOLGT ;yet 
	. . IF YQ=0 WRITE "<script language="_""""_"JavaScript"_""""_">alert('"_$$^WWWTEXT(33568,,1)_"');</script>"  ;F.-ANWEISUNG BEREITS GEDRUCKT
	. ;
	. IF $TRANSLATE($PIECE(VORG(1),"=",2),"x","X")="X" DO  ;LOESCHEN
	. . NEW YPARA1,TLFN,YPARA2
	. . SET YPARA2=YPARA_","
	. . SET YSONDERFUNKTION=1
	. . SET TLFN=$PIECE(VORG(1),"=",1) 
	. . SET TLFN(1)=$PIECE(TLFN,"-",1)
	. . SET TLFN(2)=$PIECE(TLFN,"-",2)
	. . IF TLFN(2)="" SET TLFN(2)=TLFN(1)
	. . FOR TLFN(3)=TLFN(1):1:TLFN(2) DO   ;LÖSCHEN EINZELNE FELDER ;Delete
	. . . SET %(YQUERY,"YFUNCT1")="KILL"   ;FUNKTION (UP DOWN KILL)
	. . . SET %(YQUERY,"YPARA1")=YAUFTRAG_","_YPOSITION_","_YPARA2_TLFN(3)
	. . . DO PROC^INAUFPTT                 ;LÖSCHEN DATEN ;Delete 
	. ;
	. IF $TRANSLATE($PIECE(VORG(1),"=",2),"x","X")'="X" DO  ;BEWEGEN ;stir 
	. . NEW YPARA1,TLFN,YPARA2
	. . SET YPARA2=YPARA_","
	. . SET YSONDERFUNKTION=1
	. . SET TLFN(1)=+$PIECE(VORG(1),"=",1) 
	. . SET TLFN(2)=+$PIECE(VORG(1),"=",2) 
	. . SET TLFN(3)=TLFN(1)-TLFN(2)
	. . IF $PIECE($GET(@(PRUEF(0)_","_TLFN(1)_")")),Y,165)'="" WRITE "<script language="_""""_"JavaScript"_""""_">alert('"_$$^WWWTEXT(33568,,1)_"');</script>" QUIT  ;FIS;02.11.04;26453;FERTIGUNGSANWEISUNG BEREITS GEDRUCKT
	. . IF TLFN(3)>0 DO  QUIT   ;UP
	. . . FOR TLFN(4)=TLFN(1):-1:TLFN(2)+1 DO   ;SCHIEBEN FELDER ;shove 
	. . . . SET %(YQUERY,"YFUNCT1")="UP"        ;FUNKTION (UP DOWN KILL)
	. . . . SET %(YQUERY,"YPARA1")=YAUFTRAG_","_YPOSITION_","_YPARA2_TLFN(4)
	. . . . DO PROC^INAUFPTT                    ; DATEN SCHIEBEN ;shove 
	. . ;
	. . IF TLFN(3)<0 DO  QUIT   ;DOWN
	. . . FOR TLFN(4)=TLFN(1):1:TLFN(2)-1 DO   ;SCHIEBEN FELDER ;shove 
	. . . . SET %(YQUERY,"YFUNCT1")="DOWN"  ;FUNKTION (UP DOWN KILL)
	. . . . SET %(YQUERY,"YPARA1")=YAUFTRAG_","_YPOSITION_","_YPARA2_TLFN(4)
	. . . . DO PROC^INAUFPTT  ; DATEN SCHIEBEN ;shove 
	. ;
	. SET %(YQUERY,"YFUNCT1")=""  ;FUNKTION (UP DOWN KILL)
	. SET %(YQUERY,"YPARA1")=""
	
	WRITE YCR
	
	IF VORG(1)'=""               WRITE "&nbsp;"_$$^WWWTEXT(148)_": "_VORG(1)   ;SUCHE NACH
	IF $PIECE(YPOSITION1,Y,26)=2 WRITE " ("_$$^WWWTEXT(32992)_")"
	
	KILL ^WWWSOR(YUSER,"ARTIKEL")
	
	;KOPF ZEILE ;Heading
	DO ^WWWFRAME(0)  ;TABLE AN  ;upon 
	WRITE YCR
	WRITE "<TH VALIGN=TOP NOWRAP VALIGN=TOP align=LEFT ALIGN=LEFT WIDTH=10%"
	WRITE " BGCOLOR="_YDARKGRAY
	WRITE ">"
	WRITE "<FONT SIZE=2>"
	WRITE $$^WWWTEXT(32025)  ;MENGE MENGENEINHEIT ;quantity 
	WRITE "</TH>"
	
	WRITE "<TH VALIGN=TOP NOWRAP VALIGN=TOP align=LEFT ALIGN=LEFT WIDTH=10%"
	WRITE " BGCOLOR="_YDARKGRAY
	WRITE ">"
	WRITE "<FONT SIZE=2>"
	WRITE $$^WWWTEXT(32024)  ;ARTIKEL ;item 
	WRITE "</TH>"
	
	WRITE "<TH VALIGN=TOP NOWRAP VALIGN=TOP align=LEFT ALIGN=LEFT WIDTH=30%"
	WRITE " BGCOLOR="_YDARKGRAY
	WRITE ">"
	WRITE "<FONT SIZE=2>"
	WRITE $$^WWWTEXT(32026)  ;BEZEICHNUNG ;notation 
	WRITE "</TH>"
	
	WRITE "<TH VALIGN=TOP NOWRAP VALIGN=TOP align=LEFT ALIGN=LEFT WIDTH=10%"
	WRITE " BGCOLOR="_YDARKGRAY
	WRITE ">"
	WRITE "<FONT SIZE=2>"
	WRITE $$^WWWTEXT(32020)  ;BESTAND
	WRITE "</TH>"
	
	WRITE "<TH VALIGN=TOP NOWRAP VALIGN=TOP align=LEFT ALIGN=LEFT WIDTH=10%"
	WRITE " BGCOLOR="_YDARKGRAY
	WRITE ">"
	WRITE "<FONT SIZE=2>"
	WRITE $$^WWWTEXT(31409)_" ("_$$^WWWTEXT(32980)_")"  ;EINZEL-PREIS (EK)
	WRITE "</TH>"
	
	WRITE "<TH VALIGN=TOP NOWRAP VALIGN=TOP align=LEFT ALIGN=LEFT WIDTH=30%"
	WRITE " BGCOLOR="_YDARKGRAY
	WRITE ">"
	WRITE "<FONT SIZE=2>"
	WRITE $$^WWWTEXT(32027)  ;AUSFÜHRUNG ;execution 
	WRITE "</TH>"
	
	WRITE "</TR>",YCR
	
	SET ANZM=0
	
	IF $PIECE($GET(^INVORG(YM,YM,1)),Y,212)'=1 DO  ;TYBD;SERACH IN BITMAPS;15,3,2005;27167
	. ;STRATEGIE 1 ARTIKELNUMMER ;strategy 
	. IF $EXTRACT(VORG(1))'="*" IF VORG(1)'="" IF $DATA(^INART(YM,VORG(1))) SET ART=VORG(1) DO
	. . SET ART1=$GET(^INART(YM,ART,1)) DO ANZ
	. ;
	. ;STRATEGIE 2 BEZEICHNUNG GENAU ;strategy notation truly 
	. IF ANZM<10 IF VORG(1)'="" IF $EXTRACT(VORG(1))'="*" SET NAME=$$^WWWUMLAU(VORG(1),1) IF $DATA(^INARTs(YM,1,NAME)) DO
	. . SET ART=""
	. . FOR  SET ART=$ORDER(^INARTs(YM,1,NAME,ART)) QUIT:ART=""  DO  QUIT:ANZM>50
	. . . SET ART1=$GET(^INART(YM,ART,1))
	. . . DO ANZ
	. ;
	. ;STRATEGIE 3 BEZEICHNUNG UNGENAU ;strategy notation inexact 
	. IF ANZM<10 IF VORG(1)'="" IF $EXTRACT(VORG(1))'="*" SET NAME=$$^WWWUMLAU(VORG(1),1) FOR  SET NAME=$ORDER(^INARTs(YM,1,NAME)) QUIT:NAME=""  QUIT:'$FIND(NAME,$$^WWWUMLAU(VORG(1),1))  DO  QUIT:ANZM>50
	. . SET ART=""
	. . FOR  SET ART=$ORDER(^INARTs(YM,1,NAME,ART)) QUIT:ART=""  DO  QUIT:ANZM>50
	. . . SET ART1=$GET(^INART(YM,ART,1))
	. . . DO ANZ
	. ;
	. ;STRATEGIE 4 SUCHEN ARTIKELNUMMERN ;strategy seek 
	. IF ANZM<10 IF +VORG(1)'=0 FOR I=0:1:4 DO  QUIT:ANZM>50
	. . SET ART=VORG(1)_$EXTRACT("00000000",1,I)
	. . IF ART'=VORG(1) IF $DATA(^INART(YM,ART,1)) SET ART1=$GET(^INART(YM,ART,1)) DO ANZ
	. . FOR  SET ART=$ORDER(^INART(YM,ART)) QUIT:ART=""  QUIT:'$FIND(ART,VORG(1))  DO  QUIT:ANZM>50
	. . . SET ART1=$GET(^INART(YM,ART,1))
	. . . IF VORG(1)'=ART DO ANZ QUIT
	. ;
	. ;STRATEGIE 4 SUCHEN ARTIKELNUMMERN ;strategy seek 
	. IF ANZM<10 IF +VORG(1)'=0 FOR I=1 DO  QUIT:ANZM>50
	. . SET ART=VORG(1)_$EXTRACT("    ",1,I)
	. . IF ART'=VORG(1) IF $DATA(^INART(YM,ART,1)) SET ART1=$GET(^INART(YM,ART,1)) DO ANZ
	. . FOR  SET ART=$ORDER(^INART(YM,ART)) QUIT:ART=""  QUIT:'$FIND(ART,VORG(1))  DO  QUIT:ANZM>50
	. . . SET ART1=$GET(^INART(YM,ART,1))
	. . . IF VORG(1)'=ART DO ANZ
	. ;
	. ;STRATEGIE 4 SUCHEN VOLLTEXT MODELL ;strategy seek full text 
	. IF ANZM=0 IF VORG(1)'="" IF $EXTRACT(VORG(1))'="*" SET NAME="" FOR  SET NAME=$ORDER(^INARTs(YM,1,NAME)) QUIT:NAME=""  IF $FIND(NAME,$$^WWWUMLAU(VORG(1),1)) DO  QUIT:ANZM>50
	. . SET ART=""
	. . FOR  SET ART=$ORDER(^INARTs(YM,1,NAME,ART)) QUIT:ART=""  DO  QUIT:ANZM>50
	. . . SET ART1=$GET(^INART(YM,ART,1))
	. . . DO ANZ
	. ;
	. ;STRATEGIE 4 SUCHEN VOLLTEXT ARTIKEL ;strategy seek full text item 
	. IF ANZM=0 IF $EXTRACT(VORG(1))="*" SET VORG(1)=$$^WWWUMLAU($EXTRACT(VORG(1),2,99),1) SET NAME="" FOR  SET NAME=$ORDER(^INARTs(YM,1,NAME)) QUIT:NAME=""  DO  QUIT:ANZM>50
	. . SET ART=""
	. . FOR  SET ART=$ORDER(^INARTs(YM,1,NAME,ART)) QUIT:ART=""  DO  QUIT:ANZM>50
	. . . SET ART1=$GET(^INART(YM,ART,1))
	. . . IF VORG(1)'="" IF $FIND($$^WWWUMLAU(ART1_Y_ART,1),VORG(1)) DO ANZ QUIT
	. . . IF VORG(1)="" DO ANZ
	
	;BITMAPSUCHE
	IF $PIECE($GET(^INVORG(YM,YM,1)),Y,212)=1 DO  ;TYBD;SERACH IN BITMAPS;15,3,2005;27167
	. NEW YFORM,YOK,SEL
	. SET YFORM="INART"
	. KILL ^WWWSOR(YUSER,"KEY")
	. KILL ^WWWSOR(YUSER,"SEL")
	. SET YOK=$$^WWWBITSEARCH(VORG(1),"INART")
	. SET ART=""
	. FOR  SET ART=$ORDER(^WWWSOR(YUSER,"SEL",ART)) QUIT:ART=""  DO  QUIT:ANZM>50    ;BITSUCHE
	. . SET ART1=$GET(^INART(YM,ART,1))
	. . DO ANZ
	. ;
	. KILL ^WWWSOR(YUSER,"KEY")
	. KILL ^WWWSOR(YUSER,"SEL")
	
	;STRATEGIE 7 SUCHEN ALTERNATIVE ARTIKELSUCHE ;strategy seek option 
	IF ANZM=0 DO    ;TYBD;25563;17,4,2004
	. SET ART=""
	. FOR  SET ART=$ORDER(^INARTXCHs(YM,1,$$^WWWUMLAU(VORG(1),1),ART)) QUIT:ART=""  DO  QUIT:ANZM>50    ;SSOK
	. . SET ART1=$GET(^INART(YM,ART,1))
	. . DO ANZ
	
	IF ANZM=0 DO   ;KEIN DATENYTEIL1 GEFUNDEN ;no 
	. WRITE "<TR>"
	. SET YDDSATZ=YDDSATZ+1
	. WRITE "<TD NOWRAP VALIGN=TOP"
	. IF YDDSATZ#2=1 WRITE " BGCOLOR="_YWHITE
	. WRITE ">"
	. WRITE "<FONT SIZE=2>"
	. WRITE "&nbsp;"
	. WRITE "</TD>"
	. ;
	. WRITE "<TD NOWRAP VALIGN=TOP"
	. IF YDDSATZ#2=1 WRITE " BGCOLOR="_YWHITE
	. WRITE ">"
	. WRITE "<FONT SIZE=2>"
	. WRITE "&nbsp;"
	. WRITE "</TD>"
	. ;
	. WRITE "<TD NOWRAP VALIGN=TOP"
	. IF YDDSATZ#2=1 WRITE " BGCOLOR="_YWHITE
	. WRITE ">"
	. WRITE "<FONT SIZE=2>"
	. WRITE "&nbsp;"
	. WRITE "</TD>"
	. ;
	. WRITE "<TD NOWRAP VALIGN=TOP"
	. IF YDDSATZ#2=1 WRITE " BGCOLOR="_YWHITE
	. WRITE ">"
	. WRITE "<FONT SIZE=2>"
	. WRITE "&nbsp;"
	. WRITE "</TD>"
	. ;
	. WRITE "<TD NOWRAP VALIGN=TOP"
	. IF YDDSATZ#2=1 WRITE " BGCOLOR="_YWHITE
	. WRITE ">"
	. WRITE "<FONT SIZE=2>"
	. WRITE "&nbsp;"
	. WRITE "</TD>"
	. ;
	. WRITE "<TD NOWRAP VALIGN=TOP"
	. IF YDDSATZ#2=1 WRITE " BGCOLOR="_YWHITE
	. WRITE ">"
	. WRITE "<FONT SIZE=2>"
	. WRITE "&nbsp;"
	. WRITE "</TD>"
	. WRITE YCR,"</TR>"
	
	DO ^WWWFRAME(1)   ;TABLE AUS ;out of 
	WRITE YCR
	WRITE "<BR>"
	IF ANZM>49 WRITE "<B>",$$^WWWTEXT(32111),"</B>"  ;Weitere Artikel vorhanden.... Suche einschränken!
	KILL ^WWWSOR(YUSER,"ARTIKEL")
	QUIT
	
ANZ ;
	;anzeige suchergebnis auswahl der Menge ;Selection who Quantity 
	NEW DIMENS,DOPPEL,FERTDRUCK
	
	SET DIMENS=0   ;DIMENSIONEN
	IF +$PIECE(ART1,Y,26)=0!($PIECE(ART1,Y,26)=2)!($PIECE(ART1,Y,26)=3)!($PIECE(ART1,Y,26)=1) DO   ;NUR WENN BESTELL ODER EIGENFERTIGUNG ;only when Or 
	. ;IF $PIECE(ART1,Y,37)="" IF $PIECE(ART1,Y,172)="" QUIT  ;KEIN MATERIAL
	. QUIT:ART'=$TRANSLATE(ART,",.-#;:_'+*´?=!§%&/()=[]{}²³@|><"_"""")
	. IF $PIECE(ART1,Y,40)'=5 IF $PIECE(ART1,Y,40)'=6 IF $PIECE(ART1,Y,40)'=12 IF $PIECE(ART1,Y,40)'=15 IF $PIECE(ART1,Y,40)'=4 QUIT  ;FALSCHE EINHEIT ;unit 
	. SET DIMENS=1  ;DIM VORHANDEN ;on hand 
	
	IF +$PIECE(ART1,Y,26)=7 QUIT  ;FIS;31.03.03;23155;KONFIGURATIONSARTIKEL=KEIN UNTERTEIL
	
	QUIT:$DATA(^WWWSOR(YUSER,"ARTIKEL",ART))
	SET ^WWWSOR(YUSER,"ARTIKEL",ART)=""
	
	;EIGENAUFTRAG
	IF $PIECE(YFELD,Y,2)=1 IF +$PIECE(ART1,Y,26)'=0 IF $PIECE(ART1,Y,26)'=2 IF $PIECE(ART1,Y,26)'=3 QUIT  ;NUR LEISTUNGEN UND EIGENFERTIGUNG BEI INNTERNEM AUFTRAG ;only LEISTUNGEN And next to order 
	
	;LIEFERANTEN BESTELLUNG ;sales order 
	IF $PIECE(YFELD,Y,2)=2 IF $PIECE(ART1,Y,26)'=0 IF $PIECE(ART1,Y,26)'=1 IF $PIECE(ART1,Y,26)'=4 QUIT  ;NUR BESTELLUNG UND KLEINTEILE BER BESTELLUNGEN  ;only sales order And 
	
	IF $PIECE(YPOSITION1,Y,26)=2 IF $PIECE(ART1,Y,26)'=2 QUIT   ;NUR LEISTUNGEN AN LEISTUNGEN TYBD 07.05.2002 ;only LEISTUNGEN upon LEISTUNGEN 
	
	;PRÜFEN OB TEIL IN GLEICHEM TEIL;FIS;23867;07.07.03
	SET DOPPEL=0
	DO
	. NEW DATEI,YI
	. IF $PIECE($GET(^INAUFP(YM,YAUFTRAG,YPOSITION,1)),Y,4)=ART SET DOPPEL=1 QUIT
	. QUIT:$GET(YPARA)=""
	. SET DATEI="^INAUFPXL("_""""_YM_""""_","_""""_YAUFTRAG_""""_","_YPOSITION
	. FOR YI=0:1:$LENGTH(YPARA,",")  QUIT:$PIECE(YPARA,",",1,$LENGTH(YPARA,",")-YI)=""  DO  QUIT:DOPPEL=1
	. . SET DATEI(1)=DATEI_","_$PIECE(YPARA,",",1,$LENGTH(YPARA,",")-YI)
	. . SET DATEI(1)=DATEI(1)_")"
	. . IF $PIECE($GET(@DATEI(1)),Y,4)=ART SET DOPPEL=1
	
	;PRÜFEN OB OBERTEIL BEREITS GEFERTIGT / BESTÄNDE KORRIGIERT ;check whether yet 
	SET PROENDE=+$PIECE($GET(^INAUFP(YM,YAUFTRAG,YPOSITION,1)),Y,90)  ;PRODUKTION ABGESCHLOSSEN ;production 
	SET FERTDRUCK=0  ;FIS;11.08.04;26113;F.-ANWEISUNG GEDRUCKT
	IF PROENDE'=1 DO
	. NEW DATEI,FERT
	. SET DATEI="^INAUFPXL("_""""_YM_""""_","_""""_YAUFTRAG_""""_","_YPOSITION
	. IF $GET(YPARA)'="" SET DATEI=DATEI_","_YPARA
	. SET DATEI=DATEI_")"
	. IF $PIECE($GET(@DATEI),Y,165)'="" SET FERTDRUCK=1     ;FIS;11.08.04;26113;F.-ANWEISUNG GEDRUCKT
	. IF $PIECE($GET(@DATEI),Y,244)'="" SET PROENDE=1 QUIT  ;LAGERBUCHUNG DES OBERTEILS BEREITS ERFOLGT ;yet 
	. SET FERT=$PIECE($GET(@DATEI),Y,165)  ;FERTIGUNGSNUMMER
	. IF FERT'="" IF $PIECE($GET(^INPROSTEMP1(YM,FERT,1)),Y,22)'="" SET PROENDE=1 QUIT  ;LAGERBUCHUNG DES OBERTEILS BEREITS ERFOLGT ;yet 
	. IF FERT'="" IF $PIECE($GET(^INPROSTEMP(YM,FERT,1)),Y,22)'="" SET PROENDE=1  ;LAGERBUCHUNG DES OBERTEILS BEREITS ERFOLGT ;yet 
	
	IF +$PIECE($GET(^INAUFP(YM,YAUFTRAG,YPOSITION,1)),Y,90)=1 SET FERTDRUCK=1    ;FIS;11.08.04;26113;F.-ANWEISUNG GEDRUCKT
	IF PROENDE=1 SET FERTDRUCK=1   ;FIS;11.08.04;26113;F.-ANWEISUNG GEDRUCKT
	
	SET ANZM=ANZM+1
	WRITE "<TR>"
	SET YDDSATZ=YDDSATZ+1
	
	;MENGE ;quantity 
	WRITE "<TD NOWRAP VALIGN=MIDDLE"
	IF YDDSATZ#2=1 WRITE " BGCOLOR="_YWHITE
	WRITE ">"
	WRITE "<FONT SIZE=2>"
	
	;MENGENAUSWAHL
	WRITE "<INPUT NAME="_"YMNG"_ART_" SIZE=5 MAXLENGTH=5 TYPE=float VALUE="_""""_""""
	WRITE " TABINDEX=ART style="_""""_"padding-top:0 ;padding-bottom:0"_""""_" style="_""""_"text-align:right"_""""
	WRITE YCR
	WRITE " onFocus='select();'"
	IF $GET(YHTMFORM)="WWW2" DO
	. WRITE YCR," onBlur='"
	. WRITE " retval = EventValue("_""""_YUCI_""""_","_""""_YUSER_""""_","_""""_YFORM_""""_","_""""_"FIX"_$GET(YKEY)_""""_","_""""_""""_",this.value,"_""""_"0"_""""_","_""""_"YMNG"_ART_""""_");"
	. ;WRITE "document.WWW.ITEMS.value="_""""_ART_""""_";document.WWW.ITEMSQ.value=this.value;"
	. ;WRITE "document.WWW.ITEMBENN.value=document."_YHTMFORM_".YBEN"_ART_".value;"
	. ;IF DIMENS=1 DO
	. ;. WRITE "document.WWW.ITEMLNGN.value=document."_YHTMFORM_".YLNG"_ART_".value;"
	. ;. WRITE "document.WWW.ITEMBRTN.value=document."_YHTMFORM_".YBRT"_ART_".value;"
	. ;. WRITE "document.WWW.ITEMHOEN.value=document."_YHTMFORM_".YHOE"_ART_".value;"
	. ;. WRITE "document.WWW.ITEMMULN.value=document."_YHTMFORM_".YMUL"_ART_".value;"
	. WRITE "'"
	
	WRITE YCR
	WRITE " onKeyDown='if (event.keyCode == 13) event.keyCode = 9;'"
	
	/*vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv DISABLED BLOCK START
	;DO 
	. IF PROENDE=1 IF $DATA(^INARTT(YM,ART)) IF $$^INARTMENGE(ART)'>0 DO  QUIT
	. . IF YDDSATZ#2=1 WRITE " STYLE="_""""_"background-color: '"_YWHITE_"'"_""""
	. . IF YDDSATZ#2'=1 WRITE " STYLE="_""""_"background-color: '"_YGRAY_"'"_""""
	. . WRITE " READONLY="_""""_"READONLY"_""""
	;^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ DISABLED BLOCK END */
	
	WRITE " STYLE="_""""_"background-color: 'beige'"_""""
	WRITE ">"
	
	IF $PIECE(ART1,Y,66)=1 WRITE "<FONT COLOR=RED>"      ;ARTIKEL ;item 
	IF $PIECE(ART1,Y,66)=2 WRITE "<FONT COLOR=ORANGE>"   ;ACHTUNG ;estimation 
	IF $PIECE(ART1,Y,66)=3 WRITE "<FONT COLOR=GREEN>"    ;
	WRITE "&nbsp;"
	IF $PIECE(ART1,Y,46)="" SET $PIECE(ART1,Y,46)=$PIECE(ART1,Y,40)  ;VERKAUFSEINHEIT=MENGENEINHEIT
	IF $PIECE(ART1,Y,46)="" SET $PIECE(ART1,Y,46)=1
	
	;MENGENEINHEIT
	IF '$DATA(^WWW101(0,"EINHEIT",SPRACHE,+$PIECE(ART1,Y,46),1)) SET $PIECE(ART1,Y,46)=1               ;STUECK
	IF +$PIECE(ART1,Y,46)'=0 WRITE $PIECE($GET(^WWW101(0,"EINHEIT",SPRACHE,$PIECE(ART1,Y,46),1)),Y,1)  ;EINHEIT ;unit 
	WRITE "&nbsp;"
	
	;BREITE/LÄNGE/HÖHE
	IF DIMENS=1 DO
	. WRITE YCR
	. WRITE "<BR>"
	. WRITE "<INPUT NAME="_"YLNG"_ART_" SIZE=5 MAXLENGTH=10 TYPE=float VALUE="_""""_$$^WWWTR(0,12,$PIECE(ART1,Y,15))_""""
	. WRITE " TABINDEX=ART style="_""""_"padding-top:0 ;padding-bottom:0"_""""_" style="_""""_"text-align:right"_""""
	. WRITE " onFocus='select();'"
	. WRITE YCR
	. WRITE " onKeyDown='if (event.keyCode == 13) event.keyCode = 9;'"
	. WRITE YCR
	. SET ^WWWDATEN(YM,+$HOROLOG,YUSER,YFORM,"V","YLNG"_ART,1)=$PIECE(ART1,Y,15)  ;DATEN ZUR PRUEFUNG
	. WRITE " onBlur='retval = EventValue("_""""_YUCI_""""_","_""""_YUSER_""""_","_""""_YFORM_""""_","_""""_"FIX"_""""_","_""""_"INMNGART"_""""_",this.value,6,"_""""_ART_""""_" + "_""""_"/"_""""_" + "_"document."_YHTMFORM_".YBRT"_ART_".value"_"+"_""""_"/"_""""_" + "_"document."_YHTMFORM_".YHOE"_ART_".value"_"); if (retval != "_""""_""""_") document."_YHTMFORM_".YMNG"_ART_".value = retval;"
	. IF $GET(YHTMFORM)="WWW2" WRITE " retval = EventValue("_""""_YUCI_""""_","_""""_YUSER_""""_","_""""_YFORM_""""_","_""""_"FIX"_$GET(YKEY)_""""_","_""""_""""_",this.value,"_""""_"0"_""""_","_""""_"YLNG"_ART_""""_");"
	. ;IF $GET(YHTMFORM)="WWW2" DO
	. ;. WRITE "document.WWW.ITEMS.value = "_""""_ART_""""_";"
	. ;. WRITE "document.WWW.ITEMSQ.value = retval;"
	. ;. WRITE "document.WWW.ITEMLNGN.value=document."_YHTMFORM_".YLNG"_ART_".value;"
	. ;. WRITE "document.WWW.ITEMBRTN.value=document."_YHTMFORM_".YBRT"_ART_".value;"
	. ;. WRITE "document.WWW.ITEMHOEN.value=document."_YHTMFORM_".YHOE"_ART_".value;"
	. WRITE "'"
	. ;
	. WRITE ">"
	. WRITE " Dim.1"
	. ;
	. WRITE YCR
	. WRITE "<BR>"
	. WRITE "<INPUT NAME="_"YBRT"_ART_" SIZE=5 MAXLENGTH=10 TYPE=float VALUE="_""""_$$^WWWTR(0,12,$PIECE(ART1,Y,16))_""""
	. WRITE " TABINDEX=ART style="_""""_"padding-top:0 ;padding-bottom:0"_""""_" style="_""""_"text-align:right"_""""
	. WRITE " onFocus='select();'"
	. WRITE YCR
	. WRITE " onKeyDown='if (event.keyCode == 13) event.keyCode = 9;'"
	. WRITE YCR
	. SET ^WWWDATEN(YM,+$HOROLOG,YUSER,YFORM,"V","YBRT"_ART,1)=$PIECE(ART1,Y,16)  ;DATEN ZUR PRUEFUNG
	. WRITE " onBlur='retval = EventValue("_""""_YUCI_""""_","_""""_YUSER_""""_","_""""_YFORM_""""_","_""""_"FIX"_""""_","_""""_"INMNGART"_""""_",this.value,6,"_""""_ART_""""_" + "_""""_"/"_""""_" + "_"document."_YHTMFORM_".YLNG"_ART_".value"_"+"_""""_"/"_""""_" + "_"document."_YHTMFORM_".YHOE"_ART_".value"_"); if (retval != "_""""_""""_") document."_YHTMFORM_".YMNG"_ART_".value = retval;"
	. IF $GET(YHTMFORM)="WWW2" WRITE " retval = EventValue("_""""_YUCI_""""_","_""""_YUSER_""""_","_""""_YFORM_""""_","_""""_"FIX"_$GET(YKEY)_""""_","_""""_""""_",this.value,"_""""_"0"_""""_","_""""_"YBRT"_ART_""""_");"
	. ;IF $GET(YHTMFORM)="WWW2" DO
	. ;. WRITE "document.WWW.ITEMS.value = "_""""_ART_""""_";"
	. ;. WRITE "document.WWW.ITEMSQ.value = retval;"
	. ;. WRITE "document.WWW.ITEMLNGN.value=document."_YHTMFORM_".YLNG"_ART_".value;"
	. ;. WRITE "document.WWW.ITEMBRTN.value=document."_YHTMFORM_".YBRT"_ART_".value;"
	. ;. WRITE "document.WWW.ITEMHOEN.value=document."_YHTMFORM_".YHOE"_ART_".value;"
	. WRITE "'"
	. ;
	. WRITE ">"
	. WRITE " Dim.2"
	. ;
	. WRITE YCR
	. WRITE "<BR>"
	. WRITE "<INPUT NAME="_"YHOE"_ART_" SIZE=5 MAXLENGTH=10 TYPE=float VALUE="_""""_$$^WWWTR(0,12,$PIECE(ART1,Y,17))_""""
	. WRITE " TABINDEX=ART style="_""""_"padding-top:0 ;padding-bottom:0"_""""_" style="_""""_"text-align:right"_""""
	. WRITE " onFocus='select();'"
	. WRITE YCR
	. WRITE " onKeyDown='if (event.keyCode == 13) event.keyCode = 9;'"
	. WRITE YCR
	. SET ^WWWDATEN(YM,+$HOROLOG,YUSER,YFORM,"V","YHOE"_ART,1)=$PIECE(ART1,Y,17)  ;DATEN ZUR PRUEFUNG
	. WRITE " onBlur='retval = EventValue("_""""_YUCI_""""_","_""""_YUSER_""""_","_""""_YFORM_""""_","_""""_"FIX"_""""_","_""""_"INMNGART"_""""_",this.value,6,"_""""_ART_""""_" + "_""""_"/"_""""_" + "_"document."_YHTMFORM_".YBRT"_ART_".value"_"+"_""""_"/"_""""_" + "_"document."_YHTMFORM_".YLNG"_ART_".value"_"); if (retval != "_""""_""""_") document."_YHTMFORM_".YMNG"_ART_".value = retval;"
	. IF $GET(YHTMFORM)="WWW2" WRITE " retval = EventValue("_""""_YUCI_""""_","_""""_YUSER_""""_","_""""_YFORM_""""_","_""""_"FIX"_$GET(YKEY)_""""_","_""""_""""_",this.value,"_""""_"0"_""""_","_""""_"YHOE"_ART_""""_");"
	. ;IF $GET(YHTMFORM)="WWW2" DO
	. ;.WRITE "document.WWW.ITEMS.value = "_""""_ART_""""_";"
	. ;.WRITE "document.WWW.ITEMSQ.value = retval;"
	. ;.WRITE "document.WWW.ITEMLNGN.value=document."_YHTMFORM_"]]><![CDATA[.YLNG"_ART_".value;"
	. ;.WRITE "document.WWW.ITEMBRTN.value=document."_YHTMFORM_".YBRT"_ART_".value;"
	. ;.WRITE "document.WWW.ITEMHOEN.value=document."_YHTMFORM_".YHOE"_ART_".value;"
	. WRITE "'"
	. ;
	. WRITE ">"
	. WRITE " Dim.3"
	. ;
	. ;WRITE "&nbsp;"
	. WRITE "<IMG SRC="_""""_YGIF_"total.gif"_""""_" ALIGN=right TITLE="_""""_$$^WWWTEXT(32366)_""""_" border=0>"
	. WRITE "</TD>",YCR
	
	;ARTIKEL NUMMER ;item numeral 
	WRITE "<TD NOWRAP ALIGN=LEFT VALIGN=TOP"
	IF YDDSATZ#2=1 WRITE " BGCOLOR="_YWHITE
	WRITE ">"
	WRITE "<FONT SIZE=2>"
	IF $PIECE(ART1,Y,66)=1 WRITE "<FONT COLOR=RED>"      ;ARTIKEL ;item 
	IF $PIECE(ART1,Y,66)=2 WRITE "<FONT COLOR=ORANGE>"   ;ACHTUNG ;estimation 
	IF $PIECE(ART1,Y,66)=3 WRITE "<FONT COLOR=GREEN>"    ;
	WRITE ART
	WRITE "&nbsp;"
	WRITE "</TD>"
	;
	;
	;BEZEICHNUNG ;notation 
	WRITE "<TD NOWRAP VALIGN=TOP WIDTH=30%"
	IF YDDSATZ#2=1 WRITE " BGCOLOR="_YWHITE
	WRITE ">"
	WRITE "<FONT SIZE=2>"
	IF $PIECE(ART1,Y,66)=1 WRITE "<FONT COLOR=RED>"      ;ARTIKEL ;item 
	IF $PIECE(ART1,Y,66)=2 WRITE "<FONT COLOR=ORANGE>"   ;ACHTUNG ;estimation 
	IF $PIECE(ART1,Y,66)=3 WRITE "<FONT COLOR=GREEN>"    ;
	WRITE $PIECE(ART1,Y,1)
	WRITE "<BR>"
	WRITE "<INPUT NAME="_"YBEN"_ART_" SIZE=20 MAXLENGTH=40 TYPE=TEXT VALUE="_""""_""""
	WRITE " TABINDEX=ART style="_""""_"padding-top:0 ;padding-bottom:0"_""""
	WRITE " onFocus='select();'"
	
	;IF $GET(YHTMFORM)="WWW2" WRITE " onBlur='document.WWW.ITEMBENN.value=this.value;'"
	IF $GET(YHTMFORM)="WWW2" WRITE " onBlur='retval = EventValue("_""""_YUCI_""""_","_""""_YUSER_""""_","_""""_YFORM_""""_","_""""_"FIX"_$GET(YKEY)_""""_","_""""_""""_",this.value,"_""""_"0"_""""_","_""""_"YBEN"_ART_""""_");'"
	WRITE YCR
	WRITE " onKeyDown='if (event.keyCode == 13) event.keyCode = 9;'"
	WRITE ">"
	
	;MENGE, WENN VIELE EINHEITEN
	IF DIMENS=1 DO
	. WRITE "<BR>"
	. WRITE "<INPUT NAME="_"YMUL"_ART_" SIZE=4 MAXLENGTH=10 TYPE=TEXT VALUE="_""""_""""
	. WRITE " TABINDEX=ART style="_""""_"padding-top:0 ;padding-bottom:0"_""""
	. WRITE " onFocus='select();'"
	. ;IF $GET(YHTMFORM)="WWW2" WRITE YCR," onBlur='document.WWW.ITEMMULN.value=this.value;'"
	. IF $GET(YHTMFORM)="WWW2" WRITE " onBlur='retval = EventValue("_""""_YUCI_""""_","_""""_YUSER_""""_","_""""_YFORM_""""_","_""""_"FIX"_$GET(YKEY)_""""_","_""""_""""_",this.value,"_""""_"0"_""""_","_""""_"YMUL"_ART_""""_");'"
	. WRITE YCR
	. WRITE " onKeyDown='if (event.keyCode == 13) event.keyCode = 9;'"
	. WRITE ">"
	. WRITE "&nbsp;"_$$^WWWTEXT(32240)  ;MENGE
	. WRITE YCR
	
	;TEIL IN EIGENEM TEIL ;FIS;23867;07.07.03
	IF DOPPEL=1 DO
	. WRITE "<BR>"
	. WRITE "<FONT COLOR="_YRED_"><B>"_$$^WWWTEXT(33525,,1)_"</B></FONT>"  ;ACHTUNG ARTIKEL KANN NICHT IN SICH SELBST EINGEBAUT WERDEN ;estimation item Not within yourself self in-built will 
	
	;BESTANDSKORREKTUR WENN PRODUKTION ABGESCHLOSSEN BZW. DAS OBERTEIL BEREITS BERICHTIGT WURDE ;when production resp. who yet were 
	IF PROENDE=1 DO
	. IF $DATA(^INARTT(YM,ART)) DO  ;FERTIGUNGSTEIL
	. . WRITE "<BR>"
	. . WRITE "<FONT COLOR="_YRED_">"_$$^WWWTEXT(33052,,1)_"</FONT>"  ;PRODUKTION ABGESCHLOSSEN, ANLAGE NUR AUS LAGERBESTAND !
	. . WRITE "<INPUT NAME="_"YWHLAG"_ART_" TYPE="_""""_"HIDDEN"_""""_" VALUE="_""""_1_""""_">"
	. . IF $GET(YHTMFORM)="WWW2" SET ^WWWDATEN(YM,+$HOROLOG,YUSER,YFORM,"V","YWHLAG"_ART,1)=1
	. . QUIT
	. WRITE "<BR>"
	. WRITE "<INPUT NAME="_"YBEKOR"_ART_" TYPE="_""""_"CHECKBOX"_""""_" VALUE="_""""_1_""""
	. WRITE " TABINDEX=ART style="_""""_"padding-top:0 ;padding-bottom:0"_""""
	. WRITE " checked"
	. WRITE " onFocus='select();'"
	. WRITE YCR
	. IF $GET(YHTMFORM)="WWW2" DO ^WWWEVENTCALL("YBEKOR"_ART,1,3)
	. IF $GET(YHTMFORM)'="WWW2" WRITE " onKeyDown='if (event.keyCode == 13) event.keyCode = 9;'"
	. WRITE ">"
	. WRITE "&nbsp;<FONT COLOR="_YRED_">"_$$^WWWTEXT(33038,,1)_"</FONT>"  ;BESTAND NACHTRÄGLICH KORRIGIEREN
	. WRITE YCR
	
	IF FERTDRUCK=1 DO  ;HINWEISMELDUNG WENN FERT.-ANWEISUNG BEREITS GEDRUCKT ;when yet 
	. WRITE "<BR>"
	. WRITE "<FONT COLOR="_YRED_"><B>"_$$^WWWTEXT(33568)_"</B></FONT>"  ;F.-ANWEISUNG BEREITS GEDRUCKT ;yet 
	
	WRITE "</TD>",YCR
	
	;BESTAND
	WRITE "<TD VALIGN=TOP ALIGN=RIGHT NOWRAP"
	IF YDDSATZ#2=1 WRITE " BGCOLOR="_YWHITE
	WRITE ">"
	WRITE "<FONT SIZE=2>"
	IF $PIECE(ART1,Y,66)=1 WRITE "<FONT COLOR=RED>"
	IF $PIECE(ART1,Y,66)=2 WRITE "<FONT COLOR=ORANGE>"
	IF $PIECE(ART1,Y,66)=3 WRITE "<FONT COLOR=GREEN>"
	DO
	. NEW MENGE
	. SET MENGE=$$^INARTMENGE(ART)
	. IF +MENGE>0 WRITE MENGE
	
	WRITE "&nbsp;"
	WRITE "</TD>",YCR
	
	;EINZEL-PREIS
	WRITE "<TD VALIGN=TOP ALIGN=RIGHT NOWRAP"
	IF YDDSATZ#2=1 WRITE " BGCOLOR="_YWHITE
	WRITE ">"
	WRITE "<FONT SIZE=2>"
	IF $PIECE(ART1,Y,66)=1 WRITE "<FONT COLOR=RED>"
	IF $PIECE(ART1,Y,66)=2 WRITE "<FONT COLOR=ORANGE>"
	IF $PIECE(ART1,Y,66)=3 WRITE "<FONT COLOR=GREEN>"
	WRITE $$^WWWZAHL($$^INARTKOST(ART,1),10,2,YWHR)
	WRITE "&nbsp;"
	WRITE "</TD>",YCR
	
	;AUSFÜHRUNG ;execution 
	WRITE "<TD VALIGN=TOP"
	IF YDDSATZ#2=1 WRITE " BGCOLOR="_YWHITE
	WRITE ">"
	WRITE "<FONT SIZE=2>"
	IF $PIECE(ART1,Y,66)=1 WRITE "<FONT COLOR=RED>"
	IF $PIECE(ART1,Y,66)=2 WRITE "<FONT COLOR=ORANGE>"
	IF $PIECE(ART1,Y,66)=3 WRITE "<FONT COLOR=GREEN>"
	WRITE $TRANSLATE($PIECE(ART1,Y,14),"|"," ")
	WRITE "&nbsp;"
	WRITE "</TD>",YCR
	
	WRITE "</TR>"
	QUIT
	
HIDDEN ;NEU HIDDENFELDER ;recent 
	QUIT:$GET(YHTMFORM)'="WWW2"
	
	WRITE YCR,"<INPUT TYPE=HIDDEN NAME="_""""_"ITEMS"_""""_" VALUE="_""""_""""_">"
	WRITE YCR,"<INPUT TYPE=HIDDEN NAME="_""""_"ITEMSQ"_""""_" VALUE="_""""_""""_">"
	WRITE YCR,"<INPUT TYPE=HIDDEN NAME="_""""_"ITEMBENN"_""""_" VALUE="_""""_""""_">"
	WRITE YCR,"<INPUT TYPE=HIDDEN NAME="_""""_"ITEMMULN"_""""_" VALUE="_""""_""""_">"
	WRITE YCR,"<INPUT TYPE=HIDDEN NAME="_""""_"ITEMLNGN"_""""_" VALUE="_""""_""""_">"
	WRITE YCR,"<INPUT TYPE=HIDDEN NAME="_""""_"ITEMBRTN"_""""_" VALUE="_""""_""""_">"
	WRITE YCR,"<INPUT TYPE=HIDDEN NAME="_""""_"ITEMHOEN"_""""_" VALUE="_""""_""""_">"
	QUIT
]]></Routine>
</Export>